if (self.CavalryLogger) { CavalryLogger.start_js(["BY9S4"]); }

__d("MNCommerceCallToActionType",[],(function a(b,c,d,e,f,g){f.exports={OPEN_NATIVE:1,OPEN_URL:2,OPEN_CANCEL_RIDE_MUTATION:3,POSTBACK:4,ACCOUNT_LINK:5,MANAGE_MESSAGES:6,SHARE:7,PAYMENT:8,FACEBOOK_REPORT_A_PROBLEM:9,SUBSCRIPTION_PRESELECT:10,NAVIGATION:11,EXTENSIBLE_SHARE:12,OPEN_REACT_NATIVE_MINI_APP:13,OPEN_PAGE_ABOUT:14};}),null);
__d('FBButtonMenuCombo.react',['invariant','FBActionSelector.react','React','Tooltip','XUIButton.react','XUIButtonGroup.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k,l,m=c('FBActionSelector.react').Option,n=c('React').PropTypes;i=babelHelpers.inherits(o,c('React').PureComponent);j=i&&i.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.$FBButtonMenuCombo1=function(){var u=[],v=[];c('React').Children.forEach(this.props.children,function(w,x){w.type.__FBButtonMenuComboItem__||h(0);if(x<this.props.numberOfButtons){var y=this.props.useImageOnlyButtons?null:w.props.label;u.push(c('React').createElement(c('XUIButton.react'),babelHelpers['extends']({},c('Tooltip').propsFor(w.props.tooltip),{'data-testid':w.props['data-testid'],'data-tooltip-alignh':this.props.tooltipAlignH,'data-tooltip-position':this.props.tooltipPosition,disabled:this.props.disabled||w.props.disabled,image:w.props.image,key:w.props.value,label:y,onClick:function(){return this.props.onClick(w.props.value);}.bind(this),size:this.props.size})));}else v.push(c('React').createElement(m,babelHelpers['extends']({},c('Tooltip').propsFor(w.props.tooltip),{'data-tooltip-alignh':this.props.tooltipAlignH,'data-tooltip-position':this.props.tooltipPosition,disabled:this.props.disabled||w.props.disabled,key:w.props.value,value:w.props.value}),w.props.label));}.bind(this));return {buttons:u,menuItems:v};}.bind(this),q;}o.prototype.render=function(){var p=this.$FBButtonMenuCombo1(),q=p.buttons,r=p.menuItems,s=null;if(r.length>0)s=c('React').createElement(c('FBActionSelector.react'),{alignment:'right',disabled:this.props.disabled,onAction:this.props.onClick,size:this.props.size},r);return c('React').createElement(c('XUIButtonGroup.react'),{className:'uiContextualLayerParent'},q,s);};o.__FBButtonMenuCombo__=true;o.propTypes={disabled:n.bool,numberOfButtons:n.number,onClick:n.func.isRequired,size:n.oneOf(['small','medium','large','xlarge','xxlarge']),tooltipPosition:n.oneOf(['above','below','left','right']),tooltipAlignH:n.oneOf(['left','right','center']),useImageOnlyButtons:n.bool};o.defaultProps={numberOfButtons:1,size:'medium'};o.Item=(l=k=function(){var p,q;p=babelHelpers.inherits(r,c('React').PureComponent);q=p&&p.prototype;r.prototype.render=function(){'use strict';return null;};function r(){'use strict';p.apply(this,arguments);}return r;}(),k.__FBButtonMenuComboItem__=true,k.propTypes={disabled:n.bool,image:n.element,label:n.string.isRequired,tooltip:n.string,value:n.string.isRequired},l);f.exports=o;}),null);
__d('OzBugNub.react',['cx','fbt','Link.react','OzImmutablePureRenderMixin','React','Tooltip','URI'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=1031744366845008,k='Error:\n\nExpected Result:\n\nSteps taken before error occurred:\n',l=c('React').createClass({displayName:'MessengerBugNub',mixins:[c('OzImmutablePureRenderMixin')],render:function m(){var n=new (c('URI'))('/ajax/bugs/report').setQueryData({config_id:j,defaultText:k});return c('React').createElement('div',{className:"_gml"},c('React').createElement(c('Link.react'),babelHelpers['extends']({href:'#',ajaxify:n,className:"_gmm",rel:'dialog'},c('Tooltip').propsFor(i._("Informar de un error"))),c('React').createElement('span',{className:"_gmn"})));}});f.exports=l;}),null);
__d('OzDialogContainer.react',['OzStores','React','Reflux'],(function a(b,c,d,e,f,g){var h=c('OzStores').DialogStore,i=c('React').createClass({displayName:'OzDialogContainer',mixins:[c('Reflux').connect(h,'dialog')],render:function j(){var k=this.state.dialog.dialogClass;if(k){var l=this.state.dialog.dialogProps||{};return c('React').createElement(k,babelHelpers['extends']({ref:'dialog'},l,{key:'dialog'}));}return null;}});f.exports=i;}),null);
__d('OzExtensionCheck.react',['cx','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','React','ReloadPage','ShimButton.react','SUIAtlasTheme','SUINotice.react','XUIDialog.react'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.render=function(){'use strict';return c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},c('React').createElement('div',{className:"_4eby _2c9g _1-6z"},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,'The Oz Chrome Extension is missing')),c('React').createElement(c('SUINotice.react'),{theme:c('SUIAtlasTheme'),type:'error'},c('React').createElement('div',{className:"_4d80"},'Toto, the oz chrome extension that helps you manage your tabs, and record what was done for each task in the background is missing!',c('React').createElement('strong',null,c('React').createElement(c('ShimButton.react'),{form:'link',onClick:this.props.onInstall},' Click here to install it.'))))));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={onInstall:m.func.isRequired};k=babelHelpers.inherits(o,c('React').Component);l=k&&k.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=l.constructor).call.apply(p,[this].concat(s)),this.$OzExtensionCheck1=function(){window.chrome.webstore.install(undefined,function(u){return c('ReloadPage').now();});},q;}o.prototype.componentDidMount=function(){'use strict';var p=!!document.querySelector('#toto-installed');if(p)return;c('OzActions').showDialog(n,{onInstall:this.$OzExtensionCheck1});};o.prototype.render=function(){'use strict';return null;};f.exports=o;}),null);
__d('OzButton.react',['cx','joinClasses','promiseFinally','React'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzButton',propTypes:{disabled:i.bool,onClick:i.func,primary:i.bool,tight:i.bool,type:i.oneOf(['button','submit','reset']),use:i.oneOf(['default','warning','danger'])},getDefaultProps:function k(){return {disabled:false,primary:false,tight:false,type:'button',use:'default'};},getInitialState:function k(){return {loading:false};},render:function k(){var l=this.props,m=l.children,n=l.className,o=l.disabled,p=l.onClick,q=l.primary,r=l.tight,s=l.type,t=l.use,u=babelHelpers.objectWithoutProperties(l,['children','className','disabled','onClick','primary','tight','type','use']),v=this.state.loading,w=c('joinClasses')(n,"_325k"+(v?' '+"_3e2u":'')+(q?' '+"_325m":'')+(r?' '+"_4wku":'')+(t==='default'?' '+"_325o":'')+(t==='warning'?' '+"_325p":'')+(t==='danger'?' '+"_325q":'')+(o?' '+"_ysb":'')+(!o&&!v?' '+"_4wkv":'')+(' '+"_1-hv"));return c('React').createElement('button',babelHelpers['extends']({className:w,disabled:o,onClick:this._handleClick,type:s},u),c('React').createElement('span',{className:"_325r"},m));},_handleClick:function k(l){var m=this.props,n=m.disabled,o=m.loading,p=m.onClick;if(n||o){l.preventDefault();return;}if(!p)return;if(p.length>1){this.setState({loading:true});p(l,this._done);return;}var q=p(l);if(q&&q.then){this.setState({loading:true});c('promiseFinally')(q,this._done);}},_done:function k(){if(this.isMounted())this.setState({loading:false});}});f.exports=j;}),null);
__d('OzFailed.react',['cx','immutable','OzButton.react','React','ReloadPage'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Iterable,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_30r7"},c('React').createElement('div',{className:"_4rg-"},c('React').createElement('div',null,'Oz couldn\'t load the following resources:',c('React').createElement('ul',null,this.props.problems.map(function(n,o){return c('React').createElement('li',{key:o},n);})),'Please wait a few seconds, then refresh. If this problem persists for more than a minute or so, contact the oncall.'),c('React').createElement('div',{className:"_4rg_"},c('React').createElement(c('OzButton.react'),{primary:true,onClick:c('ReloadPage').now},'Refresh'))));};function m(){'use strict';i.apply(this,arguments);}m.propTypes={problems:l.instanceOf(k)};f.exports=m;}),null);
__d('OzHumans',['OzHelpers'],(function a(b,c,d,e,f,g){var h=60000,i=45000,j=-1;function k(s){return s.get('coach-mode?');}function l(s){return s.get('is-coach');}function m(s){return s.get('away?');}function n(s){return s&&!m(s)&&c('OzHelpers').serverNow()-s.get('at',0)<i;}function o(s){return n(s)&&s.get('inactive-ms',0)<h;}function p(s){return o(s)&&s.get('load',0)<=0&&s.get('team',j)!==j;}function q(s){return o(s)&&!k(s);}function r(s){var t=s.filter(q).count(),u=s.reduce(function(v,w){return v+w.get('load',0);},0);return u/t;}f.exports={inCoachMode:k,isCoach:l,isAway:m,isPresent:n,isActive:o,isIdle:p,isWorking:q,avgLoad:r};}),null);
__d('OzReps',['OzHelpers'],(function a(b,c,d,e,f,g){var h=1000*60*60*8;function i(l){return !l||c('OzHelpers').serverNow()-l.get('updated-at',0)>h;}function j(l){var m=l.get('stats');return i(m)?0:m.get('closed-intents',0);}function k(l,m){var n=l.get('team');return m.reduce(function(o,p){return o+(p.get('team')===n?j(p):0);},0);}f.exports={closedIntentCount:j,teamClosedIntentCount:k};}),null);
__d('OzTriSwitch.react',['cx','React','joinClasses'],(function a(b,c,d,e,f,g,h){function i(k){var l=k.className,m=k.value,n=k.onClick,o=k.label,p=k.animated,q=babelHelpers.objectWithoutProperties(k,['className','value','onClick','label','animated']);return c('React').createElement('div',babelHelpers['extends']({},q,{className:c('joinClasses')(l,"_56de"+(q.reverseColors?' '+"_3tyl":'')+(p?' '+"_56df":'')+(m==='on'?' '+"_56dg":'')+(m==='off'?' '+"_56dh":'')+(m==='neutral'?' '+"_56di":'')),onClick:function(r){function s(t){return r.apply(this,arguments);}s.toString=function(){return r.toString();};return s;}(function(r){return n(j[m]);}),role:'checkbox',tabIndex:'0'}),c('React').createElement('div',{className:"_56dj",tabIndex:'0'},c('React').createElement('div',{className:"_56dk"})),o?c('React').createElement('span',{className:"_56dn"},o):null);}var j={on:'off',off:'neutral',neutral:'on'};i.toBoolean=function(k){if(k==='neutral')return undefined;if(k==='on')return true;if(k==='off')return false;throw new Error('OzTriSwitch: unknown state '+k);};i.fromBoolean=function(k){return k==null?'neutral':k?'on':'off';};f.exports=i;}),null);
__d('OzSwitch.react',['OzImmutablePureRenderMixin','OzTriSwitch.react','React'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=c('React').createClass({displayName:'OzSwitch',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{isAnimated:h.bool.isRequired,isOn:h.bool.isRequired,label:h.node.isRequired,onToggle:h.func.isRequired,reverseColors:h.bool},getDefaultProps:function j(){return {isAnimated:false};},render:function j(){var k=this.props,l=k.className,m=k.isAnimated,n=k.isOn,o=k.label,p=k.onToggle;return c('React').createElement(c('OzTriSwitch.react'),{animated:m,className:l,reverseColors:!!this.props.reverseColors,label:o,onClick:function q(){return p(!n);},value:c('OzTriSwitch.react').fromBoolean(n)});}});f.exports=i;}),null);
__d("OzReactMetrics",[],(function a(b,c,d,e,f,g){var h={},i=function l(){return {mountCount:0,mountAvgMs:0,mountTotalMs:0,updateCount:0,updateAvgMs:0,updateTotalMs:0};},j=function l(m,n){if(!h[m])h[m]=i();h[m].mountCount+=1;h[m].mountTotalMs+=n;h[m].mountAvgMs=h[m].mountTotalMs/h[m].mountCount;},k=function l(m,n){if(!h[m])h[m]=i();h[m].updateCount+=1;h[m].updateTotalMs+=n;h[m].updateAvgMs=h[m].updateTotalMs/h[m].updateCount;};f.exports={metrics:h,updateMount:j,updateUpdate:k};}),null);
__d('OzWrapper.react',['React','OzReactMetrics'],(function a(b,c,d,e,f,g){function h(i){var j,k;j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;l.prototype.componentWillMount=function(){'use strict';this.$Comp1=Date.now();};l.prototype.componentDidMount=function(){'use strict';var m=Date.now()-this.$Comp1;c('OzReactMetrics').updateMount(i.displayName,m);};l.prototype.componentWillUpdate=function(){'use strict';this.$Comp2=Date.now();};l.prototype.componentDidUpdate=function(){'use strict';var m=Date.now()-this.$Comp2;c('OzReactMetrics').updateUpdate(i.displayName,m);};l.prototype.render=function(){'use strict';return c('React').createElement(i,babelHelpers['extends']({},this.props,this.state));};function l(){'use strict';j.apply(this,arguments);}return l;}f.exports=h;}),null);
__d('OzHeader.react',['cx','OzHelpers','immutable','Layout.react','messengerButtonReact','OzButton.react','OzConfig','OzHumans','OzReps','OzStores','OzSwitch.react','React','OzWrapper.react','Reflux','ReactRouter','Tooltip'],(function a(b,c,d,e,f,g,h){var i=c('messengerButtonReact').jsComponent,j=c('immutable').Map,k=c('OzStores').RepStore,l=c('OzStores').HumanStore,m=c('ReactRouter').Link,n=c('React').PropTypes,o=c('React').createClass({displayName:'OzHeader',mixins:[c('Reflux').connect(l,'humans'),c('Reflux').connect(k,'reps'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{coachMode:n.bool.isRequired,rev:n.number.isRequired,version:n.string.isRequired,onAway:n.func.isRequired,onCoachModeToggle:n.func.isRequired,params:n.object.isRequired},contextTypes:{uid:n.string.isRequired,router:n.object.isRequired},render:function q(){var r='/inbox/'+(this.props.params.threadid||''),s=this.state.humans.getIn([this.context.uid,'load'],0),t='Inbox'+(s?' ('+s+')':''),u=this.state.config.get('GK',j());return c('React').createElement(c('Layout.react'),{className:"_2d86"},c('React').createElement('div',{className:"_2d87"},c('React').createElement(m,{to:'/',className:"_2d88"}),this._renderItem(t,r),this._renderItem('Merchants','/merchants'),this._renderItem('Feedback','/feedback'),this._renderItem('Top','/top'),u.get('supervisor')&&this._renderItem('Trainers','/trainers'),u.get('allThreads')&&this._renderItem('All Threads','/all')),c('React').createElement('div',{className:"_j6m"},c('React').createElement(p,{humans:this.state.humans,reps:this.state.reps,uid:this.context.uid})),c('React').createElement(i,{label:'Away',className:"_4s9f",type:'primary',onClick:this.props.onAway}),u.get('supervisor')?c('React').createElement(c('OzSwitch.react'),{className:"_b8c",isAnimated:true,isOn:this.props.coachMode,label:'Coach Mode',onToggle:this.props.onCoachModeToggle}):null);},_renderItem:function q(r,s){return c('React').createElement(m,{activeClassName:'active',className:"_33os",to:s},c('React').createElement('span',null,r));}}),p=c('OzHelpers').pure(function(q){var r=q.reps,s=q.humans,t=q.uid,u=r.get(t,j()),v=c('OzReps').closedIntentCount(u),w=c('OzReps').teamClosedIntentCount(u,r),x=Math.round(c('OzHumans').avgLoad(s)),y=isFinite(x)?x:'N/A',z=s.filter(c('OzHumans').isWorking).count();return c('React').createElement('div',null,c('React').createElement('span',babelHelpers['extends']({className:"_3fs"},c('Tooltip').propsFor('Your closed intents')),v),c('React').createElement('span',{className:"_4s9g"},'closed by you'),' ',c('React').createElement('span',babelHelpers['extends']({className:"_3fs"},c('Tooltip').propsFor('Closed intents for your entire team')),w),c('React').createElement('span',{className:"_4s9g"},'closed by team'),c('React').createElement('span',{className:"_3fs"},y),c('React').createElement('span',{className:"_4s9g"},'average load'),c('React').createElement('span',{className:"_3fs"},z),c('React').createElement('span',{className:"_4s9g"},z===1?'trainer':'trainers'));});f.exports=c('OzWrapper.react')(o);}),null);
__d('OzLoading.react',['cx','MessengerFlexArea.react','MessengerSpinner.react','React'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_30r7"},c('React').createElement(c('MessengerSpinner.react'),{color:this.props.color}),c('React').createElement('div',{className:"_4rg-",style:{marginLeft:'10px'}},this.props.message));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={message:m.node,color:m.oneOf(["grey","blue"])};n.defaultProps={color:"blue"};n.Inline=(l=k=function(){var o,p;o=babelHelpers.inherits(q,c('React').Component);p=o&&o.prototype;q.prototype.render=function(){'use strict';var r=this.props,s=r.loading,t=babelHelpers.objectWithoutProperties(r,['loading']);if(!s)return null;return c('React').createElement('div',{className:"_nkb"},c('React').createElement(n,t));};function q(){'use strict';o.apply(this,arguments);}return q;}(),k.propTypes={loading:m.bool.isRequired},l);n.Flex=function(){var o,p;o=babelHelpers.inherits(q,c('React').Component);p=o&&o.prototype;q.prototype.render=function(){'use strict';return c('React').createElement(c('MessengerFlexArea.react'),null,c('React').createElement(n,this.props));};function q(){'use strict';o.apply(this,arguments);}return q;}();f.exports=n;}),null);
__d('OzDate.react',['cx','formatDate','immutable','joinClasses','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes,l=c('immutable').fromJS([{start:0,end:7*24*3600000,format:'D g:ia'},{start:7*24*3600000,end:365*24*3600000,format:'M jS, g:ia'},{start:365*24*3600000,end:Infinity,format:'m/d/Y g:ia'}]);i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.formatTimestamp=function(n){'use strict';if(n<Date.now()+24*3600000){return c('formatDate')(new Date(n),{today:'g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});}else return c('formatDate')(new Date(n),l.find(function(o){return n>Date.now()+o.get('start')&&n<Date.now()+o.get('end');}).get('format'));};m.prototype.render=function(){'use strict';var n=this.constructor.formatTimestamp(this.props.timestamp);return c('React').createElement('time',{className:c('joinClasses')("_2s4p",this.props.className)},n);};function m(){'use strict';i.apply(this,arguments);}m.propTypes={timestamp:k.number.isRequired};f.exports=m;}),null);
__d('OzDraggable.react',['cx','Draggable','joinClasses','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzDraggable',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{getHandle:i.func},componentDidMount:function k(){this._draggable=new (c('Draggable'))(this.refs.root).setUseAbsolute(true).setGutter(15);this._updateHandle();},componentDidUpdate:function k(){this._updateHandle();},_updateHandle:function k(){if(this._handle)this._draggable.removeHandle(this._handle);this._handle=(this.props.getHandle||function(){return this.refs.root;}.bind(this))();this._draggable.addHandle(this._handle);},render:function k(){var l=this.props,m=l.children,n=l.className,o=babelHelpers.objectWithoutProperties(l,['children','className']);return c('React').createElement('div',{className:"_5k4j"},c('React').createElement('div',babelHelpers['extends']({className:c('joinClasses')("_2c1d",n),ref:'root'},o),m));},componentWillUnmount:function k(){this._draggable&&this._draggable.destroy();}});f.exports=j;}),null);
__d('OzDraggableModal.react',['cx','joinClasses','OzDraggable.react','React'],(function a(b,c,d,e,f,g,h){var i,j;i=babelHelpers.inherits(k,c('React').PureComponent);j=i&&i.prototype;k.prototype.render=function(){'use strict';var l=this.props,m=l.children,n=l.className,o=babelHelpers.objectWithoutProperties(l,['children','className']);return c('React').createElement(c('OzDraggable.react'),babelHelpers['extends']({className:c('joinClasses')("_5d80",n)},o),m);};function k(){'use strict';i.apply(this,arguments);}f.exports=k;}),null);
__d('OzUserImage.react',['cx','joinClasses','Image.react','immutable','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzUserImage',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{photo:j.object},render:function l(){var m=c('joinClasses')(this.props.className,"_3c52 _3c53"),n=function p(q){return c('React').createElement(c('Image.react'),{className:m,src:q});},o=this.props.photo||i();return o.getIn(['data','url'])&&n(o.getIn(['data','url']))||o.get('data')&&n(o.get('mime_type')+','+o.get('data'))||c('React').createElement('span',{className:c('joinClasses')(m,"_3ejm")});}});f.exports=k;}),null);
__d('OzSearch.react',['cx','OzAPI','OzHelpers','Image.react','immutable','Keys','OzActions','OzDate.react','OzDraggableModal.react','OzStores','OzUserImage.react','ReactComponentWithPureRenderMixin','React','Reflux','ShimButton.react','XUITextInput.react','OzConfig','debounce'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m,n=c('immutable').List,o=c('immutable').Map,p=c('React').PropTypes,q=c('OzStores').ActiveThreadStore,r=c('OzStores').ThreadStore,s='Messages',t='Side Bar',u='Users',v='Calendars',w='All',x=[s,t,u,v,w],y=(m={},m[s]='messages',m[t]='side-bar',m[u]='users',m[v]='calendar-event',m[w]='all',m),z=c('React').createClass({displayName:'OzSearch',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(q,'activeThread'),c('Reflux').connect(r,'threads'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{router:p.object.isRequired},componentWillMount:function la(){this._handleTyping=c('debounce')(this._handleTyping,300,this,true);this.setState({calendarGK:this.state.config.get('GK',o()).get('calendar')});},componentDidMount:function la(){document.addEventListener('keydown',this._handleKBShortcuts);this._unlisten=function(){document.removeEventListener('keydown',this._handleKBShortcuts);}.bind(this);this._focusSearch();},getInitialState:function la(){return {currentTab:s,results:n([]),selected:-1,shown:false,text:'',calendarGK:false};},componentWillUnmount:function la(){this._unlisten();},render:function la(){var ma=this.state,na=ma.shown,oa=ma.currentTab,pa=ma.results,qa=ma.selected,ra=ma.threads;if(!na){return null;}else return c('React').createElement(c('OzDraggableModal.react'),{className:"_cxg"},c('React').createElement(c('XUITextInput.react'),{className:"_cxh",placeholder:'Search...',ref:'searchBar',onChange:function(sa){return this._handleTyping(sa.target.value);}.bind(this)}),c('React').createElement('div',{className:"_cxi"},c('React').createElement(ca,{tabs:x,currentTab:oa,onClickTab:this._handleChangeTab,calendarGK:this.state.calendarGK}),c('React').createElement(da,{onClick:this._handleSelectResult,results:pa,selected:qa,threads:ra,calendarGK:this.state.calendarGK})));},_search:function la(){var ma=this.state,na=ma.text,oa=ma.currentTab,pa=ma.activeThread,qa={text:na,type:y[oa]};if(oa===t||oa===s)qa['user-id']=pa.get('threadID');c('OzAPI').search(qa).then(function(ra){this.setState({results:ra,selected:0});}.bind(this)).done();},_handleTyping:function la(ma){this.setState({text:ma},this._search);},_handleChangeTab:function la(ma){var na=this.state.text;this.setState({currentTab:ma},function(oa){na.length&&this._search();}.bind(this));},_handleSelectResult:function la(ma){switch(ma.get('_type')){case 'user':this._handleSelectResultUser(ma);break;case 'event':switch(ma.getIn(['_source','type'])){case 'message':case 'message-from-page':this._handleSelectResultMessage(ma);break;case 'send-email':case 'receive-email':this._handleSelectResultEmail(ma);break;case 'calendar-event':this._handleSelectResultCalendarEvent(ma);break;default:}break;default:}this.setState({shown:false});},_handleSelectResultUser:function la(ma){var na=ma.getIn(['_source','user-id']);this.context.router.push('/inbox/'+na);},_handleSelectResultMessage:function la(ma){var na=ma.getIn(['_source','user-id']),oa=ma.getIn(['_source','timestamp']);this.context.router.push('/inbox/'+na);this._createTransitionListener(na,oa);},_createTransitionListener:function la(ma,na){this._transitionListenerId=window.setInterval(function(oa){var pa=this.context.router.isActive('/inbox/'+ma);if(pa){c('OzActions').scrollThreadToTimestamp(na);window.clearInterval(this._transitionListenerId);}}.bind(this),100);},_handleSelectResultEmail:function la(ma){var na=ma.getIn(['_source','user-id']),oa=ma.getIn(['_source','intent-id']);this.context.router.push('/inbox/'+na+'/intent/'+oa);},_handleSelectResultCalendarEvent:function la(ma){var na=ma.getIn(['_source','user-id']);this.context.router.push('/inbox/'+na);},_toggleShown:function la(){this.setState({shown:!this.state.shown});},_focusSearch:function la(){this.refs.searchBar&&this.refs.searchBar.focusInput();},_handleKBShortcuts:function la(ma){var na=this.state,oa=na.results,pa=na.selected,qa=na.shown,ra=na.calendarGK;if(ka(ma)||ma.which===c('Keys').ESC&&qa){ma.preventDefault();this._toggleShown();!qa&&this._focusSearch();}else if(qa)switch(ma.which){case c('Keys').DOWN:ma.preventDefault();this.setState({selected:Math.min(pa+1,ba(oa,ra).count()-1)});break;case c('Keys').UP:ma.preventDefault();this.setState({selected:Math.max(pa-1,0)});break;case c('Keys').RETURN:ma.preventDefault();pa&&this._handleSelectResult(ba(oa,ra).get(pa));break;case c('Keys').TAB:ma.preventDefault();var sa=x.indexOf(this.state.currentTab),ta=x.length;if(ma.getModifierState('Shift')){sa=(sa-1+ta)%ta;if(!ra&&sa===3)sa--;}else{sa++;if(!ra&&sa===3)sa++;sa%=ta;}this._handleChangeTab(x[sa]);break;}}}),aa=function la(ma){return function(na){var oa=na.get('_type');switch(oa){case 'user':return true;case 'event':var pa=na.getIn(['_source','type']);if(pa=='calendar-event'&&!ma)return false;return pa=='message'||pa=='message-from-page'||pa=='send-email'||pa=='receive-email'||pa=='calendar-event';default:return false;}};},ba=function la(ma,na){return ma.filter(aa(na)).sortBy(function(oa){return oa.getIn(['_source','timestamp']);}).reverse();};i=babelHelpers.inherits(ca,c('React').PureComponent);j=i&&i.prototype;ca.prototype.render=function(){'use strict';var la=this.props,ma=la.tabs,na=la.currentTab,oa=la.onClickTab;return c('React').createElement('div',{className:"_cxj"},n(ma).map(function(pa){if(!this.props.calendarGK&&pa===v){return null;}else return c('React').createElement(c('ShimButton.react'),{className:(pa===na?"_cxk":'')+(' '+"_cxl"),key:pa,onClick:function qa(ra){return oa(pa);}},pa);}.bind(this)).toSeq());};function ca(){'use strict';i.apply(this,arguments);}ca.propTypes={tabs:p.arrayOf(p.string).isRequired,currentTab:p.string.isRequired,onClickTab:p.func.isRequired,calendarGK:p.bool.isRequired};k=babelHelpers.inherits(da,c('React').PureComponent);l=k&&k.prototype;da.prototype.render=function(){'use strict';var la=this.props,ma=la.onClick,na=la.results,oa=la.selected,pa=la.threads;return c('React').createElement('div',{className:"_cxm"},ba(na,this.props.calendarGK).map(function(qa,ra){switch(qa.get('_type')){case 'user':return c('React').createElement(fa,{result:qa,selected:oa==ra,threads:pa,onClick:ma});case 'event':switch(qa.getIn(['_source','type'])){case 'message-from-page':if(qa.getIn(['_source','data','attachments']))return c('React').createElement(ha,{result:qa,selected:oa==ra,threads:pa,onClick:ma});case 'message':return c('React').createElement(ga,{result:qa,selected:oa==ra,threads:pa,onClick:ma});case 'send-email':case 'receive-email':return c('React').createElement(ia,{result:qa,selected:oa==ra,threads:pa,onClick:ma});case 'calendar-event':return c('React').createElement(ja,{result:qa,selected:oa==ra,threads:pa,onClick:ma});default:return null;}default:return null;}}));};function da(){'use strict';k.apply(this,arguments);}da.propTypes={onClick:p.func,results:p.instanceOf(n),selected:p.number,threads:p.instanceOf(o).isRequired,calendarGK:p.bool.isRequired};var ea=c('OzHelpers').pure(function(la){var ma=la.image,na=la.text,oa=la.selected,pa=la.onClick,qa=la.timestamp;return c('React').createElement(c('ShimButton.react'),{className:"_cxn",id:oa?'selected':null,onClick:pa},ma,c('React').createElement('div',{className:"_4fwg"},c('React').createElement('div',{className:"_4fwh"},c('React').createElement('div',{className:"_4fwi"},na)),qa?c('React').createElement(c('OzDate.react'),{className:"_4fwj",timestamp:qa}):c('React').createElement('div',{className:"_4fwk"})));}),fa=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','user-id']),ra=ma.getIn(['_source','user-name']),sa=pa.get(qa);if(!sa)c('OzAPI').thread(qa);return c('React').createElement(ea,{onClick:function ta(ua){return na(ma);},selected:oa,image:sa?c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(sa),className:"_cxp"}):null,text:ra});}),ga=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','user-id']),ra=ma.getIn(['_source','data','text']),sa=ma.getIn(['_source','type'])==='message',ta=pa.get(qa);if(sa&&!ta)c('OzAPI').thread(qa);var ua=sa?ta?c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(ta),className:"_cxp"}):null:c('React').createElement(c('Image.react'),{src:'/images/oz/icons/OzMessengerLogo.png',className:"_cxp"});return c('React').createElement(ea,{onClick:function va(wa){return na(ma);},selected:oa,image:ua,text:ra,timestamp:ma.getIn(['_source','timestamp'])});}),ha=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','data','attachments',0,'metadata']),ra=qa.get('name'),sa=qa.get('desc'),ta=qa.get('thumb_url');return c('React').createElement(ea,{onClick:function ua(va){return na(ma);},selected:oa,image:c('React').createElement(c('Image.react'),{src:ta,className:"_cxp"}),text:ra+' - '+sa,timestamp:ma.getIn(['_source','timestamp'])});}),ia=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','data']),ra=qa.get('to'),sa=qa.get('subject'),ta=(ra?'To: '+ra.toJS().join(', ')+' - ':'')+sa,ua=c('React').createElement(c('Image.react'),{src:'/images/nux_icon_gmail.gif',className:"_cxr _cxp"});return c('React').createElement(ea,{onClick:function va(wa){return na(ma);},selected:oa,image:ua,text:ta,timestamp:ma.getIn(['_source','timestamp'])});}),ja=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','user-id']),ra=pa.get(qa),sa=ma.getIn(['_source','data']),ta=new Date(sa.get('start')),ua=ta.toLocaleString('en-US',{timeZoneName:'short'}),va=ra?c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(ra),className:"_cxp"}):null;return c('React').createElement(ea,{onClick:function wa(xa){return na(ma);},selected:oa,image:va,text:c('React').createElement('div',null,c('React').createElement('div',{className:"_5u4o"},sa.get('title')),c('React').createElement('div',{className:"_5u4p"},ua))});});function ka(la){return la.getModifierState('Control')&&la.which==83;}f.exports=z;}),null);
__d('OzSkywalkerBanner.react',['cx','OzHelpers','OzStores','OzImmutablePureRenderMixin','React','Reflux','ReloadPage','ShimButton.react'],(function a(b,c,d,e,f,g,h){var i=c('OzStores').SkywalkerStore,j=c('React').createClass({displayName:'OzSkywalkerBanner',mixins:[c('Reflux').connect(i,'skywalker'),c('OzImmutablePureRenderMixin')],componentDidUpdate:function k(l,m){var n=this.state.skywalker;if(n.get('isStalled')&&n.get('last-receive-ts')){window.clearTimeout(this._timer);this._timer=window.setTimeout(this.forceUpdate.bind(this),1000);}},componentWillUnmount:function k(){window.clearTimeout(this._timer);},render:function k(){var l=this.state.skywalker,m=l.get('last-receive-ts'),n=m?'in '+Math.round((c('OzHelpers').serverNow()-m)/1000)+' seconds':'since you opened Oz';return c('React').createElement('div',{className:"_hsr"+(l.get('isStalled')?' '+"_hss":'')},c('React').createElement('span',null,'We haven\'t received a message from Skywalker ',n,'.',' ',c('React').createElement(c('ShimButton.react'),{form:'link',onClick:c('ReloadPage').now},'Refresh!'),' ',' or terrible things will happen.'));}});f.exports=j;}),null);
__d('OzSuggestions',['OzHelpers','immutable','OzConstants'],(function a(b,c,d,e,f,g){var h=c('OzConstants').ATTS,i=c('immutable').List,j=c('immutable').Map;f.exports={toServer:function m(n,o){return n.set('type',h.SUGG).update('data',function(p){return j({name:p.get('title'),description:p.get('description')||'','merchant-name':this.findMerchantName(p.get('merchant'),o),'thumb-url':p.get('images',i()).find(c('OzHelpers').validateURL)||null,'thumb-urls':p.get('images',i()).filter(c('OzHelpers').validateURL),'target-url':p.get('url'),'expiration-time':p.get('expiration-time'),currency:'USD',amount:p.has('price')?k(p.get('price')):null});}.bind(this));},findMerchantName:function m(n,o){var p=o&&n&&o.find(function(q){return (q.get('name-dba')||'').toLowerCase()===n.toLowerCase();});if(p){c('OzHelpers').info('[sugg] found merchant',n,p);return p.get('name-dba');}return null;}};function k(m){return Math.round(100*parseFloat(l(m,'$'),10));}function l(m,n){if(!m||!m.startsWith(n))return m;return m.substr(n.length);}}),null);
__d('OzTwilio',['cx','OzHelpers','immutable','Keys','messengerButtonReact','OzNotify','OzActions','OzConfig','OzDraggableModal.react','OzImmutablePureRenderMixin','React','Reflux','StarsInput.react'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=c('messengerButtonReact').jsComponent,r=c('immutable').Record,s=c('immutable').Set,t=c('immutable').List,u=c('React').PropTypes,v=c('OzActions').twilio;function w(){var ua=window.Twilio.Device,va=function wa(xa,ya){return function(){c('OzHelpers').info('[twilio] '+xa,z.data.toJS());ya.apply(undefined,arguments);};};v.setup.listen(function(wa){ua.setup(wa,{rtc:c('OzConfig').getInStaticConfig(['GK','webRTC']),debug:true});});v.hangUp.listen(function(wa){ua.disconnectAll();v.endCall();});v.startCall.listen(va('start-call',ua.connect));ua.ready(v.ready);ua.error(function(wa){var xa=wa.message;c('OzNotify').error('VOIP is having issues. '+(xa?xa:'')+'. Please contact the wit oncall');c('OzHelpers').error('[twilio] had an error',wa);v.endCall();});ua.connect(va('connect',v.connect));ua.disconnect(va('disconnect',v.endCall));ua.cancel(va('cancel',v.endCall));ua.incoming(va('incoming',v.incoming));}w();i=babelHelpers.inherits(x,r({'intent-id':null,tid:null,extension:null}));j=i&&i.prototype;function x(){'use strict';i.apply(this,arguments);}k=babelHelpers.inherits(y,r({from:null,meta:new x(),muted:false,status:'pending',to:null,wasIncoming:null,rating:null,sentDigits:null,sentDigitsBuffer:t(),sentDigitsIntervalId:null}));l=k&&k.prototype;function y(){'use strict';k.apply(this,arguments);}var z=c('Reflux').createStore({init:function ua(){this.data=new y();this.listenToMany(v);},getInitialState:function ua(){return this.data;},onChangeTo:function ua(va){this._u(function(wa){return wa.set('to',va);});},onDialAgain:function ua(){this._conn=null;this._u(function(va){return new y({status:'dial',meta:va.get('meta'),from:va.get('from'),to:ja(va.get('to'))});});},onConnect:function ua(va){this._conn=va;},onEndCall:function ua(){this._conn=null;this._u(function(va){return va.merge({status:'ended'});});},onIncoming:function ua(va){this._conn=va;this._u(function(wa){return wa.mergeDeep({status:'incoming',to:va.parameters.From,wasIncoming:true});});},onIncomingAccept:function ua(){if(this._conn){this._conn.accept();this._u(function(va){return va.merge({status:'in-call'});});}},onIncomingReject:function ua(){if(this._conn){this._conn.reject();this._conn=null;}this.onEndCall();},onMute:function ua(){if(this._conn){this._conn.mute(true);this._u(function(va){return va.set('muted',true);});}},onReady:function ua(){this._u(function(va){return new y({status:'ready'});});},_sendDigitsFromBuffer:function ua(){var va=this.data.get('sentDigitsBuffer');if(!va.isEmpty()){this._conn.sendDigits(va.first());this._u(function(xa){return xa.update('sentDigitsBuffer',function(ya){return ya.shift();});});}else{var wa=this.data.get('sentDigitsIntervalId');clearInterval(wa);this._u(function(xa){return xa.set('sentDigitsIntervalId',null);});}},onSendDigits:function ua(va){if(this._conn){this._u(function(wa){return wa.update('sentDigits',function(xa){return (xa||'')+va;});});this._u(function(wa){return wa.update('sentDigitsBuffer',function(xa){return xa.concat(t(va.split('')));});});if(!Number.isInteger(this.data.get('sentDigitsIntervalId')))this._u(function(wa){return wa.set('sentDigitsIntervalId',setInterval(this._sendDigitsFromBuffer,1000));}.bind(this));}},onStartCall:function ua(){this._u(function(va){return va.set('status','in-call');});},onUnmute:function ua(){if(this._conn){this._conn.mute(false);this._u(function(va){return va.set('muted',false);});}},onUseIntent:function ua(va){if(this.data.get('status')!=='ready'){c('OzNotify').error('End your call before starting another one');return;}this._u(function(wa){return new y({status:'dial',from:va.get('phone-number'),to:wa.get('to'),meta:new x({tid:va.get('user-id'),'intent-id':va.get('id'),extension:va.get('phone-extension')})});});},onUpdateIncomingInfo:function ua(va){this._u(function(wa){return wa.merge({meta:new x({tid:va.get('user-id'),'intent-id':va.get('intent-id'),extension:va.get('phone-extension')}),from:va.get('to'),to:va.get('from')});});},onUpdateRating:function ua(va){this._u(function(wa){return wa.set('rating',va);});},_u:function ua(va){this.data=va(this.data);this.trigger(this.data);}}),aa=c('React').createClass({displayName:'OzTwilio',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(z,'store'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{router:u.object.isRequired},componentDidMount:function ua(){var va=window.setInterval(function(wa){this.state.store.get('status')==='in-call'&&c('OzActions').isActive();}.bind(this),5000);this._cleanup=function(wa){return window.clearInterval(va);};},componentDidUpdate:function ua(va,wa){var xa=wa.store.get('status'),ya=this.state.store.get('status');if(xa==='in-call'&&ya==='ended')this.setState({paused:true});},componentWillUnmount:function ua(){this._cleanup();},render:function ua(){var va=this.state,wa=va.store,xa=va.startedAt,ya=va.paused;return c('React').createElement('span',{className:"_221-"},ba(wa)&&c('React').createElement(ca,{startedAt:xa,paused:ya,onCallStart:this._handleStartCall,onDialAgain:v.dialAgain,onHangUp:this._handleHangUp,onIncomingAccept:this._handleIncomingAccept,onIncomingReject:v.incomingReject,onMute:v.mute,onRatingChange:this._handleRatingChange,onReady:v.ready,onSendDigits:v.sendDigits,onThreadClick:this._handleThreadClick,onToChange:v.changeTo,onUnmute:v.unmute,store:wa}));},_handleThreadClick:function ua(va){this.context.router.push('/inbox/'+va);},_handleStartCall:function ua(){var va=this.state.store;this._startDurationTimer();v.startCall(babelHelpers['extends']({},va.get('meta').toJS(),{from:va.get('from'),to:ja(va.get('to')),page:this.state.config.get('PAGE_ID'),type:'outgoing'}));},_handleIncomingAccept:function ua(){this._startDurationTimer();v.incomingAccept();},_startDurationTimer:function ua(){this.setState({startedAt:Date.now()});this.setState({paused:false});},_handleHangUp:function ua(){v.hangUp();this.setState({paused:true});},_handleRatingChange:function ua(va){c('OzHelpers').info('[twilio] rating='+va,this.state.store.toJS());v.updateRating(va);}});function ba(ua){return s(['dial','in-call','incoming','ended']).has(ua.get('status'));}m=babelHelpers.inherits(ca,c('React').Component);n=m&&m.prototype;ca.prototype.render=function(){'use strict';return c('React').createElement(c('OzDraggableModal.react'),{className:"_2221",getHandle:function(ua){return this.refs.header.refs.header;}.bind(this)},c('React').createElement(ea,{store:this.props.store,ref:'header'}),c('React').createElement(fa,this.props));};function ca(){'use strict';m.apply(this,arguments);}o=babelHelpers.inherits(da,c('React').Component);p=o&&o.prototype;function da(){var ua,va;'use strict';for(var wa=arguments.length,xa=Array(wa),ya=0;ya<wa;ya++)xa[ya]=arguments[ya];return va=(ua=p.constructor).call.apply(ua,[this].concat(xa)),this.state={elapsed:Date.now()-this.props.startedAt},this.$DurationTimer2=function(){this.setState({elapsed:Date.now()-this.props.startedAt});}.bind(this),va;}da.prototype.componentDidMount=function(){'use strict';if(!this.props.paused)this.$DurationTimer1=setInterval(this.$DurationTimer2,1000);};da.prototype.componentWillUnmount=function(){'use strict';clearInterval(this.$DurationTimer1);};da.prototype.componentWillReceiveProps=function(ua){'use strict';if(ua.paused==this.props.paused)return;ua.paused?clearInterval(this.$DurationTimer1):(this.$DurationTimer1=setInterval(this.$DurationTimer2,1000));};da.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_1su8"},ia(this.state.elapsed));};var ea=c('OzHelpers').pure(function(ua){var va=ua.store,wa=va.get('status'),xa=va.get('wasIncoming')?'Incoming':'Outgoing';return c('React').createElement('h2',{className:"_1su5",ref:'header'},wa==='ended'&&xa+' Call End'||xa+' Phone Call');}),fa=c('OzHelpers').pure(function(ua){switch(ua.store.get('status')){case 'dial':return c('React').createElement(ga,ua);case 'in-call':return c('React').createElement(la,ua);case 'incoming':return c('React').createElement(qa,ua);case 'ended':return c('React').createElement(ra,ua);default:c('OzHelpers').debug('[twilio] unknown status',ua);return null;}}),ga=c('OzHelpers').pure(function(ua){var va=ua.store,wa=ua.onToChange,xa=ua.onCallStart,ya=ua.onReady;return c('React').createElement('div',{className:"_3hon"},c('React').createElement(ta,{placeholder:'Type a phone number...',value:va.get('to'),onChange:function za(ab){return wa(ab.target.value);},onKeyDown:function za(ab){return ab.which===c('Keys').RETURN?ha(va)&&xa():null;}}),c('React').createElement('div',{className:"_1su6"},ka(va)),c('React').createElement('div',{className:"_1su7"},c('React').createElement(q,{onClick:ya,type:'secondary',label:'Cancel'}),c('React').createElement(q,{disabled:!ha(va),onClick:xa,type:'primary',label:'Call'})));});function ha(ua){return ua.get('from')&&ua.get('to')&&ua.get('to').length>=10;}var ia=function ua(va){var wa=60000,xa=Math.floor(va/wa);va%=wa;var ya=Math.floor(va/1000);if(xa<10)xa='0'+xa;if(ya<10)ya='0'+ya;return xa+':'+ya;},ja=function ua(va){return va.trim().replace(' ','-').replace(/(.)\+/g,'$1-');},ka=function ua(va){var wa=va.getIn(['meta','extension']);return 'My Number: '+c('OzHelpers').parsePhoneNumber(va.get('from'))+' ext. '+wa;},la=c('OzHelpers').pure(function(ua){var va=ua.startedAt,wa=ua.paused,xa=ua.onHangUp,ya=ua.onMute,za=ua.onSendDigits,ab=ua.onThreadClick,bb=ua.onUnmute,cb=ua.store;return c('React').createElement('div',{className:"_2225"},c('React').createElement(da,{startedAt:va,paused:wa}),c('React').createElement('div',{className:"_1su9"},c('OzHelpers').parsePhoneNumber(cb.get('to'))),c('React').createElement(ma,{sentDigits:cb.get('sentDigits'),onSendDigits:za}),c('React').createElement('div',{className:"_1su6"},cb.get('from')?ka(cb):'Searching for our number...'),c('React').createElement('div',{className:"_1su7"},c('React').createElement(pa,{tid:cb.getIn(['meta','tid']),onThreadClick:ab}),cb.get('muted')?c('React').createElement(q,{onClick:bb,type:'secondary',use:'danger',label:'Unmute'}):c('React').createElement(q,{onClick:ya,type:'secondary',use:'default',label:'Mute'}),c('React').createElement(q,{onClick:xa,type:'primary',label:'End Call'})));}),ma=c('OzHelpers').pure(function(ua){var va=ua.onSendDigits,wa=ua.sentDigits;return c('React').createElement('div',null,c('React').createElement(ta,{placeholder:'Type numbers using keyboard',value:'',onChange:function xa(ya){var za=oa(ya.target.value);za&&va(za);}}),c('React').createElement('div',{className:"_538o"},wa));}),na=s(['1','2','3','4','5','6','7','8','9','0','#','*']);function oa(ua){return ua.split('').filter(function(va){return na.has(va);}).join('');}var pa=c('OzHelpers').pure(function(ua){var va=ua.onThreadClick,wa=ua.tid;return wa?c('React').createElement(q,{onClick:function xa(){return va(wa);},type:'secondary',label:'Go to Thread'}):null;}),qa=c('OzHelpers').pure(function(ua){var va=ua.store,wa=ua.onIncomingAccept,xa=ua.onIncomingReject;return c('React').createElement('div',{className:"_2226"},c('React').createElement('div',{className:"_1su9"},c('OzHelpers').parsePhoneNumber(va.get('to'))),c('React').createElement('div',{className:"_1su6"},ka(va)),c('React').createElement('div',{className:"_1su7"},c('React').createElement(q,{onClick:xa,type:'secondary',label:'Ignore'}),c('React').createElement(q,{onClick:wa,type:'primary',label:'Answer'})));}),ra=c('OzHelpers').pure(function(ua){var va=ua.startedAt,wa=ua.paused,xa=ua.store,ya=ua.onHideDialog,za=ua.onRatingChange,ab=ua.onDialAgain,bb=ua.onReady;return c('React').createElement('div',{className:"_5gaw"},c('React').createElement(da,{startedAt:va,paused:wa}),c('React').createElement('div',{className:"_1su9"},c('OzHelpers').parsePhoneNumber(xa.get('to'))),c('React').createElement('div',{className:"_1su6"},ka(xa)),c('React').createElement(sa,{rating:xa.get('rating'),onRatingChange:za}),c('React').createElement('div',{className:"_1su7"},c('React').createElement(q,{onClick:ab,type:'secondary',label:'New Call'}),c('React').createElement(q,{onClick:bb,type:'primary',label:'Close'})));}),sa=c('OzHelpers').pure(function(ua){var va=ua.rating,wa=ua.onRatingChange;return c('React').createElement('div',{className:"_5rvp"},va?c('React').createElement('h3',{className:"_5rvu"},'Thank you for rating!'):c('React').createElement('span',null,c('React').createElement('h3',{className:"_5rvu"},'How would you rate your experience?'),c('React').createElement(c('StarsInput.react'),{large:true,count:0,onClick:wa})));}),ta=c('OzHelpers').pure(function(ua){return c('React').createElement('input',babelHelpers['extends']({},ua,{className:"_1-i0 _2224"}));});f.exports=aa;}),null);
__d('Oz.react',['cx','OzAPI','OzHelpers','immutable','Layout.react','OzActions','OzBugNub.react','OzConfig','OzDialogContainer.react','OzExtensionCheck.react','OzHeader.react','OzLoading.react','OzFailed.react','OzNotify','OzSearch.react','OzSkywalkerBanner.react','OzStores','OzSuggestions','OzTwilio','OzImmutablePureRenderMixin','React','OzWrapper.react','Reflux','Run','ShimButton.react','XUIDialog.react','XUINotice.react'],(function a(b,c,d,e,f,g,h){var i=c('OzNotify').Component,j=c('OzStores').ActiveThreadStore,k=c('OzStores').MerchantStore,l=c('OzStores').LoadingStore,m=c('OzStores').RepStore,n=c('OzStores').RequirementStore,o=c('OzStores').ThreadStore,p=c('OzStores').WitIntentStore,q=c('React').PropTypes,r=c('immutable').Map,s=20000,t=60000,u=5000,v=100,w=1000*60*60,x=c('React').createClass({displayName:'OzWrapper',mixins:[c('Reflux').connect(l,'loading')],propTypes:{rev:q.number.isRequired,uid:q.string.isRequired,version:q.string.isRequired,skipToto:q.bool,onUnmount:q.func.isRequired},render:function fa(){var ga=this.state.loading.valueSeq().some(function(ha){return ha.get('state')!=='loaded'&&!ha.get('skip');});if(ga)return c('React').createElement(y,null);return c('React').createElement(z,this.props);}}),y=c('React').createClass({displayName:'AppLoading',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config'),c('Reflux').connect(l,'loading')],render:function fa(){return c('React').createElement('div',null,c('React').createElement(i,null),this._renderBody(),c('React').createElement(c('OzBugNub.react'),null));},_renderBody:function fa(){var ga=this.state.loading,ha=ga.entrySeq().filter(function(ja){var ka=ja[0],la=ja[1];return la.get('state')==='failed'&&!la.get('skip');}).map(function(ja){var ka=ja[0],la=ja[1];return ka;});if(!ha.isEmpty())return c('React').createElement(c('OzFailed.react'),{problems:ha});var ia='Hello '+this.state.config.get('publicName')+'! Oz is connecting...';return c('React').createElement(c('OzLoading.react'),{message:ia});}}),z=c('React').createClass({displayName:'Oz',mixins:[c('Reflux').connect(k,'merchants'),c('Reflux').connect(m,'reps'),c('Reflux').connect(p,'witIntents'),c('Reflux').connect(n,'requirements'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{rev:q.number.isRequired,uid:q.string.isRequired,version:q.string.isRequired,skipToto:q.bool,onUnmount:q.func.isRequired},childContextTypes:{uid:q.string.isRequired,merchants:q.instanceOf(r).isRequired,reps:q.instanceOf(r).isRequired,witIntents:q.instanceOf(r).isRequired},getChildContext:function fa(){return {uid:this.props.uid,merchants:this.state.merchants,reps:this.state.reps,witIntents:this.state.witIntents};},getInitialState:function fa(){return {almostInactive:false,away:false,coachMode:false,fellAsleep:false,inactive:false};},componentDidMount:function fa(){window.addEventListener('message',this._handleMessage);window.postMessage({type:'consolemounted'},'*');this.lastPulseAt=Date.now();var ga=c('OzActions').sendPulse.listen(this._handlePulse),ha=setInterval(c('OzActions').sendPulse,u);this.lastActiveAt=Date.now();this._isActive=function(la){return c('OzActions').isActive();};window.addEventListener('mousemove',this._isActive);window.addEventListener('keydown',this._isActive);var ia=c('OzActions').isActive.listen(function(){this.lastActiveAt=Date.now();if(this.state.almostInactive||this.state.inactive)this.setState({almostInactive:false,inactive:false});}.bind(this));this.lastAwakeAt=Date.now();var ja=setInterval(function(la){var ma=Date.now();if(ma-this.lastAwakeAt>w)this.setState({fellAsleep:true});this.lastAwakeAt=ma;}.bind(this),v);c('OzActions').updateThreads.preEmit=ca.bind(null,this.props.uid);var ka=c('OzActions').isInactive.listen(function(la){if(Date.now()-this.lastActiveAt>u)this.setState({almostInactive:false,inactive:true});}.bind(this));this._cleanup=function(){window.removeEventListener('message',this._handleMessage);ga();clearInterval(ha);clearInterval(ja);window.removeEventListener('mousemove',this._isActive);ia();ka();}.bind(this);},componentWillUnmount:function fa(){this._cleanup();},render:function fa(){return c('React').createElement(c('Layout.react'),{className:"_3_ps _li",onKeyPress:this._handleKeyPress},c('React').createElement(i,null),!this.props.skipToto&&c('React').createElement(c('OzExtensionCheck.react'),null),this.state.away?c('React').createElement(aa,{onClick:this._handleAway,text:'You\'re currently away.',className:"_1tir"}):this.state.almostInactive?c('React').createElement(ba,{lastActiveAt:this.lastActiveAt,onZero:this._handleZero}):this.state.fellAsleep&&!this.state.config.get('devMode')?c('React').createElement(aa,{text:'Looks like your computer has gone to sleep. Please '+'refresh the page.'}):this.state.inactive?c('React').createElement(aa,{text:'You\'re currently inactive.',className:"_4da6"}):null,c('React').createElement(c('OzSkywalkerBanner.react'),null),c('React').createElement(c('OzHeader.react'),{away:this.state.away,coachMode:!!this.state.coachMode,onAway:this._handleAway,onCoachModeToggle:this._handleCoachModeToggle,rev:this.props.rev,version:this.props.version,reps:this.state.reps,params:this.props.params}),c('React').cloneElement(this.props.children,{witIntents:this.state.witIntents,requirements:this.state.requirements,merchants:this.state.merchants,reps:this.state.reps}),c('React').createElement(c('OzBugNub.react'),null),c('React').createElement(c('OzDialogContainer.react'),null),c('React').createElement(c('OzSearch.react'),null),c('React').createElement(c('OzTwilio'),null));},_handleKeyPress:function fa(){c('OzActions').isActive();},_handlePulse:function fa(){var ga=Date.now(),ha=Math.round((ga-this.lastPulseAt)/1000),ia=this._buildPulse();c('OzAPI').sendPulse(ha,ia);ea(j.data,o.data);this.lastPulseAt=ga;if(!this.state.almostInactive&&!this.state.inactive&&ia.get('inactive-ms')>=t-s)this.setState({almostInactive:true});},_handleMessage:function fa(ga){if(ga.source!==window)return;if(!ga.data)return;switch(ga.data.type){case 'active':c('OzActions').isActive();break;case 'recordactivity':var ha=j.data,ia=ga.data.data,ja=ha.get('threadID');c('OzHelpers').debug('[oz-ext] received activity',ia);if(!ja){c('OzHelpers').debug('[oz-ext] skipping event, no threadID');return;}c('OzAPI').recordActivity(ja,ia);break;case 'bubble':c('OzHelpers').debug('[toto] got bubble',ga.data);c('OzActions').addBubble(c('OzSuggestions').toServer(c('immutable').fromJS(ga.data),this.state.merchants));break;case 'autopilot-data':c('OzHelpers').debug('[toto] got autopilot',ga.data);if(ga.data)c('OzActions').addAutopilot(c('immutable').fromJS(ga.data));break;}},_handleAway:function fa(ga){c('OzAPI').away(!this.state.away).done(function(ha){this.setState({away:!!ha});}.bind(this));},_handleCoachModeToggle:function fa(ga){c('OzAPI').coachMode(ga).done(function(){this.setState({coachMode:ga});}.bind(this));},_handleZero:function fa(){this.setState({almostInactive:false,inactive:true});},_buildPulse:function fa(ga){return da(this.props.uid,j.data,o.data,this.lastActiveAt,this.state.away||ga||false,this.state.coachMode);}});function aa(fa){var ga=fa.onClick,ha=fa.text,ia=fa.className;return c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false},c('React').createElement('div',{className:"_1tip"},c('React').createElement('div',{className:ia}),c('React').createElement('div',{className:"_1tis"},ha),ga?c('React').createElement(c('ShimButton.react'),{className:"_1tit _57lt _30yy",form:'link',onClick:ga},'I\'m back :)'):null));}var ba=c('React').createClass({displayName:'OzCountdownDialog',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{lastActiveAt:q.number.isRequired,onZero:q.func.isRequired},getInitialState:function fa(){return {countdown:Math.floor((t-(Date.now()-this.props.lastActiveAt))/1000)};},componentDidMount:function fa(){this._interval=setInterval(function(){this.setState({countdown:Math.max(this.state.countdown-1,0)});}.bind(this),1000);},componentDidUpdate:function fa(){if(this.state.countdown===0){clearInterval(this._interval);this.props.onZero();}},componentWillUnmount:function fa(){clearInterval(this._interval);},render:function fa(){return c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false},c('React').createElement('div',{className:"_1tip"},c('React').createElement('div',{className:"_4da6"}),c('React').createElement(c('XUINotice.react'),{use:'warn'},'You\'ll be inactive (and your threads will be reassigned) in approximately ',this.state.countdown,' seconds...')));}});function ca(fa,ga){var ha=o.data;if(ha.isEmpty())return;ga.filter(function(ia){return (c('OzHelpers').isOwner(ia,fa)||c('OzHelpers').isSubscriber(ia,fa))&&(ia.get('ready')||c('OzHelpers').isUnread(ia)||c('OzHelpers').hasPaid(ia)||c('OzHelpers').hasReminder(ia));}).forEach(function(ia){var ja=c('OzHelpers').isUnread(ia)&&c('OzHelpers').shortDesc(c('OzHelpers').lastUserMessage(ia))||c('OzHelpers').hasPaid(ia)&&'Payment received.'||c('OzHelpers').hasReminder(ia)&&'Reminder triggered.';if(!ja)return;var ka=c('OzHelpers').threadID(ia),la=ha.getIn([ka,'last-event-at']);if(ia.get('last-event-at')===la)return;var ma=c('OzHelpers').photo(ia),na=ma?ma.getIn(['data','url'])||ma.get('mime_type')+','+ma.get('data'):null;c('OzAPI').notifyExtension({action:'show',title:c('OzHelpers').getName(ia),desc:ja,picture:na,id:c('OzHelpers').threadID(ia)});});}function da(fa,ga,ha,ia,ja,ka){var la=ga.get('threadID'),ma=la&&ha.get(la),na=r();if(la)na=na.merge({tid:la});if(ma)na=na.merge({'intent-id':ga.get('activeIntent'),'owner-id':ma.getIn(['owner','id']),'user-name':ma.getIn(['user-vcard','name'])});if(Number.isFinite(ia))na=na.set('inactive-ms',Date.now()-ia);na=na.set('load',ha.toSeq().filter(function(oa){return c('OzHelpers').isOwner(oa,fa)&&oa.get('ready');}).count());na=na.set('away?',ja);na=na.set('coach-mode?',ka);return na;}function ea(fa,ga){var ha=fa.get('threadID'),ia=ha&&ga.get(ha),ja=r();if(ia)ja=ja.merge({tid:ha,'intent-id':fa.get('activeIntent'),'user-vcard':ia.get('user-vcard')});window.postMessage({type:'consolepulse',data:ja.toJS()},'*');}f.exports=c('OzWrapper.react')(x);}),null);
__d('OzLastEvent.react',['cx','OzHelpers','OzConstants','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i=c('OzConstants').AUTHOR_TYPES,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzLastEvent',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{name:j.string.isRequired,lastEvent:j.object.isRequired},render:function l(){var m=this.props.lastEvent,n=c('OzHelpers').authorType(m)===i.USER?this.props.name.split(' ')[0].substr(0,10):'M',o=m.get('text'),p=c('OzHelpers').shortDesc(m)||'did something',q=o&&n+': '+o||n+' '+p;return c('React').createElement('div',{className:"_4-_6 _4-_7",title:q},this._renderText(n,p));},_renderText:function l(m,n){return c('React').createElement('span',null,c('React').createElement('span',{className:"_3ikz"},m,': '),n);}});f.exports=k;}),null);
__d('OzStrings',[],(function a(b,c,d,e,f,g){f.exports={NOTREADY_BUTTON:'I\'m waiting',IS_NOTREADY:'Currently waiting',READY_BUTTON:'The user is waiting for us!',USER_FILTER_ALL:'All users',USER_FILTER_PUBLIC:'Public only',USER_FILTER_EMPLOYEE:'Employee only',READY_FILTER_ALL:'All threads',READY_FILTER_ATTENTION:'Needs attention',READY_FILTER_WAITING:'I\'m waiting'};}),null);
__d('OzThreadLabels.react',['cx','OzHelpers','OzAPI','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','joinClasses','immutable','ReactLayeredComponentMixin_DEPRECATED','OzImmutablePureRenderMixin','React','XUICloseButton.react','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('immutable').OrderedMap,k=c('immutable').List,l=c('React').PropTypes,m=c('React').createClass({displayName:'Label',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{noColor:l.bool,removable:l.bool,shade:l.oneOf(['dark','light']),thread:l.instanceOf(i).isRequired},getDefaultProps:function aa(){return {shade:'dark'};},render:function aa(){if(!this.props.shown)return null;return c('React').createElement('div',{className:c('joinClasses')("_2yqb"+(this.props.noColor?' '+"_2yqc":'')+(' '+"_2yqd"),this.props.className)},this.props.text,this.props.removable&&this.props.onRemove?c('React').createElement(c('XUICloseButton.react'),{className:"_2yqe",onClick:this.props.onRemove,shade:this.props.shade}):c('React').createElement('div',{className:"_4ypj"}));}});function n(aa){return c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yqi",text:'REMINDER',shown:!c('OzHelpers').urgentReminders(aa.thread).isEmpty()}));}function o(aa){return c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yqj",text:'PAID',shown:!c('OzHelpers').paidReminders(aa.thread).isEmpty()}));}function p(aa){var ba=c('OzHelpers').minAge(aa.thread);return c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yqm",text:ba<18&&'UNDER 18'||ba<21&&'UNDER 21',shown:ba<21}));}function q(aa){return c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yql",text:'ENGAGE',shown:c('OzHelpers').hasEngage(aa.thread)}));}var r=j({OzVIPLabel:['vip',"_2yqf"],OzUrgentLabel:['urgent',"_2yqg"],OzAbuserLabel:['abuser',"_2yqh"],OzEscalatedLabel:['escalated',"_1jce"]}),s=j({OzEmployeeLabel:['employee',"_2yqk"]}),t=r.merge(s).map(function(aa){var ba=aa[0],ca=aa[1];return ba;}).toSet();function u(aa,ba,ca){return function(da){return c('React').createElement(m,babelHelpers['extends']({},da,{className:ba,text:z(aa),shown:c('OzHelpers').hasTag(da.thread,aa),onRemove:function ea(){return c('OzAPI').deleteTag(c('OzHelpers').threadID(da.thread),aa);}}));};}var v=r.map(function(aa){return u.apply(undefined,aa);}),w=s.map(function(aa){return u.apply(undefined,aa);});function x(aa){var ba=aa.className,ca=aa.removable,da=aa.addable,ea=babelHelpers.objectWithoutProperties(aa,['className','removable','addable']);return c('React').createElement('div',{className:ba},w.map(function(fa,ga){return c('React').createElement(fa,babelHelpers['extends']({key:ga},ea));}).valueSeq(),c('React').createElement(n,ea),v.map(function(fa,ga){return c('React').createElement(fa,babelHelpers['extends']({key:ga,removable:ca},ea));}).valueSeq(),(ea.thread.get('tags')||k()).filterNot(function(fa){return t.has(fa);}).sort().map(function(fa){var ga=u(fa,"_tch");return ga(babelHelpers['extends']({key:fa,removable:ca},ea));}),c('React').createElement(q,ea),c('React').createElement(o,ea),da?c('React').createElement(y,{thread:ea.thread}):null);}var y=c('React').createClass({displayName:'OzAddLabel',mixins:[c('OzImmutablePureRenderMixin'),c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{thread:l.instanceOf(i).isRequired},getInitialState:function aa(){return {shown:false};},render:function aa(){return c('React').createElement('span',{ref:'add'},this._tags().isEmpty()?null:c('React').createElement('button',{className:"_1-hv _2yqb _2yqn _2yqo",onClick:function(){return this.setState({shown:true});}.bind(this)},'+'));},renderLayers:function aa(){var ba=this.state.shown;if(!ba)return null;var ca=this.props.thread;return {contextualDialog:c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll')},position:'below',shown:ba,contextRef:function(){return this.refs.add;}.bind(this),onBlur:function(da){return this.setState({shown:false});}.bind(this)},c('React').createElement('div',{className:"_2yqp"},this._tags().map(function(da){var ea=da[0],fa=da[1];return c('React').createElement('button',{key:ea,className:c('joinClasses')(fa,"_1-hv _2yqq"),onClick:function(){this.setState({shown:false});c('OzAPI').createTag(c('OzHelpers').threadID(ca),ea);}.bind(this)},z(ea));}.bind(this))))};},_tags:function aa(){return r.filterNot(function(ba){var ca=ba[0],da=ba[1];return c('OzHelpers').hasTag(this.props.thread,ca);}.bind(this)).valueSeq();}});function z(aa){return aa.split('m_experiment_').join('').toUpperCase();}f.exports={OzLabelList:x,OzUnderageLabel:p};}),null);
__d('OzAllRow.react',['cx','OzStrings','OzHelpers','immutable','OzButton.react','OzConfig','OzConstants','OzDate.react','OzLastEvent.react','OzThreadLabels.react','OzUserImage.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('immutable').List,k=c('OzConstants').AUTHOR_TYPES,l=c('React').PropTypes,m=c('OzThreadLabels.react').OzLabelList,n=c('OzHelpers').pure(function(w){var x=w.thread,y=w.witIntents,z=babelHelpers.objectWithoutProperties(w,['thread','witIntents']);return c('React').createElement('div',{className:"_-66"},c('React').createElement(t,{width:'220px'},c('React').createElement(o,{thread:x})),c('React').createElement(t,{marginLeft:'10px',width:'250px'},c('React').createElement(p,{thread:x,witIntents:y})),c('React').createElement(t,{marginLeft:'10px',width:'350px'},c('React').createElement(q,{thread:x})),c('React').createElement(t,{marginLeft:'10px',width:'150px'},c('React').createElement(r,{thread:x})),c('React').createElement(t,{margineft:'10px',flex:'1',alignItems:'right'},c('React').createElement(s,babelHelpers['extends']({thread:x},z))));}),o=c('OzHelpers').pure(function(w){var x=w.thread;return c('React').createElement('div',{className:"_-67"},c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(x)}),c('React').createElement('div',{className:"_-68"},c('React').createElement('h1',{className:"_-69"},c('OzHelpers').getName(x)),c('React').createElement(m,{className:"_-6a",thread:x})));}),p=c('OzHelpers').pure(function(w){var x=w.thread,y=w.witIntents,z=c('OzHelpers').openIntents(x).toSeq().map(function(ba){return y.getIn([ba.get('wit-intent-uuid'),'name']);}).filter(function(ba){return ba;}).map(function(ba){return 'Intent: '+ba;}),aa=c('OzHelpers').urgentReminders(x).toSeq().map(function(ba){return ba.getIn(['body','description']);}).filter(function(ba){return ba;}).map(function(ba){return 'Reminder: '+ba;});return c('React').createElement('div',{className:"_-6q"},c('React').createElement('div',{className:"_-6r"},z.concat(aa).map(function(ba,ca){return c('React').createElement('div',{key:ca,className:"_4-_7 _-6s"},ba);})));}),q=c('OzHelpers').pure(function(w){var x=w.thread;return c('React').createElement('div',{className:"_-6u"},u(x).map(function(y){return c('React').createElement('div',{key:c('OzHelpers').msgID(y),className:"_-6v"+(c('OzHelpers').authorType(y)!==k.USER?' '+"_-6w":'')},c('React').createElement('span',{className:"_4-_7 _-6x"},c('React').createElement(c('OzDate.react'),{timestamp:y.get('timestamp')})),c('React').createElement(c('OzLastEvent.react'),{key:c('OzHelpers').msgID(y),name:c('OzHelpers').getName(x),lastEvent:y}));}));}),r=c('OzHelpers').pure(function(w){var x=w.thread,y=x.getIn(['owner','name'])||'No owner',z=x.getIn(['last-owner','name']);return c('React').createElement('div',{className:"_-6y"},c('React').createElement('div',{className:"_-6z"},y),z?c('React').createElement('div',{className:"_-6-"},'Last owner: ',z):null);}),s=c('React').createClass({displayName:'Actions',mixins:[c('OzImmutablePureRenderMixin')],contextTypes:{uid:l.string.isRequired},propTypes:{thread:l.instanceOf(i).isRequired,onThreadNotReady:l.func.isRequired,onThreadReady:l.func.isRequired,onThreadRelease:l.func.isRequired,onThreadView:l.func.isRequired},render:function w(){return c('React').createElement('div',{className:"_-6_"},v(babelHelpers['extends']({},this.props,{uid:this.context.uid})).map(function(x){var y=x.body,z=x.f;return c('React').createElement(c('OzButton.react'),{key:y,onClick:function(aa,ba){return z(this.props.thread,ba,aa);}.bind(this)},y);}.bind(this)));}}),t=c('OzHelpers').pure(function(w){var x=w.children,y=babelHelpers.objectWithoutProperties(w,['children']);return c('React').createElement('div',{className:"_-70",style:y},x);});function u(w){var x=c('OzHelpers').lastEvents(w).groupBy(c('OzHelpers').authorType);return j([x.get(k.USER),x.get(k.TRAINER),x.get(k.BOT)]).toSeq().filter(function(y){return y;}).map(function(y){return y.last();}).sortBy(function(y){return y.get('timestamp');});}function v(w){var x=w.onThreadNotReady,y=w.onThreadReady,z=w.onThreadRelease,aa=w.onThreadView,ba=w.thread,ca=w.uid,da=ba,ea=c('OzConfig').getInStaticConfig(['GK','supervisor']),fa=[];if(ea&&c('OzHelpers').hasOwner(da))fa.push({body:'Release',f:z});if(da.get('ready')){fa.push({body:c('OzStrings').NOTREADY_BUTTON,f:x});}else if(ea)fa.push({body:c('OzStrings').READY_BUTTON,f:y});if(da.getIn(['owner','id'])!==ca&&!c('OzHelpers').isSubscriber(da,ca))fa.push({body:'View',f:aa});return fa;}f.exports=n;}),null);
__d('OzAll.react',['cx','OzStrings','OzAPI','OzHelpers','immutable','MessengerFlexScrollableArea.react','OzActions','OzAllRow.react','OzLoading.react','OzStores','promiseFinally','OzImmutablePureRenderMixin','React','Reflux','XUIButton.react','XUIRadioButtonGroup.react'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('OzLoading.react').Flex,k=c('OzLoading.react').Inline,l=c('OzStores').QueueFilterStore,m=c('OzStores').ThreadStore,n=c('React').PropTypes,o=c('React').createClass({displayName:'OzAll',mixins:[c('Reflux').connect(l,'filters'),c('Reflux').connect(m,'threads')],contextTypes:{router:n.object.isRequired},getInitialState:function ca(){return {clientLimit:y};},componentWillMount:function ca(){if(this.state.threads.size<y)this._fetchThreads();},componentDidUpdate:function ca(da,ea){var fa=ea.filters.get('all'),ga=this.state.filters.get('all');if(!c('immutable').is(fa,ga))this._fetchThreads();},render:function ca(){var da=this._getFilters(),ea=da[0],fa=da[1],ga=this._threads();return c('React').createElement('div',{className:"_3l5z"},c('React').createElement(q,{showTags:ea,hideTags:fa,onChange:this._handleFilterChange}),c('React').createElement(p,{threads:ga,loading:!!w[aa(ea,fa)],clientLimit:this.state.clientLimit,onScrollBottom:this._handleScrollBottom,onThreadNotReady:this._handleThreadNotReady,onThreadReady:this._handleThreadReady,onThreadRelease:this._handleThreadRelease,onThreadView:this._handleThreadView,witIntents:this.props.witIntents}));},_getFilters:function ca(){var da=this.state.filters.get('all');return [da.get('showTags'),da.get('hideTags')];},_fetchThreads:function ca(){ba(this._getFilters());},_threads:function ca(){return t(s(this.state.threads),this._getFilters());},_handleFilterChange:function ca(da){c('OzActions').updateQueueFilters(i({all:i(da)}));this.setState({clientLimit:y});},_handleScrollBottom:function ca(){var da=this.state.clientLimit,ea=this._threads(),fa=da+y;this.setState({clientLimit:fa});ea.slice(da,fa).size||this._fetchThreads();},_handleThreadNotReady:function ca(da,ea){c('OzAPI').notready(c('OzHelpers').threadID(da)).done(ea,ea);},_handleThreadReady:function ca(da,ea){c('OzAPI').ready(c('OzHelpers').threadID(da)).done(ea,ea);},_handleThreadRelease:function ca(da,ea){c('OzAPI').release(c('OzHelpers').threadID(da)).done(ea,ea);},_handleThreadView:function ca(da,ea,fa){var ga=c('OzHelpers').threadID(da),ha=c('OzHelpers').hasCmdOrCtrl(fa);c('OzAPI').view(ga).done(function(ia){ea();ha||this.context.router.push('/inbox/'+ga);}.bind(this),ea);}}),p=c('React').createClass({displayName:'ThreadList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{clientLimit:n.number.isRequired,loading:n.bool.isRequired,onScrollBottom:n.func.isRequired,onThreadNotReady:n.func.isRequired,onThreadReady:n.func.isRequired,onThreadRelease:n.func.isRequired,onThreadView:n.func.isRequired,threads:n.instanceOf(i).isRequired,witIntents:n.instanceOf(i).isRequired},render:function ca(){var da=this.props,ea=da.loading,fa=da.threads,ga=da.clientLimit;if(ea&&!fa.count())return c('React').createElement(j,null);return c('React').createElement(c('MessengerFlexScrollableArea.react'),{ref:'scrollable',onScroll:this._handleScroll},c('React').createElement('div',{className:"_3l5-"},fa.take(ga).map(function(ha){return c('React').createElement(c('OzAllRow.react'),{key:c('OzHelpers').threadID(ha),thread:ha,witIntents:this.props.witIntents,onThreadNotReady:this.props.onThreadNotReady,onThreadReady:this.props.onThreadReady,onThreadRelease:this.props.onThreadRelease,onThreadView:this.props.onThreadView});}.bind(this)).valueSeq()),c('React').createElement(k,{loading:ea}));},_handleScroll:function ca(){var da=this.refs.scrollable;da&&da.isScrolledToBottom()&&this.props.onScrollBottom();}}),q=c('OzHelpers').pure(function(ca){var da,ea,fa=ca.showTags,ga=ca.hideTags,ha=ca.onChange,ia=function ja(ka){var la=ka.tagName,ma=ka.value,na=v({tagName:la,value:ma,showTags:fa,hideTags:ga});ha(na);};return c('React').createElement('div',{className:"_3l5_"},c('React').createElement(r,{tagName:'employee',value:u('employee',fa,ga),onChange:ia,buttons:(da={},da[u.NEUTRAL]=c('OzStrings').USER_FILTER_ALL,da[u.OFF]=c('OzStrings').USER_FILTER_PUBLIC,da[u.ON]=c('OzStrings').USER_FILTER_EMPLOYEE,da)}),c('React').createElement(r,{tagName:'ready',value:u('ready',fa,ga),onChange:ia,buttons:(ea={},ea[u.NEUTRAL]=c('OzStrings').READY_FILTER_ALL,ea[u.OFF]=c('OzStrings').READY_FILTER_ATTENTION,ea[u.ON]=c('OzStrings').READY_FILTER_WAITING,ea)}));}),r=c('OzHelpers').pure(function(ca){var da=ca.tagName,ea=ca.value,fa=ca.buttons,ga=ca.onChange;return c('React').createElement('div',{key:da,className:"_3l60"},c('React').createElement(c('XUIRadioButtonGroup.react'),{selectedValue:ea,selectedUse:'confirm',onValueChange:function ha(ia){ga({tagName:da,value:ia});}},Object.keys(fa).map(function(ha){return c('React').createElement(c('XUIButton.react'),{key:ha,value:ha,label:fa[ha]});})));});function s(ca){return ca.sortBy(function(da){return -da.get('last-event-at');});}function t(ca,da){var ea=da[0],fa=da[1];return ca.filter(function(ga){var ha=true;if(ea.size)ha=c('OzHelpers').hasAllTags(ga,ea);if(fa.size)ha=!c('OzHelpers').hasSomeTag(ga,fa);return ha;});}var u=function ca(da,ea,fa){return ea.has(da)?ca.ON:fa.has(da)?ca.OFF:ca.NEUTRAL;};u.ON='on';u.OFF='off';u.NEUTRAL='neutral';function v(ca){var da=ca.tagName,ea=ca.value,fa=ca.showTags,ga=ca.hideTags,ha,ia;switch(ea){case u.ON:ha=fa.add(da);ia=ga.remove(da);break;case u.OFF:ha=fa.remove(da);ia=ga.add(da);break;default:ha=fa.remove(da);ia=ga.remove(da);break;}return {showTags:ha,hideTags:ia};}var w={},x={},y=20,z=2*y;function aa(ca,da){var ea=ca.toJS().join('-'),fa=da.toJS().join('-');return 'show['+ea+']hide['+fa+']';}function ba(ca){var da=ca[0],ea=ca[1],fa=aa(da,ea),ga=w[fa];c('OzHelpers').debug('[oz-all] fetchThreads',fa);if(ga){c('OzHelpers').debug('[oz-all] abort fetchthreads : loading',fa);return;}var ha=x[fa]||0;w[fa]=true;c('promiseFinally')(c('OzAPI').allThreads(da,ea,ha,z),function(ia){return w[fa]=false;}).done(function(ia){return x[fa]=ha+z;});}f.exports=o;}),null);
__d('OzExpirationCountdown.react',['cx','relativeTimeString.atlas','OzDate.react','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes,l=30*1000;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.$OzExpirationCountdown2=function(){this.forceUpdate();if(this.isExpired()){clearInterval(this.$OzExpirationCountdown1);this.$OzExpirationCountdown1=null;}}.bind(this),this.remainingTime=function(){return this.props.endTime-Date.now();}.bind(this),this.isExpired=function(){return this.props.endTime<=Date.now();}.bind(this),o;}m.prototype.componentDidMount=function(){'use strict';this.$OzExpirationCountdown1=setInterval(this.$OzExpirationCountdown2,l);};m.prototype.componentWillReceiveProps=function(){'use strict';this.$OzExpirationCountdown1=this.$OzExpirationCountdown1||setInterval(this.$OzExpirationCountdown2,l);};m.prototype.componentWillUnmount=function(){'use strict';clearInterval(this.$OzExpirationCountdown1);};m.prototype.render=function(){'use strict';var n=this.props.endTime,o=this.isExpired()&&c('React').createElement('span',null,'Expired ',c('React').createElement(c('OzDate.react'),{timestamp:n}))||this.remainingTime()<=60*1000&&'Expires in less than a minute'||'Expires in '+c('relativeTimeString.atlas')(n,true),p="_3d53"+(this.isExpired()?' '+"_3d54":'')+(!this.isExpired()?' '+"_3d55":'');return c('React').createElement('span',{className:p},o);};m.propTypes={endTime:k.number.isRequired};f.exports=m;}),null);
__d('OzMessage.react',['cx','getURLRanges','OzHelpers','formatDate','Image.react','immutable','Link.react','MNCommerceAgentItemSuggestionMercuryShareAttachment.react','MNCommercePromotionMercuryShareAttachment.react','OzExpirationCountdown.react','OzImmutablePureRenderMixin','React','OzWrapper.react','TextWithEntities.react','XStickerAssetController'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzMessage',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{message:k.instanceOf(i).isRequired},render:function ma(){var na=this.props.message,oa=na.get('attachments')||j(),pa=j([na.get('text')&&ka(na.get('text'))]).concat(oa.map(function(qa){var ra=x(qa)&&y(qa)||s(qa)&&t(qa)||ea(qa)&&ga(fa(qa))||da(qa)&&ga(qa.get('uri'))||ba(qa)&&ca(qa)||z(qa)&&aa(qa)||u(qa)&&v(qa)||q(qa)&&r(qa)||m(qa)&&p(o(qa.get('metadata')))||n(qa)&&p(c('OzHelpers').uiSuggestion(qa.get('suggestion')))||ha(qa)&&ia(qa.getIn(['xma','link']))||qa.get('uri')&&ia(qa.get('uri'));if(ra){return ra;}else{c('OzHelpers').error('could not render attachment',qa.toJS(),na.toJS());return la('Oops. We could not render this attachment.');}})).filter(function(qa){return !!qa;}).map(function(qa,ra){return c('React').createElement('span',{key:ra,className:"_15_n"},qa);});if(pa.size){return c('React').createElement('span',null,pa);}else{c('OzHelpers').error('no text or attachments',na.toJS());return la('Oops. We did not get text or attachments.');}}}),m=function ma(na){return na.hasIn(['metadata','target_url']);},n=function ma(na){return na.has('suggestion');},o=function ma(na){if(!i.isMap(na.get('total_cost'))&&na.has('raw_amount'))na=na.set('total_cost',i({amount:+na.get('raw_amount')}));return na.update('target_url',c('OzHelpers').shimURI).toJS();};function p(ma){return c('React').createElement('div',{className:"_53qw"},ma.expiration_time?c('React').createElement('div',{className:"_4jjz"},c('React').createElement(c('OzExpirationCountdown.react'),{endTime:ma.expiration_time*1000})):null,c('React').createElement('div',{className:"_4jj-"},c('React').createElement(c('MNCommerceAgentItemSuggestionMercuryShareAttachment.react'),{attachment:{target:ma}})));}var q=function ma(na){return na.get('mime_type')==='oz/business-message';};function r(ma){var na=ma.get('xma').setIn(['target','call_to_actions'],[]).toJS();return c('React').createElement('div',{className:"_53qw"},c('React').createElement('div',{className:"_4jj-"},c('React').createElement(c('MNCommercePromotionMercuryShareAttachment.react'),{attachment:na})));}var s=function ma(na){return na.get('mime_type')==='oz/event';};function t(ma){var na=ma.get('metadata'),oa=function qa(ra){return ra?c('formatDate')(ra,'M jS, g:ia'):'[no time]';},pa=na.getIn(['place','name'])||na.get('description')||'[no location]';return c('React').createElement('a',{className:"_3is9",href:na.get('url'),target:'_blank'},c('React').createElement('img',{alt:pa,className:"_3isa",src:na.get('image_url')}),c('React').createElement('div',{className:"_3isb"},c('React').createElement('div',{className:"_3isc"},na.get('title')||'[no invitation title]'),c('React').createElement('div',null,oa(na.get('start')),' \u2014 ',oa(na.get('end'))),c('React').createElement('div',null,pa)));}var u=function ma(na){var oa=na.get('metadata');return oa&&oa.get('location')&&oa.get('url')&&oa.get('image_url');};function v(ma){return ga(ma.getIn(['metadata','image_url']),ma.getIn(['metadata','url']));}var w=function ma(na){var oa=na.get('uri'),pa=na.get('sticker_id');if(pa)oa=c('XStickerAssetController').getURIBuilder().setInt('sticker_id',pa).getURI().toString();return oa;},x=function ma(na){return (na.get('sticker_id')||c('OzHelpers').isStickerType(na.get('mime_type')))&&w(na);};function y(ma){return c('React').createElement(c('Image.react'),{className:"__vl",src:w(ma)});}var z=function ma(na){return /video/.test(na.get('mime_type'))&&na.get('uri');};function aa(ma){return c('React').createElement('video',{controls:true,height:'300',width:'300'},c('React').createElement('source',{src:ma.get('uri'),type:ma.get('mime_type')}));}var ba=function ma(na){return /audio/.test(na.get('mime_type'))&&na.get('uri');};function ca(ma){return c('React').createElement('audio',{className:"_1d86",controls:true},c('React').createElement('source',{src:ma.get('uri'),type:ma.get('mime_type')}));}var da=function ma(na){var oa=/blob:/.test(na.get('uri')),pa=/\.(jpg|gif|png)/.test(na.get('uri'));return na.get('uri')&&(c('OzHelpers').isImageType(na.get('mime_type'))||oa||pa);},ea=function ma(na){return /base64/.test(na.get('mime_type'))&&na.get('data');},fa=function ma(na){return na.get('mime_type')+','+na.get('data');};function ga(ma,na){return c('React').createElement('a',{href:na||ma,target:'_blank',className:"_4y6l",style:{backgroundImage:'url(\''+ma+'\')'}});}var ha=function ma(na){return !!na.getIn(['xma','link']);};function ia(ma){return c('React').createElement('div',{className:"_4y6k"},c('React').createElement('a',{href:ma,target:'_blank'},'Attachment Link'));}function ja(ma,na){return c('React').createElement(c('Link.react'),{target:'_blank',href:c('OzHelpers').shimURI(na.entity.url)},ma);}function ka(ma){return c('React').createElement(c('TextWithEntities.react'),{className:"_4y6k",text:ma,interpolator:ja,ranges:c('getURLRanges')(ma),renderEmoticons:true,renderEmoji:true});}function la(ma){return c('React').createElement('div',{className:"_4y6k _5kng"},ma);}f.exports=c('OzWrapper.react')(l);}),null);
__d('OzSearchSource',['AbstractSearchSource'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('AbstractSearchSource'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$OzSearchSource1=k;}j.prototype.bootstrap=function(){'use strict';return this.$OzSearchSource1({});};j.prototype.suggest=function(k){'use strict';return this.$OzSearchSource1(k);};j.prototype.searchImpl=function(k,l){'use strict';return this.$OzSearchSource1({query:k}).then(function(m){return l(m,k);},function(m){return l([],k);});};f.exports=j;}),null);
__d('OzFeedbackDashboard.react',['cx','Promise','OzAPI','OzHelpers','immutable','OzButton.react','OzConfig','OzMessage.react','OzSearchSource','OzImmutablePureRenderMixin','React','Reflux','SearchableDropdownInput.contrib','SearchableEntry','Stars.react','joinClasses'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzFeedbackDashboard',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{uid:j.string.isRequired,router:j.object.isRequired},getInitialState:function da(){return {messages:i(),authorID:this.context.uid};},componentWillMount:function da(){this._searchSource=new (c('OzSearchSource'))(function(ea){var fa=(ea.query||'').toLowerCase();return new (c('Promise'))(function(ga){return ga(this.props.reps.valueSeq().map(u).concat([u('autoresponse-bot'),u('survey-bot')]).sortBy(function(ha){return ha.getTitle();}).filter(function(ha){return (ha.getTitle()||'').toLowerCase().indexOf(fa)>-1;}).toJS());}.bind(this));}.bind(this));},componentDidMount:function da(){this._fetchFeedback();},render:function da(){return c('React').createElement('div',{className:"_60f"},this.state.config.getIn(['GK','supervisor'])?c('React').createElement(l,{reps:this.props.reps,authorID:this.state.authorID,searchSource:this._searchSource,onSelect:function(ea){return this.setState({messages:i(),activeMessage:null,authorID:ea.getUniqueID()},this._fetchFeedback);}.bind(this)}):null,c('React').createElement(m,{messages:this.state.messages}),c('React').createElement(r,{messages:this.state.messages,reps:this.props.reps,activeMessage:this.state.activeMessage||this.state.messages.first(),onMessageClick:function(ea){return this.setState({activeMessage:ea});}.bind(this),onSeeThreadClick:function(ea){return this.context.router.push('/inbox/'+ea);}.bind(this)}));},_fetchFeedback:function da(){c('OzAPI').authorFeedback(this.state.authorID).done(function(ea){ea=ea.sortBy(function(fa){return -fa.get('timestamp');});this.isMounted()&&this.setState({messages:ea});}.bind(this));}}),l=c('OzHelpers').pure(function(da){var ea=da.reps,fa=da.authorID,ga=da.searchSource,ha=da.onSelect;return c('React').createElement('div',{className:"_5p66"},c('React').createElement('div',{className:"_wa_"},c('React').createElement(c('SearchableDropdownInput.contrib'),{value:u(ea.get(fa)||fa),onSelect:ha,placeholder:'Pick a rep',emptySearchResultsText:'No Rep found',searchSource:ga})));}),m=c('OzHelpers').pure(function(da){var ea=da.messages;return c('React').createElement('div',null,c('React').createElement(o,{messages:ea,days:'-7',span:'7'}),c('React').createElement(o,{messages:ea,days:'-14',span:'7'}),c('React').createElement(o,{messages:ea,days:'-21',span:'7'}),c('React').createElement(o,{messages:ea,days:'-30',span:'30'}),c('React').createElement(o,{messages:ea,days:'-60',span:'30'}));}),n=c('OzHelpers').pure(function(da){var ea=da.day,fa=da.span;return c('React').createElement('div',{className:"_24xm"},ea+fa==0?'LAST '+ -ea+' DAYS':'FROM '+(ea+fa)+' TO '+ea+' DAYS');}),o=c('OzHelpers').pure(function(da){var ea=da.messages,fa=da.days,ga=da.span,ha=parseInt(fa,10),ia=parseInt(ga,10),ja=ca(ea,ha,ha+ia);return c('React').createElement('div',{className:"_wb0"},c('React').createElement(n,{day:ha,span:ia}),c('React').createElement('div',{className:"_wb2"},c('React').createElement(p,{label:'TONE'},z(ja)),c('React').createElement(p,{label:'RESPONSIVENESS'},y(ja)),c('React').createElement(p,{label:'EXECUTION'},x(ja)),c('React').createElement(p,{label:'CONSOLE'},aa(ja)),c('React').createElement(q,null,ba(ja))),c('React').createElement('div',{className:"_3gch"},c('React').createElement(p,{label:'FEEDBACK GIVEN'},ja.size)));}),p=c('OzHelpers').pure(function(da){var ea=da.label,fa=da.children,ga=da.variation,ha=da.className;return c('React').createElement('div',{className:c('joinClasses')(ha,"_wb3")},c('React').createElement('span',{className:"_wb4"},fa),c('React').createElement('span',{className:"_wb5"},ea));}),q=c('OzHelpers').pure(function(da){var ea=da.children;return c('React').createElement(p,{label:'POLICY',className:(ea===0?"_wb6":'')+(ea>0?' '+"_wb7":'')},ea);}),r=c('OzHelpers').pure(function(da){var ea=da.messages,fa=da.reps,ga=da.activeMessage,ha=da.onMessageClick,ia=da.onSeeThreadClick,ja=ga&&ga.get('reviews'),ka=ga&&ga.get('user-id');return c('React').createElement('div',{className:"_wb8"},c('React').createElement('div',{className:"_wbc"},c('React').createElement('div',{className:"_4fj7"},ea.map(function(la){return c('React').createElement('div',{className:"_wbf"+(la===ga?' '+"_wbg":''),key:c('OzHelpers').msgID(la),onClick:function ma(na){return ha(la);},role:'presentation'},c('React').createElement(c('OzMessage.react'),{message:la}));}).valueSeq())),c('React').createElement('div',{className:"_wbh"},c('React').createElement('div',{className:"_wbe"},ja?ja.map(function(la){return c('React').createElement(s,{key:la.get('id'),rep:fa.get(la.get('reviewer-id')),review:la});}).valueSeq():null)),c('React').createElement('div',{className:"_wbi"},ka?c('React').createElement(c('OzButton.react'),{onClick:function la(ma){return ia(ka);}},'See Thread'):null));}),s=c('OzHelpers').pure(function(da){var ea=da.review,fa=da.rep;return c('React').createElement('div',{className:"_wbj"},c('React').createElement('div',{className:"_wbk"},c('React').createElement('h2',{className:"_wbl"},fa&&fa.get('name')),ea.has('tone')?c('React').createElement(t,{label:'Tone'},c('React').createElement(c('Stars.react'),{count:ea.get('tone'),max:3,size:'large'})):null,ea.has('responsiveness')?c('React').createElement(t,{label:'Responsiveness'},c('React').createElement(c('Stars.react'),{count:ea.get('responsiveness'),max:3,size:'large'})):null,ea.has('execution')?c('React').createElement(t,{label:'Execution'},c('React').createElement(c('Stars.react'),{count:ea.get('execution'),max:3,size:'large'})):null,ea.has('followed-policy')?c('React').createElement(t,{label:'Followed Policy?'},c('React').createElement('div',{className:"_wbm"},ea.get('followed-policy')?'YES':'NO')):null,ea.has('console-proficiency')?c('React').createElement(t,{label:'Console'},c('React').createElement(c('Stars.react'),{count:ea.get('console-proficiency'),max:3,size:'large'})):null),c('React').createElement('div',{className:"_wbn"},ea.get('body')));}),t=c('OzHelpers').pure(function(da){var ea=da.label,fa=da.children;return c('React').createElement('div',{className:"_wbo"},fa,c('React').createElement('div',{className:"_wbp"},ea));});function u(da){var ea=function fa(ga){return new (c('SearchableEntry'))(ga);};return da?da.get?ea({title:da.get('name'),uniqueID:da.get('fbid')}):ea({title:da,uniqueID:da}):null;}function v(da,ea){return function(fa){var ga=fa.valueSeq().flatMap(function(ka){return ka.get('reviews');}).filter(function(ka){return ka&&ka.has(da);}),ha=ga.reduce(function(ka,la){var ma=ka[0],na=ka[1];return [ma+ea,na+la.get(da)];},[0,0]),ia=ha[0],ja=ha[1];return ia?Math.round(ja/ia*100)+'%':' ';};}function w(da){return function(ea){var fa=ea.valueSeq().flatMap(function(ha){return ha.get('reviews');}).filter(function(ha){return ha&&ha.has(da);}),ga=fa.reduce(function(ha,ia){return ha+!ia.get(da);},0);return ga?ga:'';};}var x=v('execution',3),y=v('responsiveness',3),z=v('tone',3),aa=v('console-proficiency',3),ba=w('followed-policy');function ca(da,ea,fa){var ga=new Date().getDate(),ha=+new Date(Date.now()).setDate(ga+ea),ia=+new Date(Date.now()).setDate(ga+fa);return da.filter(function(ja){var ka=+ja.get('timestamp');return ka>=ha&&ka<=ia;});}f.exports=k;}),null);
__d('OzInboxThreadRow.react',['cx','OzHelpers','immutable','OzConfig','OzLastEvent.react','OzThreadLabels.react','OzUserImage.react','OzImmutablePureRenderMixin','React','OzWrapper.react','Reflux','Sound','Timestamp.react','Tooltip'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('OzThreadLabels.react').OzLabelList,k=c('React').PropTypes,l=1000,m=c('React').createClass({displayName:'OzInboxThreadRow',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{thread:k.object.isRequired,locker:k.object.isRequired,selected:k.bool.isRequired,onClick:k.func.isRequired,onUnview:k.func.isRequired,witIntents:k.instanceOf(i).isRequired},contextTypes:{uid:k.string.isRequired},getInitialState:function r(){return {flashing:false,unread:false};},componentWillReceiveProps:function r(s){var t=s.thread,u=s.selected;if(this.state.config.getIn(['GK','responsiveness'])){if(n(this.props.thread,t)){o(t);this.setState({unread:true,flashing:true});window.clearTimeout(this._flashingTimeout);this._flashingTimeout=window.setTimeout(function(v){return this.setState({flashing:false});}.bind(this),l);}if(u)this.setState({unread:false});}},componentWillUnmount:function r(){window.clearTimeout(this._flashingTimeout);},render:function r(){var s=this.props,t=s.thread,u=s.locker,v=s.selected,w=s.subscribed,x=s.owned,y=s.onUnview,z=c('OzHelpers').getName(t),aa=c('OzHelpers').photo(t),ba=c('OzHelpers').lastEvents(t).last(),ca=!x&&t.get('ui-reassign'),da=c('OzHelpers').hasPaid(t),ea=c('OzHelpers').hasReminder(t),fa=t.get('locked'),ga=fa?'Thread locked by '+u.get('name')+'\n       at '+new Date(t.get('locked-at')).toLocaleString():'',ha=x&&(t.get('ready')||da||ea)&&!fa,ia=null,ja=ba&&ba.get('timestamp');if(!x){var ka=t.get('ui-reassign')?'Reassigned to':'Grabbed by';ia=ka+' '+c('OzHelpers').nameOrId(t.get('owner'));}var la=this.state.config.getIn(['GK','responsiveness']),ma=this.state.config.getIn(['GK','responsivenessV2']),na=ma?c('OzHelpers').isUnread(t)&&!v:this.state.unread;return c('React').createElement('div',{className:"_2ic2"+(la&&na?' '+"_2ic4":'')+(la&&this.state.flashing?' '+"_5lan":'')+(ha?' '+"_2ic3":'')+(ea?' '+"_2ic5":'')+(da?' '+"_2ic6":'')+(v?' '+"_2ic7":'')+(ca?' '+"_2q4a":''),onClick:this._handleClick,role:'presentation'},c('React').createElement('div',{className:"_2ic8"},c('React').createElement(c('OzUserImage.react'),{photo:aa}),w?c('React').createElement('button',{className:"_1-hv _2ic9",onClick:function oa(pa){return y(t);}}):null),c('React').createElement('div',{className:"_2ica"},!x?c('React').createElement(p,{name:ia}):null,c('React').createElement('h1',{className:"_4-_7 _2ice"},z),c('React').createElement(q,{thread:t,witIntents:this.props.witIntents}),c('React').createElement('div',{className:"_2icb"},ba?c('React').createElement(c('OzLastEvent.react'),{lastEvent:ba,name:z}):null),c('React').createElement('div',{className:"_3lxn"},c('React').createElement(j,{className:"_2icc",thread:t}))),c('React').createElement('div',{className:"_6f"},ja?c('React').createElement('div',{className:"_2icf"},c('React').createElement(c('Timestamp.react'),{autoUpdate:true,shorten:true,time:ja/1000})):null,c('React').createElement('div',babelHelpers['extends']({className:fa?"_1hw":''},c('Tooltip').propsFor(ga)))));},_handleClick:function r(){this.props.onClick(this.props.thread);}});function n(r,s){return (c('OzHelpers').unreadTs(r)||0)<(c('OzHelpers').unreadTs(s)||0);}c('Sound').init(['audio/ogg','audio/mpeg']);function o(r){var s=c('OzHelpers').unreadTs(r);c('OzHelpers').debug('[inboxThreadRow] sound for tid '+c('OzHelpers').threadID(r)+', ts '+s);var t=c('OzConfig').ConfigStore.data.getIn(['resources','sound','notifyUnread'],i()).toObject(),u=t.ogg,v=t.mp3;if(s&&(u||v)){c('Sound').play([u,v],s,false);}else c('OzHelpers').warn('[inboxThreadRow] sounds not loaded');}function p(r){var s=r.name,t=r.lastEvent,u=t&&t.get('timestamp');return c('React').createElement('div',{className:"_2icd"},c('React').createElement('h1',{className:"_4-_7 _2ice"},s),u?c('React').createElement('div',{className:"_2icf"},c('React').createElement(c('Timestamp.react'),{autoUpdate:true,shorten:true,time:u/1000})):null);}function q(r){var s=r.thread,t=r.witIntents,u=c('OzHelpers').openIntents(s).first(),v=u&&t.getIn([u.get('wit-intent-uuid'),'name']);return v?c('React').createElement('div',{className:"_2icg"},v):c('React').createElement('span',null);}f.exports=c('OzWrapper.react')(m);}),null);
__d('OzInboxThreadList.react',['cx','OzHelpers','joinClasses','OzInboxThreadRow.react','immutable','OzLoading.react','OzImmutablePureRenderMixin','React','OzWrapper.react'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('immutable').Map,j=c('immutable').OrderedMap,k=c('React').PropTypes,l=c('OzLoading.react').Inline,m=c('React').createClass({displayName:'OzInboxThreadList',mixins:[c('OzImmutablePureRenderMixin')],contextTypes:{uid:k.string.isRequired},propTypes:{loading:k.bool.isRequired,onThreadClick:k.func.isRequired,onUnview:k.func.isRequired,threadGroups:k.instanceOf(j).isRequired,witIntents:k.instanceOf(i).isRequired,className:k.string,selectedThread:k.string},render:function o(){var p=this.props.threadGroups.some(function(q){return q.count();});return c('React').createElement('div',{className:c('joinClasses')("_36ob",this.props.className)},p?c('React').createElement(l,{key:'l',loading:this.props.loading}):c('React').createElement(n,null),p?this.props.threadGroups.map(this._renderRows).valueSeq():null);},_renderRows:function o(p,q){var r=p.map(function(s){return c('React').createElement(c('OzInboxThreadRow.react'),{key:c('OzHelpers').threadID(s),thread:s,locker:this.props.reps.get(s.get('locker-id'),i()),owned:c('OzHelpers').isOwner(s,this.context.uid),selected:c('OzHelpers').threadID(s)===this.props.selectedThread,subscribed:c('OzHelpers').isSubscriber(s,this.context.uid),onClick:this.props.onThreadClick,onUnview:this.props.onUnview,witIntents:this.props.witIntents});}.bind(this)).valueSeq();return c('React').createElement('span',{className:"_36oc",key:q},r);}});function n(){return c('React').createElement('div',{className:"_725"},'You do not own any threads at the moment.',c('React').createElement('br',null));}f.exports=c('OzWrapper.react')(m);}),null);
__d('OzInboxThreads',['OzHelpers','OzConfig'],(function a(b,c,d,e,f,g){var h='GRABBED',i='VIEWING',j='PAST';function k(n){return c('OzConfig').ConfigStore.data.getIn(['GK','responsivenessV2'])?Math.max(c('OzHelpers').unreadTs(n)||0,n.get('last-event-at',0)):n.get('last-event-at',0);}function l(n){var o=function p(q){return q.get('locked-at')&&q.get('locker-id')===n;};return function(p,q){if(o(p)&&!o(q)){return -1;}else if(!o(p)&&o(q)){return 1;}else return c('OzHelpers').compareNums(k(p),k(q));};}var m=c('OzHelpers').memoize(function(n,o){var p=arguments.length<=2||arguments[2]===undefined?'':arguments[2],q=l(o);return n.filter(function(r){var s=c('OzHelpers').isOwner(r,o),t=c('OzHelpers').isLocker(r,o),u=c('OzHelpers').isSubscriber(r,o),v=c('OzHelpers').wasOwner(r,o),w=c('OzHelpers').hasOpenIntents(r);switch(p){case h:return (s||r.get('ui-reassign')&&v)&&(r.get('ready')||w||t);case i:return u;case j:return v||s&&!r.get('ready')&&!w;default:return s||u;}}).sort(q);},function(n,o){var p=arguments.length<=2||arguments[2]===undefined?'':arguments[2];return n.hashCode()+o+p;},3);f.exports={getInboxThreads:m,OZ_GRABBED_TAB:h,OZ_VIEWING_TAB:i,OZ_PAST_TAB:j};}),null);
__d('OzTabHeader.react',['cx','React'],(function a(b,c,d,e,f,g,h){function i(j){var k=j.tabs,l=j.onChange,m=j.active;return c('React').createElement('div',{className:"_2j6l"},k.map(function(n){var o=n[0],p=n[1];return c('React').createElement('button',{key:p,role:'button',className:"_1-hv"+(' '+"_2j6m")+(p===m?' '+"_2j6n":''),onClick:function q(r){return l([o,p]);}},o);}));}f.exports=i;}),null);
__d('OzInbox.react',['cx','OzAPI','OzHelpers','DataTransfer','immutable','OzActions','OzInboxThreadList.react','OzInboxThreads','OzStores','OzTabHeader.react','ReactComponentWithPureRenderMixin','React','OzWrapper.react','Reflux','promiseFinally'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('immutable').OrderedMap,m=c('immutable').List,n=c('OzStores').HandledEventsStore,o=c('OzStores').HumanStore,p=c('OzStores').ThreadStore,q=c('React').PropTypes,r=c('OzInboxThreads').OZ_GRABBED_TAB,s=c('OzInboxThreads').OZ_VIEWING_TAB,t=c('OzInboxThreads').OZ_PAST_TAB,u=5000,v=30000,w=120*1000,x=r,y=c('React').createClass({displayName:'OzInbox',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(p,'threads'),c('Reflux').connect(o,'humans'),c('Reflux').connect(n,'handledEvents')],contextTypes:{uid:q.string.isRequired,router:q.object.isRequired},getInitialState:function da(){return {activeTab:null,loading:false};},componentDidMount:function da(){this._fetchThreads();var ea=window.setInterval(function(ga){this._fetchThreads();}.bind(this),v),fa=window.setInterval(function(){var ga=this.threads(this._getActiveTab());if(ga.some(function(ha){return ha.get('ui-reassign');}))c('OzActions').clearReassignState();}.bind(this),u);this._cleanup=function(){x=this._getActiveTab();window.clearInterval(fa);window.clearInterval(ea);}.bind(this);},componentDidUpdate:function da(ea,fa){var ga=this.props.params.threadid;if(!ga){var ha=this.threads(),ia=c('OzStores').ActiveThreadStore.data.get('oldThreadID'),ja=ha.get(ia)||ha.first();if(ja){c('OzHelpers').info('[ozinbox] search for best thread, found:',ja);this.context.router.push('/inbox/'+c('OzHelpers').threadID(ja));}}},componentWillUnmount:function da(){this._cleanup();},render:function da(){var ea=this._getActiveTab(),fa=this.threads(ea),ga=this.state.humans.getIn([this.context.uid,'load'],0),ha=function ia(ja){return ja.preventDefault();};return c('React').createElement('div',{className:"_4b5_",onDragStart:ha,onDragEnd:ha,onDragOver:ha,onDrop:function ia(ja){ha(ja);var ka=new (c('DataTransfer'))(ja.nativeEvent.dataTransfer);c('OzActions').updateComposer({files:ka.getFiles()});}},c('React').createElement(z,{threadGroups:ba(fa,this.context.uid,ea),reps:this.props.reps,loading:this.state.loading,activeCount:ga,activeTab:ea,selectedThread:this.props.params.threadid,onTabChange:this._handleTabChange,onUnview:this._handleUnview,onThreadClick:this._handleThreadClick,witIntents:this.props.witIntents}),this._renderDetails());},_getActiveTab:function da(){var ea=this.state.threads.get(this.props.params.threadid);return this.state.activeTab||ea&&c('OzHelpers').isOwner(ea,this.context.uid)&&r||ea&&c('OzHelpers').isSubscriber(ea,this.context.uid)&&s||x||r;},_handleUnview:function da(ea){this._callAPIAndShift('unview',ea);},_handleThreadClick:function da(ea){c('OzHelpers').info('[inbox/handleThreadClick] clicked on thread',c('OzHelpers').threadID(ea));var fa=c('OzHelpers').nextTaskForThread(ea);this.context.router.push(c('OzHelpers').threadPath({threadid:c('OzHelpers').threadID(ea),intentid:fa&&fa.get('intent-id'),taskid:fa&&fa.get('id')}));},_handleTabChange:function da(ea){var fa=ea[0],ga=ea[1];this.setState({activeTab:ga});},_callAPIAndShift:function da(ea,fa){var ga=aa(this.threads(r),fa),ha=function(ja){c('OzHelpers').info('[inbox/callAPIAndShift] shifting to thread',c('OzHelpers').threadID(ja));this.context.router.push('/inbox/'+c('OzHelpers').threadID(ja));}.bind(this),ia=c('OzAPI')[ea](c('OzHelpers').threadID(fa));ga&&ha(ga);ia.done(null,function(ja){c('OzHelpers').error('[inbox] could not shift',ja);ha(fa);});},_renderDetails:function da(){var ea=this.props.params.threadid;if(!ea&&this.threads().isEmpty())return this._renderFinished();var fa=c('OzHelpers').fullThreadData(this.state.threads,this.state.handledEvents,ea);if(!fa||!this.props.children)return null;return c('React').cloneElement(this.props.children,{thread:fa,witIntents:this.props.witIntents,requirements:this.props.requirements,merchants:this.props.merchants,humans:this.state.humans,reps:this.props.reps});},_renderFinished:function da(){return c('React').createElement('div',{className:"_57l3"},c('React').createElement('div',{className:"_57l8"},c('React').createElement('div',{className:"_57lo"}),c('React').createElement('h2',null,'Congrats! You\'ve made a lot of people happy'),c('React').createElement('p',null,'Sit tight, new messages should be coming soon!')));},_fetchThreads:function da(){var ea=this.state.loading;if(ea)return;this.setState({loading:true});c('promiseFinally')(c('OzAPI').myThreads(),function(fa){return this.isMounted()&&this.setState({loading:false});}.bind(this)).done();},threads:function da(ea){return c('OzInboxThreads').getInboxThreads(this.state.threads,this.context.uid,ea);}});i=babelHelpers.inherits(z,c('React').PureComponent);j=i&&i.prototype;z.prototype.render=function(){'use strict';var da=this.props,ea=da.activeTab,fa=da.onTabChange,ga=da.activeCount,ha=babelHelpers.objectWithoutProperties(da,['activeTab','onTabChange','activeCount']),ia=ga?'Open ('+ga+')':'Open';return c('React').createElement('div',{className:"_4b61"},c('React').createElement('div',{className:"_4cwh"},c('React').createElement(c('OzTabHeader.react'),{active:ea,tabs:[[ia,r],['Viewing',s],['Closed',t]],onChange:fa})),c('React').createElement('div',{className:"_3_cz"},c('React').createElement('div',{className:"_4fj7"},c('React').createElement(c('OzInboxThreadList.react'),babelHelpers['extends']({className:ea===r?"_2sav":''},ha)))));};function z(){'use strict';i.apply(this,arguments);}z.propTypes=babelHelpers['extends']({activeTab:q.oneOf([r,s,t]).isRequired,onTabChange:q.func.isRequired},c('OzInboxThreadList.react').propTypes);function aa(da,ea){var fa=c('OzHelpers').threadID(ea),ga=da.toList(),ha=ga.findIndex(function(ka){return c('OzHelpers').threadID(ka)===fa;}),ia=ha-1,ja=ha+1;if(ja<ga.count()){return ga.get(ja);}else if(ia>=0)return ga.get(ia);}function ba(da,ea,fa){var ga;switch(fa){case r:return ca(da,ea,fa);default:return l((ga={},ga[fa]=da,ga));}}function ca(da,ea,fa){var ga='Needs Attention',ha='Up For Grabs',ia='Waiting',ja=function ka(la){var ma=c('OzHelpers').isOwner(la,ea),na=la.get('ready')||c('OzHelpers').hasPaid(la)||c('OzHelpers').hasReminder(la),oa=c('OzHelpers').isLocker(la,ea),pa=c('OzHelpers').hasOpenIntents(la);return ma&&(oa||na&&pa)?ga:na?ha:ia;};return l().withMutations(function(ka){ka.set(ga,[]);ka.set(ha,[]);ka.set(ia,[]);da.forEach(function(la){return ka.update(ja(la),function(ma){ma.push(la);return ma;});});}).map(function(ka){return m(ka);});}f.exports=c('OzWrapper.react')(y);}),null);
__d('PhotocropConstraintConstants',[],(function a(b,c,d,e,f,g){var h={BOUNDARY:'boundary',SQUARE:'square',WIDE:'wide'};h.getAspectRatioForType=function(i){switch(i){case h.SQUARE:return 1;case h.WIDE:return 16/9;default:return null;}};f.exports=h;}),null);
__d('PhotocropConstraint',['Vector','PhotocropConstraintConstants','clamp'],(function a(b,c,d,e,f,g){var h,i,j,k;function l(p){'use strict';this.photocrop=p;this.pos=null;}l.prototype.onMouseMove=function(p,q,r){'use strict';var s=p.sub(this.pos);if(q){this.onResize(s,r);}else this.onMove(s);this.pos=this.pos.add(s);};l.prototype.onMouseDown=function(p){'use strict';this.pos=p;};l.prototype.onResize=function(p,q){'use strict';};l.prototype.onMove=function(p){'use strict';var q=this.photocrop.box,r=this.photocrop.wrapper.offsetWidth,s=this.photocrop.wrapper.offsetHeight;p.x=c('clamp')(p.x,-q.l,r-q.r);p.y=c('clamp')(p.y,-q.t,s-q.b);this.photocrop.box=q.add(p);};h=babelHelpers.inherits(m,l);i=h&&h.prototype;m.prototype.onResize=function(p,q){'use strict';var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight;switch(q){case 'ne':t.r+=p.x=c('clamp')(p.x,t.l+r-t.r,u-t.r);t.t+=p.y=c('clamp')(p.y,-t.t,t.b-s-t.t);break;case 'nw':t.l+=p.x=c('clamp')(p.x,-t.l,t.r-r-t.l);t.t+=p.y=c('clamp')(p.y,-t.t,t.b-s-t.t);break;case 'se':t.r+=p.x=c('clamp')(p.x,t.l+r-t.r,u-t.r);t.b+=p.y=c('clamp')(p.y,t.t+s-t.b,v-t.b);break;case 'sw':t.l+=p.x=c('clamp')(p.x,-t.l,t.r-r-t.l);t.b+=p.y=c('clamp')(p.y,t.t+s-t.b,v-t.b);break;}};function m(){'use strict';h.apply(this,arguments);}j=babelHelpers.inherits(n,l);k=j&&j.prototype;n.prototype.setRatio=function(p){'use strict';this.ratio=p;return this;};n.prototype.onMouseDown=function(p){'use strict';k.onMouseDown.call(this,p);var q=this.photocrop.box,r=q.r-q.l,s=q.b-q.t;this.displacement=new (c('Vector'))(r,s);};n.prototype.$AspectRatioConstraint1=function(p,q,r,s,t,u){'use strict';var v,w,x,y,z;v=this.displacement.x/this.displacement.y;w=y=c('clamp')(q,p,r);x=z=c('clamp')(t,s,u);if(v>this.ratio){x=c('clamp')(w/this.ratio,s,u);w=x*this.ratio;}else{w=c('clamp')(x*this.ratio,p,r);x=w/this.ratio;}return new (c('Vector'))(w,x);};n.prototype.onResize=function(p,q){'use strict';var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight,w;switch(q){case 'ne':this.displacement=this.displacement.add(p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,t.b);t.r=t.l+w.x;t.t=t.b-w.y;break;case 'nw':this.displacement=this.displacement.add(-p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,t.b);t.l=t.r-w.x;t.t=t.b-w.y;break;case 'se':this.displacement=this.displacement.add(p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,v-t.t);t.r=t.l+w.x;t.b=t.t+w.y;break;case 'sw':this.displacement=this.displacement.add(-p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,v-t.t);t.l=t.r-w.x;t.b=t.t+w.y;break;}};function n(){'use strict';j.apply(this,arguments);}function o(p,q){var r;switch(q){case c('PhotocropConstraintConstants').BOUNDARY:r=new m(p);break;case c('PhotocropConstraintConstants').WIDE:case c('PhotocropConstraintConstants').SQUARE:r=new n(p).setRatio(c('PhotocropConstraintConstants').getAspectRatioForType(q));break;default:throw Error('unsupported PhotocropConstraint type');}return r;}f.exports=o;}),null);
__d('Photocrop2',['ArbiterMixin','PhotocropConstraintConstants','CSS','DOM','Event','PhotosConst','Rect','Style','Vector','mixin','PhotocropConstraint'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m){'use strict';i.constructor.call(this);this.photo=k;var n=this.getPhotoDimensions();if(m){this.imageDimensions=new (c('Vector'))(m.x,m.y);}else this.imageDimensions=new (c('Vector'))(n.x,n.y);l.height=l.height||c('PhotosConst').PIC_NORMAL_FBX_SIZE;l.width=l.width||c('PhotosConst').PIC_NORMAL_FBX_SIZE;Object.assign(this,{target:this.photo.parentNode,create_target:false,target_parent:this.photo.parentNode,min_width:c('PhotosConst').PIC_NORMAL_FBX_SIZE,min_height:c('PhotosConst').PIC_NORMAL_FBX_SIZE,center_x:(n.x||l.width)/2,center_y:(n.y||l.height)/2,constraint_type:c('PhotocropConstraintConstants').BOUNDARY},l);this._unscaledMinHeight=this.min_height;this._unscaledMinWidth=this.min_width;this._unscaledHeight=this.height;this._unscaledWidth=this.width;this.setInitialDimensionsAndPos();if(this.create_target){this.target=c('DOM').create('div');c('CSS').addClass(this.target,'stageCropper');this.target_parent.appendChild(this.target);}c('CSS').addClass(this.target,'photocrop');['bg','wrapper','viewport'].forEach(function(o){this[o]=c('DOM').create('div');c('CSS').addClass(this[o],o);}.bind(this));this.highlight=c('DOM').create('img');c('CSS').addClass(this.highlight,'highlight');this.setHighlightSource();c('CSS').addClass(this.wrapper,'photocropWrapper');this.target.appendChild(this.bg);this.target.appendChild(this.wrapper);this.wrapper.appendChild(this.highlight);this.wrapper.appendChild(this.viewport);['ne','nw','sw','se'].forEach(function(o){var p=c('DOM').create('div');c('CSS').addClass(p,o);p.setAttribute('data-cropcorner',o);this.viewport.appendChild(p);c('CSS').addClass(p,'profilePicViewportGrabby');}.bind(this));c('Event').listen(this.viewport,{mousedown:this.mousedown.bind(this),dragstart:c('Event').kill,selectstart:c('Event').kill,click:c('Event').stop});c('Event').listen(document,{mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)});c('Event').listen(window,{resize:this.adjustForResize.bind(this)});this.realignToPictureSize();this.redraw();}j.prototype.setInitialDimensionsAndPos=function(){'use strict';this._constraint=c('PhotocropConstraint')(this,this.constraint_type);var k=c('PhotocropConstraintConstants').getAspectRatioForType(this.constraint_type),l=this.getPhotoDimensions();if(k){this._unscaledMinHeight=this._unscaledMinWidth/k;this._unscaledHeight=this._unscaledWidth/k;}this.setNewRatio();var m=Math.min(this.width,l.x),n=Math.min(this.height,l.y);this.min_width=Math.min(this.min_width,l.x);this.min_height=Math.min(this.min_height,l.y);if(k)if(l.x/l.y>k){n=Math.min(n,l.y);m=n*k;this.min_width=this.min_height*k;}else{m=Math.min(m,l.x);n=m/k;this.min_height=this.min_width/k;}var o=this.center_x-m/2,p=this.center_y-n/2;this.box=new (c('Rect'))(p,o+m,p+n,o);};j.prototype.getPhotoDimensions=function(){'use strict';return new (c('Vector'))(Math.round(parseFloat(c('Style').get(this.photo,'width'))),Math.round(parseFloat(c('Style').get(this.photo,'height'))));};j.prototype.getPhotoPosition=function(){'use strict';return new (c('Vector'))(this.photo.offsetLeft,this.photo.offsetTop);};j.prototype.setHighlightSource=function(){'use strict';this.highlight.src=this.photo.src;};j.prototype.setConstraintType=function(k){'use strict';this.constraint_type=k;this.setInitialDimensionsAndPos();this.adjustForResize();};j.prototype.adjustForResize=function(){'use strict';var k=this.ratio,l=this.setNewRatio(),m=l/k;this.box.t*=m;this.box.l*=m;this.box.b*=m;this.box.r*=m;this.redraw();this.realignToPictureSize();};j.prototype.setNewRatio=function(){'use strict';this.ratio=this.getPhotoDimensions().x/this.imageDimensions.x;this.min_width=this.ratio*this._unscaledMinWidth;this.min_height=this.ratio*this._unscaledMinHeight;this.width=Math.max(1,this.ratio)*this._unscaledWidth;this.height=Math.max(1,this.ratio)*this._unscaledHeight;return this.ratio;};j.prototype.realignToPictureSize=function(){'use strict';var k=this.photo;if(!k)return;var l=this.getPhotoDimensions(),m=this.getPhotoPosition();[this.bg,this.wrapper].forEach(function(n){n.style.width=l.x+'px';n.style.height=l.y+'px';n.style.top=m.y+'px';n.style.left=m.x+'px';});};j.prototype.redraw=function(){'use strict';var k=[this.box.t,this.box.r,this.box.b,this.box.l],l=this.getPhotoDimensions();this.highlight.style.width=l.x+"px";this.highlight.style.height=l.y+"px";this.highlight.style.clip="rect("+k.join("px ")+"px)";this.viewport.style.top=this.box.t+"px";this.viewport.style.left=this.box.l+"px";this.viewport.style.height=this.box.b-this.box.t+"px";this.viewport.style.width=this.box.r-this.box.l+"px";};j.prototype.done=function(k){'use strict';this.freezeViewport=true;if(!k){[this.bg,this.wrapper].forEach(c('DOM').remove);if(this.create_target){c('DOM').remove(this.target);this.target=null;}else c('CSS').removeClass(this.target,'photocrop');}var l=Math.round(this.box.l*(1/this.ratio)),m=Math.round(this.box.t*(1/this.ratio)),n=Math.round(this.box.r*(1/this.ratio)),o=Math.round(this.box.b*(1/this.ratio));this.inform('done',k);return {x:Math.max(l,0),y:Math.max(m,0),width:n-Math.max(l,0),height:o-Math.max(m,0)};};j.prototype.reset=function(){'use strict';this.freezeViewport=false;};j.prototype.mousedown=function(k){'use strict';if(this.freezeViewport)return;this.mouseTarget=k.getTarget();this._constraint.onMouseDown(c('Vector').getEventPosition(k));c('CSS').addClass(document.body,'draggingMode');return false;};j.prototype.mousemove=function(k){'use strict';if(!this.mouseTarget)return;this._constraint.onMouseMove(c('Vector').getEventPosition(k),this.mouseTarget!==this.viewport,this.mouseTarget.getAttribute('data-cropcorner'));this.redraw();return false;};j.prototype.mouseup=function(k){'use strict';this.mouseTarget=null;c('CSS').removeClass(document.body,'draggingMode');};f.exports=j;}),null);
__d('OzPhotoCropper.react',['cx','OzHelpers','BasicVector','Photocrop2','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={imageSize:null},this.finalizeCrop=function(r){var s=this.refs.canvas,t=this.$OzPhotoCropper2.done(r),u=t.x,v=t.y,w=t.height,x=t.width;s.width=x;s.height=w;s.getContext('2d').drawImage(this.$OzPhotoCropper1,Math.max(0,u),Math.max(0,v),x,w,0,0,x,w);return c('OzHelpers').blobFromDataURI(s.toDataURL());}.bind(this),n;}l.prototype.componentDidMount=function(){'use strict';this.$OzPhotoCropper1=new Image();this.$OzPhotoCropper1.src=this.props.src;this.$OzPhotoCropper1.onload=function(m){var n=new (c('BasicVector'))(this.$OzPhotoCropper1.width,this.$OzPhotoCropper1.height);this.setState({imageSize:n});this.$OzPhotoCropper2=new (c('Photocrop2'))(this.refs.img,{},n);}.bind(this);};l.prototype.componentWillUnmount=function(){'use strict';this.$OzPhotoCropper1=null;};l.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_3x2x"},c('React').createElement('canvas',{ref:'canvas',style:{display:'none'}}),c('React').createElement('img',{src:this.props.src,ref:'img',className:"_3x2y"}));};l.propTypes={src:k.string.isRequired};f.exports=l;}),null);
__d('OzAttachmentCropper.react',['OzHelpers','DialogFitHeight','immutable','OzPhotoCropper.react','OzImmutablePureRenderMixin','React','XUIButton.react','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogTitle.react'],(function a(b,c,d,e,f,g){var h=c('immutable').Map,i=c('immutable').OrderedMap,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzAttachmentCropper',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{attachment:j.instanceOf(h).isRequired,onSave:j.func.isRequired,onClose:j.func.isRequired},_handleSubmit:function l(){var m=this.props,n=m.attachment,o=m.onSave,p=this.refs.photoCropper.finalizeCrop();o(n.set('ui-blob',p));},render:function l(){return c('React').createElement(c('XUIDialog.react'),{behaviors:{DialogFitHeight:c('DialogFitHeight')},onToggle:this.props.onClose,shown:true,width:900},c('React').createElement(c('XUIDialogTitle.react'),null,c('React').createElement('span',null,'Crop tool')),c('React').createElement(c('XUIDialogBody.react'),null,c('React').createElement(c('OzPhotoCropper.react'),{src:c('OzHelpers').blobURI(this.props.attachment.get('ui-blob')),ref:'photoCropper'})),c('React').createElement(c('XUIDialogFooter.react'),null,c('React').createElement(c('XUIButton.react'),{onClick:this._handleSubmit,label:'Crop'})));}});f.exports=k;}),null);
__d('OzAttachmentOverlay.react',['cx','joinClasses','OzLoading.react','OzImmutablePureRenderMixin','React','XUICloseButton.react','XUIEditButton.react'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzAttachmentOverlay',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onClick:i.func,onEdit:i.func,onRemove:i.func,loading:i.bool},render:function k(){var l=this.props,m=l.onClick,n=l.onEdit,o=l.onRemove,p=l.loading;return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_18wc")},p?c('React').createElement(c('OzLoading.react'),null):null,c('React').createElement('div',{className:"_4xe8",onClick:m,role:'presentation'},n?c('React').createElement(c('XUIEditButton.react'),{className:"_1yll",type:'button',size:'medium',title:'Add Image',onClick:this._handleEdit}):null,o?c('React').createElement(c('XUICloseButton.react'),{type:'button',className:"_1ylm",size:'medium',shade:'dark',onClick:this._handleRemove}):null),this.props.children);},_handleEdit:function k(l){l.stopPropagation();this.props.onEdit&&this.props.onEdit();},_handleRemove:function k(l){l.stopPropagation();this.props.onRemove&&this.props.onRemove();}});f.exports=j;}),null);
__d('OzBubbleImageSelector.react',['cx','Image.react','immutable','OzAttachmentOverlay.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('immutable').List,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzBubbleImageSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onImageAdd:j.func.isRequired,onImageSelect:j.func.isRequired,selectedURI:j.string,thumbURIs:j.instanceOf(i).isRequired},render:function m(){var n=this.props,o=n.onImageSelect,p=n.selectedURI,q=n.thumbURIs;return c('React').createElement('div',{className:"_1-i2"},q.map(function(r,s){return c('React').createElement(l,{index:s,isSelected:r===p,key:s,onSelect:o,uri:r});}),this._renderAddButton());},_renderAddButton:function m(){return c('React').createElement('button',{type:'button',className:"_1-hv _1-i4",onClick:this.props.onImageAdd},'+');}}),l=c('React').createClass({displayName:'Thumbnail',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{index:j.number.isRequired,isSelected:j.bool.isRequired,uri:j.string.isRequired},render:function m(){return c('React').createElement(c('OzAttachmentOverlay.react'),{className:this.props.isSelected?"_4-8e":'',onClick:this._handleSelect},c('React').createElement(c('Image.react'),{src:this.props.uri,className:"_1-i3",alt:'image thumb'}));},_handleSelect:function m(){this.props.onSelect(this.props.uri);}});f.exports=k;}),null);
__d('OzFormPreview.react',['cx','OzHelpers','joinClasses','React','Tooltip'],(function a(b,c,d,e,f,g,h){var i=c('OzHelpers').pure(function(k){var l=k.children;return c('React').createElement('div',{className:"_5bwr"},l);}),j=c('OzHelpers').pure(function(k){var l=k.label,m=k.tip,n=k.children,o=k.className;if(!n)return null;return c('React').createElement('div',{className:c('joinClasses')("_5bws _5bwt",o)},c('React').createElement('div',{className:"_5bwv"},l),c('React').createElement('div',babelHelpers['extends']({className:"_5bx2"},c('Tooltip').propsFor(m)),n));});i.Row=j;f.exports=i;}),null);
__d('OzBubblePreview.react',['cx','OzAPI','OzHelpers','formatDate','AdsCurrencyFormatter','immutable','OzConfig','OzFormPreview.react','OzStores','OzActions','OzConstants','OzImmutablePureRenderMixin','React','Reflux','ShimButton.react','TextWithHighlights.atlas','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){var i=c('OzConstants').ATTS,j=c('immutable').Map,k=c('immutable').List,l=c('React').PropTypes,m=c('OzFormPreview.react').Row,n=c('OzStores').AutopilotStore,o=c('React').createClass({displayName:'OzBubblePreview',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{bubble:l.instanceOf(j).isRequired,highlight:l.string,meta:l.instanceOf(j),source:l.string},render:function va(){return ka(this.props)?c('React').createElement(t,this.props):c('React').createElement(p,this.props);}}),p=c('OzHelpers').pure(function(va){var wa=va.bubble,xa=va.highlight,ya=null;if(Number.isSafeInteger(wa.get('amount')))ya=c('AdsCurrencyFormatter').formatCurrencyFullFormat(wa.get('currency'),wa.get('amount'));return c('React').createElement(fa,{thumbURL:wa.get('thumb-url')},c('React').createElement(ha,{text:wa.get('name'),highlight:xa}),c('React').createElement(ia,null,c('React').createElement(ja,{color:'grey',highlight:xa},wa.get('description')||'No Description')),c('React').createElement(ia,null,c('React').createElement(ja,null,wa.get('merchant-name')||'No Merchant')),c('React').createElement(ia,null,c('React').createElement(ja,{color:'blue',weight:'bold'},ya)));}),q='__overviewTab',r='__hoursTab',s='__moreInfoTab',t=c('React').createClass({displayName:'PlacesPreview',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(n,'autopilot'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{bubble:l.instanceOf(j).isRequired,meta:l.instanceOf(j).isRequired,highlight:l.string},getInitialState:function va(){return {shown:false,activeTab:q};},_makeOpentableRequest:function va(wa,xa){if(!this.state.config.getIn(['GK','openTableAPI'])){var ya=ra(wa);if(ya){var za=v(wa,xa);if(!za)c('OzAPI').requestAutopilot(ya.toJS());}}},componentWillMount:function va(){this._makeOpentableRequest(this.props.meta,this.state.autopilot);window.clearTimeout(this.timeout);},componentWillReceiveProps:function va(wa){var xa=wa.meta;if(sa(xa)!==sa(this.props.meta))this._makeOpentableRequest(xa,this.state.autopilot);},_handleToggle:function va(wa){window.clearTimeout(this.timeout);var xa=function(ya){return this.setState({shown:wa,activeTab:q});}.bind(this);wa?xa():(this.timeout=window.setTimeout(xa,100));},render:function va(){var wa=this.props,xa=wa.bubble,ya=wa.meta,za=wa.highlight,ab=this.state,bb=ab.shown,cb=ab.activeTab,db=ab.autopilot,eb=ab.config;return c('React').createElement('div',{ref:'root',tabIndex:'0',onMouseEnter:function(fb){return this._handleToggle(true);}.bind(this),onMouseLeave:function(fb){return this._handleToggle(false);}.bind(this)},c('React').createElement(fa,{thumbURL:xa.get('thumb-url')},c('React').createElement(ha,{text:xa.get('name'),highlight:za}),c('React').createElement(u,{rating:ya.get('rating')}),c('React').createElement(ia,null,c('React').createElement(ja,null,ya.get('cuisine')),'\u00A0',c('React').createElement(ja,null,ya.get('price'))),c('React').createElement(ia,null,c('React').createElement(w,{meta:ya,autopilot:db}))),c('React').createElement(x,babelHelpers['extends']({activeTab:cb,contextRef:function(fb){return this.refs.root;}.bind(this),onTabChange:this._handleTabChange,shown:bb,onToggle:this._handleToggle,autopilot:db,config:eb},this.props)));},_handleTabChange:function va(wa){this.setState({activeTab:wa});}}),u=c('OzHelpers').pure(function(va){var wa=va.rating;return wa?c('React').createElement(ia,null,c('React').createElement(ja,{weight:'500'},wa.get('value'),'/',wa.get('scale')),' ',c('React').createElement(ja,{color:'grey'},wa.get('rating-count')?'('+wa.get('rating-count')+' reviews)':null)):null;}),v=function va(wa,xa){var ya=ra(wa);if(ya)if(c('OzConfig').getInStaticConfig(['GK','openTableAPI'])){return ya.getIn(['data','times']);}else return xa.get(ya.getIn(['data','id']));return null;},w=c('OzHelpers').pure(function(va){var wa=va.meta,xa=va.autopilot,ya=ra(wa);if(!ya)return c('React').createElement(ja,null,'No OT info');var za=v(wa,xa);if(!za)return c('React').createElement(ja,null,'Checking OT...');if(za.size===0)return c('React').createElement(ja,{color:'red'},'No Tables Available!');return c('React').createElement(ja,null,'Table at ',pa(wa,za));}),x=c('OzHelpers').pure(function(va){var wa=va.activeTab,xa=va.contextRef,ya=va.meta,za=va.onTabChange,ab=va.onToggle,bb=va.shown,cb=babelHelpers.objectWithoutProperties(va,['activeTab','contextRef','meta','onTabChange','onToggle','shown']);return c('React').createElement(c('XUIContextualDialog.react'),{contextRef:xa,hoverHideDelay:0,position:'above',shown:bb,hasActionableContext:true},c('React').createElement('div',{className:"_53qb",onMouseEnter:function db(eb){return ab(true);},onMouseLeave:function db(eb){return ab(false);}},c('React').createElement('div',{className:"_c38"},c('React').createElement(y,babelHelpers['extends']({meta:ya},cb)),c('React').createElement(ea,{tabs:[['Overview',q],['Hours',r],['More Info',s]],active:wa,onChange:za})),c('React').createElement(z,babelHelpers['extends']({activeTab:wa,meta:ya},cb))));}),y=c('OzHelpers').pure(function(va){var wa=va.bubble,xa=va.meta,ya=va.highlight;return c('React').createElement('div',{className:"_53qc"},c('React').createElement(ga,{url:wa.get('thumb-url')}),c('React').createElement('div',{className:"_53qd"},c('React').createElement(ha,{text:wa.get('name'),highlight:ya}),c('React').createElement(u,{rating:xa.get('rating')}),c('React').createElement(ia,null,c('React').createElement(ja,null,xa.get('cuisine'))),c('React').createElement(ia,null,c('React').createElement(ja,null,xa.get('price')))));}),z=c('OzHelpers').pure(function(va){var wa=va.activeTab,xa=babelHelpers.objectWithoutProperties(va,['activeTab']);return c('React').createElement('div',{className:"_53qe"},wa===q&&c('React').createElement(aa,xa)||wa===r&&c('React').createElement(ca,xa)||wa===s&&c('React').createElement(da,xa)||null);}),aa=c('OzHelpers').pure(function(va){var wa=va.bubble,xa=va.highlight,ya=va.meta,za=va.autopilot,ab=va.config,bb=(ya.getIn(['address','street'],'')+'\n     '+ya.getIn(['address','city'],'')+'\n    ').trim();return c('React').createElement(c('OzFormPreview.react'),null,c('React').createElement(m,{label:'Address'},bb),c('React').createElement(m,{label:'Phone'},ba(wa,ya)),c('React').createElement(m,{label:'Website'},c('React').createElement('a',{href:wa.get('target-url'),target:'_blank',rel:'noopener noreferrer'},'Link')),c('React').createElement(m,{label:'OpenTable'},ma(wa,ya,za)),ab.getIn(['GK','yelpLink'])?c('React').createElement(m,{label:'Yelp'},c('React').createElement('a',{href:ya.get('yelp-url'),target:'_blank',rel:'noopener noreferrer'},'Link')):null,c('React').createElement(m,{label:'Description'},wa.get('description')));}),ba=function va(wa,xa){var ya=xa.get('phone');return ya?c('React').createElement(ja,{weight:'bold'},c('OzHelpers').parsePhoneNumber(ya)):null;},ca=c('OzHelpers').pure(function(va){var wa=va.meta;return c('React').createElement(c('OzFormPreview.react'),null,oa(wa.get('hours')||k()).map(function(xa,ya){return c('React').createElement(m,{key:ya,label:ya},xa);}).valueSeq());}),da=c('OzHelpers').pure(function(va){var wa,xa=va.bubble,ya=va.meta,za=ya.get('payment'),ab=ya.get('infos');if(za&&za.size||ab&&ab.size){var wa=function(){var bb=function cb(db){return db[0].toUpperCase()+db.slice(1).toLowerCase();};return {v:c('React').createElement(c('OzFormPreview.react'),null,ab.map(function(cb,db){return c('React').createElement(m,{label:bb(db),key:db},cb);}).toList(),za?c('React').createElement(m,{label:'Payments'},za.map(bb).toJS().join(', ')):null)};}();if(typeof wa==="object")return wa.v;}else return c('React').createElement('div',null,'No additional info for this place...');}),ea=c('OzHelpers').pure(function(va){var wa=va.tabs,xa=va.onChange,ya=va.active;return c('React').createElement('div',{className:"_c39"},wa.map(function(za){var ab=za[0],bb=za[1],cb=bb===ya?{weight:'bold',color:'blue'}:{color:'grey'};return c('React').createElement('button',{key:bb,role:'button',className:"_1-hv",onClick:function db(eb){return xa(bb);}},c('React').createElement(ja,cb,ab));}));}),fa=c('OzHelpers').pure(function(va){var wa=va.children,xa=va.thumbURL;return c('React').createElement('div',{className:"_1q15 _5rxk"},c('React').createElement(ga,{url:xa}),c('React').createElement('div',{className:"_1q17"},wa));}),ga=c('OzHelpers').pure(function(va){var wa=va.url;return wa?c('React').createElement('div',{className:"_1q16",style:{backgroundImage:'url(\''+wa+'\')'}}):null;}),ha=c('OzHelpers').pure(function(va){var wa=va.text,xa=va.highlight;return c('React').createElement(ia,null,c('React').createElement(ja,{weight:'bold',highlight:xa},wa||'No Title'));}),ia=c('OzHelpers').pure(function(va){var wa=va.children;return c('React').createElement('div',{className:"_4-_7 _5rxl"},wa);}),ja=c('OzHelpers').pure(function(va){var wa=va.children,xa=va.color,ya=va.highlight,za=va.size,ab=va.weight,bb=ab===undefined?'normal':ab;return wa?c('React').createElement('span',{className:"_5rxm"+(za==='large'?' '+"_5rxn":'')+(xa==='blue'?' '+"_5ryf":'')+(xa==='grey'?' '+"_5ryk":'')+(xa==='red'?' '+"_5emd":'')+(xa==='green'?' '+"_5emf":''),style:{fontWeight:bb}},ya?c('React').createElement(c('TextWithHighlights.atlas'),{text:wa,highlight:ya}):wa):null;});function ka(va){var wa=va.meta,xa=va.source;return xa==='places'&&wa;}function la(va,wa,xa){c('OzActions').selectAIPick(j({type:i.OPENTABLEQR,bubble:va,meta:wa,'ui-body':xa.count()>1?'Here are available times for today: '+ua(xa):'The only available time for today is '+ua(xa),quickreplies:ta(xa)}));}function ma(va,wa,xa){var ya,za=wa.get('open-table');if(za){var ab,ya=function(){var bb=v(wa,xa);if(bb)if(bb.size===0){ab=c('React').createElement(ja,{color:'red'},'No tables available!');}else ab=c('React').createElement(ja,null,'Tables available at '+ua(bb));return {v:c('React').createElement('div',null,c('React').createElement('a',{href:za.get('url'),target:'_blank',rel:'noopener noreferrer'},'Link (',za.get('area'),')'),c('React').createElement('br',null),ab,bb&&bb.size?c('React').createElement('span',null,c('React').createElement('br',null),c('React').createElement(c('ShimButton.react'),{form:'link',onClick:function cb(){return la(va,wa,bb);}},'Suggest via quickreplies')):null)};}();if(typeof ya==="object")return ya.v;}return null;}var na=k(['Sun','Mon','Tues','Wed','Thurs','Fri','Sat']);function oa(va){var wa=function bb(){var cb=new Date(c('OzHelpers').serverNow());cb.setHours(0,0,0,0);cb.setDate(cb.getDate()-cb.getDay()+1);return +cb;},xa=wa(),ya=function bb(cb){return new Date(xa+cb*60*1000);},za=function bb(cb){return c('formatDate')(cb,'h:i A',{skipPatternLocalization:true});},ab=function bb(cb){return cb.map(za).join(' - ');};return va.map(function(bb){return bb.map(ya);}).groupBy(function(bb){return bb.get('start').getDay();}).mapKeys(function(bb){return na.get(bb);}).map(function(bb){return bb.map(ab).join(', ');});}function pa(va,wa){var xa=function za(ab){var bb=ab.split(':'),cb=bb[0],db=bb[1];return parseInt(db,10)+parseInt(cb,10)*60;},ya=xa(va.getIn(['open-table','availability','data','hour']));return qa(wa.map(function(za){return za.get('hour');}).minBy(function(za){return Math.abs(ya-xa(za));}));}function qa(va){var wa=va.split(':'),xa=wa[0],ya=wa[1];xa=parseInt(xa,10);if(xa===0){return '12:'+ya+'AM';}else if(xa<12){return va+'AM';}else if(xa===12){return va+'PM';}else return xa-12+':'+ya+'PM';}function ra(va){return va.getIn(['open-table','availability']);}function sa(va){return va.getIn(['open-table','availability','data','id']);}function ta(va){var wa=va.count()>1?'None of these times work for me':'This time doesn\'t work for me';return va.map(function(xa){return qa(xa.get('hour'));}).push(wa);}function ua(va){return va.map(function(wa){return qa(wa.get('hour'));}).toJS().join(', ');}f.exports=o;}),null);
__d('OzMerchantDialog.react',['cx','OzHelpers','immutable','Layout.react','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','React','ReactDOM','XUIDatePicker.react','XUIError.react'],(function a(b,c,d,e,f,g,h){var i,j,k=c('Layout.react').Column,l=c('Layout.react').FillColumn,m=c('React').PropTypes,n=c('immutable').Map,o=c('immutable').Set,p=o(['name-dba','name-legal','website','phone','address','page-id','country','type','owner-name']),q=n({country:'US'});i=babelHelpers.inherits(r,c('React').Component);j=i&&i.prototype;function r(t){'use strict';j.constructor.call(this,t);s.call(this);var u=t.initialMerchant,v=q.filterNot(function(w,x){return u.get(x);});this.state={inputs:v,errors:n()};}r.prototype.componentDidMount=function(){'use strict';var t=c('ReactDOM').findDOMNode(this.refs['name-dba']);t&&t.focus();};r.prototype.render=function(){'use strict';return c('React').createElement(c('MessengerDialog.react'),{className:"_18w8",onToggle:this.$OzMerchantDialog1,ref:'dialog',type:'default',width:544},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,this.props.title)),this.$OzMerchantDialog2(),c('React').createElement('div',null,this.$OzMerchantDialog3('Save',this.$OzMerchantDialog4),this.$OzMerchantDialog3('Cancel',c('OzActions').hideDialog)));};r.propTypes={onMerchant:m.func.isRequired,title:m.string,initialMerchant:m.instanceOf(n)};r.defaultProps={title:"Create a merchant",initialMerchant:n()};var s=function t(){this.$OzMerchantDialog3=function(u,v){return c('React').createElement('button',{onClick:v,className:"_bx0 _3e2t _30yy"},u);};this.$OzMerchantDialog2=function(){return c('React').createElement('div',{className:"_374d _18w9"},this.$OzMerchantDialog5('name-dba','Name *'),this.$OzMerchantDialog5('name-legal','Legal Name'),this.$OzMerchantDialog5('website','Website'),this.$OzMerchantDialog5('phone','Phone'),this.$OzMerchantDialog5('address','Address'),this.$OzMerchantDialog5('page-id','Facebook Page Id'),this.$OzMerchantDialog5('country','Country *'),this.$OzMerchantDialog5('type','Business Type'),this.$OzMerchantDialog5('owner-name','Owner Name'),this.$OzMerchantDialog6('owner-birth-date','Owner Birth Date'));}.bind(this);this.$OzMerchantDialog5=function(u,v){var w=this.props.initialMerchant,x=this.state,y=x.inputs,z=x.errors;return c('React').createElement(c('Layout.react'),{key:u},c('React').createElement(k,{className:"mrm _bx1"},v),c('React').createElement(l,null,c('React').createElement(c('XUIError.react'),{xuiError:z.get(u)||null},c('React').createElement('input',{ref:u,type:'text',className:"_7q5 _bx2",defaultValue:w.get(u),value:y.get(u),onChange:function(aa){this.setState({inputs:y.set(u,aa.target.value),errors:n()});}.bind(this)}))));}.bind(this);this.$OzMerchantDialog6=function(u,v){var w={},x=this.props.initialMerchant,y=x.get('owner-birth-date');if(y)w.initialTime=y;return c('React').createElement(c('Layout.react'),{key:u},c('React').createElement(k,{className:"mrm _bx1"},v),c('React').createElement(k,null,c('React').createElement(c('XUIDatePicker.react'),babelHelpers['extends']({ref:u,shouldSetDefaultDate:false},w))));}.bind(this);this.$OzMerchantDialog4=function(){var u=this.$OzMerchantDialog7();if(u){u.id=this.props.initialMerchant.get('id');this.props.onMerchant(u);}}.bind(this);this.$OzMerchantDialog1=function(u){if(!u)c('OzActions').hideDialog();};this.$OzMerchantDialog7=function(){var u=n(),v=this.props.initialMerchant,w=function(z){var aa=this.state.inputs.get(z,undefined);if(aa===undefined)return v.get(z);return aa||null;}.bind(this);u=n(p.map(function(z){return [z,w(z)];})).set('id',v.get('id'));var x=this.refs['owner-birth-date'].state.selectTime;u=u.set('owner-birth-date',x);u=c('OzHelpers').normalizeMerchant(u);var y=c('OzHelpers').validateMerchant(u);this.setState({errors:y});if(!y.isEmpty())return null;return u;}.bind(this);};f.exports=r;}),null);
__d('OzSetPicURLDialog.react',['cx','getURLRanges','OzHelpers','Image.react','Keys','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzImmutablePureRenderMixin','React','ReactDOM'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzSetPicURLDialog',mixins:[c('OzImmutablePureRenderMixin')],PropTypes:{onURL:i.func.isRequired,onEscape:i.func},componentDidMount:function k(){var l=c('ReactDOM').findDOMNode(this.refs.url);l&&l.focus();},getInitialState:function k(){return {errors:[],url:''};},render:function k(){return c('React').createElement(c('MessengerDialog.react'),{className:"_18w8",onToggle:this._handleToggle,ref:'dialog',type:'default',width:544},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,'Enter a URL for your picture')),this._renderImage(),this._renderErrors(),c('React').createElement('div',{className:"_374d _18w9"},c('React').createElement('input',{onChange:this._handleChange,onKeyDown:this._handleKeyDown,ref:'url',type:'text',className:"_7q5",placeholder:'URL to picture'})),c('React').createElement('div',{className:"_18wa"},'Press Enter when you\'re done.'));},_renderImage:function k(){var l=this.state.url,m=this.state.errors||[];if(m.length>0||!l||l.length===0)return null;return c('React').createElement(c('Image.react'),{className:"_24p-",src:l});},_renderErrors:function k(){var l=this.state.errors;if(!l||l.length===0)return null;return c('React').createElement('div',{key:'errors',className:"_1yln"},l.map(function(m){var n=m[0],o=m[1];return c('React').createElement('div',{key:n,className:"_1ylp"},o);}));},_handleChange:function k(l){if(l.target.value.length&&!c('getURLRanges')(l.target.value).length){this.setState({errors:[['invalid_url','You must provide a valid uri']]});return;}var m=l.target.value.length?c('getURLRanges')(l.target.value)[0].entity.url:'';this.setState({errors:[],url:m});},_handleKeyDown:function k(l){if(l.keyCode===c('Keys').ESC){var m=this.props.onEscape;if(m)m(l);return;}var n=this.state.errors||[];if(n.length===0&&l.keyCode===c('Keys').RETURN){l.preventDefault();var o=l.target.value.length?c('getURLRanges')(l.target.value)[0].entity.url:'';this.props.onURL(o);}return;},_handleToggle:function k(){c('OzHelpers').debug('[OzSetPicURLDialog] toggled',arguments);}});f.exports=j;}),null);
__d('OzBubbleEditor.react',['cx','Promise','OzAPI','getURLRanges','OzHelpers','OzNotify','AdsCurrencyInput.react','immutable','Keys','OzActions','OzBubbleImageSelector.react','OzBubblePreview.react','OzConfig','OzMerchantDialog.react','OzSearchSource','OzSetPicURLDialog.react','OzImmutablePureRenderMixin','React','Reflux','SearchableDropdownInput.contrib','SearchableEntry','ShimButton.react','XUICloseButton.react'],(function a(b,c,d,e,f,g,h){var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=['thumb-url'],m=['thumb-urls'],n=q('No Merchant'),o=69,p=c('React').createClass({displayName:'OzBubbleEditor',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{merchants:k.instanceOf(j).isRequired,seedBubble:k.instanceOf(j).isRequired,onSave:k.func.isRequired,onClose:k.func.isRequired},getInitialState:function u(){return {newData:j()};},componentWillMount:function u(){this._searchSource=new (c('OzSearchSource'))(function(v){var w=v.query||'',x=this.props.merchants.valueSeq().filter(function(y){return y.get('name-dba').toLowerCase().indexOf(w.toLowerCase())>-1;}).map(function(y){return q(y.get('name-dba'));}).take(15).toArray();return c('Promise').resolve(this._data().get('merchant-name')?[n].concat(x):x);}.bind(this));},componentDidMount:function u(){this.focus('Title');},focus:function u(v){this.refs[v]&&this.refs[v].focus&&this.refs[v].focus();},render:function u(){return c('React').createElement('div',{className:"_1-ht"},c('React').createElement('div',{className:"_2zfj"},this._renderSection('Preview',this._renderPreview)),c('React').createElement('form',{className:"_2zfk",onKeyDown:function(v){v.keyCode===c('Keys').ESC&&this.props.onClose(this._bubble());}.bind(this),onSubmit:function(v){v.stopPropagation();v.preventDefault();this._handleSubmit();}.bind(this)},c('React').createElement(c('XUICloseButton.react'),{className:"_1-hu",shade:'dark',size:'medium',onClick:function(v){return this.props.onClose(this._bubble());}.bind(this)}),this._renderSection('Image',this._renderImage),this._renderSection('Title',this._renderInput.bind(this,['name'])),this._renderSection('Description',this._renderDescription),this._renderSection('URL',this._renderInput.bind(this,['target-url'])),this._renderSection('Merchant',this._renderMerchant),this._renderSection('Price',this._renderPrice),this._renderSubmit()));},_bubble:function u(){return this.props.seedBubble.set('data',this._data()).deleteIn(['data','thumb-urls']);},_data:function u(){var v=this.state.newData.updateIn(m,function(w){var x=this.props.seedBubble.getIn(['data'].concat(m));return (x||i()).concat(w);}.bind(this));return this.props.seedBubble.get('data').merge(v);},_handleSubmit:function u(){var v=this._bubble(),w=v.get('data'),x=[[w.get('name'),'Please enter a title.'],[w.get('expires-in')||!w.get('expiration-time'),'Since this bubble is old, please re-enter the expiration time.'],[c('OzHelpers').validateURL(w.get('target-url')),'Please enter a valid url. Usually, you need to add "www."'],[c('OzHelpers').validateURL(w.get('thumb-url'))||!w.get('thumb-url'),'Please enter a valid url for your image.'],[w.get('merchant-name')||!w.get('amount'),'You need to specify a merchant if you\'ve listed a price.'],[w.get('amount')||!w.get('expires-in'),'You need to list a price if you\'ve set an expiration time.']].filter(function(y){var z=y[0],aa=y[1];return !z;}).map(function(y){var z=y[0],aa=y[1];return aa;});if(x.length){c('OzNotify').error(x[0]);return;}this.props.onSave(v.updateIn(['data','target-url'],function(y){return c('getURLRanges')(y)[0].entity.url;}));},_handleCreateMerchant:function u(){c('OzActions').showDialog(c('OzMerchantDialog.react'),{onMerchant:function(v){c('OzAPI').createMerchant(v);var w=this.state.newData.set('merchant-name',v.get('name-dba'));this.setState({newData:w});c('OzActions').hideDialog();}.bind(this)});},_handleAddImage:function u(){c('OzActions').showDialog(c('OzSetPicURLDialog.react'),{onEscape:function(v){c('OzActions').hideDialog();this.focus('Title');}.bind(this),onURL:function(v){c('OzActions').hideDialog();this.setState(function(w){return {newData:t(w.newData,v)};});this.focus('Title');}.bind(this)});},_handleSelectImage:function u(v){this.setState(function(w){return {newData:w.newData.setIn(l,v)};});},_renderSubmit:function u(){return c('React').createElement('button',{type:'submit',className:"_1-hv _1-hw"},'DONE');},_renderSection:function u(v,w){return c('React').createElement('div',{className:"_1-hx"},c('React').createElement('div',{className:"_1-hz",onClick:function(x){return this.focus(v);}.bind(this),role:'presentation'},v),c('React').createElement('div',{className:"_1-h-"},w(v)));},_renderPrice:function u(v){var w=this._data(),x=w.get('currency'),y=w.get('amount');return c('React').createElement('div',{className:"_1-h_"},c('React').createElement(c('AdsCurrencyInput.react'),{placeholder:'(optional)',currency:x||'USD',value:Number.isSafeInteger(y)?y:null,onDataUpdate:function(z){this.setState({newData:w.set('amount',z)});}.bind(this),eventType:'change'}),this._renderExpiration());},_renderExpiration:function u(){if(!this.state.config.getIn(['GK','expirationDate']))return null;return c('React').createElement('div',{className:"_51w3"},c('React').createElement('div',{className:"_1-hz"},'Expiration Time:'),c('React').createElement(s,{expiresIn:this._data().get('expires-in'),onChange:function(v){return this.setState({newData:this.state.newData.set('expires-in',v)});}.bind(this)}));},_renderInput:function u(v,w){var x=this.state.newData;return c('React').createElement('input',{ref:w,type:'text',className:"_1-i0 _1-i1",value:this._data().getIn(v),onChange:function(y){return this.setState({newData:x.setIn(v,y.target.value)});}.bind(this)});},_renderImage:function u(){var v=this._data(),w=v.getIn(l),x=r(v,w);return c('React').createElement(c('OzBubbleImageSelector.react'),{onImageAdd:this._handleAddImage,onImageSelect:this._handleSelectImage,selectedURI:w,thumbURIs:x});},_renderMerchant:function u(){var v=this._data(),w=v.get('merchant-name'),x=w?q(w):null;return c('React').createElement('div',{className:"_1-i5"},c('React').createElement('div',{className:"_1-i6"},c('React').createElement(c('SearchableDropdownInput.contrib'),{divClassName:"_1-i7",value:x,onSelect:function(y){var z=y.getUniqueID()===n.getUniqueID()?null:y.getTitle(),aa=this.state.newData.set('merchant-name',z);this.setState({newData:aa});}.bind(this),emptySearchResultsText:'No merchants found. Click + to add',placeholder:'Pick a Merchant (optional)',searchSource:this._searchSource})),c('React').createElement(c('ShimButton.react'),{className:"_1-hv _4nd4 _1-i8",onClick:this._handleCreateMerchant}));},_renderPreview:function u(){return c('React').createElement(c('OzBubblePreview.react'),{bubble:this._data()});},_renderDescription:function u(){var v=this._data(),w=v.get('description'),x=w&&w.length>o;return c('React').createElement('div',null,c('React').createElement('input',{ref:'description',type:'text',className:"_1-i0 _1-i1",value:w,onChange:function(y){return this.setState({newData:v.set('description',y.target.value)});}.bind(this)}),c('React').createElement('text',{className:x?"_353q":''},o-(w?w.length:0)+' characters left'));}});function q(u){return new (c('SearchableEntry'))({title:u,uniqueID:u});}function r(u,v){return u.getIn(m,i()).toOrderedSet().add(v).toList().filter(function(w){return w;});}var s=c('OzHelpers').pure(function(u){var v=u.expiresIn,w=u.onChange,x="_1-i0 _3owv",y=v||j({hours:0,minutes:0}),z=function ca(da){return Math.max(+da,0);},aa=function ca(da){return w(y.merge(j(da)));},ba=function ca(da,ea){return y.get(ea)===1?da:da+'s';};return c('React').createElement('div',{className:"_51wb"},c('React').createElement('label',{className:"_1-hz"},c('React').createElement('input',{className:x,onChange:function ca(da){return aa({hours:z(da.target.value)});},type:'number',value:v?v.get('hours'):null}),ba('hour','hours')),c('React').createElement('label',{className:"_1-hz"},c('React').createElement('input',{className:x,onChange:function ca(da){return aa({minutes:z(da.target.value)});},type:'number',value:v?v.get('minutes'):null}),ba('minute','minutes')));});function t(u,v){return u.withMutations(function(w){w.updateIn(m,i(),function(x){return x.push(v);});w.setIn(l,v);});}f.exports=p;}),null);
__d('OzComposerAI.react',['cx','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','OzHelpers','joinClasses','immutable','Image.react','LayerHideOnBlur','MessengerSpinner.react','OzBubblePreview.react','OzConfig','OzConstants','OzImmutablePureRenderMixin','React','Reflux','ShimButton.react','TextWithHighlights.atlas','messengerButtonReact','formatDate','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){var i=c('messengerButtonReact').jsComponent,j=c('immutable').Map,k=c('immutable').List,l=c('OzConstants').ATTS,m=c('React').PropTypes,n=c('React').createClass({displayName:'OzComposerAIList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{filter:m.string,items:m.instanceOf(k).isRequired,onItemClick:m.func.isRequired},getInitialState:function ca(){return {};},render:function ca(){var da=this.props,ea=da.items,fa=da.filter,ga=da.onItemClick,ha={filter:fa,onItemClick:ga};return !ea.isEmpty()&&c('React').createElement('div',{className:"_4285"},ea.map(function(ia,ja){return k.isList(ia)?c('React').createElement('div',{key:ja,className:"_2961"},ia.map(function(ka,la){return c('React').createElement(t,babelHelpers['extends']({key:la,column:la,line:ja,item:ka},ha));})):c('React').createElement(o,babelHelpers['extends']({key:ja,line:ja,item:ia,onToggleDebug:function(ka){return this.setState({debugLine:this.state.debugLine===ja?null:ja});}.bind(this),debugShown:this.state.debugLine===ja},ha));}.bind(this)).reverse());}}),o=c('React').createClass({displayName:'ItemRow',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{onToggleDebug:m.func.isRequired,debugShown:m.bool.isRequired},componentDidMount:function ca(){if(this.props.item.get('id')&&this.props.item.get('at'))this._timeout=window.setTimeout(function(da){return this._timeout!==null&&this.forceUpdate();}.bind(this),ba(this.props.item));},componentWillUnmount:function ca(){window.clearTimeout(this._timeout);this._timeout=null;},render:function ca(){var da=this.props,ea=da.item,fa=da.line,ga=da.onItemClick,ha=da.filter,ia=j({line:fa,column:0}),ja=ea.get('id'),ka=ea.get('at'),la=this.state.config.get('debugAI');return c('React').createElement('div',{className:"_2962",onClick:function ma(na){na.preventDefault();ga(ia);},role:'presentation'},aa(ea)?c('React').createElement(s,{label:'AUTO-SENDING',at:ka}):null,c('React').createElement('div',{className:"_58jk",ref:'root'},c('React').createElement('div',{className:"_2964"},c('React').createElement(v,{item:ea,filter:ha})),c('React').createElement('span',{className:"_58jl"},z(ea)?c('React').createElement(i,{type:'secondary',label:'EXECUTING NOW...'}):aa(ea)?c('React').createElement(i,{type:'secondary',label:'STOP'}):ja&&ka?c('formatDate')(ka/1000,'g:ia M j'):'\u2318'+ea.get('shortcut',fa+1),la&&c('React').createElement(r,babelHelpers['extends']({contextRef:function(ma){return this.refs.root;}.bind(this)},this.props)))));}});function p(ca,da,ea,fa,ga){var ha='<span style="color: brown">',ia='<span style="color: navy">',ja='<span style="color: navy">',ka=da||'';if(ea)ka=ka+ha+ea.replace(/[\": ]/g,'')+'</span>: ';if(fa)ka=ka+(fa[0]=='"'?ja:ia)+fa+'</span>';return ka+(ga||'');}function q(ca){var da=/^( *)(\"[\w]+\": )?(\"[^\"]*\"|[\w.+-]*)?([,[{])?$/mg,ea={__html:JSON.stringify(ca,null,3).replace(/&/g,'&amp;').replace(/\\"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(da,p)};return c('React').createElement('div',{dangerouslySetInnerHTML:ea});}var r=c('React').createClass({displayName:'DebugInfo',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onToggleDebug:m.func.isRequired,debugShown:m.bool.isRequired},_handleToggleDebugInfo:function ca(event){this.props.onToggleDebug();event.stopPropagation();},render:function ca(){var da=this.props,ea=da.contextRef,fa=da.item,ga=da.debugShown,ha=fa.get('source'),ia=fa.get('debug');return c('React').createElement('span',null,ha?' '+ha:'',ia?' ':'',ia&&c('React').createElement('span',null,c('React').createElement(c('ShimButton.react'),{className:"_5ufb",form:'link',onClick:this._handleToggleDebugInfo}),c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')},contextRef:ea,hoverHideDelay:0,onBlur:this.props.onToggleDebug,position:'right',shown:ga,hasActionableContext:true},c('React').createElement('div',{className:"_5ufd"},q(ia.toJS())))));}}),s=c('React').createClass({displayName:'TimeProgress',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{at:m.number.isRequired,label:m.string},componentDidMount:function ca(){this._start=Date.now();var da=window.setInterval(function(ea){return this.forceUpdate();}.bind(this));this.unlisten=function(ea){return window.clearInterval(da,1000);};},componentWillUnmount:function ca(){this.unlisten();},render:function ca(){var da=this.props,ea=da.at,fa=da.label,ga=x(this._start,Date.now(),ea);return c('React').createElement('div',{className:"_58jn"},c('React').createElement('div',{className:"_16bc",style:{width:ga+'%'}}),c('React').createElement('div',{className:"_16bd"},fa));}}),t=c('React').createClass({displayName:'ItemColumn',mixins:[c('OzImmutablePureRenderMixin')],componentDidMount:function ca(){if(this.props.item.get('id')&&this.props.item.get('at'))this._timeout=window.setTimeout(function(da){return this._timeout!==null&&this.forceUpdate();}.bind(this),ba(this.props.item));},componentWillUnmount:function ca(){window.clearTimeout(this._timeout);this._timeout=null;},render:function ca(){var da=this.props,ea=da.column,fa=da.filter,ga=da.item,ha=da.line,ia=da.onItemClick,ja=j({line:ha,column:ea}),ka=ga.get('at');return c('React').createElement('div',{className:"_2966",onClick:function la(ma){ma.preventDefault();ia(ja);},role:'presentation'},aa(ga)?c('React').createElement(s,{label:'AUTO-SENDING',at:ka}):null,c('React').createElement('div',{className:"_34mx"},z(ga)?c('React').createElement(i,{type:'secondary',label:'EXECUTING NOW...'}):aa(ga)?c('React').createElement(i,{type:'secondary',label:'STOP'}):c('React').createElement('span',null,ga.get('id')&&ka?c('formatDate')(ka/1000,'g:ia M j'):'')),c('React').createElement(v,{className:"_34mz",item:ga,filter:fa}));}}),u=c('OzHelpers').pure(function(ca){var da=ca.images;return c('React').createElement('div',null,da.map(function(ea,fa){return c('React').createElement(c('Image.react'),{key:fa,className:"_1q16",src:ea.get('url'),alt:ea.get('filename')});}));}),v=c('OzHelpers').pure(function(ca){var da=ca.filter,ea=ca.item,fa=ca.className;switch(ea.get('type')){case l.COMMAND:return c('React').createElement(w,{command:ea,highlight:da});case l.SURVEY:case 'send':case l.TEMPLATE:var ga=ea.get('ui-body')&&'"'+ea.get('ui-body')+'"',ha=ea.getIn(['data','images']);return c('React').createElement('div',{className:fa},ga?c('React').createElement(c('TextWithHighlights.atlas'),{text:ga,highlight:da}):null,ha?c('React').createElement(u,{images:ha}):null);case 'suggest':case l.SUGG:return c('React').createElement(c('OzBubblePreview.react'),{bubble:ea.get('data'),highlight:da,meta:ea.get('meta'),source:ea.get('source')});default:c('OzHelpers').debug('[composerai] could not render item',ea);return null;}}),w=c('OzHelpers').pure(function(ca){var da=ca.command,ea=ca.highlight;return c('React').createElement('div',{className:"_2_he"},c('React').createElement('i',{className:c('joinClasses')("_2_hf",da.get('iconCl'))}),c('React').createElement(c('TextWithHighlights.atlas'),{text:da.get('text'),highlight:ea}));});function x(ca,da,ea){var fa=da-ca,ga=ea-ca;return fa>=0&&ga>0?Math.min(100,Math.round(fa/ga*100)):100;}var y=10000;function z(ca){return ca.get('id')&&ca.get('at')&&c('OzHelpers').serverNow()>ca.get('at');}function aa(ca){return ca.get('id')&&ca.get('at')&&c('OzHelpers').serverNow()+y>ca.get('at');}function ba(ca){var da=500;return aa(ca)?ca.get('at')-c('OzHelpers').serverNow()+da:ca.get('at')-y-c('OzHelpers').serverNow()+da;}f.exports={OzComposerAIList:n};}),null);
__d('OzListEditor.react',['cx','OzHelpers','joinClasses','immutable','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzListEditor',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{autofocus:k.bool,list:k.instanceOf(i).isRequired,onClose:k.func,onEdit:k.func.isRequired},componentDidMount:function o(){if(this.props.autofocus)this._focus(0);},componentDidUpdate:function o(p){var q=p.list,r=this.props.list.count();q.count()<r&&this._focus(r-1);},_focus:function o(p){this.refs[p]&&this.refs[p].focus();},render:function o(){var p=this.props,q=p.list,r=p.onEdit,s=p.className,t=babelHelpers.objectWithoutProperties(p,['list','onEdit','className']);return c('React').createElement('div',{className:c('joinClasses')(s,"_42e_")},q.map(function(u,v){return c('React').createElement('div',{key:u.get('key'),className:"_42f5"},c('React').createElement('input',{type:'text',ref:v,className:"_42f6 _1-i0",value:u.get('text'),onBlur:function(w){return this._handleItemBlur(u.get('text'),v,w);}.bind(this),onChange:function(w){return this._handleItemChange(u.get('text'),v,w);}.bind(this),onKeyDown:function(w){return this._handleBackspace(u.get('text'),v,w);}.bind(this)}));}.bind(this)),c('React').createElement('div',{key:'plus',className:"_42f5"},c('React').createElement('button',{ref:'plus',className:"_42f7 _1-hv _30yy",type:'button',onMouseDown:function u(v){return v.preventDefault();},onClick:this._handlePlusClick,onKeyDown:function(u){return this._handleBackspace(null,q.count(),u);}.bind(this)},'+')));},_setText:function o(p,q){this.props.onEdit(this.props.list.setIn([p,'text'],q));},_handlePlusClick:function o(){var p=this.props,q=p.list,r=p.onEdit,s=m(q),t=s===null?q.push(n()):q['delete'](s).push(q.get(s));r(t);},_handleItemBlur:function o(p,q,r){var s=this.props,t=s.list,u=s.onEdit;p.trim()?this._setText(q,p.trim()):t.count()>1&&u(t['delete'](q));},_handleItemChange:function o(p,q,r){this._setText(q,r.target.value);},_handleBackspace:function o(p,q,r){var s=this.props,t=s.list,u=s.onClose;if(r.key==='Backspace'&&!p){r.preventDefault();q>0?this._focus(q-1):t.count()===1?u&&u():this._focus(q+1);}}});function m(o){var p=o.findEntry(function(q){return !q.get('text','').trim();});return p?p[0]:null;}function n(){return j({key:c('OzHelpers').uniqId(),text:''});}f.exports=l;}),null);
__d('OzTokenizer.react',['cx','Promise','OzHelpers','immutable','OzSearchSource','OzImmutablePureRenderMixin','React','SearchableEntry','XUITokenizer.react','XUITokenizerToken.react','TypeaheadViewItem','TypeaheadViewPropTypes'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzTokenizer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{allTokens:k.instanceOf(j).isRequired,onCreateToken:k.func.isRequired,onDeleteToken:k.func.isRequired,chosenTokens:k.instanceOf(j).isRequired,resultRank:k.func.isRequired,resultFilter:k.func.isRequired,placeholder:k.string.isRequired,autofocus:k.bool,maxTokenTitleLength:k.number.isRequired,dropUp:k.bool,timeline:k.bool},getDefaultProps:function p(){return {allTokens:j(),chosenTokens:j(),resultRank:function q(r){return 0;},resultFilter:function q(r,s){return true;},maxTokenTitleLength:Number.MAX_SAFE_INTEGER,timeline:false};},getInitialState:function p(){return {q:''};},componentWillMount:function p(){var q=this.props,r=q.allTokens,s=q.chosenTokens,t=q.resultFilter,u=q.resultRank,v=q.maxTokenTitleLength;this._searchSource=new (c('OzSearchSource'))(function(w){var x=w.query;return c('Promise').resolve(m(x,r,s,t,u,v));});},componentDidMount:function p(){if(this.props.autofocus)this.refs.tokenizer.focusInput();},_onAddEntryAttempt:function p(q){var r=this.props,s=r.onCreateToken,t=r.maxTokenTitleLength;if(q.getTitle().length>t)return;this.setState({q:''});s(o(q));},_onDeleteEntryAttempt:function p(q){var r=this.props.onDeleteToken;r(o(q));},_onQueryStringChange:function p(q){var r=q.target.value;if(r.length<=this.props.maxTokenTitleLength)this.setState({q:q.target.value});},render:function p(){var q=this.props,r=q.chosenTokens,s=q.placeholder,t=q.timeline;return c('React').createElement('div',{className:"_2-e2"},c('React').createElement(c('XUITokenizer.react'),{className:"_2-e3"+(t?' '+"_11_w":''),placeholder:s,entries:r.map(n).toJS(),presenter:this._tokenPresenter(),queryString:this.state.q,searchSource:this._searchSource,onRemoveEntryAttempt:this._onDeleteEntryAttempt,onAddEntryAttempt:this._onAddEntryAttempt,onQueryStringChange:this._onQueryStringChange,ref:'tokenizer'}));},_tokenPresenter:function p(){var q=this.props.dropUp,r=c('OzHelpers').pure(function(u){return c('React').createElement(c('XUITokenizerToken.react'),babelHelpers['extends']({},u,{className:"_2-e5"}));}),s=c('React').createClass({displayName:'OzTypeaheadViewItem',mixins:[c('TypeaheadViewItem').Mixin],propTypes:c('TypeaheadViewItem').propTypes,render:function u(){var v=this.props.highlighted;return c('React').createElement('li',{className:"_2-e7"+(v?' '+"_2-e8":''),'aria-selected':this.props.highlighted,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight,role:this.props.role},this.props.entry.getTitle());}}),t=c('React').createClass({displayName:'OzTypeaheadView',mixins:[c('OzImmutablePureRenderMixin')],propTypes:c('TypeaheadViewPropTypes'),_renderItem:function u(v){var w=v===this.props.highlightedEntry;return c('React').createElement(s,{key:v.getUniqueID(),entry:v,highlighted:w,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight});},render:function u(){var v="_2-e9"+(q?' '+"_2-ea":'')+(!this.props.entries.length?' '+"_599s":'');return c('React').createElement('ul',{className:v,id:this.props.ariaOwneeID,role:this.props.role},this.props.entries.map(this._renderItem));}});return {ViewRenderer:t,TokenRenderer:r,useLayer:false};}});function m(){var p=arguments.length<=0||arguments[0]===undefined?'':arguments[0],q=arguments[1],r=arguments[2],s=arguments[3],t=arguments[4],u=arguments[5];if(!p)return [];var v=q.filter(function(w){return !r.includes(w);}).filter(function(w){return w.get('name').length<=u;}).filter(function(w){return s(w,p);}).sortBy(t).map(n).take(10).toList();return v.filter(function(w){return w.getUniqueID()==p;}).count()==0?v.push(n(i({name:p,id:p}))).toJS():v.toJS();}function n(p){return new (c('SearchableEntry'))({title:p.get('name'),uniqueID:p.get('id')});}function o(p){return i({id:p.getUniqueID(),name:p.getTitle()});}f.exports=l;}),null);
__d('OzTextTokenizer.react',['immutable','OzTokenizer.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g){var h=c('immutable').List,i=c('React').PropTypes,j=c('React').createClass({displayName:'OzTextTokenizer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{allTokens:i.instanceOf(h).isRequired,onChange:i.func.isRequired,chosenTokens:i.instanceOf(h).isRequired,placeholder:i.string.isRequired,autofocus:i.bool,maxTokenLength:i.number},getDefaultProps:function k(){return {allTokens:h(),chosenTokens:h()};},_commitChangedTokens:function k(l){var m=this.props.onChange;this.setState({q:''});m(l);},_onAddEntryAttempt:function k(l){var m=this.props.chosenTokens;this._commitChangedTokens(m.push(l));},_onDeleteEntryAttempt:function k(l){var m=this.props.chosenTokens,n=m.indexOf(l);this._commitChangedTokens(n>=0?m['delete'](n):m);},render:function k(){var l=this.props,m=l.allTokens,n=l.chosenTokens,o=l.placeholder,p=l.maxTokenLength,q=l.autofocus;return c('React').createElement(c('OzTokenizer.react'),{placeholder:o,allTokens:m,chosenTokens:n,onDeleteToken:this._onDeleteEntryAttempt,onCreateToken:this._onAddEntryAttempt,resultFilter:function r(s,t){return s.get('name').toLowerCase().indexOf(t.toLowerCase())==0;},maxTokenTitleLength:p,dropUp:true,autofocus:q});}});f.exports=j;}),null);
__d('OzQuickRepliesComposer.react',['cx','immutable','OzTextTokenizer.react','React','XUICloseButton.react'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('immutable').List,m=c('React').PropTypes,n=l(['Yes','No','Maybe later','7:00am','7:30am','8:00am','8:30am','9:00am','11:00am','11:30am','12:00pm','12:30pm','1:00pm','1:30pm','2:00pm','5:00pm','5:30pm','6:00pm','6:30pm','7:00pm','7:30pm','8:00pm','8:30pm','9:00pm','Italian','Japanese','Steakhouse','American','French','Chinese','Thai','Burmese','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday','San Francisco','Menlo Park','Los Angeles','New York','London','Paris','Berlin']);i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.$OzQuickRepliesComposer1=function(u){var v=this.props,w=v.attachment,x=v.onEdit;x(w.set('data',u));}.bind(this),q;}o.prototype.render=function(){'use strict';var p=this.props,q=p.attachment,r=p.onRemove;return c('React').createElement('div',{className:"_46s3"},c('React').createElement('div',{className:"_46s4"},c('React').createElement('div',{className:"_46s5"},'Quick Replies'),c('React').createElement(c('XUICloseButton.react'),{onClick:r})),c('React').createElement(c('OzTextTokenizer.react'),{allTokens:n.map(function(s){return k({id:s,name:s});}),onChange:this.$OzQuickRepliesComposer1,chosenTokens:q.get('data')||l(),placeholder:'Add quick replies...',autofocus:true,maxTokenLength:20}));};o.propTypes={attachment:m.instanceOf(k).isRequired,onEdit:m.func.isRequired,onRemove:m.func.isRequired};f.exports=o;}),null);
__d('OzComposerAttachments.react',['cx','OzHelpers','Image.react','immutable','MNCommerceAgentItemSuggestionMercuryAttachment.react','OzAttachmentOverlay.react','OzConstants','OzListEditor.react','OzQuickRepliesComposer.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i=c('immutable').OrderedMap,j=c('immutable').Map,k=c('immutable').List,l=c('OzConstants').ATTS,m=c('React').PropTypes,n=c('React').createClass({displayName:'OzComposerAttachments',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{attachments:m.instanceOf(i).isRequired,onAttachmentCrop:m.func.isRequired,onBubbleEdit:m.func.isRequired,onQuickRepliesEdit:m.func.isRequired,onRemove:m.func.isRequired},render:function q(){var r=this.props,s=r.attachments,t=r.onAttachmentCrop,u=r.onBubbleEdit,v=r.onQuickRepliesEdit,w=r.onRemove;if(s.isEmpty())return null;return c('React').createElement('div',{className:"_18wb"},s.map(function(x,y){return c('React').createElement(o,{key:y,id:y,attachment:x,onRemove:w,onBubbleEdit:u,onAttachmentCrop:t,onQuickRepliesEdit:v});}).valueSeq());}}),o=c('React').createClass({displayName:'Attachment',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{attachment:m.instanceOf(j).isRequired,id:m.number.isRequired,onAttachmentCrop:m.func.isRequired,onBubbleEdit:m.func.isRequired,onQuickRepliesEdit:m.func.isRequired,onRemove:m.func.isRequired},render:function q(){var r=this.props,s=r.attachment,t=r.id,u=r.onAttachmentCrop,v=r.onBubbleEdit,w=r.onQuickRepliesEdit,x=r.onRemove;switch(s.get('type')){case l.IMAGE:return c('React').createElement(c('OzAttachmentOverlay.react'),{key:t,onEdit:function y(z){return u(s,t);},onRemove:function y(z){return x(s,t);},loading:s.get('loading')},p(s));case l.SUGG:return c('React').createElement(c('OzAttachmentOverlay.react'),{key:t,onRemove:function y(z){return x(s,t);},onEdit:function y(z){return v(s,t);}},c('React').createElement(c('MNCommerceAgentItemSuggestionMercuryAttachment.react'),{itemSuggestion:c('OzHelpers').uiSuggestion(s.get('data'))}));case l.QUICK_REPLIES:return c('React').createElement(c('OzQuickRepliesComposer.react'),{attachment:s,onEdit:w,onRemove:function y(z){return x(s,t);}});default:return c('React').createElement(c('OzAttachmentOverlay.react'),{key:t},c('React').createElement('span',null,JSON.stringify(s)));}}});function p(q){var r=q.get('ui-blob');if(r&&!c('OzHelpers').isImageType(r.type)){return c('React').createElement('p',{className:"_4gpv"},r.name);}else{var s=q.get('url')||c('OzHelpers').blobURI(r);return c('React').createElement(c('Image.react'),{className:"_4xee",onClick:function t(u){return window.open(s);},src:s});}}f.exports=n;}),null);
__d('OzConfirmDialog.react',['cx','joinClasses','MessengerDialog.react','MessengerDialogBody.react','MessengerDialogButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','OzActions','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;l.prototype.render=function(){'use strict';var n=this.props,o=n.body,p=n.className,q=n.confirmLabel,r=n.cancelLabel,s=n.header,t=n.onCancel,u=n.onConfirm,v=n.width,w=babelHelpers.objectWithoutProperties(n,['body','className','confirmLabel','cancelLabel','header','onCancel','onConfirm','width']);return c('React').createElement(c('MessengerDialog.react'),babelHelpers['extends']({className:c('joinClasses')("_1vdh",p),onToggle:m(t),width:v||500},w),c('React').createElement(c('MessengerDialogHeader.react'),null,s),c('React').createElement(c('MessengerDialogBody.react'),{className:"_1vdi"},o),c('React').createElement(c('MessengerDialogFooter.react'),null,c('React').createElement(c('MessengerDialogButton.react'),{label:r||'Cancel',onClick:m(t),type:'secondary',use:'default'}),c('React').createElement(c('MessengerDialogButton.react'),{className:'autofocus',label:q||'OK',onClick:m(u),ref:'confirm',type:'primary',use:'default'})));};function l(){'use strict';i.apply(this,arguments);}l.propTypes={body:k.node.isRequired,confirmLabel:k.string,cancelLabel:k.string,header:k.string.isRequired,onConfirm:k.func.isRequired,onCancel:k.func,width:k.number};function m(n){return function(o){c('OzActions').hideDialog();n&&n();};}f.exports=l;}),null);
__d('OzEditorStateHelpers',['ContentState','OzHelpers','DraftModifier','EditorState','UnicodeUtils'],(function a(b,c,d,e,f,g){function h(s,t){var u=c('ContentState').createFromText(t),v=c('EditorState').push(s,u,'remove-range');v=c('EditorState').forceSelection(v,v.getSelection());return v;}function i(s){var t=s.getCurrentContent().getBlockMap(),u=s.getSelection().getStartKey();return t.get(u);}function j(s,t){return s.getCurrentContent().getPlainText().indexOf(t)>=0;}function k(s){var t=q(s,function(u){var v=u.getSelection();if(v.getStartOffset()===0)return r(u,1);var w=i(u).getText().length;return v.merge({anchorOffset:w,focusOffset:0,isBackward:true});},'backward');if(t===s.getCurrentContent())return s;return c('EditorState').push(s,t,'remove-range');}function l(s,t){var u=s.getCurrentContent(),v=i(s).getText(),w=s.getSelection().merge({anchorOffset:0,focusOffset:v.length}),x=c('DraftModifier').replaceText(u,w,t);c('OzHelpers').debug('[replaceLine]',t,v,x.getPlainText());if(x===u)return s;return c('EditorState').push(s,x,'remove-range');}function m(s,t){var u=s.getCurrentContent(),v=c('DraftModifier').insertText(u,u.getSelectionAfter(),t);if(v===u)return s;return c('EditorState').push(s,v,'insert-characters');}function n(s,t){var u=i(s).getText(),v=u.length;if(v===0)return false;t=Math.min(t,v-1);return u[t];}function o(s,t){var u=s.getSelection().merge({focusOffset:t,anchorOffset:t});return c('EditorState').forceSelection(s,u);}function p(s,t){var u=q(s,function(w){var x=w.getSelection(),y=w.getCurrentContent(),z=x.getAnchorKey(),aa=x.getAnchorOffset(),ba=y.getBlockForKey(z).getText().slice(aa-t,aa);return r(w,ba?c('UnicodeUtils').strlen(ba):1);},'backward');if(u===s.getCurrentContent())return s;u=u.set('selectionBefore',s.getSelection());var v=s.getSelection().isCollapsed()?'backspace-character':'remove-range';return c('EditorState').push(s,u,v);}function q(s,t,u){var v=s.getSelection(),w=s.getCurrentContent(),x=v;if(v.isCollapsed()){if(u==='forward'){if(s.isSelectionAtEndOfContent())return w;}else if(s.isSelectionAtStartOfContent())return w;x=t(s);if(x===v)return w;}return c('DraftModifier').removeRange(w,x,u);}function r(s,t){var u=s.getSelection(),v=s.getCurrentContent(),w=u.getStartKey(),x=u.getStartOffset(),y=w,z=0;if(t>x){var aa=v.getKeyBefore(w);if(aa==null){y=w;}else{y=aa;var ba=v.getBlockForKey(aa);z=ba.getText().length;}}else z=x-t;return u.merge({focusKey:y,focusOffset:z,isBackward:true});}f.exports={append:m,backspaceTimes:p,charAt:n,currentBlock:i,deleteCurrentLine:k,editorStateHas:j,forceCollapsedSelection:o,replaceContentWithText:h,replaceLine:l};}),null);
__d('OzHistory',['invariant','immutable'],(function a(b,c,d,e,f,g,h){var i=c('immutable').List,j=c('immutable').OrderedMap,k='oz-history',l=10,m=100;function n(){return j(JSON.parse(localStorage.getItem(k)||'{}')).map(function(s){return i(s);});}function o(s){j.isOrderedMap(s)||h(0);return localStorage.setItem(k,JSON.stringify(s));}function p(s){var t=n();if(t.has(s))return;o(t.set(s,[]).takeLast(l));}function q(s){var t={},u={items:function v(){if(!t.items)t.items=n().get(s);return t.items;},persist:function v(w){i.isList(w)||h(0);o(n().set(s,w));t.items=w;u.resetPos();},resetPos:function v(){t.pos=u.items().size;},pos:function v(){if(!Number.isSafeInteger(t.pos))u.resetPos();return t.pos;},dec:function v(){t.pos=Math.max(u.pos()-1,0);},inc:function v(){t.pos=Math.min(u.pos()+1,u.items().size);},val:function v(){return u.items().get(u.pos());}};return u;}function r(s){p(s);var t=q(s);return {up:function u(){t.dec();return t.val();},down:function u(){t.inc();return t.val();},push:function u(v){var w=t.items();if(!v||w.last()===v)return;t.persist(w.push(v).takeLast(m));}};}f.exports=r;}),null);
__d('OzSendLater.react',['cx','OzHelpers','LayerHideOnBlur','messengerButtonReact','OzDateTimePicker.react','OzImmutablePureRenderMixin','React','Tooltip','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){var i=c('messengerButtonReact').jsComponent,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzSendLater',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{numScheduled:j.number.isRequired,onSendLater:j.func.isRequired,onTimeChange:j.func.isRequired,onToggle:j.func.isRequired,shown:j.bool.isRequired,timestamp:j.number,timezone:j.string,disabled:j.bool},render:function l(){var m=this.props,n=m.shown,o=m.disabled,p=m.numScheduled,q=m.onSendLater,r=m.onToggle,s=m.timestamp,t=m.timezone;return c('React').createElement('span',{className:"_40yd"},c('React').createElement('button',babelHelpers['extends']({ref:'btn',disabled:o,onClick:function u(v){return r(true);}},o?c('Tooltip').propsFor('We can not schedule this message; '+'images are not supported yet'):null,{className:"_1-hv _40ye _30yy"}),c('React').createElement('i',{className:"_40yf"}),p?c('React').createElement('div',{className:"_2ism"},p):null),c('React').createElement(c('XUIContextualDialog.react'),{autoFocus:false,position:'above',contextRef:function(u){return this.refs.btn;}.bind(this),className:"_40yg",shown:n,onToggle:r,behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')}},c('React').createElement('div',{className:"_40yg"},c('React').createElement(c('OzDateTimePicker.react'),babelHelpers['extends']({className:"_40yh",timestamp:s||c('OzHelpers').serverNow(),timezone:t,onChange:this._handleTimeChange},c('OzHelpers').dateRestraints())),c('React').createElement(i,{onClick:q,label:'Send Later',type:'primary'}))));},_handleTimeChange:function l(m){this.props.onTimeChange(m);}});f.exports=k;}),null);
__d('OzTypingDots.react',['cx','immutable','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Range,l=c('React').PropTypes,m=3;i=babelHelpers.inherits(n,c('React').PureComponent);j=i&&i.prototype;n.prototype.render=function(){'use strict';var p=this.props,q=p.bouncing,r=p.disabled,s=p.onClick,t=this.props.numDots||m,u="_32p1"+(q&&!r?' '+"_32p2":'')+(r?' '+"_32p3":'')+(' '+"_30yy");return c('React').createElement('div',{className:u,onClick:s,role:'presentation'},c('React').createElement('div',{className:"_32p4"},k(0,t).map(function(v){return c('React').createElement(o,{index:v,key:v});})));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={bouncing:l.bool,disabled:l.bool,numDots:l.number,onClick:l.func};function o(p){var q=p.index,r=100*q;return c('React').createElement('div',{className:"_32p5",style:{animationDelay:r+'ms'}});}f.exports=n;}),null);
__d('OzUpdateDateTime.react',['immutable','OzHelpers','React'],(function a(b,c,d,e,f,g){var h,i,j=c('immutable').Map,k=c('React').PropTypes;h=babelHelpers.inherits(l,c('React').Component);i=h&&h.prototype;l.prototype.componentDidMount=function(){'use strict';var m=setInterval(function(){this.forceUpdate();}.bind(this),60000);this.setState({timer:m});};l.prototype.componentWillUnmount=function(){'use strict';if(this.state.timer)clearInterval(this.state.timer);};l.prototype.render=function(){'use strict';var m=new Date(c('OzHelpers').serverNow()+this.props.timezoneOffset);return c('React').createElement('span',null,m.toLocaleString(this.props.locale,this.props.options.set('timeZone','UTC').toJS()));};function l(){'use strict';h.apply(this,arguments);}l.propTypes={timezoneOffset:k.number.isRequired,locale:k.string.isRequired,options:k.instanceOf(j).isRequired};f.exports=l;}),null);
__d('OzComposer.react',['cx','fbt','invariant','Promise','OzAPI','OzEditorStateHelpers','formatDate','getDefaultKeyBinding','getEntityMatcher','getVisibleValueForContentState','OzHelpers','insertEmoticonIntoEditorState','OzNotify','promiseFinally','ChatContentSearchButton.react','ChatStickerButton.react','CompositeDraftDecorator','DraftEditor.react','DraftModifier','EditorState','EmoticonsList','EmoticonSpan.react','FileInput.react','immutable','KeyBindingUtil','Keys','MessengerContextualDialog.react','MercuryConfig','OzActions','OzAttachmentCropper.react','OzBubbleEditor.react','OzComposerAI.react','OzComposerAttachments.react','OzConfig','OzConfirmDialog.react','OzConstants','OzHistory','OzSendLater.react','OzTypingDots.react','OzStores','OzSuggestions','OzUpdateDateTime.react','React','OzWrapper.react','Reflux','SelectionState','Timestamp.react'],(function a(b,c,d,e,f,g,h,i,j){var k=c('OzHistory')('composer-history'),l=c('immutable').Map,m=c('immutable').OrderedMap,n=c('immutable').List,o=c('React').PropTypes,p=c('OzComposerAI.react').OzComposerAIList,q=c('OzConstants').ATTS,r=c('OzConstants').TOKENS,s=c('OzStores').ActiveThreadStore,t=c('OzStores').BubbleStore,u=8*1024*1024,v={CREATE_BUBBLE:'CREATE_BUBBLE',CREATE_REMINDER:'CREATE_REMINDER',CREATE_INTENT:'CREATE_INTENT',CLOSE_INTENT:'CLOSE_INTENT',CLOSE_REMINDER:'CLOSE_REMINDER',ADD_QUICK_REPLIES:'ADD_QUICK_REPLIES'},w=15*60*1000,x=4*60*1000,y=c('React').createClass({displayName:'OzComposer',mixins:[c('Reflux').connect(t,'bubbles'),c('Reflux').connect(s,'activeThread'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{thread:o.instanceOf(l).isRequired,merchants:o.instanceOf(l).isRequired,onResize:o.func},contextTypes:{router:o.object.isRequired,uid:o.string.isRequired},getInitialState:function tb(){return da(this.props.thread);},componentDidMount:function tb(){this._unlistenComposer=c('OzActions').updateComposer.listen(this._onUpdateComposer);this._unlistenAISelect=c('OzActions').selectAIPick.listen(this._handleAISelect);this._cleanup=function(){this._unlistenComposer();this._unlistenAISelect();}.bind(this);this._oldHeight=this.refs.root.offsetHeight;},componentWillReceiveProps:function tb(ub){if(c('OzHelpers').threadID(ub.thread)!==c('OzHelpers').threadID(this.props.thread)){ea(this.tid(),this.state);this.setState(da(ub.thread));}},componentDidUpdate:function tb(ub,vb){window.setTimeout(function(xb){var yb=this.refs.root&&this.refs.root.offsetHeight;if(yb!==this._oldHeight)this.props.onResize&&this.props.onResize();this._oldHeight=yb;}.bind(this));var wb=c('OzHelpers').threadID(ub.thread);wb===this.tid()?fa(this.tid(),vb,this.state):c('OzAPI').notTyping(wb);},componentWillUnmount:function tb(){ea(this.tid(),this.state);this._cleanup();c('OzAPI').notTyping(this.tid());},getValue:function tb(){return c('getVisibleValueForContentState')(this.e().getCurrentContent());},focusInput:function tb(){this.refs.input.focus();},render:function tb(){return c('React').createElement('div',{ref:'root',className:"_5751 _19ib"},this._renderWidgets(),c('React').createElement('div',{className:"_5754"},this._renderSettings(),c('React').createElement('div',{className:"_19id"},this._renderTextEditor()),this._renderActions()));},_renderTextEditor:function tb(){return c('React').createElement(c('DraftEditor.react'),{ref:'input',editorState:this.e(),keyBindingFn:this._toKeyCommand,handleKeyCommand:this._handleKeyCommand,handleBeforeInput:this._handleBeforeInput,onChange:this._handleChange,onDownArrow:this._handleDownArrow,onUpArrow:this._handleUpArrow,onTab:this._handleTab,handleReturn:this._handleReturn,onFocus:this._handleFocus,handlePastedFiles:this._handleFiles,handleDroppedFiles:function(ub,vb){this._handleFiles(vb);}.bind(this),placeholder:this.state.sendTyping?i._("Type a message... (\u2318\u21a9 to send)"):i._("Sneakily type a message... (\u2318\u21a9 to exit sneaky mode and send)"),spellCheck:true,textAlignment:'left'});},_handleFocus:function tb(){this.setState({isAIOpen:true});},_onUpdateComposer:function tb(ub){var vb=ub.text,wb=ub.files;vb&&this._handleChange(c('OzEditorStateHelpers').append(this.e(),vb));wb&&this._handleFiles(wb);this.refs.input.focus();},_validateSend:function tb(){var ub=this.state.attachments;return new (c('Promise'))(function(vb,wb){var xb=[[wa(this.e().getCurrentContent()).length>0,'You have not filled in all the missing information.'],[ub.some(function(yb){return yb.get('loading');}),'Your attachments are still loading. Please wait and send in a bit'],[ja(ub)&&!this.getValue().trim()&&!ub.find(function(yb){return yb.get('type')===q.SUGG;}),'You need to type a message or create a bubble '+'if you want to send quick replies'],[!c('OzHelpers').isOwner(this.t(),this.context.uid),'You do not own this thread. Assign yourself to send messages']].find(function(yb){var zb=yb[0],ac=yb[1];return zb;});xb?wb(xb[1]):vb();}.bind(this));},_sendWith:function tb(ub,vb){this._validateSend().done(function(wb){var xb=c('OzHelpers').threadID(this.t()),yb=this.getValue().trim(),zb=this.state.attachments.groupBy(function(gc){return gc.get('type');}),ac=ua(this.t(),this.state),bc=zb.get(q.IMAGE,n()).map(function(gc){return gc['delete']('ui-blob');}).toList(),cc=ka(this.state.attachments),dc=cc&&{'generic-metadata':cc},ec=function gc(){return yb||!bc.isEmpty()?ub(babelHelpers['extends']({tid:xb,images:bc,text:yb,aiusage:ac},dc)):c('Promise').resolve();},fc=function gc(){return zb.get(q.SUGG,n()).reduce(function(hc,ic){return c('promiseFinally')(hc,function(jc){return vb(babelHelpers['extends']({tid:xb,suggestion:ic.get('data'),aiusage:ac},dc));});},c('Promise').resolve());};c('promiseFinally')(ec(),fc);c('OzAPI').notifyExtension({action:'discard',id:xb});this._toHistory();this.setState(babelHelpers['extends']({},ba(this.t()),{editorState:c('OzEditorStateHelpers').replaceContentWithText(this.e(),''),seedBubble:this.state.seedBubble,isAIOpen:this.state.isAIOpen}));}.bind(this),c('OzNotify').error);},_handleMessageSend:function tb(){la('send',[ma(this.t()),na(this.t(),this.state.activeThread),oa(this.getValue().trim())],function(ub){return this._sendWith(c('OzAPI').sendMessage,c('OzAPI').suggest);}.bind(this));},_handleSendLater:function tb(){var ub=this.state.schedule.timestamp;this.setState({sendTyping:false});if(!ub){c('OzNotify').error('You need to pick a time to send later');return;}if(ub<c('OzHelpers').serverNow()-x){c('OzNotify').error('This time is in the past. Is the timezone correct?');return;}la('schedule',[na(this.t(),this.state.activeThread),oa(this.getValue().trim())],function(vb){this._sendWith(function(wb){return c('OzAPI').scheduleMessage(babelHelpers['extends']({},wb,{at:ub}));},function(wb){return c('OzAPI').scheduleSuggest(babelHelpers['extends']({},wb,{at:ub}));});this.setState({sendTyping:true});}.bind(this));},_handleReturn:function tb(ub){if(c('OzHelpers').hasCmdOrCtrl(ub)){setTimeout(this._handleMessageSend);return true;}return false;},_handleFiles:function tb(ub){var vb=ub;if(vb.some(function(yb){return yb.size>=u;})){c('OzNotify').error('The file you are trying to add is too large.');return false;}if(!vb.length)return false;var wb=this.state.attachments.merge(vb.map(function(yb,zb){return [zb,l({type:q.IMAGE,'ui-blob':yb,loading:true})];}));this.setState({attachments:wb});var xb=function yb(zb){return vb.reduce(function(ac,bc,cc){return ac['delete'](cc);},zb);};c('Promise').all(vb.map(function(yb){return c('OzAPI').upload(l({type:yb.type,blob:yb}));})).done(function(yb){yb.every(function(zb){return zb.get('id');})||j(0);this.setState({attachments:ga(xb(this.state.attachments),yb.map(function(zb,ac){return zb.set('ui-blob',vb[ac]);}))});}.bind(this),function(yb){this.setState({attachments:xb(this.state.attachments)});}.bind(this));return true;},_nonTextSend:function tb(ub){var vb=la('send',[ma(this.t()),na(this.t(),this.state.activeThread)],ub);return this._validateSend().then(vb,c('OzNotify').error);},_handleStickerSelect:function tb(ub){this._nonTextSend(function(vb){c('OzAPI').sendMessage({tid:c('OzHelpers').threadID(this.t()),'sticker-id':ub,aiusage:ua(this.t(),this.state)});}.bind(this));},_handleContentSearchSelect:function tb(ub,vb){if(ub.platformFBID.toString()===c('MercuryConfig').MessengerAppID){this._handleStickerSelect(ub.resultID.toString());return;}this._nonTextSend(function(wb){c('OzAPI').upload(l({type:'image/url','attribution-app-id':ub.platformFBID,'image-url':ub.source.url})).done(function(xb){return c('OzAPI').sendMessage({tid:c('OzHelpers').threadID(this.t()),images:[xb],aiusage:ua(this.t(),this.state)});}.bind(this));}.bind(this));},_handleEmoticonSelect:function tb(ub){var vb=c('EmoticonsList').symbols[ub];vb&&this._handleChange(c('insertEmoticonIntoEditorState')(vb,this.state.editorState));},_handleAttRemove:function tb(ub){this.setState({attachments:this.state.attachments['delete'](ub.get('id'))});},_handleBubbleEdit:function tb(ub){this.setState({seedBubble:ub});},_handleBubbleEditorSave:function tb(ub){this.setState({seedBubble:null,attachments:ga(this.state.attachments,[ub])},function(vb){return this.refs.input.focus();}.bind(this));},_handleBubbleEditorClose:function tb(ub){var vb={seedBubble:null},wb=ub.get('id');if(wb)vb.attachments=this.state.attachments['delete'](wb);this.setState(vb,function(xb){return this.refs.input.focus();}.bind(this));},_handleAttachmentCrop:function tb(ub){this.setState({cropAttachment:ub});},_handleAttCropperSave:function tb(ub){var vb=this.state.attachments['delete'](ub.get('id'));this.setState({cropAttachment:null,attachments:vb},function(wb){this._handleFiles([ub.get('ui-blob')]);this.refs.input.focus();}.bind(this));},_handleAttCropperClose:function tb(ub){this.setState({cropAttachment:null},function(vb){return this.refs.input.focus();}.bind(this));},_handleQuickRepliesEdit:function tb(ub){this.setState({attachments:ga(this.state.attachments,[ub])});},_handleTypingDotsClick:function tb(){this.setState({sendTyping:!this.state.sendTyping});},_renderWidgets:function tb(){if(this.state.seedBubble)return c('React').createElement(c('OzBubbleEditor.react'),{merchants:this.props.merchants,seedBubble:this.state.seedBubble,onSave:this._handleBubbleEditorSave,onClose:this._handleBubbleEditorClose});if(this.state.cropAttachment)return c('React').createElement(c('OzAttachmentCropper.react'),{attachment:this.state.cropAttachment,onSave:this._handleAttCropperSave,onClose:this._handleAttCropperClose});return c('React').createElement('div',null,c('React').createElement(p,{filter:this.getValue(),items:this._AIItems(),onItemClick:this._handleAIItemClick}),c('React').createElement(c('OzComposerAttachments.react'),{attachments:this.state.attachments,onRemove:this._handleAttRemove,onBubbleEdit:this._handleBubbleEdit,onAttachmentCrop:this._handleAttachmentCrop,onQuickRepliesEdit:this._handleQuickRepliesEdit}));},_renderSettings:function tb(){return c('React').createElement('div',{className:"_41s9"},c('React').createElement(c('OzTypingDots.react'),{disabled:!this.state.sendTyping,onClick:this._handleTypingDotsClick}));},_renderActions:function tb(){return c('React').createElement('div',{className:"_575c"},c('React').createElement(c('ChatStickerButton.react'),{className:"_30yy"+(' '+"_1v3y"),flyoutAlignment:'right',flyoutClassName:"_293j",onStickerSelect:this._handleStickerSelect,onEmoticonSelect:this._handleEmoticonSelect}),c('React').createElement(c('FileInput.react'),{ref:'fileInput',display:'inline-block',containerClassName:"_30yy _41sr",accept:'*/*',multiple:true,onChange:function(ub){this._handleFiles([].slice.apply(ub.target.files));this.refs.fileInput.getFileInput().clear();}.bind(this)},c('React').createElement('a',{title:'add images',className:"_2e01 _30yy"})),c('React').createElement(c('ChatContentSearchButton.react'),{className:"_yht _30yy _592k",ref:'chatContentSearch',ContextualDialogClass:c('MessengerContextualDialog.react'),flyoutAlignment:'right',flyoutClassName:"_293j",flyoutWidth:285,onStickerSelect:this._handleStickerSelect,getInput:function(){return this.refs.input;}.bind(this),getQuery:this.getValue,onSelect:this._handleContentSearchSelect}),c('React').createElement(c('OzSendLater.react'),babelHelpers['extends']({},this.state.schedule,{numScheduled:this.props.thread.get('events')?this.props.thread.get('events').count():0,onTimeChange:this._handleScheduleTimeChange,onToggle:this._handleScheduleToggle,onSendLater:this._handleSendLater})));},_handleChange:function tb(ub){this.setState({editorState:ub});},_handleDownArrow:function tb(ub){if(c('OzHelpers').hasCmdOrCtrl(ub)&&this.e().isSelectionAtStartOfContent()){this._fromHistory('down');ub.preventDefault();return true;}},_handleUpArrow:function tb(ub){if(c('OzHelpers').hasCmdOrCtrl(ub)&&this.e().isSelectionAtStartOfContent()){this._fromHistory('up');ub.preventDefault();return true;}},_handleTab:function tb(ub){var vb=ya(this.e());if(vb){this.setState({editorState:c('EditorState').forceSelection(this.e(),vb)});ub.preventDefault();return true;}var wb=sa(this._AIItems(),l({line:0,column:0}));if(wb){this._handleAISelect(wb);ub.preventDefault();return true;}},_toKeyCommand:function tb(ub){var vb=function(){var xb=ub.keyCode-c('Keys').ZERO;if(this.state.isAIOpen&&xb<=this._AIItems().size)return 'SELECT-AI-ITEM-'+(xb-1);}.bind(this),wb=function(xb){return qa(xb)&&!ja(this.state.attachments)&&this.state.config.getIn(['GK','quickReplies']);}.bind(this);return pa(ub)&&v.CREATE_BUBBLE||wb(ub)&&v.ADD_QUICK_REPLIES||ta(ub)&&vb()||ra(ub)&&'PREFERRED-NAME'||c('getDefaultKeyBinding')(ub);},_handleKeyCommand:function tb(ub,vb){switch(ub){case 'SELECT-AI-ITEM-0':case 'SELECT-AI-ITEM-1':case 'SELECT-AI-ITEM-2':case 'SELECT-AI-ITEM-3':case 'SELECT-AI-ITEM-4':case 'SELECT-AI-ITEM-5':case 'SELECT-AI-ITEM-6':case 'SELECT-AI-ITEM-7':case 'SELECT-AI-ITEM-8':case 'SELECT-AI-ITEM-9':this._handleAIItemClick(l({line:+ub.slice(-1),column:0}));return true;case 'PREFERRED-NAME':this._handleChange(c('EditorState').push(vb,c('DraftModifier').replaceText(vb.getCurrentContent(),vb.getSelection(),c('OzHelpers').preferredName(this.t()))));return true;case v.CREATE_BUBBLE:this.setState({seedBubble:ha()});return true;case v.ADD_QUICK_REPLIES:this.setState({attachments:ga(this.state.attachments,[ia()])});return true;}return false;},_AIItems:function tb(ub){return bb(this.state.isAIOpen,this.props.thread,this.state.attachments,this.state.bubbles,this.props.merchants,this.getValue());},_handleAISelect:function tb(ub){this.setState({lastAIPick:ub,lastAIGuesses:this.t().get('guesses'),sendTyping:eb(ub)?false:this.state.sendTyping},function(){var vb=ub.get('id');if(eb(ub)){c('OzAPI').deleteScheduled(c('OzHelpers').threadID(this.t()),vb);this._handleScheduleTimeChange({timestamp:ub.get('at'),timezone:c('OzHelpers').timezone(this.t())});}switch(ub.get('type')){case q.COMMAND:if(!eb(ub))switch(ub.get('action')){case v.CREATE_REMINDER:this._handleCreateReminder(ub);break;case v.CLOSE_REMINDER:this._handleCloseReminder(ub);break;case v.CREATE_INTENT:this._handleCreateIntent(ub);break;case v.CLOSE_INTENT:this._handleCloseIntent(ub);break;default:this._handleKeyCommand(ub.get('action'));}break;case q.SURVEY:case 'send':case q.TEMPLATE:var wb=ub.get('f'),xb=wb&&wb()||ub.get('ui-body'),yb=ub.getIn(['data','images']),zb=c('OzEditorStateHelpers').replaceLine(this.e(),xb+' '),ac=ya(zb);if(xb)this._handleChange(ac?c('EditorState').forceSelection(zb,ac):zb);if(yb)this.setState({attachments:ga(this.state.attachments,yb.toArray())});break;case 'suggest':case q.SUGG:this.setState({seedBubble:ub});break;case q.OPENTABLEQR:this.setState({attachments:ga(this.state.attachments,[l({data:ub.get('bubble')['delete']('thumb-urls'),meta:ub.get('meta'),source:'places',type:q.SUGG}),ia(ub.get('quickreplies'))])});var bc=c('OzEditorStateHelpers').replaceLine(this.e(),ub.get('ui-body'));this._handleChange(bc);break;}}.bind(this));this.focusInput();},_handleAIItemClick:function tb(ub){this._handleAISelect(sa(this._AIItems(),ub));},_handleCreateReminder:function tb(ub){c('OzAPI').createReminder(this.tid(),l({body:ub.get('body'),'scheduled-time':ub.get('scheduled-time')}));},_handleCloseReminder:function tb(ub){c('OzAPI').closeReminder(this.tid(),ub.get('id')||ub.get('reminder-id'),false);},_handleCreateIntent:function tb(ub){c('OzAPI').createIntent(this.tid(),l({'wit-intent-uuid':ub.get('wit-intent-uuid'),name:ub.get('name'),metadata:ub.get('metadata'),params:ub.get('params'),actions:ub.get('actions'),notes:ub.get('notes'),requirements:ub.get('requirements')})).done(function(vb){c('OzHelpers').info('[composer/handleCreateIntent] created for:',c('OzHelpers').threadID(vb));this.context.router.push(c('OzHelpers').threadPath({threadid:c('OzHelpers').threadID(vb),intentid:vb.getIn(['intents',-1,'id'])}));}.bind(this));},_handleCloseIntent:function tb(ub){c('OzAPI').closeIntent(this.tid(),ub.get('id'));},_toHistory:function tb(){var ub=this.state.attachments,vb=ub.filter(function(xb){return xb.get('type')===q.SUGG;}),wb=this.getValue();k.push(JSON.stringify({bubbles:vb,text:wb}));},_fromHistory:function tb(ub){var vb=c('OzHelpers').safeParse(k[ub]()),wb=vb.bubbles,xb=vb.text;xb&&this._handleChange(c('OzEditorStateHelpers').replaceContentWithText(this.e(),xb));wb&&this.setState({attachments:m(wb).mapEntries(function(yb){return c('immutable').fromJS(yb);}).mapKeys(function(yb){return +yb;})});},_handleScheduleToggle:function tb(ub){var vb=this.state.schedule,wb=vb.timestamp||c('OzHelpers').serverNow();vb.shown===ub?null:this.setState({schedule:babelHelpers['extends']({},vb,{shown:ub,timestamp:wb})});},_handleScheduleTimeChange:function tb(ub){this.setState({schedule:babelHelpers['extends']({},this.state.schedule,ub)});},e:function tb(){return this.state.editorState;},t:function tb(){return this.props.thread;},tid:function tb(){return c('OzHelpers').threadID(this.t());}});function z(){var tb=new (c('CompositeDraftDecorator'))([{strategy:function ub(vb,wb){wa(vb.getText()).map(function(xb){return wb.apply(undefined,xb);});},component:ab},{strategy:c('getEntityMatcher')(function(ub){return ub.getType()==='EMOTICON';}),component:c('EmoticonSpan.react')}]);return c('EditorState').createEmpty(tb);}function aa(tb){return {shown:false,timestamp:null,timezone:c('OzHelpers').timezone(tb)};}function ba(tb){return {attachments:m(),editorState:z(),sendTyping:true,seedBubble:null,isAIOpen:false,lastAIPick:null,lastAIGuesses:null,schedule:aa(tb)};}var ca={};function da(tb){return ca[c('OzHelpers').threadID(tb)]||ba(tb);}function ea(tb,ub){var vb=babelHelpers['extends']({},ub);delete vb.bubbles;delete vb.activeThread;delete vb.config;vb.isAIOpen=false;ca[tb]=vb;}function fa(tb,ub,vb){var wb=ub.editorState.getCurrentContent().getPlainText(),xb=vb.editorState.getCurrentContent().getPlainText();wb!==xb&&c('OzHelpers').debug('[composer] changed from',wb,xb);if(vb.sendTyping){var yb=[wb,xb].map(function(bc){return !!bc.length;}),zb=yb[0],ac=yb[1];!zb&&ac&&c('OzAPI').typing(tb);zb&&!ac&&c('OzAPI').notTyping(tb);}ub.sendTyping&&!vb.sendTyping&&c('OzAPI').notTyping(tb);}function ga(tb,ub){m.isOrderedMap(tb)||j(0);Array.isArray(ub)||j(0);return tb.withMutations(function(vb){return ub.reduce(function(wb,xb){xb=xb.set('id',xb.get('id')||xb.hashCode());return wb.set(xb.get('id'),xb);},vb);});}function ha(){return c('immutable').fromJS({data:{currency:'USD'},type:q.SUGG});}function ia(tb){return c('immutable').fromJS({type:q.QUICK_REPLIES,data:tb?tb.map(function(ub){return l({id:ub,name:ub});}):n()});}function ja(tb){return tb.find(function(ub){return ub.get('type')===q.QUICK_REPLIES;});}function ka(tb){var ub=l(ja(tb)).get('data',n()).map(function(vb){return vb.get('name','').trim();}).filter(function(vb){return !!vb;});return ub.isEmpty()?null:{agent_quick_replies:ub.toArray()};}function la(tb,ub,vb){var wb=n(ub).filter(function(xb){return !!xb;});wb.isEmpty()?vb():c('OzActions').showDialog(c('OzConfirmDialog.react'),{body:wb.size===1?wb.first():c('React').createElement('ul',null,wb.map(function(xb,yb){return c('React').createElement('li',{key:yb},xb);})),confirmLabel:c('OzHelpers').toTitleCase(tb),header:'Are you sure you want to '+tb+' this message?',onConfirm:vb});}function ma(tb){var ub=l({hour:'numeric',minute:'numeric'}),vb=tb.getIn(['location','timezone-offset']),wb=c('OzHelpers').preferredName(tb),xb=c('OzHelpers').lastPresence(tb);if(vb&&!c('OzHelpers').isDaytime(vb)&&xb&&c('OzHelpers').serverNow()-xb>w)return c('React').createElement('span',null,'It\'s\u00A0',c('React').createElement('strong',null,c('React').createElement(c('OzUpdateDateTime.react'),{locale:'en-US',options:ub,timezoneOffset:vb||0})),'\u00A0at ',wb,'\'s last known location and they haven\'t interacted with us since ',c('React').createElement('strong',null,c('React').createElement(c('Timestamp.react'),{autoUpdate:true,time:xb/1000})),'.');}function na(tb,ub){var vb=ub.get('activeIntent'),wb=vb&&tb.get('intents').find(function(xb){return xb.get('id')===vb;});if(!wb||wb.get('state')!=='open')return 'You should create an intent or select an open one so the AI can '+'learn from what you\'re sending.';}function oa(tb){var ub=n([[/ +/g,function(vb){return vb.length>1;},'a bunch of spaces in a row'],[/^ | $/gm,function(vb){return true;},'whitespace at the beginning or end of a line']]).map(function(vb){var wb=vb[0],xb=vb[1],yb=vb[2];return n(tb.match(wb)).some(xb)&&yb;}).filter(function(vb){return !!vb;});if(!ub.isEmpty())return c('React').createElement('div',null,'Your text contains some weird formatting:',c('React').createElement('ul',null,ub.map(function(vb,wb){return c('React').createElement('li',{key:wb},vb);})));}function pa(tb){return c('OzHelpers').hasCmdOrCtrl(tb)&&tb.which===66;}function qa(tb){return c('OzHelpers').hasCmdOrCtrl(tb)&&tb.which===191;}function ra(tb){return tb.getModifierState('Control')&&tb.which===78;}function sa(tb,ub){var vb=tb.get(ub.get('line'));return n.isList(vb)?vb.get(ub.get('column')):vb;}function ta(tb){return c('KeyBindingUtil').hasCommandModifier(tb)&&tb.keyCode>=c('Keys').ZERO+1&&tb.keyCode<=c('Keys').ZERO+9;}function ua(tb,ub){var vb=ub.lastAIPick,wb=ub.lastAIGuesses,xb=wb||tb.get('guesses'),yb=c('OzHelpers').openIntents(tb).map(function(zb){return zb.filter(c('OzHelpers').keysIn('name','wit-intent-uuid'));});c('OzHelpers').debug('building ai usage',c('OzHelpers').threadID(tb));return l({gold:vb,guesses:xb,intents:yb});}var va=/(@\[[^\]]+\])/g;function wa(tb){var ub=void 0,vb=[];while(ub=va.exec(tb))vb.push([ub.index,ub.index+ub[0].length]);return vb;}function xa(tb){return '@['+tb+']';}function ya(tb){var ub=tb.getCurrentContent().getBlockMap().toSeq().map(function(xb){return [xb,wa(xb.getText())[0]];}).find(function(xb){var yb=xb[0],zb=xb[1];return !!zb;},null,[]),vb=ub[0],wb=ub[1];return vb&&wb?za.apply(undefined,[vb.getKey()].concat(wb)):null;}function za(tb,ub,vb){return new (c('SelectionState'))({anchorKey:tb,focusKey:tb,anchorOffset:ub,focusOffset:vb,hasFocus:true,isBackward:false});}var ab=c('OzHelpers').pure(function(tb){var ub=tb.offsetKey,vb=tb.children;return c('React').createElement('span',{'data-offset-key':ub,className:"_a5n"},vb);});function bb(tb,ub,vb,wb,xb,yb){var zb=db(ub,xb,yb),ac=cb(ub,zb,vb,xb,wb,yb),bc=ac.groupBy(function(ec){return ec.get('ui-scheduled')?'scheduled':ec.get('type')===q.SUGG?q.SUGG:'rest';}),cc=bc.get('rest',n()).push(bc.get(q.SUGG)).filter(function(ec){return !!ec;}),dc=bc.get('scheduled',n());if(!tb){return dc.isEmpty()?n():n().push(dc);}else if(dc.isEmpty()){return cc;}else return cc.push(dc);}function cb(tb,ub,vb,wb,xb,yb){var zb=ub.filter(function(cc){return cc.get('type')==q.SUGG;}).take(25),ac=ub.filter(function(cc){return cc.get('type')!=q.SUGG;}).concat(sb(tb,yb)).take(5),bc=zb.concat(ac);return mb(xb,yb).takeLast(1).concat(bc).concat(kb(vb,yb)).concat(fb(tb,wb,yb));}function db(tb,ub,vb){return (tb.get('guesses')||n()).flatMap(function(wb){return wb.get('items')||[wb].map(function(xb){return xb.merge(l({position:wb.get('position'),confidence:wb.get('confidence'),'class':wb.get('class')}));});}).map(function(wb){switch(wb.get('type')){case q.TEMPLATE:var xb=nb(tb,wb.get('body'));return eb(wb)||rb(xb,vb)?wb.set('ui-body',xb):null;case 'bubble':return eb(wb)||qb(wb.get('data'),vb)?c('OzSuggestions').toServer(wb,ub):null;case 'close-intent':return hb(tb,wb);case 'create-intent':return gb(tb,wb);case 'close-reminder':return ib(tb,wb);case 'reminder':var yb=wb.getIn(['body','description']),zb=wb.get('scheduled-time'),ac=c('formatDate')(zb/1000,'g:ia M j');return l({type:q.COMMAND,action:v.CREATE_REMINDER,text:'Create Reminder for '+ac+': "'+yb+'"',iconCl:"_3e_w",body:wb.get('body'),'scheduled-time':zb});}}).filter(function(wb){return !!wb;});}function eb(tb){return !!(tb.get('id')&&tb.get('at'));}function fb(tb,ub,vb){return (tb.get('events')||n()).concat(tb.get('scheduled')||n()).toSeq().map(function(wb){switch(wb.get('type')){case 'send':return wb.set('ui-body',wb.getIn(['data','text']));case 'suggest':return wb.set('type',q.SUGG).set('data',wb.getIn(['data','suggestion'])).updateIn(['data','merchant-name'],function(xb){return c('OzSuggestions').findMerchantName(xb,ub);});case 'create-intent':return gb(tb,wb.get('data')).set('id',wb.get('id'));case 'close-intent':return hb(tb,wb.get('data')).set('id',wb.get('id'));case 'close-reminder':return ib(tb,wb.get('data')).merge({id:wb.get('id'),at:wb.get('at')});case 'create-reminder':return jb(tb,wb.get('data')).set('id',wb.get('id'));case q.SURVEY:case q.TEMPLATE:return wb.set('ui-body',nb(tb,wb.getIn(['data','body'])));case 'bubble':return c('OzSuggestions').toServer(wb.get('data'),ub).setIn(['data','amount'],+wb.getIn(['data','data','price'])).set('id',wb.get('id'));case 'send-calendar':return wb.set('type',q.SUGG).set('data',l({name:wb.getIn(['data','title']),description:c('OzHelpers').toLocaleDate(wb.getIn(['data','start'])),'merchant-name':'Invite bubble'}));default:c('OzHelpers').debug('[oz-scheduled], unk scheduled',wb);}}).filter(function(wb){return !!wb;}).map(function(wb){return wb.set('ui-scheduled',true);}).sortBy(function(wb){return wb.get('at');});}function gb(tb,ub){var vb=ub.get('name');return ub.set('type',q.COMMAND).set('action',v.CREATE_INTENT).set('text','Create intent '+vb).set('iconCl',"_3e_w");}function hb(tb,ub){var vb=ub.get('id'),wb=tb.get('intents').findLast(function(yb){return yb.get('id')===vb;}),xb=wb?wb.get('alias')||wb.get('name'):ub.get('source');return ub.set('type',q.COMMAND).set('action',v.CLOSE_INTENT).set('text','Close intent '+xb).set('iconCl',"_3e_w");}function ib(tb,ub){var vb=ub.get('id')||ub.get('reminder-id'),wb=tb.get('reminders').findLast(function(yb){return yb.get('id')===vb;}),xb=wb?wb.getIn(['body','description']):ub.get('source');return ub.set('type',q.COMMAND).set('action',v.CLOSE_REMINDER).set('text','Close reminder '+xb).set('iconCl',"_3e_w");}function jb(tb,ub){var vb=ub.getIn(['body','description']);return ub.set('type',q.COMMAND).set('action',v.CREATE_REMINDER).set('text','Create reminder '+vb).set('iconCl',"_3e_w");}function kb(tb,ub){return c('immutable').fromJS([{type:q.COMMAND,action:v.CREATE_BUBBLE,text:'Create Bubble',iconCl:"_3e_w",shortcut:'B'},!ja(tb)&&lb()]).filter(function(vb){return vb&&rb(vb.get('text'),ub);});}function lb(){if(c('OzConfig').getInStaticConfig(['GK','quickReplies']))return {type:q.COMMAND,action:v.ADD_QUICK_REPLIES,text:'Add Quick Replies',iconCl:"_3e_w",shortcut:'/'};}function mb(tb,ub){var vb=tb.filter(function(wb){return qb(wb,ub);});return (vb.isEmpty()?tb:vb).toList();}function nb(tb,ub){if(typeof ub==='string')return ub;return ub&&ub.map(function(vb){if(typeof vb==='string')return vb;return pb(tb,vb);}).toJS().join('');}function ob(tb){var ub=tb.get('index');return xa(tb.get('type')+(ub?' '+ub:''));}function pb(tb,ub){if(ub.get('type')===r.USER_FIRST_NAME)return c('OzHelpers').preferredName(tb);return ob(ub);}function qb(tb,ub){var vb=tb.get('data',l());return rb(vb.get('name','')+'\n     '+vb.get('description','')+'\n     '+vb.get('target-url',''),ub);}function rb(tb,ub){return tb&&tb.toLowerCase().indexOf((ub||'').toLowerCase())>-1;}function sb(tb,ub){var vb=function yb(zb){return nb(tb,zb[Math.floor(zb.length*Math.random())]);},wb='\uD83D\uDC64',xb=n([nb(tb,c('immutable').fromJS([{type:r.USER_FIRST_NAME}])),[wb+' Who are you?',function(){return vb(["My name is M! I'm your personal assistant in Messenger.","My name is M! I'm your personal assistant. I can help you with things like making reservations, finding the perfect gift or planning your next vacation.","My name is M! I'm your personal assistant in Messenger. I'm here to help you do things better and faster.","My name is M! I'm here to help make your life easier."]);}],[wb+' What can you do for me?',function(){return vb(["I can help you with lots of things, like figuring out where to go to dinner, finding a great gift for someone, or planning your weekend. Just ask!","I can help you with lots of things. Just ask and I'll let you know if it's something I can't do.","In general, I can help you with anything that's not illegal. Just ask and I'll let you know if there's something I can't do."]);}],['Sent the wrong info',function(){return 'Sorry! It looks like I sent you the wrong info. @[Right info]';}],[wb+' How did you pick this?',function(){return "I look at a variety of things and try to find the info that's best for you. Would you like me to send you some other options?";}],[wb+' What does M stand for?',function(){return vb(["M is just my name! ","Just M!","I'm just M, like Messenger."]);}],[wb+' Do you have a partnership with X?',function(){return "No, I just try to find the best info for you. Do you want me to send you some other options?";}],["Storing contact info",function(){return vb(["Thanks! I'll remember this for next time."]);}],["Don't have an opinion",function(){return "I don't have an opinion about that, but...@[point to resources]";}],['Not my area of expertise',function(){return "I'm not a @[lawyer, financial adviser, etc.] so I can't give you @[legal, financial, etc.] advice, but I can do some research for you. ";}],[wb+' What\'s your favorite sticker?',function(){return vb(["I can't pick a favorite!","They're all great!","I love all of the stickers equally!"]);}],["General redirect",function(){return "I'm not really sure how to answer that, but can I help you with something else?";}],["Bugs redirect",function(){return "You can actually report things like this right from Facebook. Here's how: https://www.facebook.com/help/326603310765065/ ";}],["Facebook support redirect",function(){return vb(["I'm not an expert, so I'd recommend checking out the Help Center: www.facebook.com/help (http://www.facebook.com/)","I'm not an expert in that, so I'd recommend going here: www.facebook.com/help (http://www.facebook.com/)"]);}],[wb+' What languages do you support?',function(){return "Right now I can only chat in English. Sorry for the inconvenience!";}],["Trolling (abusing M/the agents)",function(){return vb(["Is there anything I can help you with?","Unfortunately I won't be able to chat with you if you say things like that."]);}],["Generic don't support message",function(){return vb(["Unfortunately I can't do that. Is there anything else I can help you with?","Unfortunately I can't help you with that. @[Sorry for the inconvenience.] Is there anything else I can do for you?","Unfortunately I can't support this type of request. Is there anything else I can help you with?"]);}],[wb+' What are you? Are you human?',function(){return vb(["I'm M! I use artificial intelligence, but people help train me to so I'll get better and better over time.","I'm M! I use artificial intelligence, but people help train me."]);}],[wb+' What gender are you?',function(){return "I don't have a gender. I'm just M.";}],[wb+' How old are you?',function(){return "I don't have an age. Maybe 42?";}],[wb+' Who made you? Where did you come from?',function(){return vb(["I was designed by the Messenger Team.","I was created by the Messenger Team."]);}],[wb+' What do you look like?',function(){return "That's me in the picture next to this message.";}],[wb+' Can you talk or just type?',function(){return "I can send you messages here in Messenger. ";}],[wb+' Where do you live?',function(){return "Right here in Messenger.";}],[wb+' Can you call/message/email my friend?',function(){return "Unfortunately I can't do that. Is there anything else I can help you with?";}],["Medical redirect",function(){return "Unfortunately I can't support this type of request right now. Is there anything else I can help you with?";}],"I'm a little busier than usual right now. I want to give you my full attention, so I'll get back to you as soon as I can. In the meantime, feel free to send me any extra info about your request.","I'm on it!",["You're welcome.",function(){return vb(["You're welcome.","You're welcome! Let me know if there's anything else I can help you with.","You're welcome! Let me know if you need anything else.","You're welcome! Let me know if I can help you with anything else."]);}],["Anything else",function(){return vb(["Let me know if there's anything else I can help you with.","Let me know if I can help with anything else.","Great! Let me know if there's anything else I can help you with.","Let me know if there's anything else I can help you with today."]);}],"How does this look?",["I'm on it",function(){return vb(["Sure, I'm on it!","I'll look into that for you.","I'll look into that for you!","I'll do some research."]);}],"How can I help you today?","How about this?","Is this what you're looking for?","I'll take care of it!","What email should I use for the invite?","Where should I send the invite?","When would you like to dine and how many people will be joining you?",["Save phone number",vb(["Would you like me to save your phone number for future requests?","What phone number would you like me to use for the reservation?"])],"Do you have a price range in mind?","Here are some options:"]).map(function(yb){return Array.isArray(yb)?l({'ui-body':yb[0],type:q.TEMPLATE,f:yb[1]}):l({'ui-body':yb,type:q.TEMPLATE});}).filter(function(yb){return rb(yb.get('ui-body'),ub);});return xb;}f.exports=c('OzWrapper.react')(y);}),null);
__d('OzCheckboxInput.react',['cx','invariant','AbstractCheckboxInput.react','OzImmutablePureRenderMixin','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){var j=c('React').createClass({displayName:'OzCheckboxInput',mixins:[c('OzImmutablePureRenderMixin')],render:function k(){return c('React').createElement(c('AbstractCheckboxInput.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_55sg _4k1t"),onChange:this._handleChange}));},_handleChange:function k(l){var m=l.target;m instanceof HTMLInputElement||i(0);this.props.onChange&&this.props.onChange(m.checked);}});f.exports=j;}),null);
__d('OzMessageFeedbackDialog.react',['cx','invariant','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','InputLabel.react','OzButton.react','OzCheckboxInput.react','React','StarsInput.react','XUIContextualDialog.react','XUIContextualDialogBody.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m=['Poor','Average','Great'];j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.$OzMessageFeedbackDialog1=function(){var t=this.props.onFollowedPolicyChange;t&&t(true);}.bind(this),this.$OzMessageFeedbackDialog2=function(){var t=this.props.onFollowedPolicyChange;t&&t(false);}.bind(this),this.$OzMessageFeedbackDialog3=function(t){t.target instanceof HTMLTextAreaElement||i(0);this.props.onFeedbackChange(t.target.value);}.bind(this),p;}n.prototype.render=function(){return c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll')},contextRef:this.props.contextRef,shown:true},c('React').createElement(c('XUIContextualDialogBody.react'),{className:"_5dx"},c('React').createElement('div',{className:"_5333"},c('React').createElement('div',{className:"_5334"},c('React').createElement('div',null,c('React').createElement('h3',null,'Tone'),c('React').createElement(c('StarsInput.react'),{count:this.props.toneRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onToneRatingChange,starLabels:m}),c('React').createElement('h3',null,'Execution'),c('React').createElement(c('StarsInput.react'),{count:this.props.executionRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onExecutionRatingChange,starLabels:m}))),c('React').createElement('div',{className:"_5335"},c('React').createElement('div',null,c('React').createElement('h3',null,'Responsiveness'),c('React').createElement(c('StarsInput.react'),{count:this.props.responsivenessRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onResponsivenessRatingChange,starLabels:m}),c('React').createElement('h3',null,'Console'),c('React').createElement(c('StarsInput.react'),{count:this.props.consoleRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onConsoleRatingChange,starLabels:m})))),c('React').createElement('div',null,c('React').createElement('h3',null,'Followed Policy'),c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement(c('OzCheckboxInput.react'),{checked:this.props.followedPolicy===true,onChange:this.$OzMessageFeedbackDialog1}),c('React').createElement('label',null,'Yes')),c('React').createElement(c('InputLabel.react'),null,c('React').createElement(c('OzCheckboxInput.react'),{checked:this.props.followedPolicy===false,onChange:this.$OzMessageFeedbackDialog2}),c('React').createElement('label',null,'No'))),c('React').createElement('h3',null,'Message'),c('React').createElement('div',{className:"_5336"},c('React').createElement('textarea',{maxLength:'2500',value:this.props.feedback,onChange:this.$OzMessageFeedbackDialog3,placeholder:'Give more details here'}))),c('React').createElement('div',{className:"_5dy"},c('React').createElement(c('OzButton.react'),{onClick:this.props.onClose},'Cancel'),c('React').createElement(c('OzButton.react'),{className:"_5dz",onClick:this.props.onSave,primary:true},'Save'))));};n.propTypes={contextRef:l.func.isRequired,executionRating:l.oneOf([0,1,2,3]),followedPolicy:l.bool,onClose:l.func,onExecutionRatingChange:l.func,onFollowedPolicyChange:l.func,onResponsivenessRatingChange:l.func,onConsoleRatingChange:l.func,onSave:l.func,onToneRatingChange:l.func,responsivenessRating:l.oneOf([0,1,2,3]),consoleRating:l.oneOf([0,1,2,3]),toneRating:l.oneOf([0,1,2,3])};f.exports=n;}),null);
__d('OzMessageFeedback.react',['cx','joinClasses','immutable','ReactLayeredComponentMixin_DEPRECATED','OzMessageFeedbackDialog.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('React').PropTypes,m='feedback_dialog',n='no_dialog',o=c('React').createClass({displayName:'OzMessageFeedback',mixins:[c('ReactLayeredComponentMixin_DEPRECATED'),c('OzImmutablePureRenderMixin')],propTypes:{message:l.instanceOf(k).isRequired,onSave:l.func.isRequired},getInitialState:function s(){return babelHelpers['extends']({currentDialog:n},q(this.props.message));},componentWillReceiveProps:function s(t){if(t.message!==this.props.message)this.setState(q(t.message));},render:function s(){var t=this.state.currentDialog,u=r(this.state);return c('React').createElement('div',{className:"_2bxa"+(' '+"_2bxb")+(u?' '+"_2bxc":'')+(t!==n?' '+"_2bxd":'')},c('React').createElement(p,{className:"_2bxf",onClick:function(v){return this.setState({currentDialog:m});}.bind(this),isActive:u||t===m,ref:'flag'}));},renderLayers:function s(){switch(this.state.currentDialog){case m:return {contextualDialog:this._renderFeedbackDialog()};default:return null;}},_renderFeedbackDialog:function s(){return c('React').createElement(c('OzMessageFeedbackDialog.react'),{contextRef:function(){return this.refs.flag;}.bind(this),executionRating:this.state.executionRating,followedPolicy:this.state.followedPolicy,onClose:this._handleDialogClose,onExecutionRatingChange:function(t){this.setState({executionRating:t});}.bind(this),onFollowedPolicyChange:function(t){this.setState({followedPolicy:t});}.bind(this),onResponsivenessRatingChange:function(t){this.setState({responsivenessRating:t});}.bind(this),onSave:this._handleFeedbackSave,onToneRatingChange:function(t){this.setState({toneRating:t});}.bind(this),onConsoleRatingChange:function(t){this.setState({consoleRating:t});}.bind(this),responsivenessRating:this.state.responsivenessRating,toneRating:this.state.toneRating,consoleRating:this.state.consoleRating,feedback:this.state.feedback,onFeedbackChange:function(t){this.setState({feedback:t});}.bind(this)});},_handleFeedbackSave:function s(){this.props.onSave(k({execution:this.state.executionRating,'followed-policy':this.state.followedPolicy,mid:this.props.message.get('mid'),'offline-threading-id':this.props.message.get('offline-threading-id'),responsiveness:this.state.responsivenessRating,tone:this.state.toneRating,feedback:this.state.feedback,'console-proficiency':this.state.consoleRating}));this._handleDialogClose();},_handleDialogClose:function s(){this.setState({currentDialog:n});}});i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;p.prototype.render=function(){'use strict';var s=this.props,t=s.className,u=s.onClick,v=s.isActive;return c('React').createElement('button',{role:'button',className:c('joinClasses')("_1-hv"+(' '+"_2bxi")+(v?' '+"_2bxj":''),t),onClick:u});};function p(){'use strict';i.apply(this,arguments);}function q(s){return {executionRating:s.get('execution'),feedback:s.get('feedback'),followedPolicy:s.get('followed-policy'),responsivenessRating:s.get('responsiveness'),toneRating:s.get('tone'),consoleRating:s.get('console-proficiency')};}function r(s){return !!(s.executionRating||s.followedPolicy!==undefined||s.responsivenessRating||s.toneRating||s.consoleRating);}f.exports=o;}),null);
__d('OzMessageQuickReplies.react',['cx','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','React','XUICloseButton.react','immutable','XUIContextualDialog.react','XUIContextualDialogBody.react','ReactLayeredComponentMixin_DEPRECATED','OzImmutablePureRenderMixin'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('immutable').Map,k=c('immutable').List,l=c('React').createClass({displayName:'OzMessageQuickReplies',mixins:[c('ReactLayeredComponentMixin_DEPRECATED'),c('OzImmutablePureRenderMixin')],propTypes:{message:i.instanceOf(j).isRequired},getInitialState:function n(){return babelHelpers['extends']({displayDialog:false},m(this.props.message));},render:function n(){return c('React').createElement('div',{className:"_g8_"},c('React').createElement('button',{className:"_1-hv _g90 _g91",onClick:function(o){return this.setState({displayDialog:!this.state.displayDialog});}.bind(this),ref:'flag'}));},renderLayers:function n(){if(this.state.displayDialog){return {contextualDialog:this._renderQRDialog()};}else return null;},_renderQRDialog:function n(){return c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll')},contextRef:function(){return this.refs.flag;}.bind(this),shown:true},c('React').createElement(c('XUIContextualDialogBody.react'),null,c('React').createElement('div',{className:"_g92"},c('React').createElement('div',{className:"_g93"},c('React').createElement('ul',null,this.state.quickReplies.map(function(o){return c('React').createElement('li',{key:o},o);}))),c('React').createElement(c('XUICloseButton.react'),{onClick:function(o){return this.setState({displayDialog:false});}.bind(this)}))));}});function m(n){return {quickReplies:n.getIn(['generic-metadata','agent_quick_replies'],k())};}f.exports=l;}),null);
__d('OzInboxMessage.react',['cx','OzAPI','OzHelpers','immutable','OzActions','OzConfig','OzConstants','OzMessage.react','OzMessageFeedback.react','OzMessageQuickReplies.react','OzImmutablePureRenderMixin','React','Reflux'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('OzConstants').AUTHOR_TYPES,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzInboxMessage',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{authorType:k.oneOf(c('OzHelpers').values(j)),isActive:k.bool.isRequired,message:k.instanceOf(i).isRequired,threadID:k.string.isRequired},render:function m(){var n=this.props,o=n.message,p=n.authorType,q=n.threadID,r=n.isActive,s=!!o.get('author'),t=c('OzConfig').ConfigStore.data.getIn(['GK','displayQR'])&&!!o.getIn(['generic-metadata','agent_quick_replies']),u=this.state.config;return c('React').createElement('div',{className:"clearfix"+(' '+"_4y6j")+(r?' '+"_4qv0":'')+(p===j.TRAINER?' '+"_2ij4":'')+(p===j.BOT?' '+"_2ij5":'')+(p===j.USER?' '+"_2p0":'')+(u.getIn(['GK','supervisor'])?' '+"_1w52":'')},c('React').createElement('div',{className:"_2pf"},c('React').createElement(c('OzMessage.react'),{message:o}),p===j.USER?c('React').createElement('button',{onClick:function v(){return c('OzActions').intentCreator.toggle(o.get('mid'));},className:"_1-hv _30yy _4nd4 _ftb"}):null),t?c('React').createElement(c('OzMessageQuickReplies.react'),{message:o}):null,s?c('React').createElement(c('OzMessageFeedback.react'),{message:o,onSave:function v(w){return c('OzAPI').updateMessage(q,w);}}):null);}});f.exports=l;}),null);
__d('OzInboxMessageGroup.react',['cx','OzHelpers','immutable','OzConfig','OzConstants','OzDate.react','OzInboxMessage.react','OzUserImage.react','OzImmutablePureRenderMixin','React','Reflux','Tooltip'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('React').PropTypes,k=c('OzConstants').AUTHOR_TYPES,l=c('React').createClass({displayName:'OzInboxMessageGroup',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{activeMsgID:j.string,authorID:j.string,authorType:j.oneOf(c('OzHelpers').values(k)),execTime:j.number,intentID:j.number,messages:j.array.isRequired,repNames:j.instanceOf(i).isRequired,thread:j.object.isRequired,timestamp:j.number.isRequired},scrollMessageIntoViewIfNeeded:function n(o){var p=this.refs[o];p?p.scrollIntoViewIfNeeded():c('OzHelpers').error('[inboxgroup] message id '+o+' not in group');},render:function n(){return c('React').createElement('div',{className:"_528w"},this._renderGroup());},_renderGroup:function n(){var o=this.props.authorType,p=k.BOT,q=k.TRAINER,r=k.USER;switch(o){case q:case p:return c('React').createElement('div',{className:(o===p?"_4m3p":'')+(o===q?' '+"_4m3r":'')},this._renderMessages(),this._renderBottomMeta());case r:return c('React').createElement('div',{className:"_4m3u"},c('React').createElement('div',{className:"_2wyu"},this._renderPhoto()),c('React').createElement('div',{className:"_2wyv"},this._renderMessages(),this._renderBottomMeta()));default:c('OzHelpers').error('got unk author type',this.props);return null;}},_renderPhoto:function n(){var o=c('OzHelpers').photo(this.props.thread),p=c('OzHelpers').getName(this.props.thread),q=c('OzHelpers').lastPresence(this.props.thread),r=c('OzDate.react').formatTimestamp(q);return c('React').createElement('div',{className:"_528y"},c('React').createElement('span',c('Tooltip').propsFor('Seen by '+p+' at '+r,'left'),c('React').createElement(c('OzUserImage.react'),{photo:o})));},_renderSeen:function n(){return c('React').createElement('div',{className:"_40ue"},this._renderPhoto());},_renderMessages:function n(){var o=this.props,p=o.messages,q=o.authorType,r=o.thread,s=o.activeMsgID;return c('React').createElement('div',{className:"_528z"},p.map(function(t){return c('React').createElement('div',{key:c('OzHelpers').msgID(t),ref:c('OzHelpers').msgID(t)},c('React').createElement(c('OzInboxMessage.react'),{authorType:q,isActive:c('OzHelpers').msgID(t)===s,message:t,threadID:c('OzHelpers').threadID(r)}),t.get('ui-seen')?this._renderSeen():null);}.bind(this)));},_renderBottomMeta:function n(){var o=this.props,p=o.authorID,q=o.execTime,r=o.intentID,s=o.repNames,t=o.thread,u=o.timestamp;return c('React').createElement('div',{className:"_4m3v"},c('React').createElement('div',null,c('React').createElement('span',{className:"_4m3w"},s.get(p)||p||null),c('React').createElement(c('OzDate.react'),{className:"_4m3x",timestamp:u})),this.state.config.getIn(['GK','responsivenessExecTime'])&&r!=null&&q!=null&&c('React').createElement('div',{className:"_5sme"},c('React').createElement('span',c('Tooltip').propsFor(m(c('OzHelpers').intentById(t,r)),'below'),'I'),' + ',c('OzHelpers').durationStr(q)));}});function m(){var n=arguments.length<=0||arguments[0]===undefined?i():arguments[0],o=n.get('name'),p=n.get('alias');return p&&o?p+' ('+o+')':p||o||'[unknown intent]';}f.exports=l;}),null);
__d('OzInboxMessageList.react',['cx','OzHelpers','immutable','OzConstants','OzInboxMessageGroup.react','OzLoading.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('React').PropTypes,m=c('OzLoading.react').Inline,n=20;i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;function o(){var u,v;'use strict';for(var w=arguments.length,x=Array(w),y=0;y<w;y++)x[y]=arguments[y];return v=(u=j.constructor).call.apply(u,[this].concat(x)),this.scrollToMessage=function(z){return k(this.refs).find(function(aa){return aa.props.messages.some(function(ba){return c('OzHelpers').msgID(ba)===z;});}).scrollMessageIntoViewIfNeeded(z);}.bind(this),this.$OzGroupList1=function(z,aa){var ba=this.props.thread,ca=z[0],da=z[z.length-1],ea=ca.get('sender'),fa=ca.get('author'),ga=ca.get('timestamp'),ha=da.get('timestamp'),ia=da.get('intent-id'),ja=da.get('executional-time'),ka=ea+ga;return c('React').createElement(c('OzInboxMessageGroup.react'),{authorID:fa,authorType:c('OzHelpers').authorType(ca),activeMsgID:this.props.activeMsgID,execTime:ja,intentID:ia,key:ka,messages:z,ref:ka,repNames:this.props.repNames,thread:ba,timestamp:ha});}.bind(this),v;}o.prototype.shouldComponentUpdate=function(u,v){'use strict';return !(this.props.activeMsgID===u.activeMsgID&&c('immutable').is(this.props.thread,u.thread)&&c('immutable').is(this.props.repNames,u.repNames)&&c('immutable').is(this.props.messages,u.messages));};o.prototype.render=function(){'use strict';var u=this.props.messages.reduceRight(r.bind(null,this.props.thread),{groupsList:[],nextTimestamp:null}).groupsList.map(this.$OzGroupList1);return c('React').createElement('frag',null,u);};o.propTypes={activeMsgID:l.string,messages:l.instanceOf(k).isRequired,repNames:l.instanceOf(k).isRequired,thread:l.instanceOf(k).isRequired};var p=c('React').createClass({displayName:'OzInboxMessageList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{activeMsgID:l.string,clientLimit:l.number.isRequired,loading:l.bool.isRequired,messages:l.instanceOf(k).isRequired,onScrollTop:l.func.isRequired,repNames:l.instanceOf(k).isRequired,thread:l.instanceOf(k).isRequired},componentDidMount:function u(){c('OzHelpers').scrollToBottom(this.refs.scrollable);},componentWillUpdate:function u(){this._wasScrolledToBottom=t(this.refs.scrollable);this._originalScrollHeight=this.refs.scrollable.scrollHeight;this._originalScrollTop=this.refs.scrollable.scrollTop;this._originalActiveMsgID=this._visiblyActiveMsgID();},componentDidUpdate:function u(v){var w=this._visiblyActiveMsgID();if(w&&w!==this._originalActiveMsgID){c('OzHelpers').debug('[messagelist] scrolling to active msg id '+w);this.refs.groupList.scrollToMessage(w);}else if(this._wasScrolledToBottom||s(v.messages,this.props.messages)||c('OzHelpers').threadID(v.thread)!==c('OzHelpers').threadID(this.props.thread)){c('OzHelpers').debug('[messagelist] scrolling bottom');c('OzHelpers').scrollToBottom(this.refs.scrollable);}else{var x=this.refs.scrollable.scrollHeight-this._originalScrollHeight+this._originalScrollTop;this.refs.scrollable.scrollTop=x;}},resize:function u(){this.componentDidUpdate(this.props);},_visibleMessages:function u(){var v=this.props,w=v.messages,x=v.clientLimit;return w.takeLast(x);},_visiblyActiveMsgID:function u(){var v=this.props.activeMsgID,w=this._visibleMessages();if(w.some(function(x){return c('OzHelpers').msgID(x)===v;}))return v;if(v)c('OzHelpers').debug('[messagelist] msg '+v+' not visible',w.toJS());return null;},render:function u(){var v=this.props,w=v.loading,x=v.sending,y=v.thread;return c('React').createElement('div',{onScroll:this._handleScroll,className:"_4fj7",ref:'scrollable'},c('React').createElement(m,{loading:w}),c('React').createElement(o,{activeMsgID:this.props.activeMsgID,thread:y,messages:this._visibleMessages(),ref:'groupList',repNames:this.props.repNames}),c('React').createElement(m,{loading:x}));},_handleScroll:function u(){if(this.refs.scrollable.scrollTop<n)this.props.onScrollTop();}});function q(u,v,w){var x=u.get('timestamp'),y=function aa(ba){var ca=ba>=x,da=!w||ba<w;return ca&&da;},z=v.get('last-seen');if(y(z))u=u.set('ui-seen',true);return u;}function r(u,v,w){var x=v.groupsList,y=v.nextTimestamp;w=q(w,u,y);var z=w.get('author'),aa=w.get('timestamp'),ba=c('OzHelpers').authorType(w),ca=x[0],da=ca&&ca[ca.length-1],ea=da&&da.get('author'),fa=da?da.get('timestamp'):Infinity,ga=da&&c('OzHelpers').authorType(da);if(ea!==z||fa-aa>60000||ga!==ba){x.unshift([w]);}else ca.unshift(w);return {groupsList:x,nextTimestamp:aa};}function s(u,v){var w=u.last(),x=v.last();return x.get('timestamp')>w.get('timestamp');}function t(u){return u.scrollHeight-u.scrollTop===u.clientHeight;}f.exports=p;}),null);
__d('OzIntentDropdown.react',['cx','Promise','immutable','OzSearchSource','React','SearchableDropdownInput.contrib','SearchableEntry'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('immutable').List,m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').PureComponent);j=i&&i.prototype;n.prototype.componentWillMount=function(){'use strict';this.$OzIntentDropdown1=new (c('OzSearchSource'))(function(s){var t=s.query;return c('Promise').resolve(o(t,this.props.witIntents));}.bind(this));};n.prototype.componentDidMount=function(){'use strict';var s=this.refs.dropdown;s&&s.focusInput();};n.prototype.render=function(){'use strict';var s=this.props,t=s.onSelect,u=s.selected;return c('React').createElement('div',{className:"_5yeg"},c('React').createElement(c('SearchableDropdownInput.contrib'),{ref:'dropdown',listClassName:"_2sg3",searchSource:this.$OzIntentDropdown1,value:u?r(u):null,onSelect:function v(w){return t(q(w));},placeholder:'Pick Intent',showSelectedSubtitle:false}));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={selected:m.instanceOf(k),witIntents:m.instanceOf(k).isRequired,onSelect:m.func.isRequired};function o(s,t){var u=function v(w){return w.map(r).toArray();};if(!s)return u(t.take(10));return u(p(t,s).take(10));}function p(s,t){var u=function w(x){return (x||'').toLowerCase().indexOf(t)>=0;},v=s.groupBy(function(w){return u(w.get('name'))?'with-name':'other';});return (v.get('with-name')||l()).concat((v.get('other')||l()).filter(function(w){return u(w.get('doc'));}));}function q(s){return k({name:s.getTitle(),doc:s.getSubtitle(),id:s.getUniqueID()});}function r(s){return new (c('SearchableEntry'))({title:s.get('name'),subtitle:s.get('doc'),uniqueID:s.get('id')});}f.exports=n;}),null);
__d('OzIntentCreator.react',['cx','OzAPI','OzHelpers','immutable','Keys','OzNotify','OzActions','OzDraggable.react','OzIntentDropdown.react','ReactComponentWithPureRenderMixin','React','Reflux'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Record,j=c('immutable').Map,k=c('React').PropTypes,l=i({shown:false,selected:null,mid:null}),m=c('Reflux').createStore({init:function t(){this.data=l();this.listenToMany(c('OzActions').intentCreator);},getInitialState:function t(){return this.data;},onSelect:function t(u){this._u(function(v){return v.set('selected',u);});},toggle:function t(u){this._u(function(v){return v.update('shown',function(w){return !w;}).set('mid',u);});},clear:function t(){this._u(function(u){return l();});},_u:function t(u){this.data=u(this.data);this.trigger(this.data);}}),n=c('React').createClass({displayName:'OzIntentCreator',mixins:[c('Reflux').connect(m,'store'),c('ReactComponentWithPureRenderMixin')],propTypes:{witIntents:k.instanceOf(j).isRequired,thread:k.instanceOf(j).isRequired},contextTypes:{router:k.object.isRequired},componentDidMount:function t(){document.addEventListener('keydown',this._handleKBShortcuts);this._unlisten=function(){document.removeEventListener('keydown',this._handleKBShortcuts);}.bind(this);},componentWillUnmount:function t(){this._unlisten();},render:function t(){if(!this.state.store.get('shown'))return null;var u=this.props.witIntents;return c('React').createElement(c('OzDraggable.react'),{className:"_1l0z"},c('React').createElement('div',{className:"_1l0-"},c('React').createElement('div',{className:"_1l0_"},c('React').createElement('div',{className:"_1l10"},'Intent'),c('React').createElement('div',{className:"_1l11"},c('React').createElement(c('OzIntentDropdown.react'),{witIntents:u.filterNot(q),selected:this._selected(),onSelect:c('OzActions').intentCreator.select}))),c('React').createElement('div',{className:"_1l14"},c('React').createElement(o,{color:'blue',onClick:this._handleSave},'Save'),c('React').createElement(o,{color:'grey',onClick:c('OzActions').intentCreator.clear},'Cancel'))));},_selected:function t(){var u=this.state.store.get('selected'),v=this.props.thread.get('intent-diag');return u||p(v,this.props.witIntents);},_handleSave:function t(){var u=this._selected(),v=this.props.thread;if(!u){c('OzNotify').error('You need to pick an intent!');return;}c('OzActions').intentCreator.clear();c('OzAPI').createIntent(c('OzHelpers').threadID(v),r(u,v.get('intent-diag'),this.state.store.get('mid'))).done(function(w){this.context.router.push(c('OzHelpers').threadPath({threadid:c('OzHelpers').threadID(w),intentid:w.getIn(['intents',-1,'id'])}));}.bind(this));},_handleKBShortcuts:function t(u){var v=this.state.store.get('shown');if(s(u)||u.which===c('Keys').ESC&&v){u.preventDefault();c('OzActions').intentCreator.toggle();}}}),o=c('OzHelpers').pure(function(t){var u=t.color,v=t.children,w=t.onClick;return c('React').createElement('button',{onClick:w,className:"_1-hv"+(' '+"_1l1b")+(u==='blue'?' '+"_1l1x":'')+(u==='grey'?' '+"_1l1y":'')},v);});function p(t,u){if(!t)return null;var v=u.get(t.get('wit-intent-uuid'));if(!v||q(v))return null;return v;}function q(t){return t.get('name').match(/^dialog_/);}function r(t,u,v){var w=j({name:t.get('name'),'wit-intent-uuid':t.get('id'),mid:v});return u&&w.get('wit-intent-uuid')===u.get('wit-intent-uuid')?w.merge(u):w;}function s(t){return t.getModifierState('Control')&&t.which==c('Keys').SPACE;}f.exports=n;}),null);
__d('OzInboxShow.react',['cx','Promise','OzStrings','OzAPI','OzHelpers','immutable','OzNotify','relativeTimeString.atlas','OzActions','OzButton.react','OzComposer.react','OzConfig','OzConfirmDialog.react','OzConstants','OzInboxMessageList.react','OzIntentCreator.react','OzStores','OzThreadLabels.react','OzUpdateDateTime.react','promiseFinally','OzImmutablePureRenderMixin','React','Reflux','Tooltip'],(function a(b,c,d,e,f,g,h){var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=c('OzConstants').AUTHOR_TYPES,m=c('OzStores').PendingMessageStateStore,n=c('OzThreadLabels.react').OzLabelList,o=c('OzConfig').ConfigStore,p=c('Reflux').createAction(),q=c('Reflux').createStore({init:function aa(){this._data=j();this.listenTo(p,this._onUpdateFetchState);},getInitialState:function aa(){return this._data;},_onUpdateFetchState:function aa(ba,ca){this._data=this._data.update(ba,function(da){return (da||j()).merge(ca);});this.trigger(this._data);}}),r='NO_OWNER',s=25,t=25,u=100,v=10000,w=c('React').createClass({displayName:'OzInboxShow',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(q,'fetchStates'),c('Reflux').connect(m,'pendingMessageState'),c('Reflux').connect(o,'config')],contextTypes:{uid:k.string.isRequired,router:k.object.isRequired},getInitialState:function aa(){return z();},componentDidMount:function aa(){this._init(this.props);var ba=c('OzActions').scrollThreadToTimestamp.listen(this._scrollToTimestamp);this._unlisten=function(){ba();};},componentWillReceiveProps:function aa(ba){if(c('OzHelpers').threadID(ba.thread)!==c('OzHelpers').threadID(this.props.thread)){c('OzHelpers').debug('[inboxshow] thread changed');this._init(ba);}if(c('OzHelpers').isUnread(ba.thread)&&c('OzHelpers').isOwner(ba.thread,this.context.uid))c('OzAPI').markRead(c('OzHelpers').threadID(ba.thread));},_init:function aa(ba){this.setState(z(),function(ca){if(!ba.thread.get('light-thread')&&x(ba.thread).size<s)this._fetchMessages();}.bind(this));},componentWillUnmount:function aa(){this._unlisten();},render:function aa(){var ba=this.state,ca=ba.fetchStates,da=ba.pendingMessageState,ea=ba.clientLimit,fa=ba.activeMsgID,ga=this.props,ha=ga.reps,ia=ga.thread,ja=ga.merchants,ka=ga.witIntents,la=x(ia),ma=c('OzHelpers').threadID(ia),na=da.get(ma,0)>0,oa=ha.map(function(qa){return qa.get('name');});if(fa)c('OzHelpers').debug('[inboxshow] Rendering with active msg id '+fa);var pa={humans:this.props.humans,onOwnerChange:this._handleOwnerChange,repNames:oa,reps:ha,requirements:this.props.requirements,thread:ia,witIntents:this.props.witIntents};return c('React').createElement('div',{className:"_1x8x"+(c('OzHelpers').hasTag(ia,'employee')?' '+"_1yyg":'')+(c('OzHelpers').hasEngage(ia)?' '+"_1fi":'')},c('React').createElement(c('OzIntentCreator.react'),{thread:ia,witIntents:ka}),c('React').createElement('div',{className:"_1x8y"},this._renderHistoryHeader(),c('React').createElement('div',{className:"_1x96"},c('React').createElement(c('OzInboxMessageList.react'),{activeMsgID:fa,clientLimit:ea,loading:!!ca.getIn([ma,'loading']),onScrollTop:this._fetchMessages,messages:la,ref:'messageList',repNames:oa,sending:na,thread:ia})),c('React').createElement('div',{className:"_237y"},c('React').createElement(c('OzComposer.react'),{merchants:ja,onResize:this._handleResize,thread:ia}))),c('React').cloneElement(this.props.children,pa));},_scrollToTimestamp:function aa(ba){var ca=c('OzHelpers').threadID(this.props.thread);c('OzHelpers').debug('[inboxshow] received request to scroll to ts '+ba);this.setState({activeMsgID:null});this._backloadHistoryUntil(ca,ba)['catch'](function(da){return c('OzActions').doneScrollingToTimestamp(ba,true);}).then(function(da){c('OzActions').doneScrollingToTimestamp(ba);if(c('OzHelpers').threadID(this.props.thread)!==ca){c('OzHelpers').debug('[inboxshow] aborting scroll because thread changed');}else{this.setState({clientLimit:this.state.clientLimit+da.size});var ea=da.isEmpty()?x(this.props.thread):da,fa=c('OzHelpers').msgID(ea.filter(function(ga){return c('OzHelpers').authorType(ga)===l.USER;}).findLast(function(ga){return ga.get('timestamp')<=ba;}));this._activateAndScrollToMsg(fa);}}.bind(this)).done();},_backloadHistoryUntil:function aa(ba,ca){var da=function ha(ia,ja){return c('OzAPI').history(ba,ia,u).then(function(ka){var la=y(ka,ia);if(la===ia||ka.isEmpty())throw la;var ma=ja.merge(ka);c('OzHelpers').debug('[inboxshow] got '+ma.size+'; dt='+(la-ca));var na=ka.filter(function(oa){return c('OzHelpers').authorType(oa)===l.USER;});return na.some(function(oa){return oa.get('timestamp')<=ca;})?ma:ha(la,ja.merge(ka));});},ea=this.state.fetchStates.getIn([ba,'timestamp']),fa=this._unseenButLoadedMessages(),ga=x(this.props.thread).filter(function(ha){return c('OzHelpers').authorType(ha)===l.USER;}).some(function(ha){return ha.get('timestamp')<=ca;});if(ga){c('OzHelpers').debug('[inboxshow] desired timestamp '+ca+' already loaded');return new (c('Promise'))(function(ha){return ha(fa);});}c('OzHelpers').debug('[inboxshow] backloading to ts '+ca+' from '+ea);return this._withFetchState(ba,ea,da(ea,j())).then(function(ha){return ha.merge(fa).sortBy(function(ia){return ia.get('timestamp');});});},_activateAndScrollToMsg:function aa(ba){this.setState({activeMsgID:ba},function(ca){window.setTimeout(function(){if(this.state.activeMsgID===ba){c('OzHelpers').debug('[inboxshow] CLEARING ACTIVE MSG ID');this.setState({activeMsgID:null});}}.bind(this),v);}.bind(this));},_withFetchState:function aa(ba,ca,da){var ea=this.state.fetchStates.get(ba,j());if(ea.get('loading')||ea.get('fetchedAll')){c('OzHelpers').debug('[inboxshow] already loading or at beginning of time');return new (c('Promise'))(function(fa){return fa();});}c('OzHelpers').debug('[inboxshow] performing load');p(ba,j({loading:true}));return c('promiseFinally')(da,function(fa){return p(ba,j({loading:false}));}).then(function(fa){var ga=y(fa,ca||Infinity);c('OzHelpers').debug('[inboxshow] loaded '+fa.size+'; ts='+ga);p(ba,j({fetchedAll:fa.isEmpty()||ga===ca,timestamp:ga}));return fa;});},_unseenButLoadedMessages:function aa(){return x(this.props.thread).skipLast(this.state.clientLimit);},_fetchMessages:function aa(){var ba=c('OzHelpers').threadID(this.props.thread),ca=this.state.fetchStates.getIn([ba,'timestamp']);this.setState({clientLimit:this.state.clientLimit+s});if(!this._unseenButLoadedMessages().isEmpty()){c('OzHelpers').debug('[inboxshow] using client cache instead of fetch');return;}this._withFetchState(ba,ca,c('OzAPI').history(ba,ca,t)).done();},_handleGrab:function aa(){c('OzAPI').grab(c('OzHelpers').threadID(this.props.thread));},_handleResize:function aa(){this.refs.messageList.resize();},_handleOwnerChange:function aa(ba){var ca=ba.value;if(ca&&ca!==r){var da=this.props.reps.get(ca),ea=this.props.thread,fa=c('OzHelpers').threadID(ea);if(!c('OzHelpers').hasOpenIntents(ea)){var ga='You must create an intent first';c('OzNotify').warn(ga);}else{if(da.get('is-coach')&&!c('OzHelpers').isEscalated(ea)){c('OzAPI').escalateTo(fa,ca);}else c('OzAPI').assignTo(fa,ca);if(!da.get('is-coach')&&c('OzHelpers').isEscalated(ea)){var ha='Please remove the "Escalated" tag to prevent the '+'thread from getting reassigned to a coach';c('OzNotify').warn(ha);}}}},_renderHistoryHeader:function aa(){var ba=this.props.thread,ca=c('OzHelpers').threadID(ba),da=c('OzHelpers').hasTag(ba,'employee')||c('OzHelpers').hasEngage(ba)?'light':'dark',ea=function ja(ka,la){return c('React').createElement(c('OzButton.react'),{onClick:la},ka);},fa=function(ja){return function(ka){c('OzHelpers').isOwner(ba,this.context.uid)?ja():c('OzActions').showDialog(c('OzConfirmDialog.react'),{onConfirm:ja,body:'You don\'t own this thread. If you proceed, the user '+'may be forgotten until they message us again.',header:'Are you sure this user doesn\'t need to be engaged?'});}.bind(this);}.bind(this),ga=c('OzHelpers').locationLastSeen(ba),ha=j({hour:'numeric',minute:'numeric'}),ia=(c('OzHelpers').timezone(ba)||'location unknown').replace(/_/g,' ');return c('React').createElement('div',{className:"_1q4l"},c('React').createElement('div',{className:"_4l-w"},c('React').createElement('h2',{className:"_1q4m"},c('OzHelpers').getName(ba)),c('React').createElement('div',{className:"_29x1"},ba.getIn(['location','timezone'])?c('React').createElement('span',c('Tooltip').propsFor('at the user\'s last known location, updated '+c('relativeTimeString.atlas')(+ga,true),'below'),c('React').createElement(c('OzUpdateDateTime.react'),{locale:'en-US',options:ha,timezoneOffset:ba.getIn(['location','timezone-offset'],0)}),' ('+ia+')'):c('React').createElement('span',null,'(location unknown)'))),c('React').createElement('div',{className:"_1q4n"},c('React').createElement(n,{className:"_1q4o",thread:ba,shade:da,removable:true,addable:true}),c('React').createElement('div',{className:"_1q4p"},c('OzHelpers').hasEngage(ba)&&ea('No need to engage',fa(function(ja){return c('OzAPI').notready(ca);})))));}}),x=c('OzHelpers').memoize(function(aa){return aa.get('messages').sortBy(function(ba){return ba.get('timestamp');});},function(aa){return aa.get('messages').hashCode();});function y(aa,ba){return aa.map(function(ca){return ca.get('timestamp');}).reduce(function(ca,da){return Math.min(ca,da);},ba);}function z(){return {activeMsgID:null,clientLimit:s};}f.exports=w;}),null);
__d('OzMerchantStatus.react',['cx','immutable','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.render=function(){'use strict';var n=this.props.merchant,o=n.get('approved'),p=n.get('blacklisted');return c('React').createElement('i',{className:"_4wc0"+(o?' '+"_4wbz":'')+(p?' '+"_4wb-":''),title:o&&'approved'||p&&'blacklisted'});};function m(){'use strict';i.apply(this,arguments);}m.propTypes={merchant:l.instanceOf(k).isRequired};f.exports=m;}),null);
__d('OzMerchantRow.react',['cx','OzAPI','OzHelpers','immutable','Layout.react','LeftRight.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','OzButton.react','OzMerchantDialog.react','OzMerchantStatus.react','OzImmutablePureRenderMixin','React','SUIAtlasTheme','SUINotice.react','XUIDialog.react'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('Layout.react').Column,k=c('Layout.react').FillColumn,l=c('React').PropTypes,m=c('React').createClass({displayName:'DeleteMerchantDialog',propTypes:{merchant:l.object.isRequired,onConfirm:l.func.isRequired},render:function o(){return c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},c('React').createElement('div',{className:"_4eby _2c9g"},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,'Delete merchant "'+this.props.merchant.get('name-dba')+'\"?')),c('React').createElement(c('SUINotice.react'),{theme:c('SUIAtlasTheme'),type:'error'},c('React').createElement('div',{className:"_4wby"},'This action is irreversible. Are you sure?'),c('React').createElement(c('LeftRight.react'),null,c('React').createElement(c('OzButton.react'),{onClick:c('OzActions').hideDialog},'Cancel'),c('React').createElement(c('OzButton.react'),{onClick:this.props.onConfirm},'Yes, permanently delete this merchant')))));},_handleToggle:function o(p){c('OzHelpers').debug('[merchantdialog] toggle',arguments);if(!p)c('OzActions').hideDialog();}}),n=c('React').createClass({displayName:'OzMerchantRow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{merchant:l.instanceOf(i).isRequired},render:function o(){var p=this.props.merchant,q=p.get('website'),r=function t(u){return '$'+(u?(u/100).toFixed(2):0);},s=function t(u){return u||0;};return c('React').createElement(c('Layout.react'),{className:"_59hd"},c('React').createElement(j,{className:"mrm _728"},c('React').createElement(c('OzMerchantStatus.react'),{merchant:p})),this._renderMerchantInfo('name-dba'),this._renderMerchantInfo('name-legal'),this._renderMerchantInfo('phone'),this._renderMerchantInfo('cumulative-transaction-amount',r),this._renderMerchantInfo('cumulative-transaction-count',s),c('React').createElement(k,{className:"mrm _4wc2 _4wc3"},c('React').createElement('a',{target:'_blank',href:q},q)),this._renderActions());},_renderMerchantInfo:function o(p,q){var r=this.props.merchant,s=r.get(p);if(q)s=q(s);return c('React').createElement(j,{className:"mrm _4wc2 _72a"},s);},_renderActions:function o(){var p=this._getActions();if(!p)return null;var q=p.map(function(r){var s=r.f,t=r.body;return c('React').createElement(c('OzButton.react'),{key:t,onClick:s},t);});return c('React').createElement(j,{className:"mrm _6w4"},q);},_getActions:function o(){var p=[],q=this.props.merchant;p.push({body:'Edit',f:this._handleMerchantEdit()});p.push({body:'Delete',f:this._handleMerchantDelete()});if(q.get('blacklisted')===true){p.push({body:'Whitelist',f:this._handleMerchantBlacklist(false)});}else p.push({body:'Blacklist',f:this._handleMerchantBlacklist(true)});return p;},_handleMerchantEdit:function o(){return function(p,q){var r=this.props.merchant;c('OzActions').showDialog(c('OzMerchantDialog.react'),{initialMerchant:r,title:'Edit merchant '+r.get('name-dba'),onMerchant:function s(t){c('OzAPI').editMerchant(t);c('OzActions').hideDialog();}});q();}.bind(this);},_handleMerchantBlacklist:function o(p){return function(q,r){var s=this.props.merchant;c('OzAPI').editMerchant(i({id:s.get('id'),blacklisted:p}));r();}.bind(this);},_handleMerchantDelete:function o(){return function(p,q){var r=this.props.merchant;c('OzActions').showDialog(m,{merchant:this.props.merchant,onConfirm:function s(){c('OzAPI').deleteMerchant(i({id:r.get('id')})).then(c('OzActions').hideDialog);}});q();}.bind(this);}});f.exports=n;}),null);
__d('OzMerchants.react',['cx','OzAPI','immutable','Layout.react','MessengerFlexScrollableArea.react','OzActions','OzButton.react','OzMerchantDialog.react','OzMerchantRow.react','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('Layout.react').Column,l=c('Layout.react').FillColumn,m=c('immutable').Map,n=c('React').PropTypes;i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=j.constructor).call.apply(p,[this].concat(s)),this.state={slice:25},this.$OzMerchants4=function(){c('OzActions').showDialog(c('OzMerchantDialog.react'),{onMerchant:function u(v){c('OzAPI').createMerchant(v);c('OzActions').hideDialog();}});},this.$OzMerchants2=function(){return c('React').createElement(c('Layout.react'),{className:"_726"},c('React').createElement(k,{className:"mrm _727 _728"},'Status'),this.$OzMerchants5('Name'),this.$OzMerchants5('Legal Name'),this.$OzMerchants5('Phone'),this.$OzMerchants5('Transaction total'),this.$OzMerchants5('Transaction count'),c('React').createElement(l,{className:"mrm _727"},'Website'),c('React').createElement(k,{className:"mrm _729"},c('React').createElement(c('OzButton.react'),{onClick:this.$OzMerchants4},'New merchant')));}.bind(this),this.$OzMerchants5=function(u){return c('React').createElement(k,{className:"mrm _727 _72a"},u);},this.$OzMerchants3=function(){var u=this.props.merchants.sortBy(function(v){return v.get('name-dba','').toLowerCase();}).toSeq().take(this.state.slice).map(function(v){return c('React').createElement(c('OzMerchantRow.react'),{key:v.get('name-dba'),merchant:v});}).valueSeq();return c('React').createElement(c('MessengerFlexScrollableArea.react'),{className:"_72b",onScroll:this.$OzMerchants6,ref:'scrollable'},u);}.bind(this),this.$OzMerchants1=function(){return c('React').createElement('div',null,'No merchants to show');},this.$OzMerchants6=function(){if(this.refs.scrollable.isScrolledToBottom())this.setState(function(u){return {slice:u.slice+25};});}.bind(this),q;}o.prototype.render=function(){'use strict';if(this.props.merchants.isEmpty())return this.$OzMerchants1();return c('React').createElement(c('Layout.react'),null,c('React').createElement(l,null,this.$OzMerchants2(),this.$OzMerchants3()));};f.exports=o;}),null);
__d('OzPerformance',['OzHelpers','OzStores','immutable','OzAPI','OzAJAX','OzReactMetrics'],(function a(b,c,d,e,f,g){var h=c('immutable').Map,i=1000*60,j=function p(){if(!window.performance||!window.performance.memory)return h({});var q=window.performance.memory,r=q.totalJSHeapSize,s=q.usedJSHeapSize,t=Math.round(100*s/r);return h({totalHeap:r,usedHeap:s,percent:t});},k=function p(){var q=Object.keys(c('OzStores')).map(function(s){return c('OzStores')[s];}),r=q.map(function(s){return s.metrics&&s.metrics();});return r.reduce(function(s,t){return s.merge(t);},h());},l=function p(){var q=c('OzAPI').metrics,r=q.getIn(['realtime','updated-thread-fetch-thread'],0),s=q.getIn(['realtime','updated-thread'],1),t=Math.round(100*r/s),u=q.getIn(['realtime','thread-metrics-update-thread'],0),v=q.getIn(['realtime','thread-metrics'],1),w=Math.round(100*u/v);return q.setIn(['realtime','percent-fetched'],t).setIn(['realtime','percent-metrics-stored'],w);},m=function p(){c('OzHelpers').info('[perf]',{memory:j().toJS(),stores:k().toJS(),api:l().toJS(),react:c('OzReactMetrics').metrics,ajax:c('OzAJAX').metrics});},n,o=function p(){n=window.setInterval(m,i);};f.exports={init:o,timer:n};}),null);
__d('ozFormatTime',[],(function a(b,c,d,e,f,g){'use strict';var h=3600,i=60;function j(k){var l=Math.floor(k/h);k%=h;var m=Math.floor(k/i);k%=i;var n=Math.round(k),o='';if(l)o+=l+'h ';if(m)o+=m+'m ';if(n)o+=n+'s';return o;}f.exports=j;}),null);
__d('OzEventShow.react',['cx','OzAPI','OzHelpers','immutable','OzActions','OzDate.react','ozFormatTime','OzImmutablePureRenderMixin','React','ShimButton.react'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzEventShow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{activeIntent:j.instanceOf(i).isRequired,event:j.instanceOf(i).isRequired},render:function q(){var event=this.props.event;switch(event.get('type')){case 'send-email':case 'receive-email':return c('React').createElement(m,{event:event,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply});case 'send-calendar':return c('React').createElement(l,{invite:event.get('data')});case 'completed-call':return c('React').createElement(n,{event:event,onCallPlay:this._handleCallPlay,onCallBack:this._handleCallBack});default:return c('React').createElement('div',null,'\'Not supported yet\'');}},_handleEmailView:function q(r){c('OzActions').emailComposer.add(babelHelpers['extends']({},c('OzHelpers').eventToEmail(r),{disabled:true}));},_handleEmailReply:function q(r){c('OzActions').emailComposer.add(c('OzHelpers').eventToEmail(c('OzHelpers').reEmail(r)));},_handleCallPlay:function q(r){return c('OzAPI').everstoreURI(r).then(function(s){return window.open(s);});},_handleCallBack:function q(r){c('OzActions').twilio.changeTo(r.getIn(['data','remote-phone']));c('OzActions').twilio.useIntent(this.props.activeIntent);}}),l=c('OzHelpers').pure(function(q){var r=q.invite;return c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement('div',{className:"_1h7v _p44"},c('React').createElement('span',{className:"_1h7r"},r.get('title'))),c('React').createElement(o,{label:'Location',row:r.get('location')||'n/a'}),c('React').createElement(o,{label:'Start',row:c('React').createElement(c('OzDate.react'),{timestamp:r.get('start')})}),c('React').createElement(o,{label:'End',row:c('React').createElement(c('OzDate.react'),{timestamp:r.get('end')})}));},'Invite'),m=c('OzHelpers').pure(function(q){var event=q.event,r=q.onEmailView,s=q.onEmailReply,t=event.get('type')==='send-email',u=event.get('data'),v='Email '+(t?'to '+u.get('to').join(', '):'from '+u.get('from'));return c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement('div',{className:"_1h7v _p44"},c('React').createElement('span',{className:"_1h7r"},v)),c('React').createElement(o,{label:'Subject',row:u.get('subject','[No subject]')}),c('OzHelpers').nonempty(u.get('cc'))?c('React').createElement(o,{label:'C.C.',row:u.get('cc').join(', ')}):null,c('OzHelpers').nonempty(u.get('bcc'))?c('React').createElement(o,{label:'B.C.C.',row:u.get('bcc').join(', ')}):null,c('React').createElement(o,{label:'Sent',row:c('React').createElement(c('OzDate.react'),{timestamp:u.get('sent-at')})}),c('React').createElement(p,{actions:c('immutable').fromJS([['View',function(w){r(t?event:c('OzHelpers').switchRecip(event));}],['Reply',function(w){s(t?event:c('OzHelpers').switchRecip(event));}]])}));},'Email'),n=c('OzHelpers').pure(function(q){var event=q.event,r=q.onCallPlay,s=q.onCallBack,t=event.get('data'),u={'in':'Call from ',out:'Call to ',voicemail:'Voicemail from '}[t.get('direction')],v=c('OzHelpers').parsePhoneNumber(t.get('remote-phone')),w=t.get('RecordingDuration'),x=t.get('recording-ev-handle'),y=x?[['Call Back',function(z){return s(event);}],['Play Voicemail',function(z){return r(x);}]]:[['Call Back',function(z){return s(event);}]];return c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement('div',{className:"_1h7v _p44"},c('React').createElement('span',{className:"_1h7r"},u+v)),c('React').createElement(o,{label:'Date',row:c('React').createElement(c('OzDate.react'),{timestamp:event.get('timestamp')})}),c('React').createElement(o,{label:'Duration',row:c('ozFormatTime')(w)}),c('React').createElement(p,{actions:c('immutable').fromJS(y)}));},'Call'),o=c('OzHelpers').pure(function(q){var r=q.label,s=q.row;return c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},r),c('React').createElement('div',{className:"_1h7y"},s));},'Row'),p=c('OzHelpers').pure(function(q){var r=q.actions;return c('React').createElement('div',{className:"_1h7t"},r.map(function(s){return c('React').createElement(c('ShimButton.react'),{className:"_47yc",key:s.first(),onClick:s.last()},s.first());}));},'ActionRow');f.exports=k;}),null);
__d('OzFeedbackCloseDialog.react',['cx','invariant','ix','OzHelpers','relativeTimeString.atlas','Image.react','immutable','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','OzBubblePreview.react','OzConfig','OzDate.react','OzFormPreview.react','React','ReactDOM','Reflux','TextAreaWithLineLimit.react','XUIButton.react','XUIRadioButtonGroup.react','XUISingleSelector.react'],(function a(b,c,d,e,f,g,h,i,j){var k,l,m=c('React').PropTypes,n=c('immutable').List,o=c('immutable').Map,p=c('immutable').OrderedMap,q=c('immutable').Set,r=c('OzFormPreview.react').Row,s='fulfilled',t='unfulfilled',u='deleted',v='completed',w='out-of-scope',x='not-completed-user-cancel',y='not-completed-user-wish-na',z='not-completed-other',aa='delete-irrelevant',ba='good',ca='no-need',da='opportunity',ea=p((k={},k[v]='Request Successfully Completed',k[w]='Request Out of Scope',k[x]='Request Not Completed:'+' User Changed Their Mind',k[y]='Request Not Completed: User Wish N/A',k[z]='Request Not Completed: Other Reason',k[aa]='Delete: Irrelevant Intent',k)),fa=p({'POL-LEGAL-FINANCIAL-MEDICAL':'1- Provide legal, financial, medical,'+' or professional advice or services','POL-INSURANCE':'2- Purchase insurance or provide quotes','POL-PERSONAL-ACCOUNTS':'3- Access personal accounts that require logins','POL-CREATIVE-CONTENT':'4- Develop creative content','POL-AUTHENTICATE':'5- Authenticate goods or services','POL-NEGOTIATE':'6- Negotiate pricing or trade of products or services','POL-FB-VIOLATION':'7- Activity violating FB\'s Statement'+' of Rights and Responsibilities','POL-TOBACCO-FIREARMS-ADULT':'8- Action violating FB/3rd party terms:'+' tobacco, firearms, adult products/services, etc','POL-FOREIGN-PURCHASE':'9- Facilitate foreign purchases','POL-DONATION':'10- Make donations or contributions in a customer\'s name','POL-MEDICAL-SEARCH-APPOINTMENT':'11- Search for medical products'+' or make medical appointments','POL-TRAVEL-UNDERAGED-SOLO':'12- Book travel for persons under the age'+' of 18 unless purchased by a user who is the parent or legal guardian'}),ga=o({flight_request:'Did you book the flight?',restaurant:'Did you book the restaurant?',restaurant_bar:'Did you book the restaurant?',ticket_purchase:'Did you buy the ticket?',movie_concert_show:'Did you buy the ticket?'}),ha='Objective_None',ia=o({restaurant:'M has finished working on your restaurant request.',restaurant_bar:'M has finished working on your restaurant request.',ticket_purchase:'M has finished working on your ticket request.',movie_concert_show:'M has finished working on your ticket request.',flight_request:'M has finished working on your air-travel request.'}),ja='option-not-presented',ka='really-bad-experience',la='other',ma=p((l={},l[ka]='Very bad experience; sending the survey'+' would make it worse',l[la]='Other',l)),na=function ta(ua){return ua.map(function(va,wa){return c('React').createElement(c('XUISingleSelector.react').Option,{key:va,value:wa},va);}).toList();};function oa(ta){switch(ta){case v:return s;case w:case x:case y:case z:return t;case aa:return u;default:return undefined;}}function pa(ta,ua){var va=ga.get(ua.get('name'),ha);return ta===v&&va!==ha;}var qa=c('React').createClass({displayName:'OzFeedbackCloseDialog',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{onFeedbackDone:m.func.isRequired,title:m.string,intent:m.instanceOf(o).isRequired,scheduleds:m.instanceOf(n).isRequired},getDefaultProps:function ta(){return {title:'Before closing, please tell us how well M did'};},getInitialState:function ta(){return {feedback:o({'close-state':'fulfilled','close-sub-state':v,'objective-reached':null,'not-completed-other':'','user-happy':0,'was-fast':true,'policy-value':fa.keySeq().first(),'automation-value':ba,'automation-opportunity':'','was-bug':false,'did-not-send-survey-reason':this._shouldAllowSendSurvey()?ka:ja}),willSendSurvey:this._shouldAllowSendSurvey(),scheduledsToCancel:q()};},_onCloseChange:function ta(ua){var va=this.props.intent;this.setState({feedback:this.state.feedback.set('close-state',oa(ua.value)).set('close-sub-state',ua.value).set('objective-reached',pa(ua.value,va))});},_onPolicyChange:function ta(ua){this.setState(function(va){var wa=va.feedback;return {feedback:wa.setIn(['policy-value'],ua.value)};});},_onReasonForNotSendingSurveyChange:function ta(ua){this.setState(function(va){var wa=va.feedback;return {feedback:wa.setIn(['did-not-send-survey-reason'],ua.value)};});},_makeOnChangeHandler:function ta(ua){return function(va){this.setState(function(wa){var xa=wa.feedback;return {feedback:xa.set(ua,va)};});}.bind(this);},componentDidMount:function ta(){var ua=this.refs['selector_close-sub-state']?c('ReactDOM').findDOMNode(this.refs['selector_close-sub-state'].refs.button):null;ua&&ua.focus();},render:function ta(){var ua=this.state.scheduledsToCancel&&this.state.scheduledsToCancel.count(),va=!ua&&'Close Intent'||ua===1&&'Close Intent and Delete 1 Scheduled Send'||'Close Intent and Delete '+ua+' Scheduled Sends';return c('React').createElement(c('MessengerDialog.react'),{onToggle:this._handleToggle,ref:'dialog',type:'default',width:544},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,this.props.title)),this._renderFields(),this._renderOptions(),this._renderTimeWarning(),c('React').createElement('div',{className:"_4k_x"},this._renderDialogAction(va,this._handleSave),this._renderDialogAction('Cancel',c('OzActions').hideDialog)));},_renderTimeWarning:function ta(){var ua=this.props.intent,va=ua.getIn(['params','datetime']),wa=va&&va.first()&&va.first().get('value')&&va.first().get('value').endsWith('07:00:00.000Z');return wa?c('React').createElement('div',{className:"_581n"},'The time set in this intent is 12am, and the AI might schedule some messages around that time. Are you sure you set the time correctly?'):null;},_renderDialogAction:function ta(ua,va){return c('React').createElement(c('XUIButton.react'),{onClick:va,className:"_42hl",label:ua});},_renderFields:function ta(){var ua=this.props.intent,va=this.state.feedback,wa=ga.get(ua.get('name'),ha);return c('React').createElement('div',{className:"_42hk"},c('React').createElement(r,{label:ua.get('name')},c('React').createElement('div',{className:"_8o2"},c('React').createElement('span',null,'Intent opened ',c('OzDate.react').formatTimestamp(ua.get('created-at'))),c('React').createElement('br',null),c('React').createElement('span',null,c('relativeTimeString.atlas')(ua.get('created-at'))))),c('React').createElement(r,{label:'Why are you closing this intent?'},c('React').createElement(c('XUISingleSelector.react'),{className:"_8o2",maxwidth:300,name:'selector_close-sub-state',ref:'selector_close-sub-state',onChange:this._onCloseChange,value:va.get('close-sub-state')},na(ea))),va.get('close-sub-state')===v&&wa!==ha&&c('React').createElement(r,{label:wa},c('React').createElement(c('XUIRadioButtonGroup.react'),{selectedValue:va.get('objective-reached'),onValueChange:this._makeOnChangeHandler('objective-reached'),selectedUse:'confirm',className:"_8o2"},c('React').createElement(c('XUIButton.react'),{value:true,label:'Yes'}),c('React').createElement(c('XUIButton.react'),{value:false,label:'No'}))),va.get('close-sub-state')===w&&c('React').createElement(r,{label:'What policy did the request violate?'},c('React').createElement(c('XUISingleSelector.react'),{maxwidth:1000,name:'selector_policy-value',size:'large',onChange:this._onPolicyChange,value:va.get('policy-value'),className:"_8o2"},na(fa))),va.get('close-sub-state')===z&&c('React').createElement(r,{label:'What was your reason?'},c('React').createElement(c('TextAreaWithLineLimit.react'),{value:va.get('not-completed-other'),onChange:this._makeOnChangeHandler('not-completed-other')})),c('React').createElement(r,{label:'How did the user seem?'},c('React').createElement(c('XUIRadioButtonGroup.react'),{className:"_8o2",selectedValue:va.get('user-happy'),onValueChange:this._makeOnChangeHandler('user-happy'),selectedUse:'confirm'},c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:j("40052"),title:'User loved it!'}),label:'User loved it!',labelIsHidden:true,value:4}),c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:j("40076"),title:'User was happy'}),label:'User was happy',labelIsHidden:true,value:3}),c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:j("40085"),title:'User was meh'}),label:'User was meh',labelIsHidden:true,value:2}),c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:j("40042"),title:'User was unhappy'}),label:'User was unhappy',labelIsHidden:true,value:1}),c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:j("316462"),title:'No Feedback'}),label:'No Feedback',labelIsHidden:true,value:0}))),c('React').createElement(r,{label:'Did the request go smoothly?'},c('React').createElement(c('XUIRadioButtonGroup.react'),{selectedValue:va.get('was-fast'),onValueChange:this._makeOnChangeHandler('was-fast'),selectedUse:'confirm',className:"_8o2"},c('React').createElement(c('XUIButton.react'),{value:true,label:'Yes: No Bugs and Good Automation'}),c('React').createElement(c('XUIButton.react'),{value:false,label:'No: I have something to report'}))),!va.get('was-fast')&&c('React').createElement(r,{label:'Did a bug affect your work on this request?'},c('React').createElement(c('XUIRadioButtonGroup.react'),{className:"_8o2",selectedValue:va.get('was-bug'),onValueChange:this._makeOnChangeHandler('was-bug'),selectedUse:'confirm'},c('React').createElement(c('XUIButton.react'),{value:false,label:'No'}),c('React').createElement(c('XUIButton.react'),{value:true,label:'Yes'}))),!va.get('was-fast')&&va.get('was-bug')&&c('React').createElement('div',{className:"_4k_y"},'Please',' ',c('React').createElement('a',{href:'https://our.intern.facebook.com/intern/tasks/?q=732683726825240',target:'_blank'},'create a task'),' or use the bugnub. Your feedback helps us make this product great!'),!va.get('was-fast')&&c('React').createElement(r,{label:'Did AI help?',tooltip:'i.e. auto sends, scheduled sends, bubble suggestions, ...'},c('React').createElement(c('XUIRadioButtonGroup.react'),{className:"_8o2",selectedValue:va.get('automation-value'),onValueChange:this._makeOnChangeHandler('automation-value'),selectedUse:'confirm'},c('React').createElement(c('XUIButton.react'),{value:ca,label:'There was no need'}),c('React').createElement(c('XUIButton.react'),{value:ba,label:'Yes, perfectly'}),c('React').createElement(c('XUIButton.react'),{value:da,label:'Could have been better'}))),!va.get('was-fast')&&va.get('automation-value')==da&&c('React').createElement('div',null,c('React').createElement('div',{className:"_4k_y"},'You can provide some feedback here or post in the',' ',c('React').createElement('a',{href:'https://www.facebook.com/groups/880028888735948/',target:'_blank'},'Feedback Group'),'.'),c('React').createElement(r,{label:'How could the AI be improved?'},c('React').createElement(c('TextAreaWithLineLimit.react'),{value:va.get('automation-opportunity'),onChange:this._makeOnChangeHandler('automation-opportunity')}))));},_renderOptions:function ta(){var ua=this.props.intent,va=this.state.feedback;return c('React').createElement('div',null,this._shouldAllowSendSurvey()&&c('React').createElement('div',{className:"_10-h"},c('React').createElement('input',{type:'checkbox',checked:this.state.willSendSurvey,onChange:this._handleToggleSendSurvey}),c('React').createElement('div',{className:"_10-i"},'Send survey and completion message to user:',c('React').createElement('br',null),c('React').createElement('span',{className:"_10-j"},'"',ia.get(ua.get('name')),'"'))),this._shouldAllowSendSurvey()&&!this.state.willSendSurvey&&c('React').createElement('div',{className:"_10-h"},c('React').createElement(r,{label:'Why have you decided not to send the survey?'},c('React').createElement(c('XUISingleSelector.react'),{className:"_8o2",maxwidth:400,onChange:this._onReasonForNotSendingSurveyChange,value:va.get('did-not-send-survey-reason')},na(ma)))),this.state.config.getIn(['GK','cancelRestaurant'])&&this._perhapsDisplayScheduleds());},_handleSave:function ta(){this.props.onFeedbackDone(this.props.intent,this._sanitizeFeedback(this.state.feedback.toJS()),this.state.willSendSurvey,this.state.scheduledsToCancel);c('OzActions').hideDialog();},_sanitizeFeedback:function ta(ua){if(ua['close-state']!==s)ua['objective-reached']=false;if(ua['close-sub-state']!==w)ua['policy-value']='';if(ua['close-sub-state']!==z)ua['not-completed-other']='';if(ua['was-fast']){ua['was-bug']=false;ua['automation-value']=ba;}if(ua['automation-value']!==da)ua['automation-opportunity']='';return ua;},_handleToggle:function ta(ua){if(!ua)c('OzActions').hideDialog();},_shouldAllowSendSurvey:function ta(){return ia.has(this.props.intent.get('name'));},_handleToggleSendSurvey:function ta(ua){this.setState({willSendSurvey:!this.state.willSendSurvey});},_handleScheduledItemClick:function ta(ua){o.isMap(ua)||i(0);this.setState(function(va){var wa=va.scheduledsToCancel;return {scheduledsToCancel:wa.has(ua)?wa.remove(ua):wa.add(ua)};});},_perhapsDisplayScheduleds:function ta(){var ua=this.props,va=ua.intent,wa=ua.scheduleds,xa={restaurant:'request_type',restaurant_bar:'request_type',appointment:'appt_action'}[va.get('name')],ya=xa&&va.getIn(['params',xa,0,'value']);if(q(['restaurant','restaurant_bar','appointment']).has(va.get('name'))&&ya==='cancel'&&!wa.isEmpty())return c('React').createElement('div',{className:"_10-h"},c('React').createElement('div',{className:"_10-i"},'Do you need to cancel any scheduled sends?'),c('React').createElement('div',{className:"_5c03"},c('React').createElement('div',{className:"_5c04"},wa.map(function(za,ab){return c('React').createElement(ra,{key:ab,item:za,isPendingCancel:this.state.scheduledsToCancel.has(za),onClick:this._handleScheduledItemClick});}.bind(this)))));return null;}});function ra(ta){var ua=ta.item,va=ta.onClick,wa=ta.isPendingCancel,xa=function(ya){switch(ua.get('type')){case 'send':var za=ua.getIn(['data','text']),ab=ua.getIn(['data','images']);return c('React').createElement('div',{className:"_5c05"},za&&'"'+za+'"',ab&&c('React').createElement(sa,{images:ab}));case 'suggest':return c('React').createElement('div',{className:"_5c05"},c('React').createElement(c('OzBubblePreview.react'),{bubble:ua.getIn(['data','suggestion']),meta:ua.get('meta'),source:ua.get('source')}));default:c('OzHelpers').debug('[feedbackCloseDialog] could not render scheduled item',ua);return null;}}();return c('React').createElement('div',{className:"_5c06"+(wa?' '+"_5c07":''),onClick:function ya(za){return va(ua);},role:'presentation'},c('React').createElement('div',{className:"_5c11"}),c('React').createElement('div',{className:"_5c12"},c('OzDate.react').formatTimestamp(ua.get('at'))),xa);}function sa(ta){var ua=ta.images;return c('React').createElement('div',{className:"_5c4_"},ua.map(function(va,wa){return c('React').createElement(c('Image.react'),{key:wa,className:"_1q16",src:va.get('url'),alt:va.get('filename')});}));}f.exports=qa;}),null);
__d('OzReminderTaskEditor.react',['cx','OzConstants','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','DatePickerRestraints','OzHelpers','immutable','InputLabel.react','ReactLayeredComponentMixin_DEPRECATED','LayerHideOnBlur','messengerButtonReact','React','XUIContextualDialog.react','XUIDateTimePicker.react','XUIError.react'],(function a(b,c,d,e,f,g,h){var i=c('OzConstants').REMINDERS,j=c('messengerButtonReact').jsComponent,k=c('immutable').Map,l=c('immutable').Set,m=c('React').PropTypes,n=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],o=c('immutable').fromJS({traffic:{label:'Include traffic update',params:[{name:'origin',placeholder:'Origin address',err:'What is the origin address?'},{name:'destination',placeholder:'Destination address',err:'What is the destination address?'}]},weather:{label:'Include weather forecast',params:[{name:'location',placeholder:'City',err:'What city is the forecast for?'},{name:'metric',placeholder:'Celsius or Fahrenheit',err:'You need to set Celsius or Fahrenheit'}]}}),p=c('OzHelpers').pure(function(s){var t=s.action,u=s.errors,v=s.onToggle,w=s.onUpdate,x=s.task,y=!!x.getIn(['data','actions',t]);return c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{type:'checkbox',checked:y,onChange:function z(aa){return v(aa,x,t);}}),c('React').createElement('label',null,o.getIn([t,'label']))),y&&c('React').createElement('div',null,o.getIn([t,'params']).map(function(z){var aa=z.get('name'),ba=['data','actions',t,aa],ca=x.getIn(ba);return c('React').createElement(c('XUIError.react'),{key:t+'-'+aa,xuiError:u.getIn([t,aa])},c('React').createElement('input',{type:z.get('type','text'),className:"_wbw",placeholder:z.get('placeholder'),value:ca,onChange:function da(ea){return w(ea,ba);}}));}).valueSeq()));}),q=c('OzHelpers').pure(function(s){var t=s.task,u=s.errors,v=s.onToggle,w=s.onUpdate;return c('React').createElement('div',null,c('React').createElement('h3',{className:"_17f0"},'Actions'),o.keySeq().map(function(x){return c('React').createElement(p,{key:x,action:x,task:t,errors:u,onToggle:v,onUpdate:w});}).valueSeq());}),r=c('React').createClass({displayName:'OzReminderTaskEditor',mixins:[c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{onSave:m.func.isRequired,seedTask:m.instanceOf(k),layered:m.bool,location:m.instanceOf(k).isRequired},getInitialState:function s(){return {shown:false,task:this.props.seedTask||k({type:'reminder',state:'waiting'}),errors:k()};},componentWillReceiveProps:function s(t){if(!c('immutable').is(t.seedTask,this.props.seedTask))this.setState({task:t.seedTask,errors:k()});},_renderBody:function s(){var t=this.state,u=t.task,v=t.errors,w=this.props.location,x=l(u.getIn(['schedule','repeat-condition','days']));return c('React').createElement('ul',{className:"_3ssq"},c('React').createElement('div',{className:"_wbu"},c('React').createElement(c('XUIDateTimePicker.react'),babelHelpers['extends']({xuiError:v.get('scheduled-time'),className:"_wbv",date:new Date(u.get('start-at',c('OzHelpers').serverNow())),allowDuplicateDateSelection:true,onChange:function(y){this.setState({task:c('OzHelpers').updateInWhen(u.set('start-at',+y).set('deadline',+y),['schedule'],function(z){return z.set('start-at',+y);})});}.bind(this)},c('OzHelpers').dateRestraints())),c('React').createElement(c('XUIError.react'),{xuiError:v.get('description')},c('React').createElement('input',{ref:'input',className:"_wbw",placeholder:'Describe the Reminder',value:u.getIn(['data','description']),onChange:function(y){this.setState({task:u.setIn(['data','description'],y.target.value)});}.bind(this)})),c('React').createElement('h3',{className:"_17f0"},'Recurrence'),n.map(function(y,z){var aa=z+1;return c('React').createElement(c('InputLabel.react'),{key:z},c('React').createElement('input',{type:'checkbox',checked:x.has(aa),onChange:function(ba){var ca=ba.target.checked?x.add(aa):x['delete'](aa);this.setState({task:u.set('schedule',k({'start-at':u.get('start-at'),frequency:'weekly',timezone:w.get('timezone'),'timezone-offset':w.get('timezone-offset'),'repeat-condition':k({spacing:1,days:ca.toList()})}))});}.bind(this)}),c('React').createElement('label',null,y));}.bind(this)),c('React').createElement(q,{task:u,errors:v,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),c('React').createElement('div',{className:"_wbz"},c('React').createElement(j,{label:this.props.seedTask?'Update Reminder':'Add Reminder',disabled:this.state.saving,onClick:this._handleSave,type:'primary'}))));},render:function s(){if(this.props.layered){var t=c('React').Children.only(this.props.children);return c('React').cloneElement(t,{onClick:function(u){return this.setState({shown:!this.state.shown});}.bind(this)});}return this._renderBody();},renderLayers:function s(){var t=this.state.shown;if(!t)return null;return {contextualDialog:c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')},position:'below',shown:t,contextRef:function(){return this;}.bind(this),onToggle:function(u){return this.setState({shown:u});}.bind(this)},this._renderBody())};},_handleActionToggle:function s(t,u,v){var w=t.target.checked?u.setIn(['data','actions'],k([[v,k()]])):u.deleteIn(['data','actions']);this.setState({task:w});},_handleActionUpdate:function s(t,u){this.setState({task:this.state.task.setIn(u,t.target.value)});},_handleSave:function s(){var t=this.state.task,u=t.get('start-at'),v=function y(z){return !!t.getIn(['actions',z]);},w=k(),x=c('OzHelpers').dateRestraints().dateRestraints;if(!u){w=w.set('scheduled-time','When would you like the reminder?');}else if(u<c('OzHelpers').serverNow()+60*1000){w=w.set('scheduled-time','Reminders should be in the future!');}else if(!c('DatePickerRestraints').isValidDate(new Date(u),x))w=w.set('scheduled-time','Reminder is outside of the '+i.RANGE_IN_YEARS+' year range');if(!t.getIn(['data','description']))w=w.set('description','What is the reminder about?');w=o.reduce(function(y,z,aa){if(v(aa))y=z.get('params').reduce(function(ba,ca){return t.getIn(['data','actions',aa,ca.get('name')])?ba:ba.setIn([aa,ca.get('name')],ca.get('err'));},y);return y;},w);this.setState({errors:w});if(w.size)return;this.setState({saving:true},function(y){this.props.onSave(t).then(function(z){if(this.props.layered)this.setState({shown:false,saving:false});}.bind(this))['catch'](function(z){return this.setState({saving:false});}.bind(this));}.bind(this));}});f.exports=r;}),null);
__d('OzIntentActions.react',['cx','Promise','OzAPI','OzHelpers','Image.react','immutable','joinClasses','OzActions','OzConfig','OzDraggable.react','OzReminderTaskEditor.react','OzImmutablePureRenderMixin','React','Reflux','XUICloseButton.react'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').Map,l=c('React').PropTypes,m=5*60000,n=10*60000,o=c('React').createClass({displayName:'OzIntentActions',propTypes:{intent:l.instanceOf(k).isRequired,location:l.instanceOf(k).isRequired,userEmail:l.string},mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{router:l.object.isRequired},getInitialState:function r(){return {reminderShown:false};},render:function r(){var s=this.state.config,t=s.get('display-tasks')||s.getIn(['GK','timeline']);return c('React').createElement('div',{className:c('joinClasses')("_x-r",this.props.className)},c('React').createElement('div',{className:(t?"_2p6s":'')+(!t?' '+"_ukm":''),style:this.props.timelineGK?{borderTop:'none'}:null},t?[['mail',this._handleEmail],['call',this._handleCall],['calendar',this._handleInvite],['todo',this._handleTask]].map(function(u){var v=u[0],w=u[1];return c('React').createElement('button',{key:v,className:"_1-hv _2p6t",onClick:w},c('React').createElement(c('Image.react'),{className:"_2p6u",id:v,src:'/images/oz/intent/'+v+'-2x.png'}));}):[['call',this._handleCall],['email',this._handleEmail],['invite',this._handleInvite]].map(function(u){var v=u[0],w=u[1];return c('React').createElement('button',{key:v,className:"_1-hv _ukn",onClick:w},v);})),this.state.reminderShown&&t?c('React').createElement(p,{onClose:this._handleCloseReminderTask,onCreate:this._handleCreateReminderTask,location:this.props.location}):null);},_handleTask:function r(){var s=this.props.intent,t=s.get('id'),u=s.get('user-id'),v=k({deadline:c('OzHelpers').serverNow()+n+m,'intent-id':t,'start-at':c('OzHelpers').serverNow()+n,state:'waiting',type:'reminder',data:{description:''}});c('OzAPI').createTask(u,v).then(function(w){this.context.router.push(c('OzHelpers').threadPath({threadid:u,intentid:t,taskid:w}));}.bind(this)).done();},_handleCreateReminderTask:function r(s){var t=this.props.intent;return c('OzAPI').createTask(t.get('user-id'),s.set('intent-id',t.get('id'))).then(function(u){return this.setState({reminderShown:false});}.bind(this));},_handleCloseReminderTask:function r(){this.setState({reminderShown:false});},_handleEmail:function r(){var s=this.props.intent;c('OzActions').emailComposer.add({intentId:s.get('id'),from:s.get('email-address')});},_handleInvite:function r(){c('OzActions').inviteComposer.create(this.props.intent.get('id'),this.props.userEmail,this.props.location.get('timezone'));},_handleCall:function r(){q(this.props.intent).done(function(s){return c('OzActions').twilio.useIntent(s);});}});i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;p.prototype.render=function(){'use strict';var r=this.props,s=r.onClose,t=r.onCreate,u=r.location;return c('React').createElement(c('OzDraggable.react'),{className:"_2jc4"},c('React').createElement('div',{className:"_2jc5"},'Reminder',c('React').createElement(c('XUICloseButton.react'),{onClick:s})),c('React').createElement(c('OzReminderTaskEditor.react'),{onSave:t,location:u}));};function p(){'use strict';i.apply(this,arguments);}p.propTypes={onClose:l.func.isRequired,onCreate:l.func.isRequired};function q(r){var s=r.get('phone-number');return s?c('Promise').resolve(r):c('OzAPI').addPhoneNumber(r.get('user-id'),r.get('id')).then(function(t){return r.merge(t);});}f.exports=o;}),null);
__d('OzIntentParams.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){return c('React').createElement('div',{className:"_3-ue"},this.props.children);};function k(){i.apply(this,arguments);}f.exports=k;}),null);
__d('OzIntentParamsAbstractField.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){return c('React').createElement('div',{className:"_5nij"+(!this.props.hasValue?' '+"_2ez0":'')},this.props.label?c('React').createElement('label',{className:"_2230 ellipsis"},this.props.label):null,c('React').createElement('div',{className:"_2ulp"},c('React').Children.only(this.props.children)));};function l(){i.apply(this,arguments);}l.propTypes={hasValue:k.bool,label:k.string};f.exports=l;}),null);
__d('OzIntentParamsTextField.react',['invariant','AbstractTextArea.react','DOMQuery','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React','ReactDOM','TextAreaControl'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntentParamsTextField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onAsk:i.func,onChange:i.func,question:i.string,value:i.string.isRequired},_control:null,componentDidMount:function k(){var l=c('DOMQuery').find(c('ReactDOM').findDOMNode(this),'textarea');this._control=new (c('TextAreaControl'))(l);this._control.setAutogrow(true);this._control.onupdate();},componentDidUpdate:function k(l,m){if(l.value!==this.props.value)this._control.onupdate();},render:function k(){return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.props.value,onAsk:this.props.onAsk,question:this.props.question},c('React').createElement(c('AbstractTextArea.react'),{onChange:this._handleChange,placeholder:this.props.label,value:this.props.value}));},_handleChange:function k(l){var m=l.target;m instanceof HTMLTextAreaElement||h(0);this.props.onChange&&this.props.onChange(m.value);}});f.exports=j;}),null);
__d('OzRequirementTokenizer.react',['immutable','OzImmutablePureRenderMixin','React','OzTokenizer.react'],(function a(b,c,d,e,f,g){var h=c('immutable').Map,i=c('immutable').List,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzRequirementTokenizer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{allRequirements:j.instanceOf(h).isRequired,onDeleteRequirement:j.func.isRequired,onCreateRequirement:j.func.isRequired,selectedRequirements:j.instanceOf(i),placeholder:j.string.isRequired,timeline:j.bool},getDefaultProps:function l(){return {timeline:false};},_requirementSort:function l(m){var n=this.props.witIntentUUID,o=m.get('wit-intent-uuids').has(n)?100000:0;return -(o+m.get('used-count',0));},render:function l(){var m=this.props,n=m.allRequirements,o=m.selectedRequirements,p=m.placeholder,q=m.onDeleteRequirement,r=m.onCreateRequirement,s=m.timeline;return c('React').createElement(c('OzTokenizer.react'),{placeholder:p,allTokens:n.toList(),chosenTokens:o,onDeleteToken:q,onCreateToken:r,resultRank:this._requirementSort,resultFilter:function t(u,v){return u.get('name').toLowerCase().indexOf(v.toLowerCase())>=0;},timeline:s});}});f.exports=k;}),null);
__d('OzTimestampScrolling.react',['cx','OzActions','React','Tooltip'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes,l=3000;i=babelHelpers.inherits(m,c('React').PureComponent);j=i&&i.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={state:null},this.$OzTimestampScrolling2=function(){this.setState({state:'loading'});c('OzActions').scrollThreadToTimestamp(this.props.timestamp);}.bind(this),o;}m.prototype.componentDidMount=function(){'use strict';this.$OzTimestampScrolling1=c('OzActions').doneScrollingToTimestamp.listen(function(n,o){if(this.props.timestamp===n)if(o){this.setState({state:'error'},function(p){window.setTimeout(function(q){this.setState({state:null});}.bind(this),l);}.bind(this));}else this.setState({state:null});}.bind(this));};m.prototype.componentWillUnmount=function(){'use strict';this.$OzTimestampScrolling1();};m.prototype.render=function(){'use strict';var n="_1e3l"+(!this.state.state?' '+"_1y5w":'')+(this.state.state==='loading'?' '+"_1y5x":'')+(this.state.state==='error'?' '+"_1y5y":'');return c('React').createElement('span',{className:n,onClick:this.$OzTimestampScrolling2,role:'presentation'},this.props.children);};m.propTypes={timestamp:k.number.isRequired};f.exports=m;}),null);
__d('OzSidebarItemHeader.react',['cx','fbt','OzHelpers','Keys','OzCheckboxInput.react','OzConfig','OzDate.react','OzTimestampScrolling.react','OzImmutablePureRenderMixin','React','Reflux','Tooltip','XUIAbstractGlyphButton.react','XUICloseButton.react','FBButtonMenuCombo.react','OzButton.react','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('FBButtonMenuCombo.react').Item,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzSidebarItemHeader',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{alias:k.string,closedAt:k.number,createdAt:k.number,creator:k.string,intentId:k.number,isBlocked:k.bool,isClosed:k.bool.isRequired,isExpanded:k.bool,label:k.string,onCancel:k.func,onChangeAlias:k.func,onIsExpandedToggle:k.func,onToggle:k.func,skipScrollToTimestamp:k.bool,subtitle:k.node,timelineGK:k.bool,title:k.string.isRequired},getDefaultProps:function n(){return {timelineGK:false};},getInitialState:function n(){return {isEditing:false};},render:function n(){var o=this.props,p=o.alias,q=o.className,r=o.closedAt,s=o.createdAt,t=o.intentId,u=o.isBlocked,v=o.isClosed,w=o.isExpanded,x=o.label,y=o.onCancel,z=o.onIsExpandedToggle,aa=o.onToggle,ba=o.skipScrollToTimestamp,ca=o.subtitle,da=o.timelineGK,ea=o.title,fa=v?r:s,ga=this.state.config.getIn(['GK','timeline']),ha=t&&ga?{color:'white'}:{},ia=t&&ga?{background:c('OzHelpers').color(t)}:{};return c('React').createElement('div',{className:c('joinClasses')(q,"_31gu"+(w?' '+"_31gx":'')+(u?' '+"_27qc":'')+(v&&!da?' '+"_31gy":''))},aa?c('React').createElement(c('OzCheckboxInput.react'),{checked:v,className:"_31gz",onChange:aa}):null,c('React').createElement('div',{className:"_31g-"},c('React').createElement('div',null,c('React').createElement('span',null,fa?ba?c('React').createElement(c('OzDate.react'),{className:"_56sd",timestamp:fa}):c('React').createElement(c('OzTimestampScrolling.react'),{timestamp:fa},c('React').createElement(c('OzDate.react'),{className:"_56sd",timestamp:fa})):null),c('React').createElement(m,{alias:p,isBlocked:u,isEditing:this.state.isEditing,name:ea,onChange:this._handleChangeAlias,onStartEditing:this._handleStartEditing,onCancelEditing:this._handleCancelEditing}),x?c('React').createElement('span',{className:"_5o4m"},x):null),c('React').createElement('span',{className:"_31h0"},ca)),c('React').createElement('div',{className:"_3_41"},this.props.children,z?c('React').createElement(c('XUIAbstractGlyphButton.react'),{className:"_31h1",label:i._("Ampliar"),labelIsHidden:true,onClick:z}):null,y&&c('React').createElement(c('XUICloseButton.react'),{onClick:y})));},_handleStartEditing:function n(){this.props.onChangeAlias&&this.setState({isEditing:true});},_handleCancelEditing:function n(){this.setState({isEditing:false});},_handleChangeAlias:function n(o){var p=this.props.onChangeAlias;if(o.which===c('Keys').RETURN){p&&p(o.target.value);this.setState({isEditing:false});}}}),m=c('OzHelpers').pure(function(n){var o=n.name,p=n.isBlocked,q=n.isEditing,r=n.alias,s=n.onChange,t=n.onStartEditing,u=n.onCancelEditing,v=n.style;return q?c('React').createElement('textarea',{className:"_31g_"+(' '+"_1p0b"),style:v,onKeyDown:s,placeholder:o,defaultValue:r,onBlur:u,ref:function w(x){if(x){x.focus();c('OzHelpers').moveCursorToInputEnd(x);}}}):c('React').createElement('span',babelHelpers['extends']({className:"_31g_"+(p?' '+"_7ok":''),style:v,onClick:t},c('Tooltip').propsFor(r?o:null)),r||o);});f.exports=l;}),null);
__d('OzGenericIntent.react',['ix','cx','Promise','OzAPI','fbglyph','OzHelpers','promiseFinally','Image.react','immutable','messengerButtonReact','OzButton.react','OzConfig','OzFormPreview.react','OzIntentActions.react','OzIntentParams.react','OzRequirementTokenizer.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','Reflux','OzIntentParamsTextField.react','Tooltip','OzDate.react','OzTimestampScrolling.react','URI','XUISingleSelector.react','Stars.react','OzActions','OzFeedbackCloseDialog.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('messengerButtonReact').jsComponent,k=c('immutable').List,l=c('immutable').Map,m=c('immutable').Set,n=c('React').PropTypes,o=c('OzFormPreview.react').Row,p=c('XUISingleSelector.react').Option,q=c('OzHelpers').pure(function(ba){var ca=ba.meta,da=ca&&ca.get('send-survey',false);if(da){var ea=ca.get('rating3')||'-1',fa=parseInt(ea,10);return c('React').createElement('div',{className:"_40k2"+(fa===1?' '+"_40k3":'')+(fa===0?' '+"_40k4":'')},fa===0?c('React').createElement('span',{title:'User says M is not done'},'Not Done'):c('React').createElement(c('Stars.react'),{count:fa,max:3,size:'small',title:ca.get('user-feedback')}));}else{var ga=ca&&ca.getIn(['feedback','did-not-send-survey-reason']);return c('React').createElement('div',{className:"_40k2"},c('React').createElement('span',null,ga==='option-not-presented'?c('React').createElement('span',{title:'Not relevant'},'N/A'):ga==='really-bad-experience'&&c('React').createElement('span',{className:"_40k3",title:'Survey not sent because of really bad ux'},'Bad')));}}),r=c('React').createClass({displayName:'OzGenericIntent',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{intent:n.instanceOf(l).isRequired,location:n.instanceOf(l).isRequired,notes:n.string.isRequired,onChangeAlias:n.func.isRequired,onClose:n.func.isRequired,onNotesChange:n.func.isRequired,onOpen:n.func.isRequired,onIsBlockedToggle:n.func.isRequired,onTriggerAI:n.func.isRequired,requirements:n.instanceOf(l).isRequired,onCreateRequirement:n.func,onDeleteRequirement:n.func,repNames:n.instanceOf(l).isRequired,userEmail:n.string,thread:n.instanceOf(l).isRequired,timelineGK:n.bool},render:function ba(){var ca=this.props,da=ca.intent,ea=ca.repNames,fa=ca.timelineGK,ga=c('OzHelpers').isDeleted(da);if(ga)return c('React').createElement('span',null);var ha=da.get('creator-fbid'),ia=ea.get(ha,ha),ja=da.get('blocked'),ka=c('OzHelpers').intentName(da);return c('React').createElement('div',{className:"_37lt"},c('React').createElement(c('OzSidebarItemHeader.react'),{alias:da.get('alias'),className:(!fa?"_a2q":'')+(fa?' '+"_37lv":''),intentId:da.get('id'),isClosed:c('OzHelpers').isClosedIntent(da),onClose:this._handleClose,closeState:da.get('state'),isBlocked:ja,onChangeAlias:this._handleChangeAlias,onFeedback:this._handleIntentFeedback,onToggle:this._handleToggle,onTriggerAI:this.props.onTriggerAI,timelineGK:fa,title:ka,creator:ia},this._renderTriggerAI()),this._renderBody());},_renderTriggerAI:function ba(){var ca=h("140058"),da=h("112825"),ea=this.state.config.getIn(['GK','timeline'])?ca:da;return c('React').createElement(c('OzButton.react'),babelHelpers['extends']({tight:true,onClick:this.props.onTriggerAI},c('Tooltip').propsFor('Rerun the AI for this intent')),c('React').createElement(c('Image.react'),{src:ea}));},_renderBody:function ba(){var ca=this.props,da=ca.intent,ea=ca.repNames,fa=ca.userEmail,ga=ca.location,ha=ca.thread,ia=ca.timelineGK,ja=ca.children,ka=da.get('creator-fbid'),la=ka===c('OzConfig').getStaticConfig('PAGE_ID')?'Bot':ka,ma='Created by '+ea.get(ka,la);return c('React').createElement('div',null,!ia?c('React').createElement(c('OzIntentActions.react'),{intent:da,userEmail:fa,location:ga}):null,c('React').createElement('div',{className:"_1x_z"},c('React').createElement(c('OzFormPreview.react'),null,c('React').createElement(o,{label:'Status',className:"_10sn"},c('React').createElement(t,{intent:da,thread:ha})),c('React').createElement(o,{label:'Created',tip:ma,className:"_10sn"},u(da.get('created-at'))),c('React').createElement(o,{label:'Closed',className:"_10sn"},u(da.get('closed-at'))),c('React').createElement(o,{label:'Assigned Bot',className:"_10sn"},da.get('assigned-bot')||'None'))),c('React').createElement('div',{className:"_10sn"},ja.length?c('React').createElement(c('OzIntentParams.react'),null,ja):null,c('React').createElement('div',{className:"_2qn_"},this.state.config.getIn(['GK','bookOnOpenTableButton'])&&x(da)?this._renderOpenTableButton():null,this.state.config.getIn(['GK','scriptRestaurantClose'])&&x(da)?this._renderAutomationTrigger():null)),c('React').createElement('div',{className:"_1x-e _10sn"},c('React').createElement(c('OzRequirementTokenizer.react'),{allRequirements:this.props.requirements,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,selectedRequirements:da.get('requirements'),placeholder:'Add a requirement/tag...'})),c('React').createElement(c('OzIntentParams.react'),null,c('React').createElement('div',{className:"_19ny"},c('React').createElement(c('OzIntentParamsTextField.react'),{label:'Add notes about this intent...',onChange:this.props.onNotesChange,value:this.props.notes}))),ia?c('React').createElement(c('OzIntentActions.react'),{intent:da,userEmail:fa,location:ga,timelineGK:ia}):null);},_renderOpenTableButton:function ba(){var ca=this.props,da=ca.thread,ea=ca.intent,fa=y(da,ea),ga=z(fa);if(!this.state.config.getIn(['GK','openTableAPI'])){return c('React').createElement(j,{className:(!(ga&&ga.length>0)?"_2qo0":'')+(' '+"_2qo1"),onClick:this._handleOpenTableClick,type:'primary',label:'Book on OT'});}else{var ha=ea.getIn(['params','request_type'],k()).first();if(!ha||ha.get('value')!=='reservation')return null;var ia=aa(ea),ja=!ia.isEmpty()?'Missing fields: '+ia.join(', '):'Book on OpenTable, schedule autosends, and send invite';return c('React').createElement(j,{className:(!ia.isEmpty()?"_2qo0":'')+(' '+"_2qo1"),onClick:this._handleOpenTableClick,type:'primary',label:'Book on OT via API',title:ja});}},_renderAutomationTrigger:function ba(){var ca=this.props.intent,da=ca.getIn(['params','request_type'],k()).first();if(!da||da.get('value')!=='reservation')return null;var ea=aa(ca),fa=!ea.isEmpty()?'Missing fields: '+ea.join(', '):'Send confirmation message, schedule autosends, and send invite';return c('React').createElement(j,{className:(!ea.isEmpty()?"_2qo0":'')+(' '+"_2qo1"),onClick:this._handleAutomationClick,type:'primary',label:'Run close automation',title:fa});},_handleAutomationClick:function ba(ca){var da=this.props,ea=da.thread,fa=da.intent,ga=c('OzHelpers').threadID(ea),ha=fa.get('id'),ia='close-restaurant',ja=c('OzHelpers').getRequirement(fa,ia),ka=ja?c('OzAPI').deleteIntentRequirement(ga,ha,ja.get('id')):c('Promise').resolve();return ka.then(function(){return c('OzAPI').createIntentRequirement(ga,ha,ia);});},_handleOpenTableClick:function ba(ca){var da=this.props,ea=da.thread,fa=da.intent,ga=y(ea,fa);if(ga.has('opentable-url'))if(this.state.config.getIn(['GK','openTableAPI'])&&ga.has('ts')&&ga.has('rid')&&ga.has('party-size')){c('OzAPI').bookOpenTable(c('OzHelpers').threadID(ea),fa.get('id'),ga.get('rid'),ga.get('ts'),ga.get('party-size'));}else{var ha=z(ga);if(ha.length)window.open(ha,'_blank').focus();}},_handleChangeAlias:function ba(ca){var da=this.props,ea=da.intent,fa=da.onChangeAlias;fa&&fa(ea,ca);},_handleOpen:function ba(){var ca=this.props,da=ca.intent,ea=ca.onOpen;ea(da.get('id'));},_handleClose:function ba(ca){var da=this.props,ea=da.intent,fa=da.onClose;fa(ea.get('id'),ca);},_handleIsBlockedToggle:function ba(){var ca=this.props,da=ca.intent,ea=ca.onIsBlockedToggle;ea(da);},_handleCreateRequirement:function ba(ca){var da=this.props,ea=da.intent,fa=da.onCreateRequirement;if(fa)fa(ea.get('id'),ca.get('name'));},_handleDeleteRequirement:function ba(ca){var da=this.props,ea=da.intent,fa=da.onDeleteRequirement;if(fa)fa(ea.get('id'),ca.get('id'));}}),s=['Active','Waiting','Closed'],t=c('React').createClass({displayName:'StatusDropdown',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intent:n.instanceOf(l).isRequired,thread:n.instanceOf(l).isRequired},getInitialState:function ba(){return {sem:0};},render:function ba(){var ca=this.props.intent,da=w(ca),ea=v(ca).set('rating3',da.rating3).set('user-feedback',da.feedback);return c('React').createElement('div',null,c('React').createElement(c('XUISingleSelector.react'),{maxHeight:240,onChange:this._handleChange,value:this._value(),disabled:this.state.sem!==0},s.map(function(fa){return c('React').createElement(p,{key:fa,value:fa},fa);})),c('React').createElement(q,{meta:ea}));},_value:function ba(){var ca=this.props.intent;return c('OzHelpers').isBlockedIntent(ca)&&'Waiting'||c('OzHelpers').isClosedIntent(ca)&&'Closed'||'Active';},_handleChange:function ba(ca){var da=ca.value;switch(da){case 'Active':this._handleOpen();break;case 'Waiting':this._handleWaiting();break;case 'Closed':this._handleIntentFeedback();break;default:c('OzHelpers').debug('[unknown intent state]');}},_sem:function ba(ca){var da=function(ea){return this.setState(function(fa){return {sem:fa.sem+ea};});}.bind(this);da(1);c('promiseFinally')(ca,function(ea){return da(-1);});},_handleOpen:function ba(){var ca=this.props.intent;this._sem(c('OzAPI').openIntent(ca.get('user-id'),ca.get('id')));},_handleWaiting:function ba(){var ca=this.props.intent;this._sem(c('OzAPI').blockIntent(ca.get('user-id'),ca.get('id')));},_handleIntentFeedback:function ba(){var ca=this.props,da=ca.intent,ea=ca.thread,fa=ea.get('events',k()).filter(function(ga){return m(['send','suggest']).has(ga.get('type'))&&ga.get('at',0)>c('OzHelpers').serverNow();}).sortBy(function(ga){return ga.get('at');});c('OzActions').showDialog(c('OzFeedbackCloseDialog.react'),{intent:da,scheduleds:fa,title:'Close Intent',onFeedbackDone:function(ga,ha,ia,ja){var ka=ha['close-state'];ja&&ja.map(function(la){return c('OzAPI').deleteScheduled(c('OzHelpers').threadID(ea),la.get('id'));});this._sem(c('OzAPI').closeIntent(ga.get('user-id'),ga.get('id'),ka,ha,ia));c('OzActions').hideDialog();}.bind(this)});}});function u(ba){return ba?c('React').createElement(c('OzTimestampScrolling.react'),{timestamp:ba},c('React').createElement(c('OzDate.react'),{timestamp:ba})):null;}function v(ba){return (ba.get('events',k()).filter(function(ca){return ca.get('type')==='close-intent';}).maxBy(function(ca){return ca.get('timestamp');})||l()).get('data',l());}function w(ba){var ca=(ba.get('events',k()).filter(function(da){return da&&da.getIn(['data','action'])==='intent_survey';}).last()||l()).getIn(['data','metadata'],'{}');return JSON.parse(ca);}function x(ba){var ca=ba.getIn(['metadata','category']);return ca==='restaurant';}function y(ba,ca){var da=l(),ea=ba.get('guesses',k()).filter(function(pa){return pa.get('class')==='suggestions';}).first(),fa=ea?ea.get('items',k()).filter(function(pa){return pa.get('type')==='bubble';}):k();if(fa.count()>0){var ga=fa.first().get('meta',l()),ha=ga.getIn(['open-table','url']),ia=ga.getIn(['open-table','rid']);da=da.set('rid',ia);if(ha&&ha.length>0){da=da.set('opentable-url',ha);var ja=ca.get('params',l()),ka=ja.get('datetime',k()).first(),la=ka?ka.get('value',''):'';if(la.length>0){var ma=new Date(la).getTime();da=da.set('ts',ma);}var na=ja.get('people_number',k()).first(),oa=na?na.get('value',0):0;if(oa>0)da=da.set('party-size',oa);}}return da;}function z(ba){var ca=ba.get('opentable-url');if(ca&&ca.length>0){var da=new (c('URI'))(ca),ea=ba.get('ts');if(ea){var fa=new Date().getTimezoneOffset()*60000,ga=new Date(ea-fa).toISOString().slice(0,-1);da.addQueryData('dateTime',ga);}var ha=ba.get('party-size',0);if(ha>0)da.addQueryData('covers',ha);return da.toString();}return '';}function aa(ba){var ca=k(['datetime','location','people_number','restaurant_name','place_id']);return ca.filterNot(function(da){return ba.getIn(['params',da]);});}f.exports=r;}),null);
__d('OzIntentParamsDateTimeField.react',['immutable','OzDateTimePicker.react','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=c('immutable').Map,j=c('React').createClass({displayName:'OzIntentParamsDateTimeField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:h.string,location:h.instanceOf(i).isRequired,onChange:h.func,value:h.instanceOf(Date)},getInitialState:function k(){return {timezone:this.props.location.get('timezone')};},render:function k(){return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.props.value,label:this.props.label},c('React').createElement(c('OzDateTimePicker.react'),{datePlaceholder:this.props.label,layout:'three-line',onChange:this._handleChange,showTimezoneName:false,timestamp:this.props.value&&this.props.value.getTime(),timezone:this.state.timezone}));},_handleChange:function k(l){var m=l.timezone,n=l.timestamp;this.props.onChange(new Date(n));this.setState({timezone:m});}});f.exports=j;}),null);
__d('OzIntentParamsEnumField.react',['immutable','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React','XUISingleSelector.react'],(function a(b,c,d,e,f,g){'use strict';var h=c('immutable').List,i=c('immutable').OrderedSet,j=c('React').PropTypes,k=c('XUISingleSelector.react').Option,l=c('React').createClass({displayName:'OzIntentParamsEnumField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:j.string,onChange:j.func,onSave:j.func,placeholder:j.string,values:j.arrayOf(j.string).isRequired,value:j.string},getInitialState:function m(){return {value:this.props.value||''};},render:function m(){var n=(this.state.value?i(this.props.values).add(this.state.value).toList():h(this.props.values)).map(function(o){return c('React').createElement(k,{key:o,value:o},o);}).unshift(c('React').createElement(k,{key:this.props.placeholder,value:''},this.props.placeholder));return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.state.value,label:this.props.label},c('React').createElement(c('XUISingleSelector.react'),{maxHeight:240,onChange:this._handleChange,value:this.state.value},n));},_handleChange:function m(n){this.props.onChange&&this.props.onChange(n.value);this.setState({value:n.value},this._save);},_save:function m(){if(this.props.onSave)this.props.onSave(this.state.value);}});f.exports=l;}),null);
__d('OzIntentParamsNumberField.react',['cx','FBNumberInput.react','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntentParamsNumberField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onChange:i.func,placeholder:i.string,value:i.number},render:function k(){return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:this.props.value!=null,label:this.props.label},c('React').createElement(c('FBNumberInput.react'),{className:"_3dag",onValueChange:this.props.onChange,placeholder:this.props.placeholder,value:this.props.value}));}});f.exports=j;}),null);
__d('OzLocationSearchSource',['WebAsyncSearchSource'],(function a(b,c,d,e,f,g){var h={allow_places:true,include_likes:false,include_subtext:true,include_address:1,limit:5,map_height:null,map_width:null,render_map:false,use_searchable_entries:true,use_unicorn:true},i=new (c('WebAsyncSearchSource'))({bootstrapRequests:[{uri:'/ajax/places/typeahead',data:h}],getAllForEmptyQuery:true,queryRequests:[{uri:'/ajax/places/typeahead',data:babelHelpers['extends']({},h,{hide_geo:true})}]});i.search('',function(j){return j;});f.exports=i;}),null);
__d('OzPlaceField.react',['cx','joinClasses','immutable','OzConfig','OzLocationSearchSource','ReactComponentWithPureRenderMixin','React','Reflux','SearchableEntry','XUIError.react','XUITypeahead.react'],(function a(b,c,d,e,f,g,h){var i=c('React').PropTypes,j=c('immutable').Map,k=c('React').createClass({displayName:'OzPlaceField',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:babelHelpers['extends']({disabled:i.bool,onQueryStringChange:i.func.isRequired,onSelect:i.func.isRequired,placeholder:i.string,queryString:i.string,selectedEntry:i.instanceOf(j)},c('XUIError.react').PropTypes),getDefaultProps:function n(){return {disabled:false,placeholder:'Place'};},render:function n(){var o=this.props,p=o.className,q=o.disabled,r=o.onQueryStringChange,s=o.onSelect,t=o.placeholder,u=o.queryString,v=o.selectedEntry,w=c('joinClasses')("_44sp"+(q?' '+"_44sq":''),p);return c('React').createElement(c('XUITypeahead.react'),{className:w,disabled:q,onChange:function x(y){return r(y.target.value);},onSelectAttempt:function x(y){return s(l(y));},placeholder:t,queryString:u,searchSource:c('OzLocationSearchSource'),selectedEntry:v&&v.get('id')&&v.get('name')?m(v):null,showEntriesOnFocus:true,tallInput:false,xuiErrorPosition:'left'});}});function l(n){return j({id:+n.getUniqueID(),name:n.getTitle(),description:n.getSubtitle(),photo:n.getPhoto()});}function m(n){return new (c('SearchableEntry'))({title:n.get('name'),subtitle:n.get('description'),uniqueID:n.get('id'),photo:n.get('photo')});}f.exports=k;}),null);
__d('OzIntentParamsPlaceField.react',['OzIntentParamsAbstractField.react','OzPlaceField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=c('React').createClass({displayName:'OzIntentParamsPlaceField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:h.string,onChange:h.func,onSave:h.func,placeholder:h.string,value:h.oneOfType([h.string,h.object])},render:function j(){var k=this.props,l=k.value,m=k.label,n=k.onChange,o=k.placeholder,p=l?typeof l==='string'?l:l.get('name')||'':'';return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!l,label:m},c('React').createElement(c('OzPlaceField.react'),{onQueryStringChange:n,onSelect:n,placeholder:o,queryString:p,selectedEntry:typeof l==='object'?l:null}));}});f.exports=i;}),null);
__d('OzIntentParamsPriceRangeField.react',['cx','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=[1,2,3,4],k=c('React').createClass({displayName:'OzIntentParamsPriceRangeField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onChange:i.func,value:i.oneOf(j)},render:function l(){var m=this.props.value;return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!m,label:this.props.label},c('React').createElement('span',{className:"_8l3"},j.map(function(n){return c('React').createElement('span',{className:"_8l4"+(m&&n<=m?' '+"_8l6":''),key:n,onClick:function(o){return this._handleDollarClick(o,n);}.bind(this),role:'presentation'},'$');}.bind(this))));},_handleDollarClick:function l(m,n){m.preventDefault();var o=this.props.value==n?null:n;this.props.onChange&&this.props.onChange(o);}});f.exports=k;}),null);
__d('OzIntentParamsStringField.react',['invariant','AbstractTextInput.react','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React','debounce'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntentParamsStringField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onChange:i.func,onSave:i.func,placeholder:i.string,value:i.string},getInitialState:function k(){return {value:this.props.value||''};},componentWillMount:function k(){this._save=c('debounce')(this._save,750,this,true);},render:function k(){return c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.state.value,label:this.props.label},c('React').createElement(c('AbstractTextInput.react'),{onChange:this._handleChange,placeholder:this.props.placeholder,type:'text',value:this.state.value}));},_handleChange:function k(l){var m=l.target;m instanceof HTMLInputElement||h(0);this.props.onChange&&this.props.onChange(m.value);this.setState({value:m.value},this._save);},_save:function k(){if(this.props.onSave)this.props.onSave(this.state.value);}});f.exports=j;}),null);
__d('OzIntentFactoryHelpers',['immutable','React','OzIntentParamsStringField.react','OzIntentParamsNumberField.react','OzIntentParamsPriceRangeField.react','OzIntentParamsEnumField.react','OzIntentParamsDateTimeField.react','OzIntentParamsPlaceField.react'],(function a(b,c,d,e,f,g){'use strict';var h=c('immutable').Map,i={makeStateUpdater:function l(m){return function(n){var o;this._setStateAndSave((o={},o[m]=n,o));};},makeStateExtractor:function l(m){return function(n){var o=n.get('params')||h(),p={};for(var q=m,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++];}else{s=q.next();if(s.done)break;t=s.value;}var u=t,v=u.name,w=u.type,x=j(o,v);switch(w){case 'string':case 'enum':p[v]=''+(x||'');break;case 'number':case 'pricerange':p[v]=+x||null;break;case 'datetime':p[v]=x&&new Date(x);break;case 'place':var y=j(o,'place_id');p[v]=h({id:y,name:x});break;}}return babelHelpers['extends']({},p,{notes:n.get('notes')||''});};},makeParamsUpdater:function l(m){return function(n,o){return (n||h()).withMutations(function(p){for(var q=m,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++];}else{s=q.next();if(s.done)break;t=s.value;}var u=t,v=u.name,w=u.type;switch(w){case 'datetime':var x=o[v],y=x?{value:x.toISOString(),grain:'minute'}:undefined;k(p,v,y);break;case 'place':var z=o[v];if(typeof z==='object'){k(p,'place_id',{value:z.get('id')});k(p,v,{value:z.get('name')});}else{k(p,'place_id',{value:null});k(p,v,{value:z});}break;default:k(p,v,{value:o[v]});break;}}});};},makeFieldRenderer:function l(m){return function(n){return m.map(function(o){var p=o.label,q=o.name,r=o.placeholder,s=o.type,t=o.values,u=i.getFieldComponent(s);return c('React').createElement(u,{key:q,label:p,location:n,onChange:this._changeHandlers.get(q),placeholder:r||p,value:this.state[q],values:t});}.bind(this));};},getFieldComponent:function l(m){switch(m){case 'string':return c('OzIntentParamsStringField.react');case 'number':return c('OzIntentParamsNumberField.react');case 'pricerange':return c('OzIntentParamsPriceRangeField.react');case 'enum':return c('OzIntentParamsEnumField.react');case 'datetime':return c('OzIntentParamsDateTimeField.react');case 'place':return c('OzIntentParamsPlaceField.react');default:throw new Error('OzIntentFactoryHelpers: Unknown field type '+m+'.');}}};function j(l,m){var n=l.get(m);if(n&&!n.isEmpty())return n.first().get('value');return null;}function k(l,m,n){l.set(m,c('immutable').fromJS([n]));}f.exports=i;}),null);
__d('OzIntentSchemas',[],(function a(b,c,d,e,f,g){'use strict';var h={get:function ma(na,oa){var pa=oa.getIn(['GK','scriptRestaurantClose']);switch(na){case 'restaurant':case 'restaurant_bar':return pa?k:j;case 'reminder':return l;case 'appointment':case 'nonmedical_appointment':return m;case 'local_search':return n;case 'good_purchase':return o;case 'customer_service':case 'customer_service_general':return p;case 'weather_forecast':return q;case 'hotel_and_accommodation':return r;case 'activities_things_to_do':return s;case 'ticket_purchase':case 'movie_concert_show':return t;case 'food_purchase':return u;case 'utility':return v;case 'book_car_transportation':case 'vehicle_service':return w;case 'traffic':return x;case 'navigation':return y;case 'flight_request':return z;case 'stocks':return aa;case 'moviebot_search_movie':return ba;case 'moviebot_search_screening_event':return ca;case 'moviebot_buy_ticket':return da;case 'moviebot_search_review':return ea;case 'moviebot_watch_trailer':return fa;case 'moviebot_provide_slot_value':return ga;case 'moviebot_reject':return ha;case 'moviebot_accept':return ia;case 'moviebot_greeting':return ja;case 'moviebot_help':return ka;case 'moviebot_other':return la;default:return i;}}},i={name:'Generic',fields:[]},j={name:'Restaurant',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','confirm','change','info','location','option']},{type:'string',name:'restaurant_name',label:'Name',placeholder:'Restaurant Name'},{type:'string',name:'restaurant_cuisine',label:'Cuisine'},{type:'string',name:'location',label:'Location'},{type:'number',name:'people_number',label:'Guests',placeholder:'Number of guests'},{type:'pricerange',name:'amount_of_money',label:'Price Range'},{type:'datetime',name:'datetime',label:'Date/Time'}]},k={name:'Restaurant',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','confirm','change','info','location','option']},{type:'place',name:'restaurant_name',label:'Name',placeholder:'Restaurant Name'},{type:'string',name:'restaurant_cuisine',label:'Cuisine'},{type:'string',name:'location',label:'Location'},{type:'number',name:'people_number',label:'Guests',placeholder:'Number of guests'},{type:'pricerange',name:'amount_of_money',label:'Price Range'},{type:'datetime',name:'datetime',label:'Date/Time'}]},l={name:'reminder',fields:[{type:'datetime',name:'datetime',label:'Reminder Time'},{type:'string',name:'reminder',label:'About'}]},m={name:'NonMedicalAppt',fields:[{type:'enum',name:'appt_action',label:'Action',placeholder:'Pick one...',values:['availability','cancel','move','confirm','book']},{type:'string',name:'appt_type',label:'Appt Type',placeholder:'Type of appointment'},{type:'string',name:'location',label:'Location',placeholder:'Location of appointment'},{type:'datetime',name:'datetime',label:'Datetime',placeholder:'Date and time of the appointment'},{type:'string',name:'local_search_query',label:'Name',placeholder:'Name of the place'}]},n={name:'LocalSearch',fields:[{type:'string',name:'local_query',label:'Query',placeholder:'Search query like yoga class...'},{type:'string',name:'location',label:'Location',placeholder:''},{type:'string',name:'local_name',label:'Name',placeholder:'Name of the place or business...'},{type:'datetime',name:'datetime',label:'Datetime',placeholder:''}]},o={name:'GoodPurchase',fields:[{type:'string',name:'good',label:'Good',placeholder:''},{type:'string',name:'provider',label:'Merchant',placeholder:''},{type:'string',name:'amount_of_money',label:'Price'},{type:'number',name:'good_number',label:'Items #',placeholder:'Number of Items'},{type:'string',name:'location',label:'Location',placeholder:''}]},p={name:'CustomerService',fields:[{type:'string',name:'provider',label:'Merchant'},{type:'string',name:'order_number',label:'Order #'}]},q={name:'Weather',fields:[{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Datetime'},{type:'string',name:'weather_type',label:'Type of forecast',placeholder:'temperature, snow, tide...'},{type:'string',name:'temperature_metric',label:'Metric',placeholder:'Celsius or Fahrenheit'}]},r={name:'Hotel',fields:[{type:'enum',name:'hotel_query_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','contact','extend','receipt']},{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Check in',placeholder:'Date and time of the appointment'},{type:'number',name:'night_number',label:'Nights #',placeholder:'Number of Nights'},{type:'number',name:'people',label:'People',placeholder:'Number of Guests'},{type:'string',name:'amount_of_money',label:'Price'},{type:'string',name:'hotel_name',label:'Hotel Name'}]},s={name:'Activities',fields:[{type:'string',name:'reservation_type',label:'Activity'},{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Datetime'},{type:'string',name:'amount_of_money',label:'Price'},{type:'number',name:'people_number',label:'People',placeholder:'Number of People'}]},t={name:'Tickets',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','info','location','option','price','receipt','time','schedule']},{type:'string',name:'event_type',label:'Type',placeholder:'Movie, show, concert...'},{type:'string',name:'event',label:'Name'},{type:'string',name:'event_venue',label:'Venue'},{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Datetime'},{type:'string',name:'amount_of_money',label:'Price'},{type:'number',name:'people_number',label:'Tickets #',placeholder:'Number of Tickets'}]},u={name:'FoodPurchase',fields:[{type:'string',name:'order',label:'Order',placeholder:''},{type:'string',name:'food_type',label:'Food Type',placeholder:''},{type:'string',name:'food_place',label:'Place'},{type:'enum',name:'delivery_type',label:'Delivery',placeholder:'Pick one...',values:['deliver','takeout']},{type:'string',name:'location',label:'Location',placeholder:''},{type:'datetime',name:'datetime',label:'Datetime'}]},v={name:'Utility',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','info','location','option','price','receipt','time','schedule']},{type:'string',name:'utility_provider',label:'Name',placeholder:'Name of the utility company'},{type:'string',name:'location',label:'Location',placeholder:''},{type:'string',name:'account_nbr',label:'Account #',placeholder:''}]},w={name:'Vehicle',fields:[{type:'enum',name:'hotel_query_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','info','location','option','price','receipt','time','schedule']},{type:'string',name:'from',label:'From'},{type:'string',name:'to',label:'To'},{type:'datetime',name:'datetime',label:'Datetime',placeholder:'Date and time of the ride'},{type:'string',name:'car_type',label:'Car Type',placeholder:'Type of car (limo, uber, lift...)'},{type:'string',name:'people_number',label:'People',placeholder:'Number of Guests'},{type:'string',name:'vehicle_provider',label:'Rental Name',placeholder:'Car rental name like Hertz, Avis..'}]},x={name:'Traffic',fields:[{type:'string',name:'from',label:'Starting Point'},{type:'string',name:'to',label:'Destination'},{type:'datetime',name:'datetime',label:'Date/Time',placeholder:'Intended departure time (not supported by automation)'}]},y={name:'Navigation',fields:[{type:'string',name:'from',label:'Starting Point'},{type:'string',name:'to',label:'Destination'},{type:'datetime',name:'datetime',label:'Date/Time',placeholder:'Intended departure time (not supported by automation)'}]},z={name:'flight_request',fields:[{type:'enum',name:'flight_query_type',label:'Action',placeholder:'Pick one...',values:['book','price','upgrade','flight_status','cancel','change']},{type:'string',name:'from',label:'From'},{type:'string',name:'to',label:'To'},{type:'datetime',name:'departure',label:'Departure'},{type:'datetime',name:'arrival',label:'Arrival'},{type:'string',name:'carrier',label:'Carrier'},{type:'string',name:'reference',label:'Reference #'},{type:'string',name:'passenger_num',label:'Passenger #'}]},aa={name:'stocks',fields:[{type:'string',name:'stock_symbol_list',label:'Stocks',placeholder:'Comma separated list of symbols'}]},ba={name:'moviebot_search_movie',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'location_text',label:'location - text',placeholder:'Part of message with location'},{type:'string',name:'location_entity',label:'location - entity',placeholder:'location referred to'},{type:'string',name:'theater_text',label:'theater - text',placeholder:'Part of message with theater'},{type:'string',name:'theater_entity',label:'theater - entity',placeholder:'theater referred to'},{type:'string',name:'datetime_text',label:'datetime - text',placeholder:'Part of message with datetime'},{type:'string',name:'datetime_entity',label:'datetime - entity',placeholder:'datetime referred to'},{type:'string',name:'screening_type_text',label:'screening_type - text',placeholder:'Part of message with screening_type'},{type:'string',name:'screening_type_entity',label:'screening_type - entity',placeholder:'screening_type referred to'},{type:'string',name:'age_rating_text',label:'age_rating - text',placeholder:'Part of message with age_rating'},{type:'string',name:'age_rating_entity',label:'age_rating - entity',placeholder:'age_rating referred to'},{type:'string',name:'genre_text',label:'genre - text',placeholder:'Part of message with genre'},{type:'string',name:'genre_entity',label:'genre - entity',placeholder:'genre referred to'}]},ca={name:'moviebot_search_screening_event',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'movie_text',label:'movie - text',placeholder:'Part of message with movie'},{type:'string',name:'movie_entity',label:'movie - entity',placeholder:'movie referred to'},{type:'string',name:'location_text',label:'location - text',placeholder:'Part of message with location'},{type:'string',name:'location_entity',label:'location - entity',placeholder:'location referred to'},{type:'string',name:'theater_text',label:'theater - text',placeholder:'Part of message with theater'},{type:'string',name:'theater_entity',label:'theater - entity',placeholder:'theater referred to'},{type:'string',name:'datetime_text',label:'datetime - text',placeholder:'Part of message with datetime'},{type:'string',name:'datetime_entity',label:'datetime - entity',placeholder:'datetime referred to'},{type:'string',name:'screening_type_text',label:'screening_type - text',placeholder:'Part of message with screening_type'},{type:'string',name:'screening_type_entity',label:'screening_type - entity',placeholder:'screening_type referred to'}]},da={name:'moviebot_buy_ticket',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'movie_text',label:'movie - text',placeholder:'Part of message with movie'},{type:'string',name:'movie_entity',label:'movie - entity',placeholder:'movie referred to'},{type:'string',name:'location_text',label:'location - text',placeholder:'Part of message with location'},{type:'string',name:'location_entity',label:'location - entity',placeholder:'location referred to'},{type:'string',name:'theater_text',label:'theater - text',placeholder:'Part of message with theater'},{type:'string',name:'theater_entity',label:'theater - entity',placeholder:'theater referred to'},{type:'string',name:'datetime_text',label:'datetime - text',placeholder:'Part of message with datetime'},{type:'string',name:'datetime_entity',label:'datetime - entity',placeholder:'datetime referred to'},{type:'string',name:'ticket_count_text',label:'ticket_count - text',placeholder:'Part of message with ticket_count'},{type:'string',name:'ticket_count_entity',label:'ticket_count - entity',placeholder:'ticket_count referred to'},{type:'string',name:'screening_type_text',label:'screening_type - text',placeholder:'Part of message with screening_type'},{type:'string',name:'screening_type_entity',label:'screening_type - entity',placeholder:'screening_type referred to'}]},ea={name:'moviebot_search_review',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'movie_text',label:'movie - text',placeholder:'Part of message with movie'},{type:'string',name:'movie_entity',label:'movie - entity',placeholder:'movie referred to'}]},fa={name:'moviebot_watch_trailer',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'movie_text',label:'movie - text',placeholder:'Part of message with movie'},{type:'string',name:'movie_entity',label:'movie - entity',placeholder:'movie referred to'}]},ga={name:'moviebot_provide_slot_value',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'movie_text',label:'movie - text',placeholder:'Part of message with movie'},{type:'string',name:'movie_entity',label:'movie - entity',placeholder:'movie referred to'},{type:'string',name:'location_text',label:'location - text',placeholder:'Part of message with location'},{type:'string',name:'location_entity',label:'location - entity',placeholder:'location referred to'},{type:'string',name:'theater_text',label:'theater - text',placeholder:'Part of message with theater'},{type:'string',name:'theater_entity',label:'theater - entity',placeholder:'theater referred to'},{type:'string',name:'datetime_text',label:'datetime - text',placeholder:'Part of message with datetime'},{type:'string',name:'datetime_entity',label:'datetime - entity',placeholder:'datetime referred to'},{type:'string',name:'ticket_count_text',label:'ticket_count - text',placeholder:'Part of message with ticket_count'},{type:'string',name:'ticket_count_entity',label:'ticket_count - entity',placeholder:'ticket_count referred to'},{type:'string',name:'screening_type_text',label:'screening_type - text',placeholder:'Part of message with screening_type'},{type:'string',name:'screening_type_entity',label:'screening_type - entity',placeholder:'screening_type referred to'},{type:'string',name:'age_rating_text',label:'age_rating - text',placeholder:'Part of message with age_rating'},{type:'string',name:'age_rating_entity',label:'age_rating - entity',placeholder:'age_rating referred to'}]},ha={name:'moviebot_reject',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'}]},ia={name:'moviebot_accept',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'}]},ja={name:'moviebot_greeting',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'}]},ka={name:'moviebot_help',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'}]},la={name:'moviebot_other',fields:[{type:'string',name:'message',label:'Message',placeholder:'Message being annotated'},{type:'string',name:'movie_text',label:'movie - text',placeholder:'Part of message with movie'},{type:'string',name:'movie_entity',label:'movie - entity',placeholder:'movie referred to'},{type:'string',name:'location_text',label:'location - text',placeholder:'Part of message with location'},{type:'string',name:'location_entity',label:'location - entity',placeholder:'location referred to'},{type:'string',name:'theater_text',label:'theater - text',placeholder:'Part of message with theater'},{type:'string',name:'theater_entity',label:'theater - entity',placeholder:'theater referred to'},{type:'string',name:'datetime_text',label:'datetime - text',placeholder:'Part of message with datetime'},{type:'string',name:'datetime_entity',label:'datetime - entity',placeholder:'datetime referred to'},{type:'string',name:'ticket_count_text',label:'ticket_count - text',placeholder:'Part of message with ticket_count'},{type:'string',name:'ticket_count_entity',label:'ticket_count - entity',placeholder:'ticket_count referred to'},{type:'string',name:'screening_type_text',label:'screening_type - text',placeholder:'Part of message with screening_type'},{type:'string',name:'screening_type_entity',label:'screening_type - entity',placeholder:'screening_type referred to'},{type:'string',name:'age_rating_text',label:'age_rating - text',placeholder:'Part of message with age_rating'},{type:'string',name:'age_rating_entity',label:'age_rating - entity',placeholder:'age_rating referred to'},{type:'string',name:'genre_text',label:'genre - text',placeholder:'Part of message with genre'},{type:'string',name:'genre_entity',label:'genre - entity',placeholder:'genre referred to'}]};f.exports=h;}),null);
__d('OzIntentFactory',['immutable','Map','OzAPI','OzGenericIntent.react','OzIntentFactoryHelpers','OzIntentSchemas','OzImmutablePureRenderMixin','React','debounce'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=new (c('Map'))(),j={get:function l(m,n){var o=c('OzIntentSchemas').get(m,n);if(!i.has(m))i.set(m,k(o));return i.get(m);}};function k(l){var m=c('immutable').Map,n=l.name,o=l.fields,p=10000,q=c('OzIntentFactoryHelpers').makeStateExtractor(o),r=c('OzIntentFactoryHelpers').makeFieldRenderer(o),s=c('OzIntentFactoryHelpers').makeParamsUpdater(o);return c('React').createClass({displayName:'Oz'+n+'DynamicIntent',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intent:h.instanceOf(m).isRequired,location:h.instanceOf(m).isRequired,onChangeAlias:h.func.isRequired,onClose:h.func.isRequired,onOpen:h.func.isRequired,onIsBlockedToggle:h.func.isRequired,onTriggerAI:h.func.isRequired,requirements:h.instanceOf(m).isRequired,repNames:h.instanceOf(m).isRequired,onCreateRequirement:h.func,onDeleteRequirement:h.func,thread:h.instanceOf(m).isRequired,userEmail:h.string},getInitialState:function t(){return babelHelpers['extends']({isEditing:false},q(this.props.intent));},componentWillMount:function t(){this._saveIntent=c('debounce')(this._saveIntent,500,this,true);this._changeHandlers=m().withMutations(function(u){for(var v=o,w=Array.isArray(v),x=0,v=w?v:v[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var y;if(w){if(x>=v.length)break;y=v[x++];}else{x=v.next();if(x.done)break;y=x.value;}var z=y;u.set(z.name,c('OzIntentFactoryHelpers').makeStateUpdater(z.name).bind(this));}}.bind(this));},componentWillReceiveProps:function t(u){var v=this.state.isEditing;if(c('immutable').is(u.intent,this.props.intent)||v)return;this.setState(q(u.intent));},componentWillUnmount:function t(){window.clearTimeout(this._editingTimeout);},render:function t(){return c('React').createElement(c('OzGenericIntent.react'),babelHelpers['extends']({},this.props,{notes:this.state.notes,onNotesChange:this._handleNotesChange}),this._renderFields(this.props.location));},_renderFields:r,_handleNotesChange:function t(u){this._setStateAndSave({notes:u});},_saveIntent:function t(){var u=this.props.intent;c('OzAPI').editIntent(u.get('user-id'),m({id:u.get('id'),params:s(u.get('params'),this.state),notes:this.state.notes}));},_setStateAndSave:function t(u){window.clearTimeout(this._editingTimeout);this.setState(babelHelpers['extends']({isEditing:true},u),this._saveIntent);this._editingTimeout=window.setTimeout(function(v){return this.setState({isEditing:false});}.bind(this),p);}});}f.exports=j;}),null);
__d('OzIntent.react',['OzAPI','OzHelpers','immutable','OzIntentFactory','OzImmutablePureRenderMixin','React','Reflux','OzConfig','OzWrapper.react'],(function a(b,c,d,e,f,g){'use strict';var h=c('immutable').Map,i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntent',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{intent:i.instanceOf(h).isRequired,requirements:i.instanceOf(h).isRequired,repNames:i.instanceOf(h).isRequired,location:i.instanceOf(h).isRequired,thread:i.instanceOf(h).isRequired},render:function k(){var l=this.props,m=l.intent,n=l.intentMeta,o=l.location,p=l.repNames,q=l.requirements,r=l.thread,s=l.timelineGK,t=c('OzIntentFactory').get(c('OzHelpers').intentName(m),this.state.config);return c('React').createElement(t,{key:m.get('id'),intent:m,intentMeta:n,onChangeAlias:this._handleChangeAlias,onClose:this._handleClose,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,onOpen:this._handleOpen,onIsBlockedToggle:this._handleIsBlockedToggle,onTriggerAI:this._handleTriggerAI,repNames:p,requirements:q,location:o,thread:r,timelineGK:s});},_handleClose:function k(l,m,n){c('OzAPI').closeIntent(c('OzHelpers').threadID(this.props.thread),l,m,n);},_handleOpen:function k(l){c('OzAPI').openIntent(c('OzHelpers').threadID(this.props.thread),l);},_handleDeleteRequirement:function k(l,m){c('OzAPI').deleteIntentRequirement(c('OzHelpers').threadID(this.props.thread),l,m);},_handleCreateRequirement:function k(l,m){c('OzAPI').createIntentRequirement(c('OzHelpers').threadID(this.props.thread),l,m);},_handleChangeAlias:function k(l,m){c('OzAPI').editIntent(l.get('user-id'),h({id:l.get('id'),alias:m}));},_handleIsBlockedToggle:function k(l){l.get('blocked')?c('OzAPI').unblockIntent(c('OzHelpers').threadID(this.props.thread),l.get('id')):c('OzAPI').blockIntent(c('OzHelpers').threadID(this.props.thread),l.get('id'));},_handleTriggerAI:function k(l,m){var n=this.props.intent;c('OzAPI').triggerAIForIntent(n.get('user-id'),n.get('id'));window.setTimeout(m,2500);}});f.exports=c('OzWrapper.react')(j);}),null);
__d('OzIntentEvents.react',['cx','OzAPI','OzHelpers','ozFormatTime','immutable','OzConfig','OzDate.react','OzTimestampScrolling.react','React','Reflux','Tooltip','OzActions'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzIntentEvents',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{intent:k.instanceOf(i).isRequired},render:function z(){var aa=this.props.intent,ba=(aa.get('events')||j()).toList(),ca=ba.filter(function(ga){return ga.get('type')==='completed-call';}),da=ba.filter(function(ga){return ga.get('type')==='send-email'||ga.get('type')==='receive-email';}),ea=ba.filter(function(ga){return ga.get('type')==='send-calendar';}),fa=ba.filter(function(ga){return ga.get('type')==='book-reservation'&&ga.getIn(['data','confirmation-number']);});return c('React').createElement('div',{className:"_4h0y"},c('React').createElement(s,{header:'Calls',events:ca,onCallPlay:p}),c('React').createElement(s,{header:'Emails',events:da}),c('React').createElement(s,{header:'Invites',events:ea}),c('React').createElement(s,{header:'Reservations',events:fa}));}}),m=function z(aa){c('OzActions').emailComposer.add(babelHelpers['extends']({},c('OzHelpers').eventToEmail(aa),{disabled:true}));},n=function z(aa){c('OzActions').emailComposer.add(c('OzHelpers').eventToEmail(c('OzHelpers').reEmail(aa)));},o=function z(aa){c('OzActions').inviteComposer.add(c('OzHelpers').eventToInvite(aa));},p=function z(aa){return c('OzAPI').everstoreURI(aa).then(function(ba){return window.open(ba);});},q=function z(aa){window.open(aa.getIn(['data','opentable-listing','url']));},r=function z(aa){return -aa.get('id');},s=c('OzHelpers').pure(function(z){var aa=z.header,ba=z.events;return ba&&!ba.isEmpty()?c('React').createElement('details',{open:true},c('React').createElement('summary',{className:"_177e _3_lv"},aa,'... (',ba.count(),')'),c('React').createElement('div',{className:"_4h0z"},ba.map(function(event){return c('React').createElement(t,{orderBy:r,event:event,key:event.get('id')});}))):null;}),t=c('OzHelpers').pure(function(z){var event=z.event,aa=z.orderBy,ba=event.get('data');switch(event.get('type')){case 'send-email':return c('React').createElement(y,{order:aa(event),sign:'@',subtitle:ba.get('subject'),actions:[['VIEW',function(fa){return m(event);}],['REPLY',function(fa){return n(event);}]]},c('React').createElement(v,{data:ba,type:'to'}));case 'receive-email':return c('React').createElement(y,{order:aa(event),sign:'@',subtitle:ba.get('subject'),actions:[['VIEW',function(fa){return m(c('OzHelpers').switchRecip(event));}],['REPLY',function(fa){return n(c('OzHelpers').switchRecip(event));}]]},c('React').createElement(v,{data:ba,type:'from'}));case 'send-calendar':return c('React').createElement(y,{order:aa(event),sign:'@',subtitle:ba.get('title'),timestamp:ba.get('start'),actions:[['VIEW',function(fa){return o(event);}]]},c('React').createElement(w,{data:ba}));case 'completed-call':return c('React').createElement(x,{event:event,onCallPlay:p,orderBy:aa});case 'book-reservation':var ca=new Date(ba.get('ts')),da=c('OzHelpers').toLocaleDate(ca)+' at '+c('OzHelpers').toLocaleTime(ca),ea='Table for '+ba.get('covers')+' on '+da;return c('React').createElement(y,{order:aa(event),sign:'',subtitle:ea,event:event,actions:[['VIEW',function(fa){return q(event);}]]});default:return null;}}),u=function z(aa){if(!aa)return j();if(typeof aa.join==='function')return aa;return j([aa]);},v=c('OzHelpers').pure(function(z){var aa=z.data,ba=z.type,ca=(ba==='to'?'Sent':'Received')+' at '+c('OzHelpers').toLocaleTime(aa.get('sent-at'))+' on '+c('OzHelpers').toLocaleDate(aa.get('sent-at')),da=ba==='from'?aa.get('from'):u(aa.get('to')).join(', '),ea=ba==='to'?'To':'From';return c('React').createElement('span',c('Tooltip').propsFor(ca),ea,' ',c('React').createElement('strong',null,da));}),w=c('OzHelpers').pure(function(z){var aa=z.data,ba='Sent at '+c('OzHelpers').toLocaleTime(aa.get('sent-at'))+' on '+c('OzHelpers').toLocaleDate(aa.get('sent-at'));return c('React').createElement('span',c('Tooltip').propsFor(ba),c('React').createElement('strong',null,u(aa.get('to')).join(', ')||null));}),x=c('OzHelpers').pure(function(z){var event=z.event,aa=z.onCallPlay,ba=z.orderBy,ca=event.get('data'),da={'in':'Call from',out:'Call to',voicemail:'Voicemail from'}[ca.get('direction')],ea=c('OzHelpers').parsePhoneNumber(ca.get('remote-phone')),fa=ca.get('RecordingDuration'),ga=ca.get('recording-ev-handle'),ha=ga?[['PLAY',function(ia){return aa(ga);}]]:[];return c('React').createElement(y,{order:ba(event),sign:'#',subtitle:c('ozFormatTime')(+fa),timestamp:event.get('timestamp'),actions:ha},c('React').createElement('span',null,da,' ',c('React').createElement('strong',null,ea)));}),y=c('OzHelpers').pure(function(z){var aa=z.sign,ba=z.children,ca=z.subtitle,da=z.actions,ea=z.timestamp,fa=z.order;return c('React').createElement('div',{className:"_25js",style:{order:fa}},c('React').createElement('div',{className:"_4h12"},aa),c('React').createElement('div',{className:"_4h18"},c('React').createElement('div',null,ba),c('React').createElement('div',null,ca,ca&&ea?c('React').createElement('span',null,' \u2014 '):null,ea?c('React').createElement(c('OzTimestampScrolling.react'),{timestamp:ea},c('React').createElement(c('OzDate.react'),{timestamp:ea,className:"_3_lw"})):null)),c('React').createElement('div',{className:"_4h19"},da.map(function(ga,ha){var ia=ga[0],ja=ga[1];return c('React').createElement('div',{key:ha},c('React').createElement('button',{key:ha,className:"_1-hv _30yy _4h1a",onClick:ja},ia));})));});f.exports={OzIntentEvents:l,EventContainer:t};}),null);
__d('OzIntentList.react',['cx','OzHelpers','immutable','OzIntentEvents.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','OzWrapper.react','ReactDOM','ReactRouter'],(function a(b,c,d,e,f,g,h){var i=c('OzIntentEvents.react').OzIntentEvents,j=c('React').PropTypes,k=c('ReactRouter').Link,l=c('React').createClass({displayName:'OzIntentList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{activeIntentId:j.number,intents:j.instanceOf(c('immutable').List).isRequired,timelineGK:j.bool},componentDidMount:function n(){var o=c('ReactDOM').findDOMNode(this.refs[this.props.activeIntentId]);o&&o.scrollIntoViewIfNeeded();},componentDidUpdate:function n(o){var p=this.props,q=p.activeIntentId,r=p.isHistory,s=c('ReactDOM').findDOMNode(this.refs[q]);if(s&&(o.activeIntentId!==q||o.isHistory!==r))s.scrollIntoViewIfNeeded();},render:function n(){return c('React').createElement('div',null,this.props.intents.map(this._renderIntent));},_renderIntent:function n(o){var p=o.get('id'),q=this.props,r=q.activeIntentId,s=q.timelineGK,t=r===p;return c('React').createElement(m,{ref:p,key:p,intent:o,isExpanded:t,timelineGK:s});}}),m=c('OzHelpers').pure(function(n){var o=n.intent,p=n.isExpanded,q=n.timelineGK;return c('React').createElement('div',null,c('React').createElement(k,{className:"_qsr",to:c('OzHelpers').threadPath({threadid:o.get('user-id'),intentid:o.get('id')})},c('React').createElement(c('OzSidebarItemHeader.react'),{alias:o.get('alias'),className:"_qsu"+(p?' '+"_qsv":''),closedAt:o.get('closed-at'),closeState:o.get('state'),createdAt:o.get('created-at'),isBlocked:o.get('blocked'),isClosed:c('OzHelpers').isClosedIntent(o),label:c('OzHelpers').isOpenIntent(o)&&o.get('assigned-bot')?'BOT':null,skipScrollToTimestamp:true,title:c('OzHelpers').intentName(o),timelineGK:q})),p&&c('React').createElement(i,{intent:o}));});f.exports=c('OzWrapper.react')(l);}),null);
__d('OzIntentTabs.react',['cx','OzHelpers','immutable','OzImmutablePureRenderMixin','React','ReactRouter'],(function a(b,c,d,e,f,g,h){var i=c('ReactRouter').Link,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzIntentTabs',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intents:k.instanceOf(j).isRequired,tasks:k.instanceOf(j).isRequired,threadId:k.string.isRequired,activeIntentId:k.number},render:function n(){var o=this.props,p=o.activeIntentId,q=o.intents,r=o.tasks,s=o.threadId;return c('React').createElement('div',{className:"_27fz"},c('React').createElement(i,{className:"_27f-"+(!p?' '+"_27f_":''),to:c('OzHelpers').threadPath({threadid:s})},'All tasks'),q.map(function(t){return c('React').createElement(m,{key:t.get('id'),intent:t,tasks:r,activeIntentId:p});}));}}),m=c('OzHelpers').pure(function(n){var o=n.intent,p=n.activeIntentId,q=n.tasks,r=o.get('id')===p,s=c('OzHelpers').isBlockedIntent(o),t=c('OzHelpers').isClosedIntent(o),u=c('OzHelpers').nextTaskForIntent(o,q);return c('React').createElement(i,{className:"_27f-"+(r?' '+"_27f_":'')+(s||t?' '+"_xpo":''),to:c('OzHelpers').threadPath({threadid:o.get('user-id'),intentid:o.get('id'),taskid:u&&u.get('id')})},o.get('alias',o.get('name')));});f.exports=l;}),null);
__d('OzReminderNotesField.react',['OzIntentParamsTextField.react','OzImmutablePureRenderMixin','React','debounce'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=c('React').createClass({displayName:'OzReminderNotesField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{seedNotes:h.string,onSave:h.func.isRequired},getInitialState:function j(){return {notes:this.props.seedNotes||''};},componentWillMount:function j(){this._save=c('debounce')(this._save,750,this,true);},render:function j(){return c('React').createElement(c('OzIntentParamsTextField.react'),{label:'Add notes about this reminder...',onChange:this._handleChange,value:this.state.notes});},_handleChange:function j(k){this.setState({notes:k},this._save);},_save:function j(){this.props.onSave(this.state.notes);}});f.exports=i;}),null);
__d('OzReminderTask.react',['cx','OzAPI','OzHelpers','immutable','OzIntentParamsAbstractField.react','OzIntentParamsStringField.react','OzReminderTaskEditor.react','OzReminderNotesField.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','ReactRouter','formatDate'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('immutable').Map,j=c('React').PropTypes,k=c('ReactRouter').Link,l=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],m=c('React').createClass({displayName:'OzReminderTask',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{task:j.instanceOf(i).isRequired,repNames:j.instanceOf(i).isRequired,location:j.instanceOf(i).isRequired},render:function o(){var p=this.props,q=p.task,r=p.repNames,s=p.location,t=q.getIn(['data','description']),u=c('OzHelpers').isUrgentTask(q),v=q.getIn(['data','suggestion']),w=c('OzHelpers').isClosedTask(q),x=q.get('from'),y=r.get(x,x);return c('React').createElement('div',{className:"_wc0"+(u?' '+"_wc2":'')+(c('OzHelpers').isPaidTask(q)?' '+"_3d-l":'')+(w?' '+"_3d-m":'')},c('React').createElement(c('OzSidebarItemHeader.react'),{className:"_1k8u",creator:y,isClosed:w,isExpanded:true,onToggle:this._handleToggle,onCancel:this._handleCancel,title:t||n(v)},u?c('React').createElement('button',{className:"_1-hv _260v _260w",alt:'Snooze',onClick:this._handleSnooze}):null,!w?c('React').createElement(c('OzReminderTaskEditor.react'),{layered:true,onSave:this._handleEdit,seedTask:q,location:s},c('React').createElement('a',{className:"_260y"},c('React').createElement('i',{className:"_5x82"}))):null),this._renderBody());},_renderBody:function o(){var p=this.props.task,q=p.getIn(['schedule','repeat-condition','days']),r=c('OzHelpers').threadPath({threadid:p.get('user-id'),intentid:p.get('intent-id')}),s=p.get('state')==='waiting'?'Fires on':'Fired on';return c('React').createElement('div',{className:"_wc3"},c('React').createElement('div',{className:"_1k8v _3-ue"},c('React').createElement(k,{to:r},c('React').createElement('span',null,'Go to intent')),this._renderPayment(p),c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:s},c('React').createElement('span',null,c('formatDate')(new Date(p.get('start-at')),'M jS, g:ia'))),c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Due'},c('React').createElement('span',null,c('formatDate')(new Date(p.get('deadline')),'M jS, g:ia'))),q&&!q.isEmpty()?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Recurs'},c('React').createElement('span',null,q.size===7?'Every Day':q.sort().map(function(t){return l[t%7];}).toArray().join(' '))):null,c('React').createElement(c('OzReminderNotesField.react'),{seedNotes:p.getIn(['data','notes'])||p.getIn(['data','description']),onSave:this._handleNotesSave})));},_renderPayment:function o(p){var q=p.getIn(['data','suggestion']);if(!q)return null;var r=p.getIn(['data','credit-card']),s=q.get('name');return c('React').createElement('div',null,c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Link'},c('React').createElement('div',{className:"_3d-q"},c('React').createElement('a',{className:"_3d-r",target:'_blank',href:q.get('target-url'),title:q.get('description')},'Click here to view ',s),r?c('React').createElement('a',{className:"_3d-s",href:'#',title:'Show credit card information',onClick:this._handlePaymentLinkClick}):null)),c('React').createElement(c('OzIntentParamsStringField.react'),{label:'Confirmation #',onSave:this._handleItemNumberSave,placeholder:'Confirmation number',value:p.getIn(['data','item-number'])||''}));},_handleNotesSave:function o(p){this._handleEdit(this.props.task.setIn(['data','notes'],p));},_handleItemNumberSave:function o(p){this._handleEdit(this.props.task.setIn(['data','item-number'],p));},_handleToggle:function o(){var p=this.props.task;c('OzHelpers').isClosedTask(p)?this._handleOpen(p):this._handleComplete(p);},_handleComplete:function o(p){c('OzAPI').completeTask(p.get('user-id'),p);},_handleCancel:function o(){var p=this.props.task;c('OzAPI').cancelTask(p.get('user-id'),p);},_handleEdit:function o(p){return c('OzAPI').editTask(p.get('user-id'),p);},_handleOpen:function o(p){c('OzAPI').openTask(p.get('user-id'),p);},_handleSnooze:function o(){var p=this.props.task,q=c('OzHelpers').serverNow()+1000*60*10;c('OzAPI').editTask(p.get('user-id'),p.set('deadline',q));},_handlePaymentLinkClick:function o(p){var q=this.props.task.getIn(['data','credit-card']);if(!q)return;var r=this.props.task.getIn(['data','suggestion','amount'])/100,s=q.get('number'),t=q.get('cvv'),u=q.get('month'),v=q.get('year'),w=q.get('zip'),x='https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/'+'512/mastercard-128.png';c('OzAPI').notifyExtension({action:'show',title:'Temporary Credit Card Information',desc:'Amount: $'+r+' Number: '+s+' cvv: '+t+' zip: '+w,html:'Amount: $'+r+'<br/>\n      Number: '+s+'<br/>\n      CVV: '+t+'<br/>\n      Month: '+u+'<br/>\n      Year: '+v,id:s,timeout:0,picture:x});}});function n(o){if(!o)return null;var p=o.get('amount')/100,q=o.get('name');return 'User paid $'+p+' for '+q;}f.exports=m;}),null);
__d('OzReminderTasks.react',['cx','OzAPI','OzHelpers','immutable','OzSidebarItemHeader.react','OzStores','OzImmutablePureRenderMixin','React','ReactCSSTransitionGroup','ReactRouter','Reflux'],(function a(b,c,d,e,f,g,h){var i=c('OzStores').ActiveThreadStore,j=c('ReactRouter').Link,k=c('immutable').List,l=c('immutable').Map,m=c('React').PropTypes,n=c('React').createClass({displayName:'OzReminderTasks',propTypes:{isHistory:m.bool,repNames:m.instanceOf(l).isRequired,thread:m.object.isRequired},mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(i,'activeThread')],render:function q(){return c('React').createElement('div',{className:"_1x92"},c('React').createElement('h2',{className:"_1x93"},'Reminders for thread'),this._renderTasks());},_handleCreate:function q(r){c('OzAPI').createTask(c('OzHelpers').threadID(this.props.thread),r);},_handleClose:function q(r){c('OzAPI').completeTask(c('OzHelpers').threadID(this.props.thread),r);},_handleEdit:function q(r){return c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),r);},_handleOpen:function q(r){c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),l({id:r.get('id'),state:'dispatched'}));},_handleSnooze:function q(r){c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),l({id:r.get('id'),deadline:c('OzHelpers').serverNow()+1000*60*5}));},_renderTasks:function q(){var r=this.props,s=r.isHistory,t=r.repNames,u=r.thread,v=this.state.activeThread.get('activeTask'),w=c('OzHelpers').threadID(u),x=u.get('tasks',k()).filter(function(y){return y.get('type')==='reminder'&&(s?c('OzHelpers').isClosedTask(y):!c('OzHelpers').isClosedTask(y));}).toSeq().sortBy(function(y){return y.get('deadline');}).map(function(y){return c('React').createElement(o,{key:y.get('id'),task:y,isExpanded:y.get('id')===v,repNames:t});});return c('React').createElement('div',{key:w+'-'+!!s,className:"_wc7"},c('React').createElement(c('ReactCSSTransitionGroup'),{transitionName:'oz-fade-in-out',transitionEnterTimeout:300,transitionLeaveTimeout:300},x));}}),o=c('OzHelpers').pure(function(q){var r=q.task,s=q.isExpanded,t=q.repNames,u=r.getIn(['data','description']),v=c('OzHelpers').isClosedTask(r),w=r.get('from'),x=t.get(w,w),y=r.getIn(['data','suggestion']);return c('React').createElement(j,{className:"_qsr"+(' '+"_wc0")+(c('OzHelpers').isUrgentTask(r)?' '+"_wc2":'')+(c('OzHelpers').isPaidTask(r)?' '+"_3d-l":'')+(v?' '+"_3d-m":''),to:c('OzHelpers').threadPath({threadid:r.get('user-id'),intentid:r.get('intent-id'),taskid:r.get('id')})},c('React').createElement(c('OzSidebarItemHeader.react'),{className:"_1k8u"+(s?' '+"_qsv":''),creator:x,isClosed:v,isExpanded:s,title:u||p(y)||'[No Title]'}));});function p(q){if(!q)return null;var r=q.get('amount')/100,s=q.get('name');return 'User paid $'+r+' for '+s;}f.exports=n;}),null);
__d('OzReminderEditor.react',['cx','OzConstants','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','DatePickerRestraints','OzHelpers','immutable','InputLabel.react','ReactLayeredComponentMixin_DEPRECATED','LayerHideOnBlur','messengerButtonReact','OzDateTimePicker.react','React','XUIContextualDialog.react','XUIError.react'],(function a(b,c,d,e,f,g,h){var i=c('OzConstants').REMINDERS,j=c('messengerButtonReact').jsComponent,k=c('immutable').Map,l=c('immutable').Set,m=c('React').PropTypes,n=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],o=c('immutable').fromJS({traffic:{label:'Include traffic update',params:[{name:'origin',placeholder:'Origin address',err:'What is the origin address?'},{name:'destination',placeholder:'Destination address',err:'What is the destination address?'}]},weather:{label:'Include weather forecast',params:[{name:'location',placeholder:'City',err:'What city is the forecast for?'},{name:'metric',placeholder:'Celsius or Fahrenheit',err:'You need to set Celsius or Fahrenheit'}]}}),p=c('OzHelpers').pure(function(s){var t=s.action,u=s.errors,v=s.onToggle,w=s.onUpdate,x=s.reminder,y=!!x.getIn(['actions',t]);return c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),{className:"_2_xq"},c('React').createElement('input',{type:'checkbox',checked:y,onChange:function z(aa){return v(aa,x,t);}}),c('React').createElement('label',null,o.getIn([t,'label']))),y&&c('React').createElement('div',null,o.getIn([t,'params']).map(function(z){var aa=z.get('name'),ba=['actions',t,aa];return c('React').createElement('div',{key:t+'-'+aa},c('React').createElement(c('XUIError.react'),{xuiError:u.getIn([t,aa])},c('React').createElement('input',{type:z.get('type','text'),className:"_2_xr",placeholder:z.get('placeholder'),value:x.getIn(ba),onChange:function ca(da){return w(da,ba);}})));}).valueSeq()));}),q=c('OzHelpers').pure(function(s){var t=s.reminder,u=s.errors,v=s.onToggle,w=s.onUpdate;return c('React').createElement('div',null,c('React').createElement('h3',{className:"_17f0"},'Actions'),o.keySeq().map(function(x){return c('React').createElement(p,{key:x,action:x,reminder:t,errors:u,onToggle:v,onUpdate:w});}).valueSeq());}),r=c('React').createClass({displayName:'OzReminderEditor',mixins:[c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{onSave:m.func.isRequired,seedReminder:m.instanceOf(k),timezone:m.string},getInitialState:function s(){return {shown:false,reminder:this.props.seedReminder||k(),timezone:this.props.timezone,errors:k()};},componentWillReceiveProps:function s(t){if(!c('immutable').is(t.seedReminder,this.props.seedReminder))this.setState({reminder:t.seedReminder,errors:k()});},render:function s(){var t=c('React').Children.only(this.props.children);return c('React').cloneElement(t,{onClick:function(u){return this.setState({shown:!this.state.shown});}.bind(this)});},renderLayers:function s(){var t=this.state,u=t.shown,v=t.reminder,w=t.errors;if(!u)return null;var x=l(v.get('days'));return {contextualDialog:c('React').createElement(c('XUIContextualDialog.react'),{autoFocus:false,behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')},position:'below',shown:u,contextRef:function(){return this;}.bind(this),onToggle:function(y){return this.setState({shown:y});}.bind(this)},c('React').createElement('ul',{className:"_3ssq"},c('React').createElement('div',{className:"_wbu"},c('React').createElement(c('OzDateTimePicker.react'),babelHelpers['extends']({xuiError:w.get('scheduled-time'),className:"_wbv",showTimezoneName:false,timestamp:v.get('scheduled-time',c('OzHelpers').serverNow()),timezone:this.state.timezone,onChange:function(y){var z=y.timestamp,aa=y.timezone;this.setState({reminder:v.set('scheduled-time',+z),timezone:aa});}.bind(this)},c('OzHelpers').dateRestraints())),c('React').createElement(c('XUIError.react'),{xuiError:w.get('description')},c('React').createElement('input',{ref:'input',className:"_wbw",placeholder:'Describe the Reminder',value:v.getIn(['body','description']),onChange:function(y){this.setState({reminder:v.setIn(['body','description'],y.target.value)});}.bind(this)})),c('React').createElement('h3',{className:"_17f0"},'Recurrence'),n.map(function(y,z){var aa=z+1;return c('React').createElement(c('InputLabel.react'),{key:z,className:"_2_xq"},c('React').createElement('input',{type:'checkbox',checked:x.has(aa),onChange:function(ba){var ca=ba.target.checked?x.add(aa):x['delete'](aa);this.setState({reminder:v.set('days',ca.toList())});}.bind(this)}),c('React').createElement('label',null,y));}.bind(this)),c('React').createElement(q,{reminder:v,errors:w,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),c('React').createElement('div',{className:"_wbz"},c('React').createElement(j,{label:this.props.seedReminder?'Update Reminder':'Add Reminder',onClick:this._handleSave,type:'primary'})))))};},_handleActionToggle:function s(t,u,v){var w=t.target.checked?u.set('actions',k([[v,k()]])):u['delete']('actions');this.setState({reminder:w});},_handleActionUpdate:function s(t,u){this.setState({reminder:this.state.reminder.setIn(u,t.target.value)});},_handleSave:function s(){var t=this.state.reminder,u=t.get('scheduled-time'),v=function y(z){return !!t.getIn(['actions',z]);},w=k(),x=c('OzHelpers').dateRestraints().dateRestraints;if(!u){w=w.set('scheduled-time','When would you like the reminder?');}else if(u<c('OzHelpers').serverNow()+60*1000){w=w.set('scheduled-time','Reminders should be in the future!');}else if(!c('DatePickerRestraints').isValidDate(new Date(u),x))w=w.set('scheduled-time','Reminder is outside of the '+i.RANGE_IN_YEARS+' year range');if(!t.getIn(['body','description']))w=w.set('description','What is the reminder about?');w=o.reduce(function(y,z,aa){if(v(aa))y=z.get('params').reduce(function(ba,ca){return t.getIn(['actions',aa,ca.get('name')])?ba:ba.setIn([aa,ca.get('name')],ca.get('err'));},y);return y;},w);this.setState({errors:w});if(w.size)return;this.setState({reminder:k(),shown:false},function(y){return this.props.onSave(t);}.bind(this));}});f.exports=r;}),null);
__d('OzReminder.react',['cx','invariant','OzAPI','OzHelpers','Event','immutable','OzIntentParamsAbstractField.react','OzIntentParamsStringField.react','OzReminderEditor.react','OzReminderNotesField.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','XUICloseButton.react','formatDate'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('immutable').List,k=c('immutable').Map,l=c('React').PropTypes,m=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],n=c('React').createClass({displayName:'OzReminder',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onClose:l.func.isRequired,onEdit:l.func.isRequired,onOpen:l.func.isRequired,onSnooze:l.func.isRequired,reminder:l.instanceOf(k).isRequired,repNames:l.instanceOf(k).isRequired,timezone:l.string},getInitialState:function p(){return {isExpanded:c('OzHelpers').isUrgentReminder(this.props.reminder)};},componentWillReceiveProps:function p(q){if(q.reminder.get('id')===this.props.reminder.get('id')&&c('OzHelpers').isUrgentReminder(q.reminder)&&!c('OzHelpers').isUrgentReminder(this.props.reminder))this.setState({isExpanded:true});},render:function p(){var q=this.props,r=q.onEdit,s=q.onSnooze,t=q.reminder,u=q.repNames,v=q.timezone,w=t.getIn(['body','description']),x=c('OzHelpers').isUrgentReminder(t),y=t.getIn(['body','suggestion']),z=t.get('state')==='closed',aa=t.get('creator-fbid'),ba=u.get(aa,aa);return c('React').createElement('div',{className:"_wc0"+(x?' '+"_wc2":'')+(c('OzHelpers').isPaidReminder(t)?' '+"_3d-l":'')+(z?' '+"_3d-m":'')},c('React').createElement(c('OzSidebarItemHeader.react'),{className:"_1k8u",creator:ba,isClosed:z,isExpanded:this.state.isExpanded,onIsExpandedToggle:this._handleIsExpandedToggle,onToggle:this._handleToggle,subtitle:c('OzHelpers').isSnoozedReminder(t)?'(snoozed)':null,title:w||o(y)||'[No Title]'},x?c('React').createElement('button',{className:"_1-hv _260v _260w",alt:'Snooze',onClick:function ca(da){return s(t);}}):null,c('React').createElement(c('OzReminderEditor.react'),{onSave:r,seedReminder:t,timezone:v},c('React').createElement('a',{className:"_260y"},c('React').createElement('i',{className:"_5x82"})))),this._renderBody());},_renderBody:function p(){if(!this.state.isExpanded)return null;var q=this.props.reminder,r=q.get('scheduled-time'),s=q.get('last-fired'),t=q.get('state')==='closed',u=c('OzHelpers').isUrgentReminder(q),v=q.get('state')==='snoozed'&&s||r>c('OzHelpers').serverNow()&&r,w=(u||t)&&s,x=q.get('days');return c('React').createElement('div',{className:"_wc3"},c('React').createElement('div',{className:"_1k8v _3-ue"},this._renderPayment(q),w?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Fired On'},c('React').createElement('span',null,c('formatDate')(new Date(w),'M jS, g:ia'))):null,v?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Will Fire On'},c('React').createElement('span',null,c('formatDate')(new Date(v),'M jS, g:ia'))):null,x&&!x.isEmpty()?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Recurs'},c('React').createElement('span',null,x.size===7?'Every Day':x.sort().map(function(y){return m[y%7];}).toArray().join(' '))):null,c('React').createElement(c('OzReminderNotesField.react'),{seedNotes:q.get('notes')||q.getIn(['body','description']),onSave:this._handleNotesSave})));},_renderPayment:function p(q){var r=q.getIn(['body','suggestion']);if(!r)return null;var s=q.getIn(['body','credit-card']),t=r.get('name');return c('React').createElement('div',null,c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Link'},c('React').createElement('div',{className:"_3d-q"},c('React').createElement('a',{className:"_3d-r",target:'_blank',href:r.get('target-url'),title:r.get('description')},'Click here to view ',t),s?c('React').createElement('a',{className:"_3d-s",href:'#',title:'Show credit card information',onClick:this._handlePaymentLinkClick}):null)),c('React').createElement(c('OzIntentParamsStringField.react'),{label:'Confirmation #',onSave:this._handleItemNumberSave,placeholder:'Confirmation number',value:q.getIn(['body','item-number'])||''}));},_handleIsExpandedToggle:function p(){this.setState({isExpanded:!this.state.isExpanded});},_handleNotesSave:function p(q){this.props.onEdit(this.props.reminder.set('notes',q));},_handleItemNumberSave:function p(q){this.props.onEdit(this.props.reminder.setIn(['body','item-number'],q));},_handleToggle:function p(q){var r=this.props,s=r.onClose,t=r.onOpen,u=r.reminder;q?s(u):t(u);},_handlePaymentLinkClick:function p(q){var r=this.props.reminder.getIn(['body','credit-card']);if(!r)return;var s=this.props.reminder.getIn(['body','suggestion','amount'])/100,t=r.get('number'),u=r.get('cvv'),v=r.get('month'),w=r.get('year'),x=r.get('zip');c('OzAPI').notifyExtension({action:'show',title:'Temporary Credit Card Information',desc:'Amount: $'+s+' Number: '+t+' cvv: '+u+' zip: '+x,html:'Amount: $'+s+'<br/>\n      Number: '+t+'<br/>\n      CVV: '+u+'<br/>\n      Month: '+v+'<br/>\n      Year: '+w,id:t,timeout:0,picture:'https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/mastercard-128.png'});}});function o(p){if(!p)return null;var q=p.get('amount')/100,r=p.get('name');return 'User paid $'+q+' for '+r;}f.exports=n;}),null);
__d('OzReminders.react',['cx','OzAPI','OzHelpers','immutable','OzReminder.react','OzReminderEditor.react','React','OzWrapper.react'],(function a(b,c,d,e,f,g,h){var i,j,k=c('immutable').List,l=c('immutable').Map,m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(){var o,p;'use strict';for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.$OzReminders2=function(t){c('OzAPI').createReminder(c('OzHelpers').threadID(this.props.thread),t);}.bind(this),this.$OzReminders3=function(t){c('OzAPI').closeReminder(c('OzHelpers').threadID(this.props.thread),t.get('id'),!!t.get('days')&&t.get('state')==='pending');}.bind(this),this.$OzReminders4=function(t){c('OzAPI').editReminder(c('OzHelpers').threadID(this.props.thread),t);}.bind(this),this.$OzReminders5=function(t){c('OzAPI').editReminder(c('OzHelpers').threadID(this.props.thread),t.set('state','pending'));}.bind(this),this.$OzReminders6=function(t){c('OzAPI').snoozeReminder(c('OzHelpers').threadID(this.props.thread),t.get('id'));}.bind(this),this.$OzReminders1=function(){var t=this.props,u=t.isHistory,v=t.repNames,w=t.thread,x=c('OzHelpers').threadID(w),y=w.get('reminders',k()).sortBy(function(z){return z.get('last-fired')||z.get('scheduled-time');}).toSeq().filter(function(z){return u?z.get('state')==='closed':z.get('state')!=='closed';}).map(function(z){return c('React').createElement(c('OzReminder.react'),{key:z.get('id'),onClose:this.$OzReminders3,onEdit:this.$OzReminders4,onOpen:this.$OzReminders5,onSnooze:this.$OzReminders6,reminder:z,repNames:v,timezone:c('OzHelpers').timezone(w)});}.bind(this));return c('React').createElement('div',{key:x+'-'+!!u,className:"_wc7"},y);}.bind(this),p;}n.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_1x92"},c('React').createElement('h2',{className:"_1x93"},'Reminders'),this.$OzReminders1(),!this.props.isHistory?c('React').createElement(c('OzReminderEditor.react'),{onSave:this.$OzReminders2,timezone:c('OzHelpers').timezone(this.props.thread)},c('React').createElement('a',{className:"_59jg"},c('React').createElement('div',{className:"_4nd4"}),c('React').createElement('span',{className:"_59jh"},'Add a reminder...'))):null);};n.propTypes={isHistory:m.bool,repNames:m.instanceOf(l).isRequired,thread:m.object.isRequired};f.exports=c('OzWrapper.react')(n);}),null);
/**
 * @providesModule CajaHTMLSanitizer
 * @preserve-header
 * @nolint
 */
__d("CajaHTMLSanitizer",[],(function a(b,c,d,e,f,g){var h=1,i=2,j=4,k=8,l=16,m=64,n=128,o=512,p=1024,q=function(){var fa=[['aliceblue','antiquewhite','aqua','aquamarine','azure','beige','bisque','black','blanchedalmond','blue','blueviolet','brown','burlywood','cadetblue','chartreuse','chocolate','coral','cornflowerblue','cornsilk','crimson','cyan','darkblue','darkcyan','darkgoldenrod','darkgray','darkgreen','darkkhaki','darkmagenta','darkolivegreen','darkorange','darkorchid','darkred','darksalmon','darkseagreen','darkslateblue','darkslategray','darkturquoise','darkviolet','deeppink','deepskyblue','dimgray','dodgerblue','firebrick','floralwhite','forestgreen','fuchsia','gainsboro','ghostwhite','gold','goldenrod','gray','green','greenyellow','honeydew','hotpink','indianred','indigo','ivory','khaki','lavender','lavenderblush','lawngreen','lemonchiffon','lightblue','lightcoral','lightcyan','lightgoldenrodyellow','lightgreen','lightgrey','lightpink','lightsalmon','lightseagreen','lightskyblue','lightslategray','lightsteelblue','lightyellow','lime','limegreen','linen','magenta','maroon','mediumaquamarine','mediumblue','mediumorchid','mediumpurple','mediumseagreen','mediumslateblue','mediumspringgreen','mediumturquoise','mediumvioletred','midnightblue','mintcream','mistyrose','moccasin','navajowhite','navy','oldlace','olive','olivedrab','orange','orangered','orchid','palegoldenrod','palegreen','paleturquoise','palevioletred','papayawhip','peachpuff','peru','pink','plum','powderblue','purple','red','rosybrown','royalblue','saddlebrown','salmon','sandybrown','seagreen','seashell','sienna','silver','skyblue','slateblue','slategray','snow','springgreen','steelblue','tan','teal','thistle','tomato','transparent','turquoise','violet','wheat','white','whitesmoke','yellow','yellowgreen'],['all-scroll','col-resize','crosshair','default','e-resize','hand','help','move','n-resize','ne-resize','no-drop','not-allowed','nw-resize','pointer','progress','row-resize','s-resize','se-resize','sw-resize','text','vertical-text','w-resize','wait'],['armenian','decimal','decimal-leading-zero','disc','georgian','lower-alpha','lower-greek','lower-latin','lower-roman','square','upper-alpha','upper-latin','upper-roman'],['100','200','300','400','500','600','700','800','900','bold','bolder','lighter'],['block-level','inline-level','table-caption','table-cell','table-column','table-column-group','table-footer-group','table-header-group','table-row','table-row-group'],['condensed','expanded','extra-condensed','extra-expanded','narrower','semi-condensed','semi-expanded','ultra-condensed','ultra-expanded','wider'],['inherit','inline','inline-block','inline-box','inline-flex','inline-grid','inline-list-item','inline-stack','inline-table','run-in'],['behind','center-left','center-right','far-left','far-right','left-side','leftwards','right-side','rightwards'],['large','larger','small','smaller','x-large','x-small','xx-large','xx-small'],['dashed','dotted','double','groove','outset','ridge','solid'],['ease','ease-in','ease-in-out','ease-out','linear','step-end','step-start'],['at','closest-corner','closest-side','ellipse','farthest-corner','farthest-side'],['baseline','middle','sub','super','text-bottom','text-top'],['caption','icon','menu','message-box','small-caption','status-bar'],['fast','faster','slow','slower','x-fast','x-slow'],['above','below','higher','level','lower'],['cursive','fantasy','monospace','sans-serif','serif'],['loud','silent','soft','x-loud','x-soft'],['no-repeat','repeat-x','repeat-y','round','space'],['blink','line-through','overline','underline'],['block','flex','grid','table'],['high','low','x-high','x-low'],['nowrap','pre','pre-line','pre-wrap'],['absolute','relative','static'],['alternate','alternate-reverse','reverse'],['border-box','content-box','padding-box'],['capitalize','lowercase','uppercase'],['child','female','male'],['=','opacity'],['backwards','forwards'],['bidi-override','embed'],['bottom','top'],['break-all','keep-all'],['clip','ellipsis'],['contain','cover'],['continuous','digits'],['end','start'],['flat','preserve-3d'],['hide','show'],['horizontal','vertical'],['inside','outside'],['italic','oblique'],['left','right'],['ltr','rtl'],['no-content','no-display'],['paused','running'],['suppress','unrestricted'],['thick','thin'],[','],['/'],['all'],['always'],['auto'],['avoid'],['both'],['break-word'],['center'],['circle'],['code'],['collapse'],['contents'],['fixed'],['hidden'],['infinite'],['inset'],['invert'],['justify'],['list-item'],['local'],['medium'],['mix'],['none'],['normal'],['once'],['repeat'],['scroll'],['separate'],['small-caps'],['spell-out'],['to'],['visible']],ga={animation:{cssPropBits:517,cssLitGroup:[fa[10],fa[24],fa[29],fa[45],fa[48],fa[54],fa[63],fa[71],fa[72]],cssFns:['cubic-bezier()','steps()']},'animation-delay':{cssPropBits:5,cssLitGroup:[fa[48]],cssFns:[]},'animation-direction':{cssPropBits:0,cssLitGroup:[fa[24],fa[48],fa[72]],cssFns:[]},'animation-duration':'animation-delay','animation-fill-mode':{cssPropBits:0,cssLitGroup:[fa[29],fa[48],fa[54],fa[71]],cssFns:[]},'animation-iteration-count':{cssPropBits:5,cssLitGroup:[fa[48],fa[63]],cssFns:[]},'animation-name':{cssPropBits:512,cssLitGroup:[fa[48],fa[71]],cssFns:[]},'animation-play-state':{cssPropBits:0,cssLitGroup:[fa[45],fa[48]],cssFns:[]},'animation-timing-function':{cssPropBits:0,cssLitGroup:[fa[10],fa[48]],cssFns:['cubic-bezier()','steps()']},appearance:{cssPropBits:0,cssLitGroup:[fa[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[fa[7],fa[42],fa[56]],cssFns:[]},'backface-visibility':{cssPropBits:0,cssLitGroup:[fa[59],fa[62],fa[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[fa[0],fa[18],fa[25],fa[31],fa[34],fa[42],fa[48],fa[49],fa[52],fa[56],fa[61],fa[68],fa[71],fa[74],fa[75]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()','rgb()','rgba()']},'background-attachment':{cssPropBits:0,cssLitGroup:[fa[48],fa[61],fa[68],fa[75]],cssFns:[]},'background-color':{cssPropBits:2,cssLitGroup:[fa[0]],cssFns:['rgb()','rgba()']},'background-image':{cssPropBits:16,cssLitGroup:[fa[48],fa[71]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()']},'background-position':{cssPropBits:5,cssLitGroup:[fa[31],fa[42],fa[48],fa[56]],cssFns:[]},'background-repeat':{cssPropBits:0,cssLitGroup:[fa[18],fa[48],fa[74]],cssFns:[]},'background-size':{cssPropBits:5,cssLitGroup:[fa[34],fa[48],fa[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[fa[0],fa[9],fa[47],fa[62],fa[64],fa[69],fa[71]],cssFns:['rgb()','rgba()']},'border-bottom':'border','border-bottom-color':'background-color','border-bottom-left-radius':{cssPropBits:5,cssFns:[]},'border-bottom-right-radius':'border-bottom-left-radius','border-bottom-style':{cssPropBits:0,cssLitGroup:[fa[9],fa[62],fa[64],fa[71]],cssFns:[]},'border-bottom-width':{cssPropBits:5,cssLitGroup:[fa[47],fa[69]],cssFns:[]},'border-collapse':{cssPropBits:0,cssLitGroup:[fa[59],fa[76]],cssFns:[]},'border-color':'background-color','border-left':'border','border-left-color':'background-color','border-left-style':'border-bottom-style','border-left-width':'border-bottom-width','border-radius':{cssPropBits:5,cssLitGroup:[fa[49]],cssFns:[]},'border-right':'border','border-right-color':'background-color','border-right-style':'border-bottom-style','border-right-width':'border-bottom-width','border-spacing':'border-bottom-left-radius','border-style':'border-bottom-style','border-top':'border','border-top-color':'background-color','border-top-left-radius':'border-bottom-left-radius','border-top-right-radius':'border-bottom-left-radius','border-top-style':'border-bottom-style','border-top-width':'border-bottom-width','border-width':'border-bottom-width',bottom:{cssPropBits:5,cssLitGroup:[fa[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[fa[60],fa[71],fa[72]],cssFns:[]},'box-shadow':{cssPropBits:7,cssLitGroup:[fa[0],fa[48],fa[64],fa[71]],cssFns:['rgb()','rgba()']},'box-sizing':{cssPropBits:0,cssLitGroup:[fa[25]],cssFns:[]},'caption-side':{cssPropBits:0,cssLitGroup:[fa[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[fa[42],fa[54],fa[71]],cssFns:[]},clip:{cssPropBits:0,cssLitGroup:[fa[52]],cssFns:['rect()']},color:'background-color',content:{cssPropBits:8,cssLitGroup:[fa[71],fa[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[fa[71]],cssFns:[]},'cue-after':'cue','cue-before':'cue',cursor:{cssPropBits:16,cssLitGroup:[fa[1],fa[48],fa[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[fa[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[fa[4],fa[6],fa[20],fa[52],fa[67],fa[71]],cssFns:[]},'display-extras':{cssPropBits:0,cssLitGroup:[fa[67],fa[71]],cssFns:[]},'display-inside':{cssPropBits:0,cssLitGroup:[fa[20],fa[52]],cssFns:[]},'display-outside':{cssPropBits:0,cssLitGroup:[fa[4],fa[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[fa[15]],cssFns:[]},'empty-cells':{cssPropBits:0,cssLitGroup:[fa[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:['alpha()']},'float':{cssPropBits:0,cssLitGroup:[fa[42],fa[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[fa[3],fa[8],fa[13],fa[16],fa[41],fa[48],fa[49],fa[69],fa[72],fa[77]],cssFns:[]},'font-family':{cssPropBits:72,cssLitGroup:[fa[16],fa[48]],cssFns:[]},'font-size':{cssPropBits:1,cssLitGroup:[fa[8],fa[69]],cssFns:[]},'font-stretch':{cssPropBits:0,cssLitGroup:[fa[5],fa[72]],cssFns:[]},'font-style':{cssPropBits:0,cssLitGroup:[fa[41],fa[72]],cssFns:[]},'font-variant':{cssPropBits:0,cssLitGroup:[fa[72],fa[77]],cssFns:[]},'font-weight':{cssPropBits:0,cssLitGroup:[fa[3],fa[72]],cssFns:[]},height:'bottom',left:'bottom','letter-spacing':{cssPropBits:5,cssLitGroup:[fa[72]],cssFns:[]},'line-height':{cssPropBits:1,cssLitGroup:[fa[72]],cssFns:[]},'list-style':{cssPropBits:16,cssLitGroup:[fa[2],fa[40],fa[57],fa[71]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()']},'list-style-image':{cssPropBits:16,cssLitGroup:[fa[71]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()']},'list-style-position':{cssPropBits:0,cssLitGroup:[fa[40]],cssFns:[]},'list-style-type':{cssPropBits:0,cssLitGroup:[fa[2],fa[57],fa[71]],cssFns:[]},margin:'bottom','margin-bottom':'bottom','margin-left':'bottom','margin-right':'bottom','margin-top':'bottom','max-height':{cssPropBits:1,cssLitGroup:[fa[52],fa[71]],cssFns:[]},'max-width':'max-height','min-height':{cssPropBits:1,cssLitGroup:[fa[52]],cssFns:[]},'min-width':'min-height',opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[fa[0],fa[9],fa[47],fa[62],fa[64],fa[65],fa[69],fa[71]],cssFns:['rgb()','rgba()']},'outline-color':{cssPropBits:2,cssLitGroup:[fa[0],fa[65]],cssFns:['rgb()','rgba()']},'outline-style':'border-bottom-style','outline-width':'border-bottom-width',overflow:{cssPropBits:0,cssLitGroup:[fa[52],fa[62],fa[75],fa[80]],cssFns:[]},'overflow-wrap':{cssPropBits:0,cssLitGroup:[fa[55],fa[72]],cssFns:[]},'overflow-x':{cssPropBits:0,cssLitGroup:[fa[44],fa[52],fa[62],fa[75],fa[80]],cssFns:[]},'overflow-y':'overflow-x',padding:'opacity','padding-bottom':'opacity','padding-left':'opacity','padding-right':'opacity','padding-top':'opacity','page-break-after':{cssPropBits:0,cssLitGroup:[fa[42],fa[51],fa[52],fa[53]],cssFns:[]},'page-break-before':'page-break-after','page-break-inside':{cssPropBits:0,cssLitGroup:[fa[52],fa[53]],cssFns:[]},pause:'border-bottom-left-radius','pause-after':'border-bottom-left-radius','pause-before':'border-bottom-left-radius',perspective:{cssPropBits:5,cssLitGroup:[fa[71]],cssFns:[]},'perspective-origin':{cssPropBits:5,cssLitGroup:[fa[31],fa[42],fa[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[fa[21],fa[69]],cssFns:[]},'pitch-range':'border-bottom-left-radius','play-during':{cssPropBits:16,cssLitGroup:[fa[52],fa[70],fa[71],fa[74]],cssFns:[]},position:{cssPropBits:0,cssLitGroup:[fa[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[fa[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[fa[39],fa[54],fa[71]],cssFns:[]},richness:'border-bottom-left-radius',right:'bottom',speak:{cssPropBits:0,cssLitGroup:[fa[71],fa[72],fa[78]],cssFns:[]},'speak-header':{cssPropBits:0,cssLitGroup:[fa[51],fa[73]],cssFns:[]},'speak-numeral':{cssPropBits:0,cssLitGroup:[fa[35]],cssFns:[]},'speak-punctuation':{cssPropBits:0,cssLitGroup:[fa[58],fa[71]],cssFns:[]},'speech-rate':{cssPropBits:5,cssLitGroup:[fa[14],fa[69]],cssFns:[]},stress:'border-bottom-left-radius','table-layout':{cssPropBits:0,cssLitGroup:[fa[52],fa[61]],cssFns:[]},'text-align':{cssPropBits:0,cssLitGroup:[fa[42],fa[56],fa[66]],cssFns:[]},'text-decoration':{cssPropBits:0,cssLitGroup:[fa[19],fa[71]],cssFns:[]},'text-indent':'border-bottom-left-radius','text-overflow':{cssPropBits:8,cssLitGroup:[fa[33]],cssFns:[]},'text-shadow':'box-shadow','text-transform':{cssPropBits:0,cssLitGroup:[fa[26],fa[71]],cssFns:[]},'text-wrap':{cssPropBits:0,cssLitGroup:[fa[46],fa[71],fa[72]],cssFns:[]},top:'bottom',transform:{cssPropBits:0,cssLitGroup:[fa[71]],cssFns:['matrix()','perspective()','rotate()','rotate3d()','rotatex()','rotatey()','rotatez()','scale()','scale3d()','scalex()','scaley()','scalez()','skew()','skewx()','skewy()','translate()','translate3d()','translatex()','translatey()','translatez()']},'transform-origin':'perspective-origin','transform-style':{cssPropBits:0,cssLitGroup:[fa[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[fa[10],fa[48],fa[50],fa[71]],cssFns:['cubic-bezier()','steps()']},'transition-delay':'animation-delay','transition-duration':'animation-delay','transition-property':{cssPropBits:1024,cssLitGroup:[fa[48],fa[50]],cssFns:[]},'transition-timing-function':'animation-timing-function','unicode-bidi':{cssPropBits:0,cssLitGroup:[fa[30],fa[72]],cssFns:[]},'vertical-align':{cssPropBits:5,cssLitGroup:[fa[12],fa[31]],cssFns:[]},visibility:'backface-visibility','voice-family':{cssPropBits:8,cssLitGroup:[fa[27],fa[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[fa[17],fa[69]],cssFns:[]},'white-space':{cssPropBits:0,cssLitGroup:[fa[22],fa[72]],cssFns:[]},width:'min-height','word-break':{cssPropBits:0,cssLitGroup:[fa[32],fa[72]],cssFns:[]},'word-spacing':'letter-spacing','word-wrap':'overflow-wrap','z-index':'bottom',zoom:'line-height','cubic-bezier()':'animation-delay','steps()':{cssPropBits:5,cssLitGroup:[fa[36],fa[48]],cssFns:[]},'image()':{cssPropBits:18,cssLitGroup:[fa[0],fa[48]],cssFns:['rgb()','rgba()']},'linear-gradient()':{cssPropBits:7,cssLitGroup:[fa[0],fa[31],fa[42],fa[48],fa[79]],cssFns:['rgb()','rgba()']},'radial-gradient()':{cssPropBits:7,cssLitGroup:[fa[0],fa[11],fa[31],fa[42],fa[48],fa[56],fa[57]],cssFns:['rgb()','rgba()']},'repeating-linear-gradient()':'linear-gradient()','repeating-radial-gradient()':'radial-gradient()','rgb()':{cssPropBits:1,cssLitGroup:[fa[48]],cssFns:[]},'rgba()':'rgb()','rect()':{cssPropBits:5,cssLitGroup:[fa[48],fa[52]],cssFns:[]},'alpha()':{cssPropBits:1,cssLitGroup:[fa[28]],cssFns:[]},'matrix()':'animation-delay','perspective()':'border-bottom-left-radius','rotate()':'border-bottom-left-radius','rotate3d()':'animation-delay','rotatex()':'border-bottom-left-radius','rotatey()':'border-bottom-left-radius','rotatez()':'border-bottom-left-radius','scale()':'animation-delay','scale3d()':'animation-delay','scalex()':'border-bottom-left-radius','scaley()':'border-bottom-left-radius','scalez()':'border-bottom-left-radius','skew()':'animation-delay','skewx()':'border-bottom-left-radius','skewy()':'border-bottom-left-radius','translate()':'animation-delay','translate3d()':'animation-delay','translatex()':'border-bottom-left-radius','translatey()':'border-bottom-left-radius','translatez()':'border-bottom-left-radius'};for(var ha in ga)if('string'===typeof ga[ha]&&Object.hasOwnProperty.call(ga,ha))ga[ha]=ga[ga[ha]];return ga;}();if(typeof window!=='undefined')window.cssSchema=q;var r,s;(function(){function fa(bc){var cc=parseInt(bc.substring(1),16);if(cc>65535){return cc-=65536,String.fromCharCode(55296+(cc>>10),56320+(cc&1023));}else if(cc==cc){return String.fromCharCode(cc);}else if(bc[1]<' '){return '';}else return bc[1];}function ga(bc,cc){return '"'+bc.replace(/[\u0000-\u001f\\\"<>]/g,cc)+'"';}function ha(bc){return ja[bc]||(ja[bc]='\\'+bc.charCodeAt(0).toString(16)+' ');}function ia(bc){return ka[bc]||(ka[bc]=(bc<'\x10'?'%0':'%')+bc.charCodeAt(0).toString(16));}var ja={'\\':'\\\\'},ka={'\\':'%5c'},la='[\\t\\n\\f ]',ma=la+'*',na='[\\n\\f]',oa='[\\ud800-\\udbff][\\udc00-\\udfff]',pa='[\\u0080-\\ud7ff\\ue000-\\ufffd]|'+oa,qa='[0-9a-fA-F]{1,6}'+la+'?',ra='\\\\'+qa,sa='(?:'+qa+'|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|'+oa+')',ta='\\\\'+sa,ua='(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|'+pa+'|'+ta+')',va='[^\'"\\n\\f\\\\]|\\\\[\\s\\S]',wa='"(?:\'|'+va+')*"'+'|\'(?:\"|'+va+')*\'',xa='[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)',ya='(?:[a-zA-Z_]|'+pa+'|'+ta+')',za='(?:[a-zA-Z0-9_-]|'+pa+'|'+ta+')',ab=za+'+',bb='-?'+ya+za+'*',cb='@'+bb,db='#'+ab,eb=xa,fb='(?:@?-?'+ya+'|#)'+za+'*',gb=xa+'%',hb=xa+bb,ib=xa+'(?:%|'+bb+')?',jb='url[(]'+ma+'(?:'+wa+'|'+ua+'*)'+ma+'[)]',kb='U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?',lb='<\!--',mb='-->',nb=la+'+',ob='/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)',pb='(?!url[(])'+bb+'[(]',qb='~=',rb='[|]=',sb='[^]=',tb='[$]=',ub='[*]=',vb='[~|^$*]=',wb='[^"\'\\\\/]|/(?![/*])',xb='\\uFEFF',yb=new RegExp([xb,kb,jb,pb,fb,wa,ib,lb,mb,nb,ob,vb,wb].join("|"),'gi'),zb=new RegExp('\\\\(?:'+sa+'|'+na+')','g'),ac=new RegExp('^url\\('+ma+'["\']?|["\']?'+ma+'\\)$','gi');s=function(bc){return bc.replace(zb,fa);};r=function(bc){bc=('\uffff'+bc).replace(/^\uffff/,'');bc=bc.replace(/\r\n?/g,'\n');var cc=bc.match(yb)||[],dc=0,ec=' ';for(var fc=0,gc=cc.length;fc<gc;++fc){var hc=s(cc[fc]),ic=hc.length,jc=hc.charCodeAt(0);hc=jc=='"'.charCodeAt(0)||jc=='\''.charCodeAt(0)?ga(hc.substring(1,ic-1),ha):jc=='/'.charCodeAt(0)&&ic>1||hc=='\\'||hc==mb||hc==lb||hc=='\ufeff'||jc<=' '.charCodeAt(0)?' ':/url\(/i.test(hc)?'url('+ga(hc.replace(ac,''),ia)+')':hc;if(ec!=hc||hc!=' ')cc[dc++]=ec=hc;}cc.length=dc;return cc;};})();if(typeof window!=='undefined'){window.lexCss=r;window.decodeCss=s;}var t=function(){function fa(va){var wa=(''+va).match(sa);if(!wa)return null;return new qa(ra(wa[1]),ra(wa[2]),ra(wa[3]),ra(wa[4]),ra(wa[5]),ra(wa[6]),ra(wa[7]));}function ga(va,wa,xa,ya,za,ab,bb){var cb=new qa(ia(va,ta),ia(wa,ta),ha(xa),ya>0?ya.toString():null,ia(za,ua),null,ha(bb));if(ab)if('string'===typeof ab){cb.setRawQuery(ab.replace(/[^?&=0-9A-Za-z_\-~.%]/g,ja));}else cb.setAllParameters(ab);return cb;}function ha(va){if('string'==typeof va)return encodeURIComponent(va);return null;}function ia(va,wa){if('string'==typeof va)return encodeURI(va).replace(wa,ja);return null;}function ja(va){var wa=va.charCodeAt(0);return '%'+'0123456789ABCDEF'.charAt(wa>>4&15)+'0123456789ABCDEF'.charAt(wa&15);}function ka(va){return va.replace(/(^|\/)\.(?:\/|$)/g,'$1').replace(/\/{2,}/g,'/');}var la=new RegExp(''+'(/|^)'+'(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)'+'/\\.\\.(?:/|$)'),ma=new RegExp(la),na=/^(?:\.\.\/)*(?:\.\.$)?/;function oa(va){if(va===null)return null;var wa=ka(va),xa=ma;for(var ya;(ya=wa.replace(xa,'$1'))!=wa;wa=ya);return wa;}function pa(va,wa){var xa=va.clone(),ya=wa.hasScheme();if(ya){xa.setRawScheme(wa.getRawScheme());}else ya=wa.hasCredentials();if(ya){xa.setRawCredentials(wa.getRawCredentials());}else ya=wa.hasDomain();if(ya){xa.setRawDomain(wa.getRawDomain());}else ya=wa.hasPort();var za=wa.getRawPath(),ab=oa(za);if(ya){xa.setPort(wa.getPort());ab=ab&&ab.replace(na,'');}else{ya=!!za;if(ya){if(ab.charCodeAt(0)!==47){var bb=oa(xa.getRawPath()||'').replace(na,''),cb=bb.lastIndexOf('/')+1;ab=oa((cb?bb.substring(0,cb):'')+oa(za)).replace(na,'');}}else{ab=ab&&ab.replace(na,'');if(ab!==za)xa.setRawPath(ab);}}if(ya){xa.setRawPath(ab);}else ya=wa.hasQuery();if(ya){xa.setRawQuery(wa.getRawQuery());}else ya=wa.hasFragment();if(ya)xa.setRawFragment(wa.getRawFragment());return xa;}function qa(va,wa,xa,ya,za,ab,bb){this.scheme_=va;this.credentials_=wa;this.domain_=xa;this.port_=ya;this.path_=za;this.query_=ab;this.fragment_=bb;this.paramCache_=null;}qa.prototype.toString=function(){var va=[];if(null!==this.scheme_)va.push(this.scheme_,':');if(null!==this.domain_){va.push('//');if(null!==this.credentials_)va.push(this.credentials_,'@');va.push(this.domain_);if(null!==this.port_)va.push(':',this.port_.toString());}if(null!==this.path_)va.push(this.path_);if(null!==this.query_)va.push('?',this.query_);if(null!==this.fragment_)va.push('#',this.fragment_);return va.join('');};qa.prototype.clone=function(){return new qa(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_);};qa.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase();};qa.prototype.getRawScheme=function(){return this.scheme_;};qa.prototype.setScheme=function(va){this.scheme_=ia(va,ta);return this;};qa.prototype.setRawScheme=function(va){this.scheme_=va?va:null;return this;};qa.prototype.hasScheme=function(){return null!==this.scheme_;};qa.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_);};qa.prototype.getRawCredentials=function(){return this.credentials_;};qa.prototype.setCredentials=function(va){this.credentials_=ia(va,ta);return this;};qa.prototype.setRawCredentials=function(va){this.credentials_=va?va:null;return this;};qa.prototype.hasCredentials=function(){return null!==this.credentials_;};qa.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_);};qa.prototype.getRawDomain=function(){return this.domain_;};qa.prototype.setDomain=function(va){return this.setRawDomain(va&&encodeURIComponent(va));};qa.prototype.setRawDomain=function(va){this.domain_=va?va:null;return this.setRawPath(this.path_);};qa.prototype.hasDomain=function(){return null!==this.domain_;};qa.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_);};qa.prototype.setPort=function(va){if(va){va=Number(va);if(va!==(va&65535))throw new Error('Bad port number '+va);this.port_=''+va;}else this.port_=null;return this;};qa.prototype.hasPort=function(){return null!==this.port_;};qa.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_);};qa.prototype.getRawPath=function(){return this.path_;};qa.prototype.setPath=function(va){return this.setRawPath(ia(va,ua));};qa.prototype.setRawPath=function(va){if(va){va=String(va);this.path_=!this.domain_||/^\//.test(va)?va:'/'+va;}else this.path_=null;return this;};qa.prototype.hasPath=function(){return null!==this.path_;};qa.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g,' ');};qa.prototype.getRawQuery=function(){return this.query_;};qa.prototype.setQuery=function(va){this.paramCache_=null;this.query_=ha(va);return this;};qa.prototype.setRawQuery=function(va){this.paramCache_=null;this.query_=va?va:null;return this;};qa.prototype.hasQuery=function(){return null!==this.query_;};qa.prototype.setAllParameters=function(va){if(typeof va==='object')if(!(va instanceof Array)&&(va instanceof Object||Object.prototype.toString.call(va)!=='[object Array]')){var wa=[],xa=-1;for(var ya in va){var za=va[ya];if('string'===typeof za){wa[++xa]=ya;wa[++xa]=za;}}va=wa;}this.paramCache_=null;var ab=[],bb='';for(var cb=0;cb<va.length;){var ya=va[cb++],za=va[cb++];ab.push(bb,encodeURIComponent(ya.toString()));bb='&';if(za)ab.push('=',encodeURIComponent(za.toString()));}this.query_=ab.join('');return this;};qa.prototype.checkParameterCache_=function(){if(!this.paramCache_){var va=this.query_;if(!va){this.paramCache_=[];}else{var wa=va.split(/[&\?]/),xa=[],ya=-1;for(var za=0;za<wa.length;++za){var ab=wa[za].match(/^([^=]*)(?:=(.*))?$/);xa[++ya]=decodeURIComponent(ab[1]).replace(/\+/g,' ');xa[++ya]=decodeURIComponent(ab[2]||'').replace(/\+/g,' ');}this.paramCache_=xa;}}};qa.prototype.setParameterValues=function(va,wa){if(typeof wa==='string')wa=[wa];this.checkParameterCache_();var xa=0,ya=this.paramCache_,za=[];for(var ab=0,bb=0;ab<ya.length;ab+=2)if(va===ya[ab]){if(xa<wa.length)za.push(va,wa[xa++]);}else za.push(ya[ab],ya[ab+1]);while(xa<wa.length)za.push(va,wa[xa++]);this.setAllParameters(za);return this;};qa.prototype.removeParameter=function(va){return this.setParameterValues(va,[]);};qa.prototype.getAllParameters=function(){this.checkParameterCache_();return this.paramCache_.slice(0,this.paramCache_.length);};qa.prototype.getParameterValues=function(va){this.checkParameterCache_();var wa=[];for(var xa=0;xa<this.paramCache_.length;xa+=2)if(va===this.paramCache_[xa])wa.push(this.paramCache_[xa+1]);return wa;};qa.prototype.getParameterMap=function(va){this.checkParameterCache_();var wa={};for(var xa=0;xa<this.paramCache_.length;xa+=2){var ya=this.paramCache_[xa++],za=this.paramCache_[xa++];if(!(ya in wa)){wa[ya]=[za];}else wa[ya].push(za);}return wa;};qa.prototype.getParameterValue=function(va){this.checkParameterCache_();for(var wa=0;wa<this.paramCache_.length;wa+=2)if(va===this.paramCache_[wa])return this.paramCache_[wa+1];return null;};qa.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_);};qa.prototype.getRawFragment=function(){return this.fragment_;};qa.prototype.setFragment=function(va){this.fragment_=va?encodeURIComponent(va):null;return this;};qa.prototype.setRawFragment=function(va){this.fragment_=va?va:null;return this;};qa.prototype.hasFragment=function(){return null!==this.fragment_;};function ra(va){return 'string'==typeof va&&va.length>0?va:null;}var sa=new RegExp("^"+"(?:"+"([^:/?#]+)"+":)?"+"(?://"+"(?:([^/?#]*)@)?"+"([^/?#:@]*)"+"(?::([0-9]+))?"+")?"+"([^?#]+)?"+"(?:\\?([^#]*))?"+"(?:#(.*))?"+"$"),ta=/[#\/\?@]/g,ua=/[\#\?]/g;qa.parse=fa;qa.create=ga;qa.resolve=pa;qa.collapse_dots=oa;qa.utils={mimeTypeOf:function(va){var wa=fa(va);if(/\.html$/.test(wa.getPath())){return 'text/html';}else return 'application/javascript';},resolve:function(va,wa){if(va){return pa(fa(va),fa(wa)).toString();}else return ''+wa;}};return qa;}();typeof window!=='undefined';var u=undefined,v=undefined,w=undefined,x=undefined,y=undefined;(function(){var fa='url("about:blank")',ga=/[\n\f\r\"\'()*<>]/g,ha={'\n':'%0a','\f':'%0c','\r':'%0d','"':'%22','\'':'%27','(':'%28',')':'%29','*':'%2a','<':'%3c','>':'%3e'};function ia(ra){if('string'===typeof ra){return 'url("'+ra.replace(ga,ja)+'")';}else return fa;}function ja(ra){return ha[ra];}var ka=new RegExp('^'+'(?:'+'([^:\/?# ]+)'+':)?'),la=/^(?:https?|mailto)$/i;function ma(ra,sa){if(ra)return t.utils.resolve(ra,sa);return sa;}function na(ra,sa,ta){if(!ta)return null;var ua=(''+ra).match(ka);if(ua&&(!ua[1]||la.test(ua[1]))){return ta(ra,sa);}else return null;}function oa(ra){return ra.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,'');}u=function(){function ra(ta){var ua={};for(var va=ta.length;--va>=0;){var wa=ta[va];for(var xa=wa.length;--xa>=0;)ua[wa[xa]]=sa;}return ua;}var sa={};return function ta(ua,va,wa,xa,ya){var za=oa(ua),ab=q[za];if(!ab||'object'!==typeof ab){va.length=0;return;}var bb=ab.cssPropBits;function cb(rb,sb){var tb=1,ub=sb+1,vb=rb.length;while(ub<vb&&tb){var wb=rb[ub++];tb+=wb===')'?-1:/^[^"']*\($/.test(wb);}if(!tb){var xb=rb[sb].toLowerCase(),yb=oa(xb),zb=rb.splice(sb,ub-sb,''),ac=ab.cssFns;for(var bc=0,cc=ac.length;bc<cc;++bc)if(ac[bc].substring(0,yb.length)==yb){zb[0]=zb[zb.length-1]='';ta(ac[bc],zb,wa,xa);return xb+zb.join(' ')+')';}}return '';}var db=bb&(l|m),eb=bb&(o|p),fb=NaN,gb=0,hb=0;for(;gb<va.length;++gb){var ib=va[gb].toLowerCase(),jb=ib.charCodeAt(0),kb,lb,mb,nb,ob,pb,qb;ib=jb===' '.charCodeAt(0)?'':jb==='"'.charCodeAt(0)?db===l?wa?ia(na(ma(xa,s(va[gb].substring(1,ib.length-1))),za,wa)):'':bb&k&&!(db&db-1)?ib:'':ib==='inherit'?ib:(pb=ab.cssLitGroup,qb=pb?ab.cssLitMap||(ab.cssLitMap=ra(pb)):sa,qb[oa(ib)]===sa)?ib:jb==='#'.charCodeAt(0)&&/^#(?:[0-9a-f]{3}){1,2}$/.test(ib)?bb&i?ib:'':'0'.charCodeAt(0)<=jb&&jb<='9'.charCodeAt(0)?bb&h?ib:'':(kb=ib.charCodeAt(1),lb=ib.charCodeAt(2),mb='0'.charCodeAt(0)<=kb&&kb<='9'.charCodeAt(0),nb='0'.charCodeAt(0)<=lb&&lb<='9'.charCodeAt(0),jb==='+'.charCodeAt(0)&&(mb||kb==='.'.charCodeAt(0)&&nb))?bb&h?(mb?'':'0')+ib.substring(1):'':jb==='-'.charCodeAt(0)&&(mb||kb==='.'.charCodeAt(0)&&nb)?bb&j?(mb?'-':'-0')+ib.substring(1):bb&h?'0':'':jb==='.'.charCodeAt(0)&&mb?bb&h?'0'+ib:'':'url("'===ib.substring(0,5)?wa&&bb&l?ia(na(ma(xa,va[gb].substring(5,ib.length-2)),za,wa)):'':ib.charAt(ib.length-1)==='('?cb(va,gb):eb&&/^-?[a-z_][\w\-]*$/.test(ib)&&!/__$/.test(ib)?ya&&eb===o?va[gb]+ya:eb===p&&q[ib]&&'number'===typeof q[ib].cssPropBits?ib:'':/^\w+$/.test(ib)&&db===m&&bb&k?fb+1===hb?(va[fb]=va[fb].substring(0,va[fb].length-1)+' '+ib+'"',ib=''):(fb=hb,'"'+ib+'"'):'';if(ib)va[hb++]=ib;}if(hb===1&&va[0]===fa)hb=0;va.length=hb;};}();var pa=new RegExp('^(active|after|before|blank|checked|default|disabled'+'|drop|empty|enabled|first|first-child|first-letter'+'|first-line|first-of-type|fullscreen|focus|hover'+'|in-range|indeterminate|invalid|last-child|last-of-type'+'|left|link|only-child|only-of-type|optional|out-of-range'+'|placeholder-shown|read-only|read-write|required|right'+'|root|scope|user-error|valid|visited'+')$'),qa={};qa['>']=qa['+']=qa['~']=qa;v=function(ra,sa,ta){var ua=sa.containerClass,va=sa.idSuffix,wa=sa.tagPolicy,xa=[],ya=0,za,ab=0,bb;for(za=0;za<ra.length;++za){bb=ra[za];if(bb=='('||bb=='['?(++ab,true):bb==')'||bb==']'?(ab&&--ab,true):!(ra[za]==' '&&(ab||qa[ra[za-1]]===qa||qa[ra[za+1]]===qa)))ra[ya++]=ra[za];}ra.length=ya;var cb=ra.length,db=0;for(za=0;za<cb;++za)if(ra[za]===','){if(!eb(db,za))return null;db=za+1;}if(!eb(db,cb))return null;function eb(fb,gb){if(ra[fb]===' ')++fb;if(gb-1!==fb&&ra[gb]===' ')--gb;var hb=[],ib=fb,jb=true;for(var kb=fb;jb&&kb<gb;++kb){var lb=ra[kb];if(qa[lb]===qa||lb===' ')if(!mb(ib,kb,lb)){jb=false;}else ib=kb+1;}if(!mb(ib,gb,''))jb=false;function mb(ob,pb,qb){var rb,sb,tb,ub,vb,wb=true;rb='';if(ob<pb){vb=ra[ob];if(vb==='*'){++ob;rb=vb;}else if(/^[a-zA-Z]/.test(vb)){var xb=wa(vb.toLowerCase(),[]);if(xb){if('tagName' in xb)vb=xb.tagName;++ob;rb=vb;}}}sb='';tb='';ub='';for(;wb&&ob<pb;++ob){vb=ra[ob];if(vb.charAt(0)==='#'){if(/^#_|__$|[^\w#:\-]/.test(vb)){wb=false;}else sb+=vb+va;}else if(vb==='.'){if(++ob<pb&&/^[0-9A-Za-z:_\-]+$/.test(vb=ra[ob])&&!/^_|__$/.test(vb)){sb+='.'+vb;}else wb=false;}else if(ob+1<pb&&ra[ob]==='['){++ob;var yb=ra[ob++].toLowerCase(),zb=ba.ATTRIBS[rb+'::'+yb];if(zb!==+zb)zb=ba.ATTRIBS['*::'+yb];var ac;if(sa.virtualizeAttrName){ac=sa.virtualizeAttrName(rb,yb);if(typeof ac!=='string'){wb=false;ac=yb;}if(wb&&zb!==+zb)zb=ba.atype.NONE;}else{ac=yb;if(zb!==+zb)wb=false;}var bc='',cc='',dc=false;if(/^[~^$*|]?=$/.test(ra[ob])){bc=ra[ob++];cc=ra[ob++];if(/^[0-9A-Za-z:_\-]+$/.test(cc)){cc='"'+cc+'"';}else if(cc===']'){cc='""';--ob;}if(!/^"([^\"\\]|\\.)*"$/.test(cc))wb=false;dc=ra[ob]==="i";if(dc)++ob;}if(ra[ob]!==']'){++ob;wb=false;}switch(zb){case ba.atype.CLASSES:case ba.atype.LOCAL_NAME:case ba.atype.NONE:break;case ba.atype.GLOBAL_NAME:case ba.atype.ID:case ba.atype.IDREF:if((bc==='='||bc==='~='||bc==='$=')&&cc!='""'&&!dc){cc='"'+cc.substring(1,cc.length-1)+va+'"';}else if(!(bc==='|='||bc===''))wb=false;break;case ba.atype.URI:case ba.atype.URI_FRAGMENT:if(bc!=='')wb=false;break;default:wb=false;}if(wb)tb+='['+ac.replace(/[^\w-]/g,'\\$&')+bc+cc+(dc?' i]':']');}else if(ob<pb&&ra[ob]===':'){vb=ra[++ob];if(pa.test(vb)){ub+=':'+vb;}else break;}else break;}if(ob!==pb)wb=false;if(wb){var ec=(rb+sb).replace(/[^ .*#\w-]/g,'\\$&')+tb+ub+qb;if(ec)hb.push(ec);}return wb;}if(jb){if(hb.length){var nb=hb.join('');if(ua!==null)nb='.'+ua+' '+nb;xa.push(nb);}return true;}else return !ta||ta(ra.slice(fb,gb));}return xa;};(function(){var ra='(?:'+'all|aural|braille|embossed|handheld|print'+'|projection|screen|speech|tty|tv'+')',sa='(?:'+'(?:min-|max-)?'+'(?:'+('(?:device-)?'+'(?:aspect-ratio|height|width)'+'|color(?:-index)?'+'|monochrome'+'|orientation'+'|resolution')+')'+'|grid'+'|hover'+'|luminosity'+'|pointer'+'|scan'+'|script'+')',ta='(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)',ua='-?(?:'+'[a-z]\\w+(?:-\\w+)*'+'|\\d+(?: / \\d+|(?:\\.\\d+)?'+ta+'?)'+')',va='\\( '+sa+' (?:'+': '+ua+' )?\\)',wa='(?:'+'(?:(?:(?:only|not) )?'+ra+'|'+va+')'+'(?: and ?'+va+')*'+')',xa=/^\w/,ya=new RegExp('^'+wa+'(?: , '+wa+')*'+'$','i');y=function(za){za=za.slice();var ab=za.length,bb=0;for(var cb=0;cb<ab;++cb){var db=za[cb];if(db!=' ')za[bb++]=db;}za.length=bb;var eb=za.join(' ');eb=!eb.length?'':!ya.test(eb)?'not all':xa.test(eb)?eb:'not all , '+eb;return eb;};})();(function(){function ra(ta){var ua=/^\s*["]([^"]*)["]\s*$/,va=/^\s*[']([^']*)[']\s*$/,wa=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/,xa=/^\s*url\s*[(][']([^']*)['][)]\s*$/,ya=/^\s*url\s*[(]([^)]*)[)]\s*$/,za;if(za=ua.exec(ta)){return za[1];}else if(za=va.exec(ta)){return za[1];}else if(za=wa.exec(ta)){return za[1];}else if(za=xa.exec(ta)){return za[1];}else if(za=ya.exec(ta))return za[1];return null;}function sa(ta,ua,va,wa,xa,ya,za){var ab=void 0,bb=za||[0],cb=[],db=false;z(ua,{startStylesheet:function(){ab=[];},endStylesheet:function(){},startAtrule:function(fb,gb){if(db){fb=null;}else if(fb==='@media'){ab.push('@media',' ',y(gb));}else if(fb==='@keyframes'||fb==='@-webkit-keyframes'){var hb=gb[0];if(gb.length===1&&!/__$|[^\w\-]/.test(hb)){ab.push(fb,' ',hb+va.idSuffix);fb='@keyframes';}else fb=null;}else if(fb==='@import'&&gb.length>0){fb=null;if('function'===typeof ya){var ib=y(gb.slice(1));if(ib!=='not all'){++bb[0];var jb=[];ab.push(jb);var kb=na(ma(ta,ra(gb[0])),function(lb){var mb=sa(kb,lb.html,va,wa,xa,ya,bb);--bb[0];var nb=ib?{toString:function(){return '@media '+ib+' {'+mb.result+'}';}}:mb.result;jb[0]=nb;ya(nb,!!bb[0]);},xa);}}else if(window.console)window.console.log('@import '+gb.join(' ')+' elided');}db=!fb;cb.push(fb);},endAtrule:function(){cb.pop();if(!db)ab.push(';');eb();},startBlock:function(){if(!db)ab.push('{');},endBlock:function(){if(!db){ab.push('}');db=true;}},startRuleset:function(fb){if(!db){var gb=void 0;if(cb[cb.length-1]==='@keyframes'){gb=fb.join(' ').match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i);db=!gb;if(gb)gb=gb[0].replace(/ +/g,'');}else{var hb=v(fb,va);if(!hb||!hb.length){db=true;}else gb=hb.join(', ');}if(!db)ab.push(gb,'{');}cb.push(null);},endRuleset:function(){cb.pop();if(!db)ab.push('}');eb();},declaration:function(fb,gb){if(!db){var hb=false,ib=gb.length;if(ib>=2&&gb[ib-2]==='!'&&gb[ib-1].toLowerCase()==='important'){hb=true;gb.length-=2;}u(fb,gb,wa,ta,va.idSuffix);if(gb.length)ab.push(fb,':',gb.join(' '),hb?' !important;':';');}}});function eb(){db=cb.length&&cb[cb.length-1]===null;}return {result:{toString:function(){return ab.join('');}},moreToCome:!!bb[0]};}w=function(ta,ua,va,wa){return sa(ta,ua,va,wa,undefined,undefined).result.toString();};x=function(ta,ua,va,wa,xa,ya){return sa(ta,ua,va,wa,xa,ya);};})();})();if(typeof window!=='undefined'){window.sanitizeCssProperty=u;window.sanitizeCssSelectorList=v;window.sanitizeStylesheet=w;window.sanitizeMediaQuery=y;}if('I'.toLowerCase()!=='i')throw 'I/i problem';var z,aa;(function(){z=function(na,oa){var pa=r(na);if(oa.startStylesheet)oa.startStylesheet();for(var qa=0,ra=pa.length;qa<ra;)qa=pa[qa]===' '?qa+1:fa(pa,qa,ra,oa);if(oa.endStylesheet)oa.endStylesheet();};function fa(na,oa,pa,qa){if(oa<pa){var ra=na[oa];if(ra.charAt(0)==='@'){return ga(na,oa,pa,qa,true);}else return ia(na,oa,pa,qa);}else return oa;}function ga(na,oa,pa,qa,ra){var sa=oa++;while(oa<pa&&na[oa]!=='{'&&na[oa]!==';')++oa;if(oa<pa&&(ra||na[oa]===';')){var ta=sa+1,ua=oa;if(ta<pa&&na[ta]===' ')++ta;if(ua>ta&&na[ua-1]===' ')--ua;if(qa.startAtrule)qa.startAtrule(na[sa].toLowerCase(),na.slice(ta,ua));oa=na[oa]==='{'?ha(na,oa,pa,qa):oa+1;if(qa.endAtrule)qa.endAtrule();}return oa;}function ha(na,oa,pa,qa){++oa;if(qa.startBlock)qa.startBlock();while(oa<pa){var ra=na[oa].charAt(0);if(ra=='}'){++oa;break;}if(ra===' '||ra===';'){oa=oa+1;}else if(ra==='@'){oa=ga(na,oa,pa,qa,false);}else if(ra==='{'){oa=ha(na,oa,pa,qa);}else oa=ia(na,oa,pa,qa);}if(qa.endBlock)qa.endBlock();return oa;}function ia(na,oa,pa,qa){var ra=oa,sa=ja(na,oa,pa,true);if(sa<0){sa=~sa;return sa===ra?sa+1:sa;}var ta=na[sa];if(ta!=='{')return sa===ra?sa+1:sa;oa=sa+1;if(sa>ra&&na[sa-1]===' ')--sa;if(qa.startRuleset)qa.startRuleset(na.slice(ra,sa));while(oa<pa){ta=na[oa];if(ta==='}'){++oa;break;}if(ta===' '){oa=oa+1;}else oa=ma(na,oa,pa,qa);}if(qa.endRuleset)qa.endRuleset();return oa;}function ja(na,oa,pa,qa){var ra=oa,sa,ta=[],ua=-1;for(;oa<pa;++oa){sa=na[oa].charAt(0);if(sa==='['||sa==='('){ta[++ua]=sa;}else if(sa===']'&&ta[ua]==='['||sa===')'&&ta[ua]==='('){--ua;}else if(sa==='{'||sa==='}'||sa===';'||sa==='@'||sa===':'&&!qa)break;}if(ua>=0)oa=~(oa+1);return oa;}var ka=/^-?[a-z]/i;function la(na,oa,pa){while(oa<pa&&na[oa]!==';'&&na[oa]!=='}')++oa;return oa<pa&&na[oa]===';'?oa+1:oa;}function ma(na,oa,pa,qa){var ra=na[oa++];if(!ka.test(ra))return la(na,oa,pa);var sa;if(oa<pa&&na[oa]===' ')++oa;if(oa==pa||na[oa]!==':')return la(na,oa,pa);++oa;if(oa<pa&&na[oa]===' ')++oa;var ta=oa,ua=ja(na,oa,pa,false);if(ua<0){ua=~ua;}else{var va=[],wa=0;for(var xa=ta;xa<ua;++xa){sa=na[xa];if(sa!==' ')va[wa++]=sa;}if(ua<pa){do{sa=na[ua];if(sa===';'||sa==='}')break;wa=0;}while(++ua<pa);if(sa===';')++ua;}if(wa&&qa.declaration)qa.declaration(ra.toLowerCase(),va);}return ua;}aa=function(na,oa){var pa=r(na);for(var qa=0,ra=pa.length;qa<ra;)qa=pa[qa]!==' '?ma(pa,qa,ra,oa):qa+1;};})();if(typeof window!=='undefined'){window.parseCssStylesheet=z;window.parseCssDeclarations=aa;}var ba={};ba.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13};ba.atype=ba.atype;ba.ATTRIBS={'*::class':9,'*::dir':0,'*::draggable':0,'*::hidden':0,'*::id':4,'*::inert':0,'*::itemprop':0,'*::itemref':6,'*::itemscope':0,'*::lang':0,'*::onblur':2,'*::onchange':2,'*::onclick':2,'*::ondblclick':2,'*::onerror':2,'*::onfocus':2,'*::onkeydown':2,'*::onkeypress':2,'*::onkeyup':2,'*::onload':2,'*::onmousedown':2,'*::onmousemove':2,'*::onmouseout':2,'*::onmouseover':2,'*::onmouseup':2,'*::onreset':2,'*::onscroll':2,'*::onselect':2,'*::onsubmit':2,'*::ontouchcancel':2,'*::ontouchend':2,'*::ontouchenter':2,'*::ontouchleave':2,'*::ontouchmove':2,'*::ontouchstart':2,'*::onunload':2,'*::spellcheck':0,'*::style':3,'*::tabindex':0,'*::title':0,'*::translate':0,'a::accesskey':0,'a::coords':0,'a::href':1,'a::hreflang':0,'a::name':7,'a::onblur':2,'a::onfocus':2,'a::shape':0,'a::target':10,'a::type':0,'area::accesskey':0,'area::alt':0,'area::coords':0,'area::href':1,'area::nohref':0,'area::onblur':2,'area::onfocus':2,'area::shape':0,'area::target':10,'audio::controls':0,'audio::loop':0,'audio::mediagroup':5,'audio::muted':0,'audio::preload':0,'audio::src':1,'bdo::dir':0,'blockquote::cite':1,'br::clear':0,'button::accesskey':0,'button::disabled':0,'button::name':8,'button::onblur':2,'button::onfocus':2,'button::type':0,'button::value':0,'canvas::height':0,'canvas::width':0,'caption::align':0,'col::align':0,'col::char':0,'col::charoff':0,'col::span':0,'col::valign':0,'col::width':0,'colgroup::align':0,'colgroup::char':0,'colgroup::charoff':0,'colgroup::span':0,'colgroup::valign':0,'colgroup::width':0,'command::checked':0,'command::command':5,'command::disabled':0,'command::icon':1,'command::label':0,'command::radiogroup':0,'command::type':0,'data::value':0,'del::cite':1,'del::datetime':0,'details::open':0,'dir::compact':0,'div::align':0,'dl::compact':0,'fieldset::disabled':0,'font::color':0,'font::face':0,'font::size':0,'form::accept':0,'form::action':1,'form::autocomplete':0,'form::enctype':0,'form::method':0,'form::name':7,'form::novalidate':0,'form::onreset':2,'form::onsubmit':2,'form::target':10,'h1::align':0,'h2::align':0,'h3::align':0,'h4::align':0,'h5::align':0,'h6::align':0,'hr::align':0,'hr::noshade':0,'hr::size':0,'hr::width':0,'iframe::align':0,'iframe::frameborder':0,'iframe::height':0,'iframe::marginheight':0,'iframe::marginwidth':0,'iframe::width':0,'img::align':0,'img::alt':0,'img::border':0,'img::height':0,'img::hspace':0,'img::ismap':0,'img::name':7,'img::src':1,'img::usemap':11,'img::vspace':0,'img::width':0,'input::accept':0,'input::accesskey':0,'input::align':0,'input::alt':0,'input::autocomplete':0,'input::checked':0,'input::disabled':0,'input::inputmode':0,'input::ismap':0,'input::list':5,'input::max':0,'input::maxlength':0,'input::min':0,'input::multiple':0,'input::name':8,'input::onblur':2,'input::onchange':2,'input::onfocus':2,'input::onselect':2,'input::pattern':0,'input::placeholder':0,'input::readonly':0,'input::required':0,'input::size':0,'input::src':1,'input::step':0,'input::type':0,'input::usemap':11,'input::value':0,'ins::cite':1,'ins::datetime':0,'label::accesskey':0,'label::for':5,'label::onblur':2,'label::onfocus':2,'legend::accesskey':0,'legend::align':0,'li::type':0,'li::value':0,'map::name':7,'menu::compact':0,'menu::label':0,'menu::type':0,'meter::high':0,'meter::low':0,'meter::max':0,'meter::min':0,'meter::optimum':0,'meter::value':0,'ol::compact':0,'ol::reversed':0,'ol::start':0,'ol::type':0,'optgroup::disabled':0,'optgroup::label':0,'option::disabled':0,'option::label':0,'option::selected':0,'option::value':0,'output::for':6,'output::name':8,'p::align':0,'pre::width':0,'progress::max':0,'progress::min':0,'progress::value':0,'q::cite':1,'select::autocomplete':0,'select::disabled':0,'select::multiple':0,'select::name':8,'select::onblur':2,'select::onchange':2,'select::onfocus':2,'select::required':0,'select::size':0,'source::type':0,'table::align':0,'table::bgcolor':0,'table::border':0,'table::cellpadding':0,'table::cellspacing':0,'table::frame':0,'table::rules':0,'table::summary':0,'table::width':0,'tbody::align':0,'tbody::char':0,'tbody::charoff':0,'tbody::valign':0,'td::abbr':0,'td::align':0,'td::axis':0,'td::bgcolor':0,'td::char':0,'td::charoff':0,'td::colspan':0,'td::headers':6,'td::height':0,'td::nowrap':0,'td::rowspan':0,'td::scope':0,'td::valign':0,'td::width':0,'textarea::accesskey':0,'textarea::autocomplete':0,'textarea::cols':0,'textarea::disabled':0,'textarea::inputmode':0,'textarea::name':8,'textarea::onblur':2,'textarea::onchange':2,'textarea::onfocus':2,'textarea::onselect':2,'textarea::placeholder':0,'textarea::readonly':0,'textarea::required':0,'textarea::rows':0,'textarea::wrap':0,'tfoot::align':0,'tfoot::char':0,'tfoot::charoff':0,'tfoot::valign':0,'th::abbr':0,'th::align':0,'th::axis':0,'th::bgcolor':0,'th::char':0,'th::charoff':0,'th::colspan':0,'th::headers':6,'th::height':0,'th::nowrap':0,'th::rowspan':0,'th::scope':0,'th::valign':0,'th::width':0,'thead::align':0,'thead::char':0,'thead::charoff':0,'thead::valign':0,'tr::align':0,'tr::bgcolor':0,'tr::char':0,'tr::charoff':0,'tr::valign':0,'track::default':0,'track::kind':0,'track::label':0,'track::srclang':0,'ul::compact':0,'ul::type':0,'video::controls':0,'video::height':0,'video::loop':0,'video::mediagroup':5,'video::muted':0,'video::poster':1,'video::preload':0,'video::src':1,'video::width':0};ba.ATTRIBS=ba.ATTRIBS;ba.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256};ba.eflags=ba.eflags;ba.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,'var':0,video:0,wbr:2};ba.ELEMENTS=ba.ELEMENTS;ba.ELEMENT_DOM_INTERFACES={a:'HTMLAnchorElement',abbr:'HTMLElement',acronym:'HTMLElement',address:'HTMLElement',applet:'HTMLAppletElement',area:'HTMLAreaElement',article:'HTMLElement',aside:'HTMLElement',audio:'HTMLAudioElement',b:'HTMLElement',base:'HTMLBaseElement',basefont:'HTMLBaseFontElement',bdi:'HTMLElement',bdo:'HTMLElement',big:'HTMLElement',blockquote:'HTMLQuoteElement',body:'HTMLBodyElement',br:'HTMLBRElement',button:'HTMLButtonElement',canvas:'HTMLCanvasElement',caption:'HTMLTableCaptionElement',center:'HTMLElement',cite:'HTMLElement',code:'HTMLElement',col:'HTMLTableColElement',colgroup:'HTMLTableColElement',command:'HTMLCommandElement',data:'HTMLElement',datalist:'HTMLDataListElement',dd:'HTMLElement',del:'HTMLModElement',details:'HTMLDetailsElement',dfn:'HTMLElement',dialog:'HTMLDialogElement',dir:'HTMLDirectoryElement',div:'HTMLDivElement',dl:'HTMLDListElement',dt:'HTMLElement',em:'HTMLElement',fieldset:'HTMLFieldSetElement',figcaption:'HTMLElement',figure:'HTMLElement',font:'HTMLFontElement',footer:'HTMLElement',form:'HTMLFormElement',frame:'HTMLFrameElement',frameset:'HTMLFrameSetElement',h1:'HTMLHeadingElement',h2:'HTMLHeadingElement',h3:'HTMLHeadingElement',h4:'HTMLHeadingElement',h5:'HTMLHeadingElement',h6:'HTMLHeadingElement',head:'HTMLHeadElement',header:'HTMLElement',hgroup:'HTMLElement',hr:'HTMLHRElement',html:'HTMLHtmlElement',i:'HTMLElement',iframe:'HTMLIFrameElement',img:'HTMLImageElement',input:'HTMLInputElement',ins:'HTMLModElement',isindex:'HTMLUnknownElement',kbd:'HTMLElement',keygen:'HTMLKeygenElement',label:'HTMLLabelElement',legend:'HTMLLegendElement',li:'HTMLLIElement',link:'HTMLLinkElement',map:'HTMLMapElement',mark:'HTMLElement',menu:'HTMLMenuElement',meta:'HTMLMetaElement',meter:'HTMLMeterElement',nav:'HTMLElement',nobr:'HTMLElement',noembed:'HTMLElement',noframes:'HTMLElement',noscript:'HTMLElement',object:'HTMLObjectElement',ol:'HTMLOListElement',optgroup:'HTMLOptGroupElement',option:'HTMLOptionElement',output:'HTMLOutputElement',p:'HTMLParagraphElement',param:'HTMLParamElement',pre:'HTMLPreElement',progress:'HTMLProgressElement',q:'HTMLQuoteElement',s:'HTMLElement',samp:'HTMLElement',script:'HTMLScriptElement',section:'HTMLElement',select:'HTMLSelectElement',small:'HTMLElement',source:'HTMLSourceElement',span:'HTMLSpanElement',strike:'HTMLElement',strong:'HTMLElement',style:'HTMLStyleElement',sub:'HTMLElement',summary:'HTMLElement',sup:'HTMLElement',table:'HTMLTableElement',tbody:'HTMLTableSectionElement',td:'HTMLTableDataCellElement',textarea:'HTMLTextAreaElement',tfoot:'HTMLTableSectionElement',th:'HTMLTableHeaderCellElement',thead:'HTMLTableSectionElement',time:'HTMLTimeElement',title:'HTMLTitleElement',tr:'HTMLTableRowElement',track:'HTMLTrackElement',tt:'HTMLElement',u:'HTMLElement',ul:'HTMLUListElement','var':'HTMLElement',video:'HTMLVideoElement',wbr:'HTMLElement'};ba.ELEMENT_DOM_INTERFACES=ba.ELEMENT_DOM_INTERFACES;ba.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};ba.ueffects=ba.ueffects;ba.URIEFFECTS={'a::href':2,'area::href':2,'audio::src':1,'blockquote::cite':0,'command::icon':1,'del::cite':0,'form::action':2,'img::src':1,'input::src':1,'ins::cite':0,'q::cite':0,'video::poster':1,'video::src':1};ba.URIEFFECTS=ba.URIEFFECTS;ba.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0};ba.ltypes=ba.ltypes;ba.LOADERTYPES={'a::href':2,'area::href':2,'audio::src':2,'blockquote::cite':2,'command::icon':1,'del::cite':2,'form::action':2,'img::src':1,'input::src':1,'ins::cite':2,'q::cite':2,'video::poster':1,'video::src':2};ba.LOADERTYPES=ba.LOADERTYPES;if(typeof window!=='undefined')window.html4=ba;if('I'.toLowerCase()!=='i')throw 'I/i problem';var ca={};ca.TagPolicyDecision;ca.TagPolicy;var da=function(fa){var ga,ha,ia;if('undefined'!==typeof window){ga=window.parseCssDeclarations;ha=window.sanitizeCssProperty;ia=window.cssSchema;}var ja={lt:'<',LT:'<',gt:'>',GT:'>',amp:'&',AMP:'&',quot:'"',apos:'\'',nbsp:'\u00A0'},ka=/^#(\d+)$/,la=/^#x([0-9A-Fa-f]+)$/,ma=/^[A-Za-z][A-za-z0-9]+$/,na='undefined'!==typeof window&&window.document?window.document.createElement('textarea'):null;function oa(ec){if(ja.hasOwnProperty(ec))return ja[ec];var fc=ec.match(ka);if(fc){return String.fromCharCode(parseInt(fc[1],10));}else if(!!(fc=ec.match(la))){return String.fromCharCode(parseInt(fc[1],16));}else if(na&&ma.test(ec)){na.innerHTML='&'+ec+';';var gc=na.textContent;ja[ec]=gc;return gc;}else return '&'+ec+';';}function pa(ec,fc){return oa(fc);}var qa=/\0/g;function ra(ec){return ec.replace(qa,'');}var sa=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,ta=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/;function ua(ec){return ec.replace(sa,pa);}var va=/&/g,wa=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,xa=/[<]/g,ya=/>/g,za=/\"/g;function ab(ec){return (''+ec).replace(va,'&amp;').replace(xa,'&lt;').replace(ya,'&gt;').replace(za,'&#34;');}function bb(ec){return ec.replace(wa,'&amp;$1').replace(xa,'&lt;').replace(ya,'&gt;');}var cb=new RegExp('^\\s*'+'([-.:\\w]+)'+'(?:'+('\\s*(=)\\s*'+'('+('(\")[^\"]*(\"|$)'+'|'+'(\')[^\']*(\'|$)'+'|'+'(?=[a-z][-\\w]*\\s*=)'+'|'+'[^\"\'\\s]*')+')')+')?','i'),db='a,b'.split(/(,)/).length===3,eb=fa.eflags.CDATA|fa.eflags.RCDATA;function fb(ec){var fc={cdata:ec.cdata||ec.cdata,comment:ec.comment||ec.comment,endDoc:ec.endDoc||ec.endDoc,endTag:ec.endTag||ec.endTag,pcdata:ec.pcdata||ec.pcdata,rcdata:ec.rcdata||ec.rcdata,startDoc:ec.startDoc||ec.startDoc,startTag:ec.startTag||ec.startTag};return function(gc,hc){return hb(gc,fc,hc);};}var gb={};function hb(ec,fc,gc){var hc,ic,jc,kc=kb(ec),lc={noMoreGT:false,noMoreEndComments:false};jb(fc,kc,0,lc,gc);}function ib(ec,fc,gc,hc,ic){return function(){jb(ec,fc,gc,hc,ic);};}function jb(ec,fc,gc,hc,ic){try{if(ec.startDoc&&gc==0)ec.startDoc(ic);var jc,kc,lc;for(var mc=gc,nc=fc.length;mc<nc;){var oc=fc[mc++],pc=fc[mc];switch(oc){case '&':if(ta.test(pc)){if(ec.pcdata)ec.pcdata('&'+pc,ic,gb,ib(ec,fc,mc,hc,ic));mc++;}else if(ec.pcdata)ec.pcdata("&amp;",ic,gb,ib(ec,fc,mc,hc,ic));break;case '<\/':if(jc=/^([-\w:]+)[^\'\"]*/.exec(pc)){if(jc[0].length===pc.length&&fc[mc+1]==='>'){mc+=2;lc=jc[1].toLowerCase();if(ec.endTag)ec.endTag(lc,ic,gb,ib(ec,fc,mc,hc,ic));}else mc=lb(fc,mc,ec,ic,gb,hc);}else if(ec.pcdata)ec.pcdata('&lt;/',ic,gb,ib(ec,fc,mc,hc,ic));break;case '<':if(jc=/^([-\w:]+)\s*\/?/.exec(pc)){if(jc[0].length===pc.length&&fc[mc+1]==='>'){mc+=2;lc=jc[1].toLowerCase();if(ec.startTag)ec.startTag(lc,[],ic,gb,ib(ec,fc,mc,hc,ic));var qc=fa.ELEMENTS[lc];if(qc&eb){var rc={name:lc,next:mc,eflags:qc};mc=ob(fc,rc,ec,ic,gb,hc);}}else mc=mb(fc,mc,ec,ic,gb,hc);}else if(ec.pcdata)ec.pcdata('&lt;',ic,gb,ib(ec,fc,mc,hc,ic));break;case '<\!--':if(!hc.noMoreEndComments){for(kc=mc+1;kc<nc;kc++)if(fc[kc]==='>'&&/--$/.test(fc[kc-1]))break;if(kc<nc){if(ec.comment){var sc=fc.slice(mc,kc).join('');ec.comment(sc.substr(0,sc.length-2),ic,gb,ib(ec,fc,kc+1,hc,ic));}mc=kc+1;}else hc.noMoreEndComments=true;}if(hc.noMoreEndComments)if(ec.pcdata)ec.pcdata('&lt;!--',ic,gb,ib(ec,fc,mc,hc,ic));break;case '<\!':if(!/^\w/.test(pc)){if(ec.pcdata)ec.pcdata('&lt;!',ic,gb,ib(ec,fc,mc,hc,ic));}else{if(!hc.noMoreGT){for(kc=mc+1;kc<nc;kc++)if(fc[kc]==='>')break;if(kc<nc){mc=kc+1;}else hc.noMoreGT=true;}if(hc.noMoreGT)if(ec.pcdata)ec.pcdata('&lt;!',ic,gb,ib(ec,fc,mc,hc,ic));}break;case '<?':if(!hc.noMoreGT){for(kc=mc+1;kc<nc;kc++)if(fc[kc]==='>')break;if(kc<nc){mc=kc+1;}else hc.noMoreGT=true;}if(hc.noMoreGT)if(ec.pcdata)ec.pcdata('&lt;?',ic,gb,ib(ec,fc,mc,hc,ic));break;case '>':if(ec.pcdata)ec.pcdata("&gt;",ic,gb,ib(ec,fc,mc,hc,ic));break;case '':break;default:if(ec.pcdata)ec.pcdata(oc,ic,gb,ib(ec,fc,mc,hc,ic));break;}}if(ec.endDoc)ec.endDoc(ic);}catch(tc){if(tc!==gb)throw tc;}}function kb(ec){var fc=/(<\/|<\!--|<[!?]|[&<>])/g;ec+='';if(db){return ec.split(fc);}else{var gc=[],hc=0,ic;while((ic=fc.exec(ec))!==null){gc.push(ec.substring(hc,ic.index));gc.push(ic[0]);hc=ic.index+ic[0].length;}gc.push(ec.substring(hc));return gc;}}function lb(ec,fc,gc,hc,ic,jc){var kc=pb(ec,fc);if(!kc)return ec.length;if(gc.endTag)gc.endTag(kc.name,hc,ic,ib(gc,ec,fc,jc,hc));return kc.next;}function mb(ec,fc,gc,hc,ic,jc){var kc=pb(ec,fc);if(!kc)return ec.length;if(gc.startTag)gc.startTag(kc.name,kc.attrs,hc,ic,ib(gc,ec,kc.next,jc,hc));if(kc.eflags&eb){return ob(ec,kc,gc,hc,ic,jc);}else return kc.next;}var nb={};function ob(ec,fc,gc,hc,ic,jc){var kc=ec.length;if(!nb.hasOwnProperty(fc.name))nb[fc.name]=new RegExp('^'+fc.name+'(?:[\\s\\/]|$)','i');var lc=nb[fc.name],mc=fc.next,nc=fc.next+1;for(;nc<kc;nc++)if(ec[nc-1]==='<\/'&&lc.test(ec[nc]))break;if(nc<kc)nc-=1;var oc=ec.slice(mc,nc).join('');if(fc.eflags&fa.eflags.CDATA){if(gc.cdata)gc.cdata(oc,hc,ic,ib(gc,ec,nc,jc,hc));}else if(fc.eflags&fa.eflags.RCDATA){if(gc.rcdata)gc.rcdata(bb(oc),hc,ic,ib(gc,ec,nc,jc,hc));}else throw new Error('bug');return nc;}function pb(ec,fc){var gc=/^([-\w:]+)/.exec(ec[fc]),hc={};hc.name=gc[1].toLowerCase();hc.eflags=fa.ELEMENTS[hc.name];var ic=ec[fc].substr(gc[0].length),jc=fc+1,kc=ec.length;for(;jc<kc;jc++){if(ec[jc]==='>')break;ic+=ec[jc];}if(kc<=jc)return void 0;var lc=[];while(ic!==''){gc=cb.exec(ic);if(!gc){ic=ic.replace(/^[\s\S][^a-z\s]*/,'');}else if(gc[4]&&!gc[5]||gc[6]&&!gc[7]){var mc=gc[4]||gc[6],nc=false,oc=[ic,ec[jc++]];for(;jc<kc;jc++){if(nc){if(ec[jc]==='>')break;}else if(0<=ec[jc].indexOf(mc))nc=true;oc.push(ec[jc]);}if(kc<=jc)break;ic=oc.join('');continue;}else{var pc=gc[1].toLowerCase(),qc=gc[2]?qb(gc[3]):'';lc.push(pc,qc);ic=ic.substr(gc[0].length);}}hc.attrs=lc;hc.next=jc+1;return hc;}function qb(ec){var fc=ec.charCodeAt(0);if(fc===34||fc===39)ec=ec.substr(1,ec.length-2);return ua(ra(ec));}function rb(ec){var fc,gc,hc=function(ic,jc){if(!gc)jc.push(ic);};return fb({startDoc:function(ic){fc=[];gc=false;},startTag:function(ic,jc,kc){if(gc)return;if(!fa.ELEMENTS.hasOwnProperty(ic))return;var lc=fa.ELEMENTS[ic];if(lc&fa.eflags.FOLDABLE)return;var mc=ec(ic,jc);if(!mc){gc=!(lc&fa.eflags.EMPTY);return;}else if(typeof mc!=='object')throw new Error('tagPolicy did not return object (old API?)');if('attribs' in mc){jc=mc.attribs;}else throw new Error('tagPolicy gave no attribs');var nc,oc;if('tagName' in mc){oc=mc.tagName;nc=fa.ELEMENTS[oc];}else{oc=ic;nc=lc;}if(lc&fa.eflags.OPTIONAL_ENDTAG){var pc=fc[fc.length-1];if(pc&&pc.orig===ic&&(pc.rep!==oc||ic!==oc))kc.push('<\/',pc.rep,'>');}if(!(lc&fa.eflags.EMPTY))fc.push({orig:ic,rep:oc});kc.push('<',oc);for(var qc=0,rc=jc.length;qc<rc;qc+=2){var sc=jc[qc],tc=jc[qc+1];if(tc!==null&&tc!==void 0)kc.push(' ',sc,'="',ab(tc),'"');}kc.push('>');if(lc&fa.eflags.EMPTY&&!(nc&fa.eflags.EMPTY))kc.push('<\/',oc,'>');},endTag:function(ic,jc){if(gc){gc=false;return;}if(!fa.ELEMENTS.hasOwnProperty(ic))return;var kc=fa.ELEMENTS[ic];if(!(kc&(fa.eflags.EMPTY|fa.eflags.FOLDABLE))){var lc;if(kc&fa.eflags.OPTIONAL_ENDTAG){for(lc=fc.length;--lc>=0;){var mc=fc[lc].orig;if(mc===ic)break;if(!(fa.ELEMENTS[mc]&fa.eflags.OPTIONAL_ENDTAG))return;}}else for(lc=fc.length;--lc>=0;)if(fc[lc].orig===ic)break;if(lc<0)return;for(var nc=fc.length;--nc>lc;){var oc=fc[nc].rep;if(!(fa.ELEMENTS[oc]&fa.eflags.OPTIONAL_ENDTAG))jc.push('<\/',oc,'>');}if(lc<fc.length)ic=fc[lc].rep;fc.length=lc;jc.push('<\/',ic,'>');}},pcdata:hc,rcdata:hc,cdata:hc,endDoc:function(ic){for(;fc.length;fc.length--)ic.push('<\/',fc[fc.length-1].rep,'>');}});}var sb=/^(?:https?|mailto)$/i;function tb(ec,fc,gc,hc,ic){if(!ic)return null;try{var jc=t.parse(''+ec);if(jc)if(!jc.hasScheme()||sb.test(jc.getScheme())){var kc=ic(jc,fc,gc,hc);return kc?kc.toString():null;}}catch(lc){return null;}return null;}function ub(ec,fc,gc,hc,ic){if(!gc)ec(fc+" removed",{change:"removed",tagName:fc});if(hc!==ic){var jc="changed";if(hc&&!ic){jc="removed";}else if(!hc&&ic)jc="added";ec(fc+"."+gc+" "+jc,{change:jc,tagName:fc,attribName:gc,oldValue:hc,newValue:ic});}}function vb(ec,fc,gc){var hc;hc=fc+'::'+gc;if(ec.hasOwnProperty(hc))return ec[hc];hc='*::'+gc;if(ec.hasOwnProperty(hc))return ec[hc];return void 0;}function wb(ec,fc){return vb(fa.ATTRIBS,ec,fc);}function xb(ec,fc){return vb(fa.LOADERTYPES,ec,fc);}function yb(ec,fc){return vb(fa.URIEFFECTS,ec,fc);}function zb(ec,fc,gc,hc,ic){for(var jc=0;jc<fc.length;jc+=2){var kc=fc[jc],lc=fc[jc+1],mc=lc,nc=null,oc;if((oc=ec+'::'+kc,fa.ATTRIBS.hasOwnProperty(oc))||(oc='*::'+kc,fa.ATTRIBS.hasOwnProperty(oc)))nc=fa.ATTRIBS[oc];if(nc!==null){switch(nc){case fa.atype.NONE:break;case fa.atype.SCRIPT:lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.STYLE:if('undefined'===typeof ga){lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;}var pc=[];ga(lc,{declaration:function(qc,rc){var sc=qc.toLowerCase();ha(sc,rc,gc?function(tc){return tb(tc,fa.ueffects.SAME_DOCUMENT,fa.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:sc},gc);}:null);if(rc.length)pc.push(sc+': '+rc.join(' '));}});lc=pc.length>0?pc.join(' ; '):null;if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.ID:case fa.atype.IDREF:case fa.atype.IDREFS:case fa.atype.GLOBAL_NAME:case fa.atype.LOCAL_NAME:case fa.atype.CLASSES:lc=hc?hc(lc):lc;if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.URI:lc=tb(lc,yb(ec,kc),xb(ec,kc),{TYPE:"MARKUP",XML_ATTR:kc,XML_TAG:ec},gc);if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.URI_FRAGMENT:if(lc&&'#'===lc.charAt(0)){lc=lc.substring(1);lc=hc?hc(lc):lc;if(lc!==null&&lc!==void 0)lc='#'+lc;}else lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;default:lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;}}else{lc=null;if(ic)ub(ic,ec,kc,mc,lc);}fc[jc+1]=lc;}return fc;}function ac(ec,fc,gc,hc){return function(ic,jc){var kc=true;if(hc){kc=false;hc.forEach(function(lc){if(ic==lc)kc=true;});}if(!(fa.ELEMENTS[ic]&fa.eflags.UNSAFE)&&kc){return {attribs:zb(ic,jc,ec,fc,gc)};}else if(gc)ub(gc,ic,undefined,undefined,undefined);};}function bc(ec,fc){var gc=[];rb(fc)(ec,gc);return gc.join('');}function cc(ec,fc,gc,hc,ic){var jc=ac(fc,gc,hc,ic);return bc(ec,jc);}var dc={};dc.escapeAttrib=dc.escapeAttrib=ab;dc.makeHtmlSanitizer=dc.makeHtmlSanitizer=rb;dc.makeSaxParser=dc.makeSaxParser=fb;dc.makeTagPolicy=dc.makeTagPolicy=ac;dc.normalizeRCData=dc.normalizeRCData=bb;dc.sanitize=dc.sanitize=cc;dc.sanitizeAttribs=dc.sanitizeAttribs=zb;dc.sanitizeWithPolicy=dc.sanitizeWithPolicy=bc;dc.unescapeEntities=dc.unescapeEntities=ua;return dc;}(ba),ea=da.sanitize;if(typeof window!=='undefined'){window.html=da;window.html_sanitize=ea;}f.exports=da;}),null);
__d('OzTaskComposers.react',['cx','OzHelpers','OzAPI','CajaHTMLSanitizer','CIWebmailValidator','DraftEditor.react','EditorState','ContentState','FileInput.react','immutable','OzNotify','OzActions','OzDateTimePicker.react','OzDraggableModal.react','OzPlaceField.react','promiseFinally','OzImmutablePureRenderMixin','React','Reflux','XUICloseButton.react','XUIError.react'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m=c('CIWebmailValidator').isValidEmail,n=c('immutable').Map,o=c('immutable').List,p=c('immutable').Record,q=c('React').PropTypes,r={intentId:null,id:null,type:null,errors:n(),disabled:false,sending:false},s=['to'],t=['from'],u=['cc'],v=['bcc'],w=['body',0,'body','contents'],x=c('immutable').fromJS([{'content-type':'text/plain; charset=UTF-8',body:{contents:''}}]),y=c('immutable').fromJS({to:'',cc:'',bcc:'',from:'',subject:'',body:x}),z=p(babelHelpers['extends']({},r,{email:y,uploadSem:0})),aa=c('Reflux').createStore({init:function za(){this._offlineId=0;this.data=n();this.listenToMany(c('OzActions').emailComposer);},getInitialState:function za(){return this.data;},onUpdate:function za(ab){this._u(function(bb){return bb.set(ab.get('id'),ab);});},onDelete:function za(ab){this._u(function(bb){return bb['delete'](ab);});},onAdd:function za(){var ab=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],bb=new z(ab).update('id',function(cb){return cb||this._offlineId++;}.bind(this)).updateIn(['email','from'],function(cb){return ab.from||(o.isList(cb)?cb.first():cb);}).update('email',oa);this._u(function(cb){return cb.set(bb.get('id'),bb);});},_u:function za(ab){this.data=ab(this.data);this.trigger(this.data);}}),ba=c('React').createClass({displayName:'EmailContainer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{emailState:q.instanceOf(z).isRequired},render:function za(){var ab=this.props.emailState;return c('React').createElement(ca,{email:ab.get('email'),errors:ab.get('errors'),disabled:ab.get('disabled'),sending:ab.get('sending'),onClose:this._handleClose,onChange:this._handleChange,onSend:this._handleSend,onUpload:this._handleUpload,onAttOpen:this._handleAttOpen});},_handleClose:function za(){c('OzActions').emailComposer['delete'](this.props.emailState.get('id'));},_handleChange:function za(ab){c('OzActions').emailComposer.update(this.props.emailState.set('email',ab));},_handleSend:function za(){var ab=this.props.emailState,bb=ab.get('email'),cb=[[bb.getIn(s),'Please specify a destination email address'],[bb.get('subject'),'Please write a subject'],[bb.getIn(w),'Please write a message'],[ab.get('uploadSem')===0,'Your attachments are still uploading']].find(function(fb){var gb=fb[0],hb=fb[1];return !gb;});if(cb){c('OzNotify').error(cb[1]);return;}var db=pa(bb).set('intent-id',ab.get('intentId')),eb=n({to:s,cc:u,bcc:v}).map(function(fb){return ma(db.getIn(fb));}).filter(function(fb){return fb;});if(!eb.isEmpty()){c('OzActions').emailComposer.update(ab.set('errors',eb));return;}c('OzActions').emailComposer.update(ab.set('sending',true));c('OzAPI').sendEmail(db,ab.get('intentId')).then(function(fb){c('OzActions').emailComposer['delete'](ab.get('id'));})['catch'](function(fb){c('OzActions').emailComposer.update(ab.set('sending',false));});},_handleAttOpen:function za(ab){var bb=ab.getIn(['body','everstore-handle']);c('OzAPI').everstoreURI(bb).done(function(cb){return window.open(cb);});},_handleUpload:function za(ab){var bb=function(db){return c('OzActions').emailComposer.update(this.props.emailState.update('uploadSem',function(eb){return eb+db;}));}.bind(this);bb(1);var cb=c('OzAPI').everstoreUpload(n({blob:ab})).then(function(db){return na(db,ab);}).then(function(db){c('OzActions').emailComposer.update(this.props.emailState.updateIn(['email','body'],function(eb){return eb.push(db);}));}.bind(this));c('promiseFinally')(cb,function(db){return bb(-1);});}});i=babelHelpers.inherits(ca,c('React').Component);j=i&&i.prototype;function ca(za){'use strict';j.constructor.call(this,za);var ab=function bb(cb){return c('EditorState').createWithContent(c('ContentState').createFromText(za.email.getIn(cb)||''));};this.state={showCC:false,showBCC:false,inputEditorStates:{from:ab(t),to:ab(s),cc:ab(u),bcc:ab(v),subject:ab(['subject'])}};}ca.prototype.componentDidMount=function(){'use strict';var za=['to','subject'].find(function(bb){var cb=this.state.inputEditorStates[bb];return cb&&!cb.getCurrentContent().getPlainText().length;}.bind(this)),ab=this.refs[za||'body'];ab&&ab.focus();};ca.prototype.render=function(){'use strict';var za=this.props,ab=za.email,bb=za.errors,cb=za.onClose,db=za.onUpload,eb=za.onAttOpen,fb=za.onChange,gb=za.onSend,hb=za.disabled,ib=za.sending,jb=this.state.showCC||hb&&ab.getIn(u),kb=this.state.showBCC||hb&&ab.getIn(v),lb=function(ob,pb,qb){return c('React').createElement(ea,{error:bb.get(pb),editorState:this.state.inputEditorStates[pb],disabled:hb||ib,placeholder:ob,ref:pb,onChange:function(rb){var sb;this.setState({inputEditorStates:babelHelpers['extends']({},this.state.inputEditorStates,(sb={},sb[pb]=rb,sb))});var tb=rb.getCurrentContent().getPlainText();fb(ab.setIn(qb,tb));}.bind(this)});}.bind(this),mb=ja(ab,'text/plain');if(mb==-1)mb=0;var nb=['body',mb,'body','contents'];return c('React').createElement(c('OzDraggableModal.react'),{className:"_4h1d",getHandle:function(ob){return this.refs.header;}.bind(this)},c('React').createElement('div',null,c('React').createElement('div',{className:"_4h1e",ref:'header'},c('React').createElement(c('XUICloseButton.react'),{onClick:cb})),c('React').createElement(ea,{editorState:this.state.inputEditorStates.from,disabled:true,onChange:function ob(pb){return null;}}),c('React').createElement('div',{className:"_1jg2"},lb('To','to',s),!jb&&!(hb||ib)?c('React').createElement('button',{tabIndex:'-1',className:"_1jg3",onClick:function(ob){return this.setState({showCC:true});}.bind(this)},'CC'):null,!kb&&!(hb||ib)?c('React').createElement('button',{tabIndex:'-1',className:"_1jg3",onClick:function(ob){return this.setState({showBCC:true});}.bind(this)},'BCC'):null),jb?lb('Cc','cc',u):null,kb?lb('Bcc','bcc',v):null,lb('Subject','subject',['subject']),hb?c('React').createElement(da,{email:ab}):c('React').createElement('textarea',{disabled:hb||ib,placeholder:'Write your masterpiece',ref:'body',className:"_1-i0 _4h1j",value:ab.getIn(nb),onChange:function ob(pb){return fb(ab.setIn(nb,pb.target.value));}}),c('React').createElement(ga,{email:ab,onChange:fb,onAttOpen:eb}),hb?null:c('React').createElement('div',{className:"_5l1v"},c('React').createElement('button',{onClick:gb,disabled:ib,className:"_1-hv _30yy _n8p"},ib?'Sending...':'Send'),c('React').createElement(c('FileInput.react'),{ref:'fileInput',onChange:function(ob){db(ob.target.files[0]);this.refs.fileInput.getFileInput().clear();}.bind(this)},c('React').createElement('a',{title:'add images',className:"_5l1w _30yy"})))));};ca.propTypes={onClose:q.func.isRequired,onSend:q.func,disabled:q.bool,sending:q.bool,email:q.instanceOf(n).isRequired,errors:q.instanceOf(n),onChange:q.func.isRequired,onUpload:q.func.isRequired,onAttOpen:q.func.isRequired};var da=c('OzHelpers').pure(function(za){var ab=za.email,bb=ia(ab,'text/html','text/plain'),cb=bb.getIn(['body','contents']);return c('React').createElement('div',{className:"_3x40"},la(bb)?c('React').createElement('div',{style:{whiteSpace:'pre-wrap'}},cb):c('React').createElement(fa,{html:cb}));}),ea=c('React').createClass({displayName:'EmailInput',propTypes:{disabled:q.bool,editorState:q.instanceOf(c('EditorState')).isRequired,error:q.string,onChange:q.func,placeholder:q.string},defaultProps:{disabled:false,error:null,onChange:function za(){},placeholder:null},focus:function za(){this.refs.editor.focus();},render:function za(){return c('React').createElement(c('XUIError.react'),{xuiError:this.props.error,xuiErrorPosition:'left'},c('React').createElement('div',{className:"_1-i0 _4h1i",onClick:this.focus,role:'presentation'},c('React').createElement(c('DraftEditor.react'),{editorState:this.props.editorState,ref:'editor',onChange:this.props.onChange,placeholder:this.props.placeholder,readOnly:this.props.disabled})));}}),fa=c('OzHelpers').pure(function(za){var ab=za.html,bb=babelHelpers.objectWithoutProperties(za,['html']);return c('React').createElement('div',babelHelpers['extends']({},bb,{dangerouslySetInnerHTML:{__html:c('CajaHTMLSanitizer').sanitize(ab,function(cb){return cb;})}}));}),ga=c('OzHelpers').pure(function(za){var ab=za.email,bb=za.onAttOpen,cb=za.onChange,db=ab.get('body').map(function(eb,fb){return ka(eb)?null:c('React').createElement(ha,{key:fb,part:eb,onClick:function gb(hb){return bb(eb);},onRemove:function gb(hb){return cb(ab.update('body',function(ib){return ib['delete'](fb);}));}});}).filter(function(eb){return !!eb;});return db.isEmpty()?null:c('React').createElement('div',{className:"_5l1-"},db);}),ha=c('OzHelpers').pure(function(za){var ab=za.part,bb=za.onClick,cb=za.onRemove;return c('React').createElement('div',{className:"_5l26"},c('React').createElement('button',{className:"_1-hv",onClick:bb},ab.getIn(['body','filename'])),c('React').createElement(c('XUICloseButton.react'),{onClick:cb}));});function ia(za){for(var ab=arguments.length,bb=Array(ab>1?ab-1:0),cb=1;cb<ab;cb++)bb[cb-1]=arguments[cb];var db=bb.map(function(eb){return ja(za,eb);}).find(function(eb){return eb>-1;});return Number.isSafeInteger(db)?za.getIn(['body',db]):x.first();}function ja(za,ab){return za.get('body').findIndex(function(bb){return bb.get('content-type').indexOf(ab)>-1;});}function ka(za){var ab=za.get('content-type');return ab&&ab.indexOf('text/plain')>-1||ab.indexOf('text/html')>-1;}function la(za){return za.get('content-type').indexOf('text/plain')>-1;}function ma(za){za=o(za);var ab=za.filterNot(m);return ab.isEmpty()?null:'Invalid email address(es): '+ab.join(', ')+'.';}function na(za,ab){return c('immutable').fromJS({'content-type':ab.type,body:{'everstore-handle':za,filename:ab.name}});}function oa(za){return za.updateIn(s,qa).updateIn(u,qa).updateIn(v,qa);}function pa(za){return za.updateIn(s,ra).updateIn(u,ra).updateIn(v,ra);}function qa(za){return za&&za.join(', ');}function ra(za){return za?za.split(/[, ]/).filter(function(ab){return ab.length;}):[];}var sa=c('immutable').fromJS({title:'',description:'',start:null,startTimezone:'',end:null,endTimezone:'',location:'',to:''}),ta=p(babelHelpers['extends']({},r,{invite:sa})),ua=c('Reflux').createStore({init:function za(){this._offlineId=0;this.data=n();this.listenToMany(c('OzActions').inviteComposer);},getInitialState:function za(){return this.data;},onUpdate:function za(ab){this._u(function(bb){return bb.set(ab.get('id'),ab);});},onDelete:function za(ab){this._u(function(bb){return bb['delete'](ab);});},onAdd:function za(){var ab=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],bb=new ta(ab).update('id',function(cb){return cb||this._offlineId++;}.bind(this)).updateIn(['invite','to'],qa);this._u(function(cb){return cb.set(bb.get('id'),bb);});},onCreate:function za(ab,bb,cb){var db=new ta({intentId:ab,invite:xa(bb,cb),id:this._offlineId++});this._u(function(eb){return eb.set(db.get('id'),db);});},_u:function za(ab){this.data=ab(this.data);this.trigger(this.data);}}),va=c('React').createClass({displayName:'InviteContainer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{inviteState:q.instanceOf(ta).isRequired},render:function za(){var ab=this.props.inviteState;return c('React').createElement(wa,{disabled:ab.get('disabled'),sending:ab.get('sending'),initialTimezone:ab.get('timezone'),invite:ab.get('invite'),errors:ab.get('errors'),onChange:this._handleChange,onClose:this._handleClose,onSend:this._handleSend});},_handleChange:function za(ab){c('OzActions').inviteComposer.update(this.props.inviteState.set('invite',ab));},_handleClose:function za(){c('OzActions').inviteComposer['delete'](this.props.inviteState.get('id'));},_handleSend:function za(){var ab=this.props.inviteState,bb=ab.get('invite'),cb=bb.get('selectedPlace'),db=[[bb.get('to')||cb,'Please click on a location in the dropdown or enter an email address'],[bb.get('title'),'Please choose a title'],[bb.get('start'),'Please select a start time'],[bb.get('end'),'Please select an end time'],[bb.get('end')>=bb.get('start'),'Event must start before it ends']].find(function(gb){var hb=gb[0],ib=gb[1];return !hb;});if(db){c('OzNotify').error(db[1]);return;}var eb=cb?bb['delete']('selectedPlace').set('intent-id',ab.get('intentId'))['delete']('to')['delete']('description').set('place-id',cb.get('id')):bb['delete']('selectedPlace').set('intent-id',ab.get('intentId')).update('to',ra),fb=n({to:'to'}).map(function(gb){return ma(eb.get(gb));}).filter(function(gb){return gb;});if(!fb.isEmpty()){c('OzActions').inviteComposer.update(ab.set('errors',fb));return;}c('OzActions').inviteComposer.update(ab.set('sending',true));c('OzAPI').sendInvite(eb,ab.get('intentId')).then(function(gb){c('OzActions').inviteComposer['delete'](ab.get('id'));})['catch'](function(gb){c('OzActions').inviteComposer.update(ab.set('sending',false));});}});k=babelHelpers.inherits(wa,c('React').Component);l=k&&k.prototype;wa.prototype.componentDidMount=function(){'use strict';var za=['title','description','location','to'].map(function(ab){return this.refs[ab];}.bind(this)).find(function(ab){return ab&&!ab.value;});za&&za.focus();};wa.prototype.render=function(){'use strict';var za=this.props,ab=za.disabled,bb=za.sending,cb=za.invite,db=za.errors,eb=za.onClose,fb=za.onChange,gb=za.onSend,hb=function lb(mb,nb){return c('React').createElement(c('XUIError.react'),{xuiError:db.get(nb),xuiErrorPosition:'left'},c('React').createElement('input',{type:'text',className:"_1-i0 _4h1i",disabled:ab||bb,placeholder:mb,ref:nb,value:cb.get(nb),onChange:function ob(pb){return fb(cb.set(nb,pb.target.value));}}));},ib=function lb(mb,nb){return c('React').createElement('div',null,mb+':',c('React').createElement(c('OzDateTimePicker.react'),babelHelpers['extends']({className:"_pto",layout:'two-line',timestamp:cb.get(nb)||c('OzHelpers').serverNow(),timezone:cb.get(nb+'Timezone'),disabled:ab||bb,onChange:function ob(pb){var qb=pb.timestamp,rb=pb.timezone;return fb(cb.set(nb,+qb).set(nb+'Timezone',rb));}},c('OzHelpers').dateRestraints())));},jb=function lb(mb,nb,ob){return c('React').createElement(c('OzPlaceField.react'),{className:"_1-i0 _n8q",disabled:ab||bb,onQueryStringChange:function pb(qb){fb(cb['delete'](ob).set(nb,qb));},onSelect:function pb(qb){fb(cb.set(ob,qb).set(nb,qb.get('name')));},placeholder:mb,queryString:cb.get(nb),selectedEntry:cb.get(ob),xuiError:db.get(nb)||db.get(ob)});},kb=!!cb.get('selectedPlace')||!!cb.get('place-id');return c('React').createElement(c('OzDraggableModal.react'),{className:"_ptp"},c('React').createElement('div',{className:"_ptq"},'Calendar Invite',c('React').createElement(c('XUICloseButton.react'),{onClick:eb})),hb('Title','title'),kb||hb('Description','description'),jb('Location...','location','selectedPlace'),kb||hb('Email to...','to'),ib('Start Time','start'),ib('End Time','end'),ab?null:c('React').createElement('div',{className:"_5l1v"},c('React').createElement('button',{onClick:gb,disabled:bb,className:"_1-hv _30yy _n8p"},bb?'Sending...':kb?'Send Bubble':'Send Email')));};function wa(){'use strict';k.apply(this,arguments);}wa.propTypes={invite:q.instanceOf(n).isRequired,errors:q.instanceOf(n),onClose:q.func.isRequired,onChange:q.func.isRequired,onSend:q.func.isRequired,disabled:q.bool,sending:q.bool};function xa(){var za=arguments.length<=0||arguments[0]===undefined?'':arguments[0],ab=arguments.length<=1||arguments[1]===undefined?'':arguments[1];return sa.set('start',c('OzHelpers').serverNow()).set('startTimezone',ab).set('end',c('OzHelpers').serverNow()).set('endTimezone',ab).set('to',za);}var ya=c('React').createClass({displayName:'OzTaskComposers',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(aa,'emails'),c('Reflux').connect(ua,'invites')],propTypes:{intent:q.instanceOf(n).isRequired},render:function za(){var ab=function(db){return db.get('intentId')==this.props.intent.get('id');}.bind(this),bb=this.state.emails.filter(ab),cb=this.state.invites.filter(ab);return c('React').createElement('span',null,bb.map(function(db){return c('React').createElement(ba,{key:db.get('id'),emailState:db});}).valueSeq(),cb.map(function(db){return c('React').createElement(va,{key:db.get('id'),inviteState:db});}).valueSeq());}});f.exports=ya;}),null);
__d('OzTaskActionEditor.react',['cx','OzHelpers','immutable','InputLabel.react','messengerButtonReact','OzImmutablePureRenderMixin','React','XUIError.react'],(function a(b,c,d,e,f,g,h){var i=c('messengerButtonReact').jsComponent,j=c('immutable').Map,k=c('React').PropTypes,l=c('immutable').fromJS({traffic:{label:'Include traffic update',params:[{name:'origin',placeholder:'Origin address',err:'What is the origin address?'},{name:'destination',placeholder:'Destination address',err:'What is the destination address?'}]},weather:{label:'Include weather forecast',params:[{name:'location',placeholder:'City',err:'What city is the forecast for?'},{name:'metric',placeholder:'Celsius or Fahrenheit',err:'You need to set Celsius or Fahrenheit'}]}}),m=c('OzHelpers').pure(function(o){var p=o.action,q=o.errors,r=o.onToggle,s=o.onUpdate,t=o.actions,u=!!t.get(p);return c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{type:'checkbox',checked:u,onChange:function v(w){return r(w,p);}}),c('React').createElement('label',null,l.getIn([p,'label']))),u&&c('React').createElement('div',null,l.getIn([p,'params']).map(function(v){var w=v.get('name'),x=[p,w],y=t.getIn(x);return c('React').createElement(c('XUIError.react'),{key:p+'-'+w,xuiError:q.getIn([p,w])},c('React').createElement('input',{type:v.get('type','text'),className:"_wbw",placeholder:v.get('placeholder'),value:y,onChange:function z(aa){return s(aa,x);}}));}).valueSeq()));}),n=c('React').createClass({displayName:'OzTaskActionEditor',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{task:k.instanceOf(j).isRequired,onSelectAction:k.func.isRequired},getInitialState:function o(){return {errors:j(),actions:this.props.task.getIn(['data','actions'],j())};},render:function o(){return c('React').createElement('div',{className:"_3zsp"},l.keySeq().map(function(p){return c('React').createElement(m,{key:p,action:p,actions:this.state.actions,errors:this.state.errors,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate});}.bind(this)).valueSeq(),c('React').createElement(i,{onClick:this._handleSaveActions,label:'Set Actions',type:'primary'}));},_handleActionToggle:function o(p,q){var r=p.target.checked?j([[q,j()]]):j();this.setState({actions:r});},_handleActionUpdate:function o(p,q){this.setState({actions:this.state.actions.setIn(q,p.target.value)});},_handleSaveActions:function o(){var p=this.props.onSelectAction,q=this.state.actions,r=this._findErrors();if(r.count()){this.setState({errors:r});}else p(q);},_findErrors:function o(){var p=this.state.actions,q=function r(s){return !!p.get(s);};return l.reduce(function(r,s,t){if(q(t))r=s.get('params').reduce(function(u,v){return p.getIn([t,v.get('name')])?u:u.setIn([t,v.get('name')],v.get('err'));},r);return r;},j());}});f.exports=n;}),null);
__d('OzTaskShow.react',['cx','debounce','getActiveElement','OzHelpers','immutable','InputLabel.react','Keys','LayerHideOnBlur','messengerButtonReact','OzNotify','OzActions','OzConfirmDialog.react','OzDate.react','OzDateTimePicker.react','OzTaskActionEditor.react','OzImmutablePureRenderMixin','React','ShimButton.react','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){var i=c('messengerButtonReact').jsComponent,j=c('immutable').Map,k=c('immutable').List,l=c('immutable').Set,m=c('React').PropTypes,n=1000,o=c('React').createClass({displayName:'OzTaskShow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{location:m.instanceOf(j).isRequired,onCancel:m.func.isRequired,onComplete:m.func.isRequired,onOpen:m.func.isRequired,onSave:m.func.isRequired,task:m.instanceOf(j).isRequired},render:function x(){var y=this.props,z=y.task,aa=y.location,ba=y.onCancel,ca=y.onComplete,da=y.onOpen;return c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement(p,{task:z,onChangeDescription:this._handleChangeDescription}),c('React').createElement(w,{task:z,onChangeNotes:this._handleChangeNotes}),c('React').createElement(r,{task:z,location:aa,onSelectDeadline:this._handleSelectDeadline}),c('React').createElement(s,{task:z,onChangeDuration:this._handleChangeDuration}),c('React').createElement(v,{task:z,onChangeActions:this._handleChangeActions}),c('React').createElement(u,{task:z,onChangeRecur:this._handleChangeRecur}),c('React').createElement(q,{task:z,onCancelTask:ba,onOpenTask:da,onCompleteTask:ca}));},_handleChangeDescription:function x(y){var z=this.props,aa=z.onSave,ba=z.task;aa(ba.setIn(['data','description'],y));},_handleSelectDeadline:function x(y){var z=this.props,aa=z.onSave,ba=z.task,ca=y-ba.get('deadline');aa(ba.set('deadline',y).update('start-at',function(da){return da+ca;}));},_handleChangeDuration:function x(y){var z=this.props,aa=z.onSave,ba=z.task;if(y<0){c('OzNotify').warn('Duration must be greater than 0');}else aa(ba.set('start-at',ba.get('deadline')-y*60000));},_handleChangeRecur:function x(y){var z=this.props,aa=z.onSave,ba=z.task,ca=z.location;aa(ba.set('schedule',j({'start-at':ba.get('start-at'),frequency:'weekly',timezone:ca.get('timezone'),'timezone-offset':ca.get('timezone-offset'),'repeat-condition':j({spacing:1,days:y.toList()})})));},_handleChangeActions:function x(y){var z=this.props,aa=z.onSave,ba=z.task;aa(ba.setIn(['data','actions'],y));},_handleChangeNotes:function x(y){var z=this.props,aa=z.onSave,ba=z.task;aa(ba.setIn(['data','notes'],y));}}),p=c('React').createClass({displayName:'OzTaskShowDescription',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeDescription:m.func.isRequired,task:m.instanceOf(j).isRequired},componentDidMount:function x(){if(!this.props.task.getIn(['data','description']))this.setState({editing:true});},getInitialState:function x(){return {editing:false};},render:function x(){var y=this.props.task,z=(y.get('state')==='completed'?'[Closed] ':'')+(y.getIn(['data','description'],'').length?y.getIn(['data','description']):'untitled task');return c('React').createElement('div',{className:"_1h7v _p44"},this.state.editing?c('React').createElement('textarea',{className:"_1h7r _1h7s",placeholder:'untitled task',defaultValue:y.getIn(['data','description']),onBlur:function(aa){return this.setState({editing:false});}.bind(this),onKeyDown:this._handleKeydown,ref:function aa(ba){if(ba){ba.focus();c('OzHelpers').moveCursorToInputEnd(ba);}}}):c('React').createElement(c('ShimButton.react'),{className:"_1h7r",inline:true,onClick:function(aa){return this.setState({editing:true});}.bind(this)},z));},_handleKeydown:function x(y){var z=this.props.onChangeDescription;switch(y.which){case c('Keys').RETURN:case c('Keys').TAB:z(y.target.value);case c('Keys').ESC:this.setState({editing:false});}}}),q=c('React').createClass({displayName:'OzTaskShowStateSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onCancelTask:m.func.isRequired,onCompleteTask:m.func.isRequired,onOpenTask:m.func.isRequired,task:m.instanceOf(j).isRequired},_maybeConfirmCancel:function x(){var y=this.props,z=y.task,aa=y.onCancelTask;if(z.has('schedule')){c('OzActions').showDialog(c('OzConfirmDialog.react'),{onConfirm:function ba(ca){return aa(z,true);},onCancel:function ba(ca){return aa(z,false);},body:'This is a recurring task. Do you want to delete just '+'this instance or all future occurrences also?',header:'Delete Recurring Task',confirmLabel:'Delete Future Tasks',cancelLabel:'Only This One'});}else aa(z,false);},render:function x(){var y=this.props,z=y.onCancelTask,aa=y.onCompleteTask,ba=y.onOpenTask,ca=y.task;return c('React').createElement('div',{className:"_1h7t"},c('React').createElement(c('ShimButton.react'),{className:"_47xm",onClick:this._maybeConfirmCancel},'Delete'),ca.get('state')==='completed'?c('React').createElement(c('ShimButton.react'),{className:"_47yc",onClick:function da(ea){return ba(ca);}},'Reopen task'):c('React').createElement(c('ShimButton.react'),{className:"_47yd",onClick:function da(ea){return aa(ca);}},'Mark complete'));}}),r=c('React').createClass({displayName:'OzTaskShowDeadlineSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onSelectDeadline:m.func.isRequired,location:m.instanceOf(j).isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return {editing:false};},render:function x(){var y=this.props,z=y.task,aa=y.location;return c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Due'),c('React').createElement('div',{className:"_1h7y"},this.state.editing?c('React').createElement('div',{className:"_1h7z"},c('React').createElement(c('OzDateTimePicker.react'),{className:"_1xh-",layout:'three-line',showTimezoneName:false,timestamp:this.state.timestamp||Date.now(),timezone:this.state.timezone||aa.get('timezone'),onChange:function(ba){return this.setState(ba);}.bind(this)}),c('React').createElement('div',{className:"_1xh_"},c('React').createElement(c('ShimButton.react'),{className:"_1h7-",onClick:this._handleSelectDeadline},'\u2713'),c('React').createElement(c('ShimButton.react'),{className:"_1h7_",onClick:this._handleCancel},'\u2715'))):c('React').createElement(c('ShimButton.react'),{className:"_1h80",onClick:this._handleStartEditing},c('React').createElement(c('OzDate.react'),{timestamp:z.get('deadline')}))));},_handleSelectDeadline:function x(){this.props.onSelectDeadline(this.state.timestamp);this.setState({editing:false});},_handleStartEditing:function x(){this.setState({editing:true,timestamp:this.props.task.get('deadline')});},_handleCancel:function x(){this.setState({editing:false});}}),s=c('React').createClass({displayName:'OzTaskShowDuration',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeDuration:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return {editing:false};},render:function x(){return c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Duration (min)'),c('React').createElement('div',{className:"_1h7y"},this.state.editing?c('React').createElement('textarea',{className:"_1h81 _1h7s",defaultValue:this._getDuration(),onBlur:function(y){return this.setState({editing:false});}.bind(this),onKeyDown:this._handleKeydown,ref:function y(z){if(z){z.focus();c('OzHelpers').moveCursorToInputEnd(z);}}}):c('React').createElement(c('ShimButton.react'),{className:"_1h81",inline:true,onClick:function(y){return this.setState({editing:true});}.bind(this)},this._getDuration())));},_getDuration:function x(){var y=this.props.task;return Math.round((y.get('deadline')-y.get('start-at'))/60000);},_handleKeydown:function x(y){var z=this.props.onChangeDuration;if(y.which===c('Keys').RETURN){z(y.target.value);this.setState({editing:false});}}}),t=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],u=c('React').createClass({displayName:'OzTaskShowRecurSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeRecur:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return {editing:false,daysSet:l()};},componentWillMount:function x(){var y=this.props.task;this.setState({daysSet:l(y.getIn(['schedule','repeat-condition','days']))});},render:function x(){var y=this.props.task,z=this.state,aa=z.editing,ba=z.daysSet,ca=y.getIn(['schedule','repeat-condition','days'],k()).map(function(da){return t[da-1];}).join(', ');return c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Recurrence'),c('React').createElement('div',{className:"_1h7y"},c('React').createElement('span',{onClick:function(da){return this.setState({editing:true});}.bind(this),ref:'setSpan',role:'button',tabIndex:'0'},ca.length?ca:'Set Recurrence...'),c('React').createElement(c('XUIContextualDialog.react'),{position:'above',contextRef:function(da){return this.refs.setSpan;}.bind(this),className:"_3zsp",shown:aa,onToggle:function(da){return this.setState({editing:da});}.bind(this),behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')}},c('React').createElement('div',{className:"_3zsp"},t.map(function(da,ea){var fa=ea+1;return c('React').createElement(c('InputLabel.react'),{key:ea},c('React').createElement('input',{type:'checkbox',checked:ba.has(fa),onChange:function(ga){var ha=ga.target.checked?ba.add(fa):ba['delete'](fa);this.setState({daysSet:ha});}.bind(this)}),c('React').createElement('label',null,da));}.bind(this)),c('React').createElement(i,{onClick:this._handleChangeRecur,label:'Set Recurrence',type:'primary'})))));},_handleChangeRecur:function x(){this.props.onChangeRecur(this.state.daysSet);this.setState({editing:false});}}),v=c('React').createClass({displayName:'OzTaskShowActionSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeActions:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return {editing:false};},render:function x(){var y=this.props.task,z=this.state.editing,aa=y.getIn(['data','actions'],j()).keySeq().join(', ');return c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Actions'),c('React').createElement('div',{className:"_1h7y"},c('React').createElement('span',{onClick:function(ba){return this.setState({editing:true});}.bind(this),ref:'setSpan',role:'button',tabIndex:'0'},aa.length?aa:'Set Actions...'),c('React').createElement(c('XUIContextualDialog.react'),{position:'above',contextRef:function(ba){return this.refs.setSpan;}.bind(this),className:"_3zsp",shown:z,onToggle:function(ba){return this.setState({editing:ba});}.bind(this),behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')}},c('React').createElement(c('OzTaskActionEditor.react'),{task:y,onSelectAction:this._handleSelectAction}))));},_handleSelectAction:function x(y){this.props.onChangeActions(y);this.setState({editing:false});}}),w=c('React').createClass({displayName:'OzTaskShowNotes',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeNotes:m.func.isRequired,task:m.instanceOf(j).isRequired},getInitialState:function x(){return {editedText:this.props.task.getIn(['data','notes'],'')};},componentWillReceiveProps:function x(y){var z=y.task.get(['data','notes']),aa=c('getActiveElement')()===this.refs.textarea;if(z!==this.props.task.get(['data','notes'])&&!aa)this.setState({editedText:z});},componentWillMount:function x(){this._save=c('debounce')(this._save,n,this,true);},render:function x(){return c('React').createElement('div',{className:"_1h7v"},c('React').createElement('textarea',{className:"_1h83 _1h7s",placeholder:'Add a note...',ref:'textarea',value:this.state.editedText,onChange:this._handleChange}));},_handleChange:function x(){var y=this.refs.textarea.value;this.setState({editedText:y},this._save);},_save:function x(){this.props.onChangeNotes(this.state.editedText);}});f.exports=o;}),null);
__d('OzCalendarEvent.react',['cx','Image.react','LineClamp.react','React','Tooltip','formatDate','joinClasses'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes,l="_2erb",m=60000;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(){var o,p;'use strict';for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=j.constructor).call.apply(o,[this].concat(r)),this.state={mouseDown:false},this.$OzCalendarEvent1=function(t,u){return {backgroundColor:'rgb(1, 136, 245)',backgroundImage:'repeating-linear-gradient(-45deg,'+'rgba(70, 130, 200, 0.8),rgba(70, 130, 200, 0.8) 10px,'+'rgba(70, 130, 200, 0.5) 10px,rgba(70, 130, 200, 0.5) 20px)'};},this.$OzCalendarEvent2=function(){this.setState({mouseDown:true});}.bind(this),this.$OzCalendarEvent3=function(){this.setState({mouseDown:false});}.bind(this),this.$OzCalendarEvent4=function(){var t=this.props;return function(u){if(this.state.mouseDown){if(this.props.onInitiateDrag&&this.props.draggable)this.props.onInitiateDrag(t,u);this.setState({mouseDown:false});}}.bind(this);}.bind(this),this.$OzCalendarEvent5=function(){if(!this.props.animation)return null;return c('React').createElement('div',{className:"_2ere",style:this.$OzCalendarEvent1(this.props.shade,this.props.tentative)});}.bind(this),p;}n.prototype.render=function(){'use strict';var o=Math.floor((this.props.height-12)/14)-1,p=Math.max(0,this.props.endTime-this.props.startTime),q=Math.round(p/m),r=q<15,s=q===15,t="_2erb"+(this.props.selected?' '+"_2erf":'')+(this.props.tentative?' '+"_2erg":'')+(s?' '+"_2erh":'')+(r?' '+"_2erk":''),u=[];if(this.props.icons)for(var v=0;v<this.props.icons.length;v++){var w=this.props.icons[v],x=w[0],y=w[1],z=c('React').createElement(c('Image.react'),{className:"_2erl",src:x,key:v,'aria-label':y,'data-hover':'tooltip','data-tooltip-content':y});u.push(z);}var aa=c('React').createElement('div',null,u),ba=null,ca=null;if(this.props.showTime){var da=null,ea=null;if(!this.props.isAllDayEvent){da=c('formatDate')(new Date(this.props.startTime),'g:ia');ea='-'+c('formatDate')(new Date(this.props.endTime),'g:ia');}else da='All day';ca=da+ea;ba=c('React').createElement('span',{className:"_2erm"},da);}var fa=ca+'\n'+this.props.title+'\n'+this.props.location,ga=null;if(o>0)ga=c('React').createElement(c('LineClamp.react'),{disableNative:true,lineHeight:14,className:"_2ero",lines:o},this.props.subTitle);var ha=this.props.draggable?{onMouseDown:this.$OzCalendarEvent2,onMouseUp:this.$OzCalendarEvent3,onMouseMove:this.$OzCalendarEvent4()}:{},ia=this.props.hasOutline?"_2ers":'';return c('React').createElement('div',babelHelpers['extends']({},this.props,ha,{className:c('joinClasses')("_2ert",ia),title:'',onClick:this.props.onEventClicked}),this.$OzCalendarEvent5(),c('React').createElement('div',{className:c('joinClasses')(this.props.className,t),style:this.$OzCalendarEvent1(this.props.shade,this.props.tentative)},aa,c('React').createElement('div',{className:"_2eru"},c('React').createElement('span',babelHelpers['extends']({className:"_2erv"+(r?' '+"_2erw":'')},c('Tooltip').propsFor(this.props.hasTooltip?fa:null)),ba,this.props.title),ga)));};n.propTypes={startTime:k.number.isRequired,endTime:k.number.isRequired,title:k.oneOfType([k.string,k.object]),location:k.string,shade:k.string.isRequired,icons:k.array,hasOutline:k.bool,hasTooltip:k.bool,height:k.number.isRequired,selected:k.bool.isRequired,tentative:k.bool,onEventClicked:k.func.isRequired,onInitiateDrag:k.func,draggable:k.bool,subTitle:k.oneOfType([k.string,k.object]),isAllDayEvent:k.bool,showTime:k.bool};n.defaultProps={showTime:true,draggable:false};n.EVENT_CLASS_NAME=l;f.exports=n;}),null);
__d('OzCalendarUtils',['DateConsts','immutable'],(function a(b,c,d,e,f,g){var h=c('DateConsts').MIN_PER_HOUR*c('DateConsts').SEC_PER_MIN*c('DateConsts').MS_PER_SEC,i=c('DateConsts').HOUR_PER_DAY*h,j=7;function k(y,z){return q(y).toDateString()===q(z).toDateString();}function l(y,z){var aa=new Date(y);aa.setDate(aa.getDate()+z);return aa.getTime();}function m(y,z){var aa=new Date(y),ba=new Date(z),ca=Date.UTC(aa.getFullYear(),aa.getMonth(),aa.getDate()),da=Date.UTC(ba.getFullYear(),ba.getMonth(),ba.getDate());return Math.floor((da-ca)/i);}function n(y){var z=arguments.length<=1||arguments[1]===undefined?1:arguments[1];if(z===null)z=1;var aa=new Date(y);aa.setHours(0);aa.setMinutes(0);aa.setSeconds(0);aa.setMilliseconds(0);var ba=aa.getDay()-z;if(ba<0)ba+=7;return l(aa.getTime(),-ba);}function o(y){var z=arguments.length<=1||arguments[1]===undefined?1:arguments[1];return new Date(n(y.getTime(),z));}function p(y,z){return n(y.getTime())===n(z.getTime());}function q(y){var z=new Date(y),aa=new Date(z.getFullYear(),z.getMonth(),z.getDate());return aa;}function r(y,z){var aa=new Date(y);aa.setDate(aa.getDate()+z);return aa;}function s(y,z){var aa=arguments.length<=2||arguments[2]===undefined?1:arguments[2],ba=[],ca=0,da=new Date(n(y,aa));do{var ea=r(da,ca),fa=r(da,ca+7);ba.push(ea);ca+=7;}while(fa.getTime()<z);return ba;}function t(y,z){var aa=[],ba=0;if(y>z)return aa;do{var ca=r(y,ba),da=r(y,ba+1);aa.push(ca);ba+=1;}while(da.getTime()<=z);return aa;}function u(event){return x.datesFrameToDays(x.timestampToDateOnly(event.props.startTime),x.timestampToDateOnly(event.props.endTime));}function v(event,y,z){var aa=q(event.props.startTime),ba=q(event.props.endTime),ca=q(y),da=l(q(z).getTime(),1);return x.datesFrameToDays(new Date(Math.max(aa,ca)),new Date(Math.min(ba,da)));}function w(y,z,aa){var ba=c('immutable').Map(),ca=c('immutable').Map();y.concat().sort(function(da,ea){return da.props.startTime-ea.props.startTime;}).forEach(function(event){var da=c('immutable').List(v(event,z,aa)),ea=0;while(true){var fa=da.every(function(ga){return !ba.get(ga,c('immutable').Set()).has(ea);});if(fa){ca=ca.set(event.key,ea);ba=da.reduce(function(ga,ha){return ga.update(ha,c('immutable').Set(),function(ia){return ia.add(ea);});},ba);break;}ea++;}});return ca;}var x={MS_IN_HOUR:h,DAY_IN_WEEK:j,datesEqual:k,compareWeeks:p,datesFrameToDays:t,timeFrameToWeeks:s,getWeekStartDate:o,addDaysToTimestamp:l,getDayDifference:m,getWeekStartTimestamp:n,timestampToDateOnly:q,getShiftedDate:r,slotsByEventKey:w,daysOfEvent:u,daysOfEventInRange:v};f.exports=x;}),null);
__d('OzFlexBox.react',['cx','invariant','DOM','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){var j,k,l;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;m.prototype.render=function(){'use strict';var p="_4o6j"+(this.props.direction&&m.VERTICAL?' '+"_4o6k":'')+(this.props.direction&&m.REVERSE?' '+"_4o6l":'');return c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,p)}),c('React').Children.map(this.props.children,n,this));};function m(){'use strict';j.apply(this,arguments);}m.VERTICAL=1;m.REVERSE=2;function n(p){if(!p)return null;var q=this.props.direction&&m.VERTICAL,r=p.props,s=r.boxFlex,t=r.boxSize,u=r.boxMinSize,v=r.boxMaxSize;!(s&&t)||i(0);var w={WebkitBoxFlex:s,WebkitFlex:s,MozFlex:s,flex:s,width:q?null:t,height:q?t:null,minWidth:q?null:u,minHeight:q?u:null,maxWidth:q?null:v,maxHeight:q?v:null};return c('React').createElement('div',{style:w,className:"_4o6m"},p);}function o(){if(l!==undefined)return l;var p=c('DOM').create('div');p.style.display='-webkit-flex';if(p.style.display==='-webkit-flex')return l=false;p.style.display='-moz-flex';if(p.style.display==='-moz-flex')return l=false;p.style.display='flex';if(p.style.display==='flex')return l=false;return l=true;}m.isLolzyFlex=o;f.exports=m;}),null);
__d('OzCalendarMonthly.react',['cx','OzFlexBox.react','DateConsts','DateStrings','OzCalendarUtils','Link.react','React','ReactDOM','ResizeListener','ScrollableArea.react','getElementPosition','joinClasses'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={selectedEventKey:null,currentTime:new Date(),dayHeight:null},this.$OzCalendarMonthly1=null,this.$OzCalendarMonthly2=27,this.$OzCalendarMonthly3=20,this.$OzCalendarMonthly4=22,this.$OzCalendarMonthly5=null,this.getCalendarContentPosition=function(){var r=c('ReactDOM').findDOMNode(this.refs.scrollable);if(r)return c('getElementPosition')(r);return null;}.bind(this),this.$OzCalendarMonthly6=function(){var r=c('getElementPosition')(c('ReactDOM').findDOMNode(this.refs.testCell));return r.height;}.bind(this),this.$OzCalendarMonthly8=function(){var r=this.getCalendarStartDate(),s=c('OzCalendarUtils').getShiftedDate(r,c('DateConsts').DAYS_PER_WEEK*6-1);return {start:r.getTime(),end:s.getTime()};}.bind(this),this.$OzCalendarMonthly7=function(){var r=this.$OzCalendarMonthly8();if(this.props.onFrameChange)this.props.onFrameChange(r.start,r.end);if(this.props.scrollToCurrentTime){var s=this.refs.scrollable.getArea();if(s)s.setScrollTop(this.state.dayHeight*(this.getCurrentDateRow()-1)+1,false);}}.bind(this),this.groupEvents=function(){var r=[],s=c('React').Children.toArray(this.props.children).sort(function(u,v){return u.props.startTime-v.props.startTime;}),t=c('OzCalendarUtils').slotsByEventKey(s,this.getCalendarStartDate(),this.getCalendarEndDate());s.forEach(function(event){var u=c('OzCalendarUtils').daysOfEventInRange(event,this.getCalendarStartDate(),this.getCalendarEndDate());u.forEach(function(v){var w=t.get(event.key);if(!r[v])r[v]=[];r[v][w]=this.cloneOfEventForDay(event,v,w);}.bind(this));}.bind(this));return r;}.bind(this),this.cloneOfEventForDay=function(event,r,s){var t=!c('OzCalendarUtils').datesEqual(event.props.startTime,event.props.endTime),u=c('OzCalendarUtils').datesEqual(r,event.props.startTime)||c('OzCalendarUtils').datesEqual(r,this.getCalendarStartDate()),v=c('OzCalendarUtils').datesEqual(r,event.props.endTime)||c('OzCalendarUtils').datesEqual(r,this.getCalendarEndDate());return c('React').cloneElement(event,{className:(!u&&!v?"_2bg_":'')+(t&&u?' '+"_2bh2":'')+(t&&v?' '+"_2bh3":''),key:event.key,height:24,onEventClicked:function(){return this.setState({selectedEventKey:event.key});}.bind(this),selected:this.state.selectedEventKey===event.key,style:{top:s*this.$OzCalendarMonthly4+this.$OzCalendarMonthly2+'px'}});}.bind(this),this.getCalendarStartDate=function(){var r=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);r.setDate(r.getDate()-r.getDay());return r;}.bind(this),this.getCalendarEndDate=function(){var r=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);r.setDate(r.getDate()+42);return r;}.bind(this),this.getCurrentDateRow=function(){var r=c('OzCalendarUtils').getDayDifference(this.getCalendarStartDate().getTime(),this.state.currentTime.getTime()),s=Math.floor(r/7);if(s>5)return 0;return s;}.bind(this),this.renderGridLines=function(r,s,t){var u=0,v=5,w=[];for(var x=0;x<=v;x++){u=x*c('DateConsts').DAYS_PER_WEEK+r;var y=c('OzCalendarUtils').getShiftedDate(this.getCalendarStartDate(),u),z=this.props.highlightedDay,aa=(t&&x===0?"_2bh4":'')+(!t&&x===0?' '+"_2bh5":'')+(r===0&&x===v?' '+"_2bh6":'')+(t&&x===v?' '+"_2bh7":'')+(t&&x!==v?' '+"_2bh8":'')+(!t&&x===v?' '+"_2bh9":'')+(r===0?' '+"_2bha":'')+(' '+"_2bhb")+(y.toDateString()===this.state.currentTime.toDateString()?' '+"_2bhe":'')+(z&&y.toDateString()===z.toDateString()?' '+"_2bhf":''),ba=null;if(this.state.dayHeight){var ca=Math.floor((this.state.dayHeight-this.$OzCalendarMonthly2-this.$OzCalendarMonthly3)/this.$OzCalendarMonthly4)+1;if(s[y]&&s[y].length>ca){(function(da){ba=c('React').createElement(c('Link.react'),{onClick:function(){return this.$OzCalendarMonthly9(da);}.bind(this),className:"_2bhg"},'Show more ('+(s[y].length-ca)+')');}).bind(this)(y);s[y]=s[y].slice(0,ca);}}else s[y]=[];w.push(c('React').createElement('div',{key:x,ref:r===0&&x===0?'testCell':null,style:{height:'16.666%'},onDoubleClick:this.$OzCalendarMonthly10(y),className:aa},c('React').createElement('div',{className:"_2bhh"+(y.getMonth()!==this.props.date.getMonth()?' '+"_2bhi":'')},y.getMonth()!==this.props.date.getMonth()&&y.getDate()===1?c('DateStrings').getMonthNameShort(y.getMonth()+1).toString()+' ':null,y.getDate()),c('React').createElement('div',{className:"_2bhj"},s[y],ba)));}return c('React').createElement('div',null,w);}.bind(this),this.$OzCalendarMonthly10=function(r){if(this.props.onDateClick){var s=this.props.onDateClick;return function(){return s(r);};}else return null;}.bind(this),this.$OzCalendarMonthly9=function(r){if(this.props.onShowMore)this.props.onShowMore(r);}.bind(this),this.renderDayHeader=function(r){var s=c('React').createElement('div',{className:"_2bhk"},c('DateStrings').getWeekdayName(r)),t=r===6;return c('React').createElement('div',{className:"_2bhx",boxFlex:1,key:r},c('React').createElement('div',{className:"_2bhy"+(t?' '+"_2bhz":'')+(r===0?' '+"_2bh-":'')},s));},this.renderCol=function(r,s){var t=r===6;return c('React').createElement('div',{className:"_2bhx",boxFlex:1,key:r},this.renderGridLines(r,s,t));}.bind(this),n;}l.prototype.componentDidMount=function(){'use strict';this.$OzCalendarMonthly1=setInterval(function(){return this.setState({currentTime:new Date()});}.bind(this),60*1000);this.setState({dayHeight:this.$OzCalendarMonthly6()});setTimeout(function(){return this.$OzCalendarMonthly7();}.bind(this),0);this.$OzCalendarMonthly5=c('ResizeListener').add(function(){return this.setState({dayHeight:this.$OzCalendarMonthly6()});}.bind(this));};l.prototype.componentWillUnmount=function(){'use strict';if(this.$OzCalendarMonthly1)clearInterval(this.$OzCalendarMonthly1);if(this.$OzCalendarMonthly5)this.$OzCalendarMonthly5.remove();};l.prototype.componentDidUpdate=function(m,n){'use strict';if(m&&m.date!==this.props.date)this.$OzCalendarMonthly7();};l.prototype.render=function(){'use strict';var m=this.groupEvents(),n=[],o=[];for(var p=0;p<c('DateConsts').DAYS_PER_WEEK;p++){n.push(this.renderCol(p,m));o.push(this.renderDayHeader(p));}var q=c('React').createElement(c('ScrollableArea.react'),{className:"_2bgx",ref:'scrollable',shadow:false},c('React').createElement(c('OzFlexBox.react'),{className:"_2bgy"},n)),r=c('joinClasses')(this.props.className,"_2bgz _2bg-"),s={};if(this.props.calendarHeight)s={height:this.props.calendarHeight+'px'};return c('React').createElement('div',{style:s,className:r},c('React').createElement(c('OzFlexBox.react'),{className:"_2bgy"},o),q);};l.propTypes={date:k.instanceOf(Date).isRequired,calendarHeight:k.number,onShowMore:k.func,scrollToCurrentTime:k.bool,onDateClick:k.func,highlightedDay:k.instanceOf(Date)};l.defaultProps={dayStartHour:9,dayEndHour:17,daysPerWeek:5,date:new Date(),weekStartDay:1,enableCurrentTimeMarker:true,calendarHeight:700};f.exports=l;}),null);
__d("OzCalendarType",[],(function a(b,c,d,e,f,g){f.exports={MONTH:1,WEEK:2,DAY:3};}),null);
__d('OzCalendarPager.react',['cx','fbt','ix','OzCalendarUtils','Image.react','OzCalendarType','React','XUIButton.react','XUIButtonGroup.react'],(function a(b,c,d,e,f,g,h,i,j){var k,l,m=c('React').PropTypes;k=babelHelpers.inherits(n,c('React').Component);l=k&&k.prototype;function n(){var o,p;'use strict';for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=l.constructor).call.apply(o,[this].concat(r)),this.onWeekNavigate=function(t){this.props.onDateChange&&this.props.onDateChange(new Date(t));}.bind(this),this.$OzCalendarPager1=function(t){var u=this.props.date.getTime(),v=c('OzCalendarUtils').addDaysToTimestamp(u,t);return v;}.bind(this),this.$OzCalendarPager2=function(t){var u=c('OzCalendarUtils').getWeekStartTimestamp(this.props.date.getTime()),v=c('OzCalendarUtils').addDaysToTimestamp(u,t*c('OzCalendarUtils').DAY_IN_WEEK);return v;}.bind(this),this.$OzCalendarPager3=function(t){return new Date(this.props.date.getFullYear(),this.props.date.getMonth()+t*1,1).getTime();}.bind(this),this.$OzCalendarPager4=function(t){return new Date(this.props.date.getFullYear()+t*1,this.props.date.getMonth(),1).getTime();}.bind(this),this.$OzCalendarPager5=function(t){var u;switch(this.props.mode){case c('OzCalendarType').MONTH:u=this.$OzCalendarPager3(t);break;case c('OzCalendarType').WEEK:u=this.$OzCalendarPager2(t);break;case c('OzCalendarType').DAY:u=this.$OzCalendarPager1(t);break;}this.onWeekNavigate(u);}.bind(this),this.$OzCalendarPager6=function(t){var u=this.props.mode===c('OzCalendarType').MONTH?this.$OzCalendarPager4(t):this.$OzCalendarPager3(t);this.onWeekNavigate(u);}.bind(this),p;}n.prototype.render=function(){'use strict';var o=this.props,p=o.buttonSize,q=o.disabled,r=o.hasFastSwitch;return c('React').createElement(c('XUIButtonGroup.react'),{className:"_3-95"},r?c('React').createElement(c('XUIButton.react'),{disabled:q,image:c('React').createElement(c('Image.react'),{src:j("101337")}),label:i._("Primera p\u00e1gina"),labelIsHidden:true,role:'button',size:p,style:{opacity:.63},onClick:function(){return this.$OzCalendarPager6(-1);}.bind(this)}):null,c('React').createElement(c('XUIButton.react'),{disabled:q,image:c('React').createElement(c('Image.react'),{src:j("101339")}),label:i._("Anterior"),labelIsHidden:true,role:'button',size:p,onClick:function(){return this.$OzCalendarPager5(-1);}.bind(this)}),c('React').createElement(c('XUIButton.react'),{label:'Today',disabled:q,size:p,onClick:function(){return this.onWeekNavigate(Date.now());}.bind(this)}),c('React').createElement(c('XUIButton.react'),{disabled:q,image:c('React').createElement(c('Image.react'),{src:j("101341")}),label:i._("Siguiente"),labelIsHidden:true,role:'button',size:p,onClick:function(){return this.$OzCalendarPager5(1);}.bind(this)}),r?c('React').createElement(c('XUIButton.react'),{disabled:q,image:c('React').createElement(c('Image.react'),{src:j("101338")}),label:i._("\u00daltima p\u00e1gina"),labelIsHidden:true,role:'button',size:p,style:{opacity:.63},onClick:function(){return this.$OzCalendarPager6(1);}.bind(this)}):null);};n.propTypes={date:m.instanceOf(Date).isRequired,onDateChange:m.func,buttonSize:m.string,mode:m.oneOf([c('OzCalendarType').MONTH,c('OzCalendarType').WEEK,c('OzCalendarType').DAY]),hasFastSwitch:m.bool,disabled:m.bool};n.defaultProps={mode:c('OzCalendarType').WEEK};f.exports=n;}),null);
__d('OzPagedMonthlyCalendar.react',['cx','DateStrings','OzCalendarMonthly.react','OzCalendarPager.react','OzCalendarType','LoadingIndicator.react','React'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={date:new Date(this.props.date)},this.$OzPagedMonthlyCalendar1=function(){return c('React').createElement('div',{className:"_1if9"},c('React').createElement('div',{className:"_1ifa"},this.props.events.length+' events'),c('React').createElement('div',{className:"_1ifb"},c('React').createElement(c('OzCalendarPager.react'),{date:this.state.date,mode:c('OzCalendarType').MONTH,onDateChange:this.$OzPagedMonthlyCalendar4,hasFastSwitch:true})),c('React').createElement('div',{className:"_1ifc"},c('React').createElement('strong',null,c('DateStrings').getMonthName(this.state.date.getMonth()+1)),'  ',this.state.date.getFullYear()));}.bind(this),this.$OzPagedMonthlyCalendar2=function(){if(!this.props.isLoading)return null;return c('React').createElement('div',{className:"_1ifd"},c('React').createElement(c('LoadingIndicator.react'),{size:'large',color:'white'}));}.bind(this),this.$OzPagedMonthlyCalendar3=function(){return c('React').createElement('div',{className:"_1ife"},c('React').createElement(c('OzCalendarMonthly.react'),{date:this.state.date,className:"_1iff",onDateClick:this.props.onDateClick,onShowMore:this.props.onShowMore,highlightedDay:this.props.highlightedDay},this.props.events));}.bind(this),this.$OzPagedMonthlyCalendar4=function(r){this.setState({date:r},function(){this.props.onDateChange(r);}.bind(this));}.bind(this),n;}l.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_1if8"},this.$OzPagedMonthlyCalendar1(),this.$OzPagedMonthlyCalendar2(),this.$OzPagedMonthlyCalendar3());};l.propTypes={date:k.instanceOf(Date).isRequired,events:k.array.isRequired,isLoading:k.bool,onDateClick:k.func,onDateChange:k.func.isRequired,onShowMore:k.func.isRequired,highlightedDay:k.instanceOf(Date)};f.exports=l;}),null);
__d('OzCalendarModal.react',['cx','OzConfig','OzImmutablePureRenderMixin','immutable','React','Reflux','OzDraggableModal.react','XUICloseButton.react','OzPagedMonthlyCalendar.react','OzCalendarEvent.react','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','formatDate'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes,l=c('immutable').Map,m=c('React').createClass({displayName:'OzCalendarModal',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{events:k.array.isRequired,onClose:k.func.isRequired},getInitialState:function q(){return {moreDialogShown:false,moreDialogDate:new Date()};},render:function q(){var r=this.state.config.get('GK',l()),s=r.get('calendar'),t=this.props,u=t.events,v=t.onClose;return c('React').createElement(c('OzDraggableModal.react'),{className:"_33-2",getHandle:function(w){return this.refs.header;}.bind(this)},c('React').createElement('div',{className:"_33-3",ref:'header'},!s?'Calendar - Busy/Free Access only':'Calendar',c('React').createElement(c('XUICloseButton.react'),{onClick:v})),c('React').createElement(c('OzPagedMonthlyCalendar.react'),{isLoading:false,events:n(u,s),date:new Date(),onDateChange:function w(x){},onShowMore:this._calendarShowMore}),this._renderShowMoreDialog(s));},_renderShowMoreDialog:function q(r){if(this.state.moreDialogShown)return c('React').createElement(p,{events:o(this.props.events,this.state.moreDialogDate),date:this.state.moreDialogDate,onToggle:this._onShowMoreToggle,calendarBusy:r});return null;},_calendarShowMore:function q(r){this.setState({moreDialogShown:true,moreDialogDate:r});}}),n=function q(r,s){return r.map(function(t){return c('React').createElement(c('OzCalendarEvent.react'),{key:t.identifier,title:s?t.title:'Busy',location:s?t.location:'',startTime:new Date(t.startDate).getTime(),endTime:new Date(t.endDate).getTime(),shade:'DarkBlue',hasTooltip:s});});},o=function q(r,s){var t=new Date(s);t.setTime(t.getTime()+86400000);return r.sort(function(u,v){return new Date(u.startDate).getTime()-new Date(v.startDate).getTime();}).filter(function(u){return new Date(u.startDate).getTime()>=new Date(s).getTime()||new Date(u.endDate).getTime()>=new Date(s).getTime();}).filter(function(u){return new Date(u.startDate).getTime()<t.getTime();});};i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;function p(){var q,r;'use strict';for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=j.constructor).call.apply(q,[this].concat(t)),this.$OzCalendarEventShowMoreDialog1=function(v,w){var x=null,y='',z=null,aa=new Date(v),ba=new Date(w),ca=aa.getDate()==ba.getDate()&&aa.getMonth()==ba.getMonth(),da=Math.floor((ba-aa)/(1000*60*60))>13;if(!da||!ca){x=c('formatDate')(aa,ca?'g:ia':'D M j, g:ia');y=c('formatDate')(ba,ca?'g:ia':'D M j, g:ia');z=x+(ca?' - ':'\n')+y;}else z='All day';return c('React').createElement('div',{className:"_33-c"},z);},r;}p.prototype.render=function(){'use strict';var q=this.props.events.map(function(r){return c('React').createElement('div',{key:r.identifier,className:"_33-4"},this.$OzCalendarEventShowMoreDialog1(r.startDate,r.endDate),c('React').createElement('div',{className:"_33-b"},c('React').createElement('span',null,this.props.calendarBusy?r.title+'\n'+r.location:'Busy')));}.bind(this));return c('React').createElement(c('XUIDialog.react'),{shown:true,width:500,onToggle:this.props.onToggle},c('React').createElement(c('XUIDialogTitle.react'),null,q.length+' events on '+this.props.date.toDateString()),c('React').createElement(c('XUIDialogBody.react'),null,q));};p.propTypes={events:k.array.isRequired,date:k.instanceOf(Date).isRequired,onToggle:k.func,calendarBusy:k.bool};f.exports=m;}),null);
__d('OzThreadMeta.react',['cx','OzAPI','OzHelpers','immutable','Keys','messengerButtonReact','OzFormPreview.react','OzThreadLabels.react','OzStores','OzSwitch.react','OzImmutablePureRenderMixin','React','Reflux','Tooltip','OzCalendarModal.react'],(function a(b,c,d,e,f,g,h){var i=c('messengerButtonReact').jsComponent,j=c('immutable').Map,k=c('OzFormPreview.react').Row,l=c('OzThreadLabels.react').OzUnderageLabel,m=c('React').PropTypes,n=c('OzStores').CalendarEventStore,o=c('React').createClass({displayName:'OzThreadMeta',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(n,'calendarEvents')],propTypes:{thread:m.object.isRequired,repNames:m.instanceOf(j).isRequired},getInitialState:function x(){return {newMeta:null,muted:w(this.props.thread),calendarShown:false};},componentWillReceiveProps:function x(y){if(c('OzHelpers').threadID(y.thread)!==c('OzHelpers').threadID(this.props.thread)){this.setState({newMeta:null,muted:w(y.thread),locked:y.thread.get('locked')});}else this.setState({muted:w(y.thread),locked:y.thread.get('locked')});},render:function x(){var y=c('OzHelpers').threadID(this.props.thread),z=this.state.calendarEvents.get(y,[]),aa=[['Cancel','secondary',this._handleCancel],['DONE','primary',this._handleDone]],ba=['Edit','primary',this._handleEdit],ca=z&&z.length?[['Calendar','primary',this._handleCalendar],ba]:[ba],da=this.state.newMeta?aa:ca;return c('React').createElement('div',{className:"_56t0"+(this.state.newMeta?' '+"_56t1":'')},this.state.calendarShown&&c('React').createElement(c('OzCalendarModal.react'),{events:z,onClose:this._onCalendarClose}),c('React').createElement(p,{thread:this.props.thread,buttons:da}),this.state.newMeta?c('React').createElement(t,{meta:this.state.newMeta,onCancel:this._handleCancel,onChange:this._handleChange,onDone:this._handleDone,onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}):c('React').createElement(r,{meta:v(this.props.thread),onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}),c('React').createElement(s,{thread:this.props.thread,repNames:this.props.repNames,locked:!!this.state.locked,onToggle:this._handleThreadLockToggle}));},_handleEdit:function x(){this.setState({newMeta:v(this.props.thread)});},_handleCancel:function x(){this.setState({newMeta:null});},_handleDone:function x(){c('OzAPI').saveMeta(c('OzHelpers').threadID(this.props.thread),this.state.newMeta);this.setState({newMeta:null});},_handleChange:function x(y){this.setState({newMeta:y});},_handleMutedToggle:function x(y){c('OzAPI').saveMuted(c('OzHelpers').threadID(this.props.thread),!y);this.setState({muted:!y});},_handleThreadLockToggle:function x(y){var z=this.props.thread,aa=c('OzHelpers').threadID(z);if(this.state.locked){this.setState({locked:false});c('OzAPI').unlockThread(aa,z.get('locked-at'));}else{this.setState({locked:true});c('OzAPI').lockThread(aa);}},_handleCalendar:function x(){var y=this.props.thread,z=c('OzHelpers').threadID(y);c('OzAPI').fetchCalendar(z);this.setState({calendarShown:true});},_onCalendarClose:function x(){this.setState({calendarShown:false});}}),p=c('OzHelpers').pure(function(x){var y=x.thread,z=x.buttons;return c('React').createElement('div',{className:"_56t2"},c('React').createElement('div',{className:"_56t6"},c('React').createElement('h2',{className:"_56tb"},c('OzHelpers').getName(y)),c('React').createElement('div',{className:"_56tc"},z.map(function(aa,ba){var ca=aa[0],da=aa[1],ea=aa[2];return c('React').createElement(i,{key:ca,label:ca,type:da,onClick:ea});}))),c('React').createElement('div',{className:"_56td"},c('React').createElement(l,{thread:y})));}),q=c('OzHelpers').pure(function(x){var y=x.isMuted,z=x.onMutedToggle,aa=function da(ea){z(y);},ba='Uncheck if person dislikes our proactive messages, e.g. surveys',ca=c('React').createElement('span',c('Tooltip').propsFor(ba),'Proactive?');return c('React').createElement(k,{label:ca},c('React').createElement('input',{type:'checkbox',checked:!y,onChange:aa}));}),r=c('OzHelpers').pure(function(x){var y=x.meta,z=x.isMuted,aa=x.onMutedToggle,ba=(y.get('address1','')+' '+y.get('address2','')+'\n     '+y.get('city','')+' '+y.get('state','')+' '+y.get('zip','')+'\n    ').trim();return c('React').createElement(c('OzFormPreview.react'),null,c('React').createElement(k,{label:'Nickname'},y.get('preferred-name')),c('React').createElement(k,{label:'Email'},y.get('email')),c('React').createElement(k,{label:'Phone'},y.get('phone')),c('React').createElement(k,{label:'Address'},ba),c('React').createElement(k,{label:'Device OS'},y.get('os-type')),c('React').createElement(k,{label:'App Version'},y.get('app-version')),c('React').createElement(q,{isMuted:z,onMutedToggle:aa}));}),s=c('OzHelpers').pure(function(x){var y=x.thread,z=x.repNames,aa=x.locked,ba=x.onToggle,ca=z.get(y.get('locker-id')),da=ca?(y.get('locked')?'Locked':'Last locked')+' by '+ca:'';da+=da&&y.get('locked-at')?' at '+new Date(y.get('locked-at')).toLocaleString():'';var ea=c('React').createElement('span',c('Tooltip').propsFor(da),aa?'Click to unlock thread':'Click to lock thread');return c('React').createElement(c('OzSwitch.react'),{className:"_z1m",isAnimated:true,reverseColors:true,isOn:aa,label:ea,onToggle:ba});}),t=c('React').createClass({displayName:'EditView',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{meta:m.instanceOf(j).isRequired,onCancel:m.func.isRequired,onChange:m.func.isRequired,onDone:m.func.isRequired,isMuted:m.bool.isRequired,onMutedToggle:m.func.isRequired},componentDidMount:function x(){this.refs['preferred-name'].focus();},render:function x(){var y=this._renderRow;return c('React').createElement('form',{className:"_56to",onKeyDown:this._handleKeyDown},c('React').createElement(u,null,y('Nickname','preferred-name','Add Preferred Name')),c('React').createElement(u,null,y('Email','email','Add email')),c('React').createElement(u,null,y('Phone','phone','Add phone')),c('React').createElement(u,null,y('Street','address1','Add Street'),y('Street','address2','Add Street'),y('City','city','Add City'),y('State','state'),y('Zip Code','zip')),c('React').createElement(u,null,c('React').createElement(q,{isMuted:this.props.isMuted,onMutedToggle:this.props.onMutedToggle})));},_handleKeyDown:function x(y){y.which===c('Keys').ESC?this.props.onCancel():y.which===c('Keys').RETURN?this.props.onDone():null;},_renderRow:function x(y,z,aa){var ba=this.props,ca=ba.meta,da=ba.onChange;return c('React').createElement(k,{label:y},c('React').createElement('input',{ref:z,type:'text',className:"_1-i0 _56uv",placeholder:aa,value:ca.get(z),onChange:function ea(fa){return da(ca.set(z,fa.target.value));}}));}}),u=c('OzHelpers').pure(function(x){var y=x.children;return c('React').createElement('div',{className:"_56vn"},y);});function v(x){return x.get('metadata-json')||j();}function w(x){return !!x.get('muted');}f.exports=o;}),null);
__d('OzThreadNote.react',['cx','OzAPI','getActiveElement','OzHelpers','immutable','OzConfig','OzRequirementTokenizer.react','React','Reflux'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('React').PropTypes,k=1000,l=c('React').createClass({displayName:'OzThreadNote',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{thread:j.instanceOf(i).isRequired,requirements:j.instanceOf(i).isRequired,timeline:j.bool},getDefaultProps:function m(){return {timeline:false};},getInitialState:function m(){return {editedText:this.props.thread.get('notes')||''};},componentWillReceiveProps:function m(n){var o=n.thread.get('notes'),p=c('getActiveElement')()===this.refs.textarea;if(o!==this.props.thread.get('notes')&&!p)this.setState({editedText:o});},render:function m(){var n=this.props,o=n.requirements,p=n.thread,q=n.timeline;return c('React').createElement('div',{className:"_1x92"},c('React').createElement('h2',{className:"_1x93"},'Thread Notes'),c('React').createElement('div',{className:"_41v4"},c('React').createElement(c('OzRequirementTokenizer.react'),{allRequirements:o,onDeleteRequirement:this._handleDeleteRequirement,onCreateRequirement:this._handleCreateRequirement,selectedRequirements:p.get('requirements'),placeholder:'Add a user tag...',timeline:q})),c('React').createElement('textarea',{ref:'textarea',className:"_1x95"+(this.props.timeline?' '+"_11_w":''),placeholder:'Leave a note',value:this.state.editedText,onChange:this._handleChange}));},_handleChange:function m(){var n=this.props.thread,o=this.refs.textarea.value;this.setState({editedText:o});window.clearTimeout(this.timeout);this.timeout=window.setTimeout(function(){c('OzAPI').saveNote(c('OzHelpers').threadID(n),o);},k);},_handleCreateRequirement:function m(n){var o=this.props.thread;c('OzAPI').createThreadRequirement(c('OzHelpers').threadID(o),n.get('name'));},_handleDeleteRequirement:function m(n){var o=this.props.thread;c('OzAPI').deleteThreadRequirement(c('OzHelpers').threadID(o),n.get('id'));}});f.exports=l;}),null);
__d('OzTimeline.react',['csx','cx','OzAPI','OzHelpers','immutable','OzActions','OzDate.react','OzStores','ozFormatTime','OzImmutablePureRenderMixin','React','ReactRouter','Reflux'],(function a(b,c,d,e,f,g,h,i){var j=c('immutable').Map,k=c('immutable').List,l=c('React').PropTypes,m=c('ReactRouter').Link,n=c('OzStores').ActiveThreadStore,o=j({'send-email':'sent email','receive-email':'received email','send-calendar':'sent invite','completed-call':'phone call'}),p=c('React').createClass({displayName:'OzTimeline',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(n,'activeThread')],propTypes:{closedIntents:l.instanceOf(k).isRequired,events:l.instanceOf(k).isRequired,tasks:l.instanceOf(k).isRequired},contextTypes:{router:l.object.isRequired},componentDidMount:function w(){this._scrollTimeline();this._timeUpdateInterval=window.setInterval(function(x){return this.setState({time:c('OzHelpers').serverNow()});}.bind(this),60000);},componentDidUpdate:function w(){this._scrollTimeline();},_scrollTimeline:function w(){var x=document.querySelector("._415b");if(x)x.scrollIntoView(true);var y=document.querySelector("._2mg4");if(y)y.scrollIntoView(true);},componentWillUnmount:function w(){window.clearInterval(this._timeUpdateInterval);},getInitialState:function w(){return {time:c('OzHelpers').serverNow()};},render:function w(){var x=this._sortedItems();return c('React').createElement('div',{className:"_201k"},c('React').createElement('div',{className:"_201l"},'Activity & tasks'),c('React').createElement('div',{className:"_4fj7 _201m",ref:'scrollable'},x.map(this._renderTimelineElement),c('React').createElement('div',{key:'OzTimelineSpacer',className:"_415b"})));},_sortedItems:function w(){var x=this.props,y=x.events,z=x.tasks,aa=x.closedIntents;return y.filter(function(ba){return o.has(ba.get('type'));}).map(function(ba){return ba.set('item-type','event');}).concat(z.map(function(ba){return ba.set('item-type','task');})).concat(aa.map(function(ba){return ba.set('item-type','intent').set('intent-id',ba.get('id'));})).sortBy(v);},_renderTimelineElement:function w(x){var y=this.state,z=y.activeThread,aa=y.time,ba=this.props.tasks,ca=x.get('item-type')+'-'+x.get('id');switch(x.get('item-type')){case 'event':return c('React').createElement(r,{key:ca,event:x,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply,onInviteView:this._handleInviteView,activeThread:z});case 'task':return c('React').createElement(s,{key:ca,task:x,activeThread:z,time:aa});case 'intent':return c('React').createElement(t,{key:ca,intent:x,tasks:ba,activeThread:z});default:c('OzHelpers').err('unknown item',x);return null;}},_handleEmailView:function w(x){c('OzActions').emailComposer.add(babelHelpers['extends']({},c('OzHelpers').eventToEmail(x),{disabled:true}));},_handleEmailReply:function w(x){c('OzActions').emailComposer.add(c('OzHelpers').eventToEmail(c('OzHelpers').reEmail(x)));},_handleInviteView:function w(x){c('OzActions').inviteComposer.add(c('OzHelpers').eventToInvite(x));},_handleCallPlay:function w(x){return c('OzAPI').everstoreURI(x).then(function(y){return window.open(y);});}}),q=c('OzHelpers').pure(function(w){var x=w.activeThread,y=w.contents,z=w.item,aa=w.onClick,ba=w.path,ca=w.status,da=w.summary,ea=z.get('intent-id')===x.get('activeIntent'),fa=z.get('id')===x.get(z.get('item-type')==='task'?'activeTask':'activeEvent');ca=ca||'completed';return c('React').createElement(m,{to:ba,className:"_8i9"+(ea?' '+"_8ia":'')+(!ea?' '+"_8ib":'')+(fa?' '+"_2mg4":'')+(ca==='pending'?' '+"_4rsf":'')+(ca==='completed'?' '+"_4rsg":'')+(ca==='close'?' '+"_4rsj":'')+(ca==='late'?' '+"_4rsm":'')},c('React').createElement('div',{className:"_8id"}),c('React').createElement('div',{className:"_201o"}),c('React').createElement('div',{className:"_201p"},c('React').createElement('div',{className:"_201r"},z.get('intent-name')),c('React').createElement('div',{className:"_8ie"},da||'[Untitled]'),c('React').createElement('div',{className:"_2022"},ca!=='completed'?'Due: ':null,c('React').createElement(c('OzDate.react'),{className:"_1qdh",timestamp:v(z)}))));},'OzTimelineItem'),r=c('OzHelpers').pure(function(w){var x=w.activeThread,event=w.event,y=w.onCallPlay,z=w.onEmailReply,aa=w.onEmailView,ba=w.onInviteView,ca=event.get('type'),da;switch(ca){case 'send-email':da='Email to '+event.getIn(['data','to']).join(', ');break;case 'receive-email':da='Email from '+event.getIn(['data','from']);break;case 'send-calendar':if(event.hasIn(['data','place-id'])){da='Invite bubble';}else da='Invite to '+event.getIn(['data','to']).join(', ');break;case 'completed-call':var ea=event.get('data'),fa={'in':'Call from ',out:'Call to ',voicemail:'Voicemail from '}[ea.get('direction')],ga=c('OzHelpers').parsePhoneNumber(ea.get('remote-phone')),ha=ea.get('RecordingDuration'),ia=ea.get('recording-ev-handle');da=fa+ga;break;default:da='Another event';}return c('React').createElement(q,{activeThread:x,path:c('OzHelpers').threadPath({threadid:event.get('user-id'),intentid:event.get('intent-id'),eventid:event.get('id')}),item:event,summary:da});},'OzTimelineEvent'),s=c('OzHelpers').pure(function(w){var x=w.task,y=w.time,z=w.activeThread,aa=function da(ea){switch(ea.get('type')){case 'reminder':return ea.getIn(['data','description']);default:return ea.get('type');}},ba;if(c('OzHelpers').isCompletedTask(x)){ba='completed';}else if(x.get('start-at')>y){ba='pending';}else if(x.get('deadline')>y){ba='close';}else ba='late';var ca=c('React').createElement('div',null,x.getIn(['data','notes']));return c('React').createElement(q,{activeThread:z,path:c('OzHelpers').threadPath({threadid:x.get('user-id'),intentid:x.get('intent-id'),taskid:x.get('id')}),item:x,status:ba,summary:aa(x),contents:ca});},'OzTimelineTask'),t=c('OzHelpers').pure(function(w){var x=w.intent,y=w.activeThread,z=w.tasks,aa='Closed: '+x.get('alias',x.get('name')),ba=c('OzHelpers').nextTaskForIntent(x,z);return c('React').createElement(q,{activeThread:y,path:c('OzHelpers').threadPath({threadid:x.get('user-id'),intentid:x.get('id'),taskid:ba&&ba.get('id')}),item:x,summary:aa});}),u=j({event:'timestamp',task:'deadline',separator:'timestamp',intent:'closed-at'});function v(w){var x=u.get(w.get('item-type'));return w.get(x,w.get('created-at'));}f.exports=p;}),null);
__d('OzThreadPanel.react',['cx','OzAPI','OzHelpers','immutable','OzConfig','OzHumans','OzEventShow.react','OzIntent.react','OzIntentActions.react','OzIntentList.react','OzIntentTabs.react','OzReminders.react','OzReminderTask.react','OzReminderTasks.react','OzStores','OzTabHeader.react','OzTaskComposers.react','OzTaskShow.react','OzThreadMeta.react','OzThreadNote.react','OzTimeline.react','OzImmutablePureRenderMixin','React','OzWrapper.react','Reflux','XUISelector.react'],(function a(b,c,d,e,f,g,h){var i=c('XUISelector.react').Option,j=c('immutable').Map,k=c('immutable').List,l=c('immutable').Set,m=c('React').PropTypes,n=c('OzStores').ActiveThreadStore,o='NO_OWNER',p='TODO',q='HISTORY',r=c('React').createClass({displayName:'OzThreadPanel',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config'),c('Reflux').connect(n,'activeThread'),c('Reflux').listenTo(n,'onActiveIntentChange')],onActiveIntentChange:function u(v){if(v.get('activeIntent')&&!v.get('activeTask')){var w=this._activeTabForIntent();if(w)this.setState({activeTab:w});}},componentWillMount:function u(){var v=this._activeTabForIntent();if(v)this.setState({activeTab:v});},componentWillReceiveProps:function u(v){if(!this.state.activeTab){var w=this._activeTabForIntent();if(w)this.setState({activeTab:w});}},render:function u(){var v=this.props,w=v.thread,x=v.repNames,y=this.state,z=y.activeTab,aa=y.config,ba=y.activeThread,ca=aa.getIn(['GK','timeline']),da=aa.get('display-tasks')||ca,ea=ba.get('activeIntent'),fa=ba.get('activeTask'),ga=ba.get('activeEvent'),ha=!(ca||z!==q),ia=c('OzHelpers').intents(w).find(function(sa){return sa.get('id')===ea;}),ja=ha?c('OzHelpers').closedIntents(w).filterNot(c('OzHelpers').isDeleted):ia?l(c('OzHelpers').openIntents(w).push(ia)).toList():c('OzHelpers').openIntents(w),ka=ia&&fa?(ia.get('tasks')||k()).find(function(sa){return sa.get('id')===fa;}):null,la=ia&&ga?(ia.get('events')||k()).find(function(sa){return sa.get('id')===ga;}):null,ma={isHistory:ha,repNames:x,thread:w},na=j(ja.map(function(sa){return [sa.get('id'),c('OzHelpers').intentAlias(sa)];}).concat(ia?[[ea,c('OzHelpers').intentAlias(ia)]]:[])),oa=w.get('tasks',k()).filter(function(sa){return ia?sa.get('intent-id')==ia.get('id'):true;}).map(function(sa){return sa.set('intent-name',na.get(sa.get('intent-id')));}),pa=w.get('tasks',k()).filter(function(sa){return sa.get('state')!=='completed';}).map(function(sa){return sa.get('intent-id');}).toSet(),qa=w.get('intents').filter(function(sa){return c('OzHelpers').isClosedIntent(sa)&&pa.get(sa.get('id'));}),ra=ia?ia.get('events',j()).valueSeq().map(function(sa){return sa.set('intent-name',na.get(sa.get('intent-id')));}).toList():ja.reduce(function(sa,ta){return sa.concat(ta.get('events',j()).valueSeq());},k()).map(function(sa){return sa.set('intent-name',na.get(sa.get('intent-id')));});return c('React').createElement('div',{className:"_5l_x"},ia&&c('React').createElement(c('OzTaskComposers.react'),{intent:ia}),ca?c('React').createElement(c('OzIntentTabs.react'),{intents:c('OzHelpers').openIntents(w).concat(qa),tasks:oa,activeIntentId:ea,threadId:w.get('user-id')}):null,c('React').createElement('div',{className:"_1c1k"+(ca?' '+"_5mt9":'')},c('React').createElement('div',{className:"_5l_y"},!ca&&c('React').createElement(c('OzTabHeader.react'),{active:z,tabs:[['Todo',p],['History',q]],onChange:this._handleTabChange}),c('React').createElement('div',{className:"_5l_z"+(ca?' '+"_5mt9":'')},ca?c('React').createElement(c('OzTimeline.react'),{events:ra,tasks:oa,closedIntents:!ea?c('OzHelpers').closedIntents(w):k()}):c('React').createElement('div',{className:"_4fj7"},c('React').createElement(c('OzIntentList.react'),{intents:ja,activeIntentId:ba.get('activeIntent'),witIntents:this.props.witIntents,isHistory:ha,timelineGK:ca}))),ha||!ca?c('React').createElement('div',{className:"_4sm5"},da?c('React').createElement(c('OzReminderTasks.react'),ma):c('React').createElement(c('OzReminders.react'),ma)):null),c('React').createElement('div',{className:"_5l_-"+(ca?' '+"_11_w":'')+(ca?' '+"_5mt9":'')},c('React').createElement('div',{className:"_5l__"},c('React').createElement('div',{className:"_4fj7"},ia?c('React').createElement(c('OzIntent.react'),{intent:ia,key:'intent-'+ia.get('id'),location:w.get('location')||j(),repNames:x,requirements:this.props.requirements,timelineGK:ca,thread:w}):null,ca&&ka?c('React').createElement(c('OzTaskShow.react'),{key:'task-'+ka.get('id'),location:w.get('location')||j(),onCancel:this._handleCancelTask,onComplete:this._handleCompleteTask,onSave:this._handleSaveTask,onOpen:this._handleOpenTask,task:ka}):la?c('React').createElement(c('OzEventShow.react'),{key:'event-'+la.get('id'),activeIntent:ia,event:la}):null)),!ca&&c('React').createElement('div',null,c('React').createElement(c('OzThreadNote.react'),{key:c('OzHelpers').threadID(w),thread:w,requirements:this.props.requirements}),c('React').createElement(c('OzThreadMeta.react'),{thread:w,repNames:x}),c('React').createElement(s,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:w})))),ca&&c('React').createElement('div',{className:"_5mtb"},c('React').createElement('div',null,c('React').createElement(c('OzThreadMeta.react'),{thread:w,repNames:x}),c('React').createElement(s,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:w})),c('React').createElement(c('OzThreadNote.react'),{key:c('OzHelpers').threadID(w),thread:w,timeline:ca,requirements:this.props.requirements})));},_activeTab:function u(){return this.state.activeTab||p;},_activeTabForIntent:function u(){var v=this.state.activeThread.get('activeIntent'),w=this.props.thread.get('intents',k()),x=v?w.find(function(y){return y.get('id')===v;}):null;if(x)if(c('OzHelpers').isClosedIntent(x)){return q;}else return p;},_handleTabChange:function u(v){var w=v[0],x=v[1];this.setState({activeTab:x});},_handleSaveTask:function u(v){return c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),v);},_handleCompleteTask:function u(v){return c('OzAPI').completeTask(c('OzHelpers').threadID(this.props.thread),v);},_handleCancelTask:function u(v){var w=arguments.length<=1||arguments[1]===undefined?false:arguments[1];return c('OzAPI').cancelTask(c('OzHelpers').threadID(this.props.thread),v,w);},_handleOpenTask:function u(v){return c('OzAPI').openTask(c('OzHelpers').threadID(this.props.thread),v);}}),s=c('OzHelpers').pure(function(u){var v=u.onOwnerChange,w=u.humans,x=u.reps,y=u.thread,z=y,aa=c('OzHelpers').nameOrId(z.get('last-owner')).split(' ')[0];return c('React').createElement('div',{className:"_5m00"},x&&!x.isEmpty()?c('React').createElement(t,{onChange:v,value:z.getIn(['owner','id'])||o,reps:x,humans:w}):null,c('React').createElement('span',{className:"_5m01"},aa?'Last owner: '+aa:null));}),t=c('OzHelpers').pure(function(u){var v=u.reps,w=u.humans,x=u.value,y=u.onChange,z=v.toSeq().filter(function(da){return c('OzHumans').isActive(w.get(da.get('fbid')));}).sortBy(function(da){return da.get('name');}).map(function(da){var ea=da.get('fbid'),fa=da.get('is-coach',false)?"_5m02":'';return c('React').createElement(i,{key:ea,value:ea},c('React').createElement('span',{className:fa},da.get('name')));}),aa=z.get(x);z=z.valueSeq();if(!aa){var ba=v.get(x,j()),ca=ba.get('is-coach',false)?"_5m02":'';z=z.toList().unshift(c('React').createElement(i,{key:'current',value:x},c('React').createElement('span',{className:ca},ba.get('name','None'))));}return c('React').createElement(c('XUISelector.react'),{size:'medium',value:x,onChange:y,maxheight:500},z);});f.exports=c('OzWrapper.react')(r);}),null);
__d('OzTop.react',['cx','OzAPI','OzHelpers','MessengerFlexScrollableArea.react','React','relativeTimeString.atlas','XUITextInput.react','SRTAdvancedDataTable.react','escapeRegex','ObjectSort','ReactRouter'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('ReactRouter').Link,l=[{id:'priority',label:'Priority',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.priority,p.priority);},cellRenderer:function n(o){return c('React').createElement('span',{className:o?"_1nnl":''},o?'yes':'no');}},{id:'trainer',label:'Trainer',sortable:true,comparator:c('ObjectSort').getStringSortFunction('trainer')},{id:'trainer-load',label:'Load',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('trainer-load'),isNumeric:true,cellRenderer:function n(o){return c('React').createElement('div',{className:o>3?"_1nnl":''},o?o:'Not present');}},{id:'trainer-team',label:'Team',sortable:true,comparator:c('ObjectSort').getStringSortFunction('trainer-team')},{id:'user-name',label:'User name',sortable:true,comparator:c('ObjectSort').getStringSortFunction('user-name'),cellRenderer:function n(o,p,q){return c('React').createElement(k,{target:'blank',to:c('OzHelpers').threadPath({threadid:q['user-id']})},o);}},{id:'external',label:'External',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.external,p.external);},cellRenderer:function n(o){return c('React').createElement('span',null,o?'external':'internal');}},{id:'vip',label:'Vip',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.vip,p.vip);},cellRenderer:function n(o){return c('React').createElement('span',null,o?'yes':'no');}},{id:'name',label:'Type',sortable:true,comparator:c('ObjectSort').getStringSortFunction('name'),cellRenderer:function n(o,p,q){return c('React').createElement(k,{target:'blank',to:c('OzHelpers').threadPath({threadid:q['user-id'],intentid:q.id})},o);}},{id:'blocked',label:'Status',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.blocked,p.blocked);},cellRenderer:function n(o){return c('React').createElement('span',null,o?'waiting':'open');}},{id:'created-at',label:'Open',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('created-at'),isNumeric:true,cellRenderer:function n(o){return c('relativeTimeString.atlas')(o,true);}},{id:'ir',label:'IR',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('ir'),isNumeric:true,cellRenderer:function n(o,p,q){return c('React').createElement('div',null,o===0?'**':o);}},{id:'cr',label:'Current CR (s)',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('cr'),isNumeric:true,cellRenderer:function n(o){return c('React').createElement('div',null,o===0?'**':o);}}];i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=j.constructor).call.apply(n,[this].concat(q)),this.state={items:[],filterText:''},this.$OzTop2=function(s){var t=s.trim().replace(/ +/g,' ').split(' '),u=new RegExp(t.map(c('escapeRegex')).join('.* .*'),'i');return function(v){return u.test(v.name)||u.test(v['user-name'])||u.test(v['trainer-team'])||u.test(v.trainer)||u.test(v['user-id'])||u.test(v.id);};},this.$OzTop3=function(event){this.setState({filterText:event.target.value});this.refs.theTable.setFilter(this.$OzTop2(event.target.value));}.bind(this),o;}m.prototype.componentWillMount=function(){var n=function(){return c('OzAPI').topIntents().then(function(o){return this.setState({items:o.toJS()});}.bind(this));}.bind(this);n();this.$OzTop1=setInterval(n,30*1000);};m.prototype.componentWillUnmount=function(){clearInterval(this.$OzTop1);};m.prototype.render=function(){return c('React').createElement('div',null,c('React').createElement('div',null,c('React').createElement('label',null,'Filter:',' ',c('React').createElement(c('XUITextInput.react'),{onChange:this.$OzTop3,value:this.state.filterText})),c('React').createElement('span',null,this.state.items.length,' open intents')),c('React').createElement(c('MessengerFlexScrollableArea.react'),null,c('React').createElement(c('SRTAdvancedDataTable.react'),{ref:'theTable',rowKeyField:'id',outerBorder:true,columns:l,rows:this.state.items,enableSelection:false})));};f.exports=m;}),null);
__d('OzTrainerDashboard.react',['cx','OzHelpers','relativeTimeString.atlas','immutable','OzButton.react','OzHumans','OzStores','OzImmutablePureRenderMixin','React','Reflux','XUITable.react'],(function a(b,c,d,e,f,g,h){var i=c('immutable').Map,j=c('OzStores').HumanStore,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzTrainerDashboard',mixins:[c('Reflux').connect(j,'humans')],contextTypes:{router:k.object.isRequired},render:function q(){return c('React').createElement(m,{onThreadSelect:this._handleThreadSelect,humans:this.state.humans,reps:this.props.reps});},_handleThreadSelect:function q(r){this.context.router.push('inbox/'+r);}}),m=c('React').createClass({displayName:'Main',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onThreadSelect:k.func.isRequired,humans:k.instanceOf(i).isRequired,reps:k.instanceOf(i).isRequired},render:function q(){return c('React').createElement('div',{className:"_10cd"},c('React').createElement(c('XUITable.react'),null,c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',null,'Trainer'),c('React').createElement('th',null,'Load'),c('React').createElement('th',null,'Status'),c('React').createElement('th',null,'Team'),c('React').createElement('th',null,'Link to Thread'))),c('React').createElement('tbody',null,this._getHumans().map(function(r){return c('React').createElement(n,{key:r.get('id'),onSelect:this._handleThreadSelect,human:r,rep:this.props.reps.get(r.get('id'))});}.bind(this)))));},_getHumans:function q(){var r=this.props,s=r.humans,t=r.reps;return s.sortBy(function(u){return t.getIn([u.get('id'),'name']);}).valueSeq();},_handleThreadSelect:function q(r){this.props.onThreadSelect(r.get('tid'));}}),n=c('React').createClass({displayName:'DashboardRow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onSelect:k.func.isRequired,human:k.instanceOf(i).isRequired,rep:k.instanceOf(i)},render:function q(){var r=this.props,s=r.onSelect,t=r.human,u=r.rep;return c('React').createElement('tr',null,c('React').createElement('td',null,o(u,t)),c('React').createElement('td',null,t.get('load')),c('React').createElement('td',null,p(t)),c('React').createElement('td',null,t.get('team')),c('React').createElement('td',null,t.get('tid')?c('React').createElement(c('OzButton.react'),{onClick:function v(){return s(t);}},'See Thread'):null));}});function o(q,r){var s=q&&q.get('name')||'Unknown name';return ''+s+(c('OzHumans').isCoach(r)?' (Coach)':'');}function p(q){var r=c('relativeTimeString.atlas')(+c('OzHelpers').serverNow()-q.get('inactive-ms',0),true),s=c('OzHumans').isActive(q)?'Active':'Away ('+r+')';return c('OzHumans').inCoachMode(q)?s+' | In Coach Mode':s;}f.exports=l;}),null);
__d('OzMount',['invariant','OzAPI','OzHelpers','promiseFinally','immutable','Oz.react','OzActions','OzAll.react','OzConfig','OzFeedbackDashboard.react','OzInbox.react','OzInboxShow.react','OzMerchants.react','OzStores','OzThreadPanel.react','OzTop.react','OzTrainerDashboard.react','React','ReactDOM','ReactRouter','URI','OzTwilio','OzServerTime','OzPerformance'],(function a(b,c,d,e,f,g,h){c('OzTwilio');var i=c('ReactRouter').Route,j=c('ReactRouter').IndexRoute,k=c('ReactRouter').browserHistory,l=c('ReactRouter').match,m=c('ReactRouter').Router,n=c('ReactRouter').Redirect,o=c('OzStores').CalendarEventStore,p={mount:function x(y,z){z=babelHelpers['extends']({},z,u());c('OzPerformance').init();c('OzConfig').setConfig(c('immutable').fromJS(z));c('OzHelpers').info('[config]',z);var aa=void 0,ba=v(c('Oz.react'),{rev:z.rev,uid:z.uid,version:z.API_VERSION,skipToto:z.skipToto==='true',onUnmount:function ka(){aa&&aa();}}),ca=function ka(la){var ma=la.threadid,na=la.intentid,oa=la.taskid,pa=la.eventid;c('OzHelpers').info('[mount] storeParams',ma,na,oa,pa);var qa=na?parseInt(na,10):null;c('OzActions').activateThread({threadID:ma,intentID:qa,taskID:oa?parseInt(oa,10):null,eventID:pa?parseInt(pa,10):null});ma&&c('OzAPI').threadFocus(ma,qa);if(!o.data.get(ma))c('OzAPI').fetchCalendar(ma);},da=w(c('OzAPI').thread,500),ea={},fa=function ka(la,ma,na){c('OzHelpers').info('[mount] onThreadEnter',la);ca(la.params);var oa=la.params,pa=oa.threadid,qa=oa.intentid;if(pa)da(pa);if(qa){na();}else{c('OzHelpers').info('[mount] no intent id; computing');if(pa&&ea[pa]){c('OzHelpers').info('[mount] loading intent from history',pa,ea[pa]);ma(c('OzHelpers').threadPath({threadid:pa,intentid:ea[pa]}));na();}else if(pa){c('promiseFinally')(da(pa).then(function(ra){c('OzHelpers').info('[mount] missing intent; looking for last created');var sa=c('OzHelpers').openIntents(ra).maxBy(function(ta){return ta.get('created-at');});if(sa){c('OzHelpers').info('[mount] missing intent; using last created',pa,sa.get('id'));ma(c('OzHelpers').threadPath({threadid:pa,intentid:sa.get('id')}));}else c('OzHelpers').info('[mount] no intent to pick',pa);}),function(ra){return na();}).done();}else{c('OzHelpers').warn('[mount] somehow missing threadid',la);na();}}},ga=function ka(la){c('OzHelpers').info('[mount] onIntentEnter',la);ca(la.params);var ma=la.params,na=ma.threadid,oa=ma.intentid,pa=oa?parseInt(oa,10):null;na&&pa&&(ea[na]=pa);pa&&c('OzAPI').handledEvents(pa);c('OzConfig').ConfigStore.data.getIn(['GK','timeline'])&&na&&pa&&c('OzAPI').tasksForIntent(pa,na);},ha=function ka(la){c('OzHelpers').info('[mount] onThreadLeave',la);c('OzActions').activateThread({threadID:null,intentID:null,taskID:null});},ia=c('React').createElement(i,{component:ba},c('React').createElement(i,{path:'/',component:c('OzInbox.react')},c('React').createElement(i,{path:'/inbox/:threadid',component:c('OzInboxShow.react'),onEnter:fa,onLeave:ha},c('React').createElement(j,{onEnter:function ka(la){var ma=la.params;return ca(ma);},component:c('OzThreadPanel.react')}),c('React').createElement(i,{path:'intent/:intentid',component:c('OzThreadPanel.react'),onEnter:ga}),c('React').createElement(i,{path:'intent/:intentid/task/:taskid',component:c('OzThreadPanel.react'),onEnter:ga}),c('React').createElement(i,{path:'intent/:intentid/event/:eventid',component:c('OzThreadPanel.react'),onEnter:ga}))),c('React').createElement(i,{path:'/all',component:c('OzAll.react')}),c('React').createElement(i,{path:'/merchants',component:c('OzMerchants.react')}),c('React').createElement(i,{path:'/top',component:c('OzTop.react')}),c('React').createElement(i,{path:'/feedback',component:c('OzFeedbackDashboard.react')}),c('React').createElement(i,{path:'/trainers',component:c('OzTrainerDashboard.react')}),c('React').createElement(n,{from:'/inbox',to:'/'})),ja=function ka(){c('ReactDOM').render(c('React').createElement(m,{history:k,routes:ia}),y);};ja();q(function(){var ka=c('OzConfig').getStaticConfig('skipSky')==='true',la=c('OzConfig').getStaticConfig('skipAPIInit')==='true';c('OzHelpers').info('[sky] connecting to '+z.skyTopic);if(ka)c('OzActions').updateLoadingState({component:'skywalker',state:'loading',skip:true});var ma=function oa(pa){if(typeof aa==='function')aa();aa=c('OzAPI').realTime(z.skyTopic,function(qa,ra,sa){if(qa){c('OzHelpers').warn('[sky] could not connect: '+qa);if(pa>0){return oa(pa-1);}else c('OzActions').updateLoadingState({component:'skywalker',state:'failed',error:qa,skip:ka});}else{c('OzHelpers').info('[sky] connected to '+z.skyTopic+': '+ra.t,ra);c('OzAPI').repsSync();c('OzActions').updateLoadingState({component:'skywalker',state:'loaded',result:{data:ra,token:sa},skip:ka});}});};ma(3);var na=function oa(pa,qa,ra){ra().then(function(sa){c('OzActions').updateLoadingState({component:qa,state:'loaded',result:sa,skip:la});})['catch'](function(sa){if(pa>0){oa(pa-1,qa,ra);}else c('OzActions').updateLoadingState({component:qa,state:'failed',error:sa,skip:la});}).done();};na(3,'init',c('OzAPI').init);na(3,'wit-intents',c('OzAPI').witIntents);na(3,'merchants',c('OzAPI').merchants);na(3,'humans',c('OzAPI').humans);na(3,'requirements',c('OzAPI').requirements);c('OzServerTime').setup();});}},q=function x(y){var z;if(window.loaded){y();}else (function(){var aa=window.onload;if(typeof aa=='function'){window.onload=function(){try{aa.apply(undefined,arguments);}catch(ba){c('OzHelpers').log('Exception on window,inload',ba);}y.apply(undefined,arguments);};}else window.onload=y;})();},r=/^ozcfg(.+)/;function s(){var x=new (c('URI'))(window.location.href).getQueryData();Object.keys(x).forEach(function(y){if(r.test(y))localStorage.setItem(y,x[y]);});}function t(){var x,y,z,aa={};for(x=0;x<localStorage.length;x++){y=localStorage.key(x);z=y.match(r);if(z&&z.length)aa[z[1]]=localStorage.getItem(y);}return aa;}function u(){s();var x=t(),y,z=document.location.hostname;if(z==='www.oz.wit.ai'){y={skyTopic:'oz/all',env:'prod',scubaCategory:'oz_console',PAGE_ID:'881263441913087',API_PATH:'https://www.oz.wit.ai/api'};}else if(z==='intern.oz.wit.ai'||!x.API_PATH){y={skyTopic:'oz-staging/all',env:'staging',scubaCategory:'oz_console_dev',PAGE_ID:'506060876211905',API_PATH:'https://intern.oz.wit.ai/api'};}else{var aa=z.split('.')[1];y={skyTopic:'oz-dev/'+aa,env:'dev',scubaCategory:'oz_console_dev',PAGE_ID:'1579802578966277'};}y=babelHelpers['extends']({},y,x,{API_VERSION:'20151027'});y.API_PATH||h(0);return y;}function v(x,y){var z,aa;return aa=z=function(){var ba,ca;ba=babelHelpers.inherits(da,c('React').Component);ca=ba&&ba.prototype;da.prototype.render=function(){'use strict';return c('React').createElement(x,babelHelpers['extends']({},y,this.props));};function da(){'use strict';ba.apply(this,arguments);}return da;}(),z.displayName='Curried'+x.displayName,aa;}var w=function x(y,z){var aa={},ba={};return function(ca){if(Date.now()-(aa[ca]||0)<=z&&ba[ca]){c('OzHelpers').info('[mount/throttle] using result',ca,ba[ca]);return ba[ca];}else{aa[ca]=Date.now();c('OzHelpers').info('[mount/throttle] running!',ca);return ba[ca]=y(ca);}};};f.exports=p;}),null);
__d('OzDev',['OzConfig','immutable','OzActions','OzHelpers','OzNotify','OzAPI','OzMount','OzStores','OzTwilio'],(function a(b,c,d,e,f,g){var h=c('immutable').Map;function i(m){c('OzConfig').updateConfig(c('immutable').fromJS(m));}function j(){for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];c('OzConfig').updateConfig(h().setIn(n,!c('OzConfig').getInStaticConfig(n)));}function k(){var m=arguments.length<=0||arguments[0]===undefined?true:arguments[0];c('OzConfig').updateConfig(h({devMode:m}));}document.addEventListener('keydown',function(m){if(m.which===84&&m.ctrlKey)j('display-tasks');if(m.which===89&&m.ctrlKey)j('GK','timeline');if(m.which===82&&m.ctrlKey&&!m.shiftKey)j('GK','responsivenessV2');if(m.which===82&&m.ctrlKey&&m.shiftKey)j('GK','responsivenessExecTime');if(m.which===79&&m.ctrlKey){j('GK','openTableAPI');var n=c('OzConfig').getInStaticConfig(['GK','openTableAPI']);c('OzNotify').info('openTableAPI set to '+n);}});function l(){var m=['selectAIPick'];m.map(function(n){c('OzActions')[n].listen(function(){for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return c('OzHelpers').debug('[Action]',n,p);});});}l();f.exports={api:c('OzAPI'),actions:c('OzActions'),config:c('OzConfig'),devMode:k,updateConfig:i,toggleConfig:j,h:c('OzHelpers'),mount:c('OzMount'),stores:c('OzStores'),twilio:c('OzTwilio'),notify:c('OzNotify')};}),null);