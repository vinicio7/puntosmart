if (self.CavalryLogger) { CavalryLogger.start_js(["a7hlk"]); }

__d("OzConstants",[],(function a(b,c,d,e,f,g){f.exports={AUTHOR_TYPES:{BOT:"bot",TRAINER:"trainer",USER:"user"},ATTS:{COMMAND:"\u0040COMMAND",IMAGE:"image",SUGG:"\u0040SUGG",TEMPLATE:"template",SURVEY:"survey",QUICK_REPLIES:"\u0040QUICK_REPLIES",OPENTABLEQR:"opentableQuickReply"},SESSION_INFO_EVENT:"iframenonce_fb_session_info",TOKENS:{USER_FIRST_NAME:"user-first-name"},REMINDERS:{RANGE_IN_YEARS:5},M_FBIDS:{M:"881263441913087",M_DEV:"1579802578966277",P:"506060876211905"}};}),null);
__d('AdsTargetingLocationInlineMapUtils',['GeoCoordinates','LeafletUtils','LeafletView','LocationConstants','leaflet'],(function a(b,c,d,e,f,g){'use strict';var h=10000;function i(n){var o=void 0;n.forEach(function(p){var q=void 0;if(p.center&&p.radius){var r=p.center,s=p.radius;q=c('LeafletUtils').circleBounds(c('LeafletUtils').toLatLng(r),s);}else if(p.coordinateLists&&p.coordinateLists.size){p.coordinateLists.forEach(function(t){var u=t.map(function(w){return c('LeafletUtils').toLatLng(new (c('GeoCoordinates'))(w.latitude,w.longitude));}).toArray(),v=c('leaflet').latLngBounds(u);q=undefined===q?v:q.extend(v);});}else if(p.center)q=c('LeafletUtils').circleBounds(c('LeafletUtils').toLatLng(p.center),h);if(undefined===o){o=q;}else o.extend(q);});return o;}function j(n,o){var p=i(o);if(!p)return n;return n.setCenter(c('LeafletUtils').fromLatLng(p.getCenter()));}function k(n,o){return new (c('LeafletView'))({center:n.center,zoom:c('LocationConstants').getNextZoomRangeStart(o)});}function l(n){return n.type===c('LocationConstants').CUSTOM_LOCATIONS&&n.custom_type===c('LocationConstants').CUSTOM_TYPE_MULTI_CITY;}var m={centerToLocations:j,getAllBounds:i,isLocationForMultiCity:l,zoomToNextRange:k};f.exports=m;}),null);
__d('AdsTargetingLocationMapPopup',['cx','FbtResultBase','React','isEmpty','nullthrows'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={showingPopoverMenu:false},this.$AdsTargetingLocationMapPopup1=function(){var r=c('isEmpty')(this.props.menuItems);return c('React').createElement('div',null,c('React').createElement('div',{className:(r?"_2e-k":'')+(!r?' '+"_37vz":'')},this.props.label),r?null:this.$AdsTargetingLocationMapPopup2());}.bind(this),this.$AdsTargetingLocationMapPopup2=function(){var r="_37v-";return c('React').createElement('div',{className:"_37v_"},c('React').createElement('button',{className:r,type:'button',onClick:this.$AdsTargetingLocationMapPopup3},this.props.children),this.$AdsTargetingLocationMapPopup4());}.bind(this),this.$AdsTargetingLocationMapPopup5=function(r){return !!(this.props.menuItemsDisabled&&this.props.menuItemsDisabled[r]);}.bind(this),this.$AdsTargetingLocationMapPopup4=function(){if(!this.state.showingPopoverMenu)return null;var r=c('nullthrows')(this.props.menuItems),s="_37w0",t=Object.keys(r).map(function(u){var v=this.$AdsTargetingLocationMapPopup6.bind(this,u),w=r[u],x=this.$AdsTargetingLocationMapPopup5(u);return c('React').createElement('button',{className:s,disabled:x,key:u,onClick:v},w);}.bind(this));return c('React').createElement('div',{className:"_37w1"},t);}.bind(this),this.$AdsTargetingLocationMapPopup3=function(){this.setState({showingPopoverMenu:!this.state.showingPopoverMenu});}.bind(this),this.$AdsTargetingLocationMapPopup6=function(r){this.setState({showingPopoverMenu:false});this.props.onMenuItemSelect(r,this.props.location);}.bind(this),n;}l.prototype.render=function(){return c('React').createElement('div',{className:"_37vy"},this.$AdsTargetingLocationMapPopup1());};l.propTypes={label:k.oneOfType([k.string,k.instanceOf(c('FbtResultBase'))]).isRequired,location:k.object.isRequired,menuItems:k.object,menuItemsDisabled:k.object,onMenuItemSelect:k.func.isRequired};f.exports=l;}),null);
__d('AdsTargetingLocationTypeAliases',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({DEFAULT:null,INVOKE_CALLBACK_ON_SINGLE_NODE:null,NONE:null,SHOW_POPUP:null,ZOOM_TO_MARKER:null,ZOOM_TO_NEXT_RANGE:null}),i={CLICK_BEHAVIORS:h};f.exports=i;}),null);
__d('AdsTargetingLocationInlineMap.react',['cx','fbt','ix','AdsCommonLocalMapUtils','AdsInterfacesLogger','AdsTargetingLocationLoggingEvents','AdsTargetingLocationMapPopup','BanzaiODS','BUIAdoptionButton.react','FBOverlayElement.react','FBTilesMap.react','FBTilesMapZoomOverlay.react','GeoCoordinates','Image.react','immutable','LeafletCircle.react','LeafletCircleMarker.react','LeafletMarker.react','LeafletMultiPolygon.react','LeafletPopup.react','LeafletUtils','LeafletView','LocationConstants','React','TilesMapConfig','XUIButton.react','areEqual','emptyFunction','leaflet','performanceNow','AdsTargetingLocationInlineMapUtils','AdsTargetingLocationTypeAliases'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('React').PropTypes,n=c('AdsTargetingLocationInlineMapUtils').centerToLocations,o=c('AdsTargetingLocationInlineMapUtils').getAllBounds,p=c('AdsTargetingLocationInlineMapUtils').isLocationForMultiCity,q=c('AdsTargetingLocationInlineMapUtils').zoomToNextRange,r=c('AdsTargetingLocationTypeAliases').CLICK_BEHAVIORS,s=new (c('LeafletView'))({center:new (c('GeoCoordinates'))(0,0),zoom:1}),t=1,u=2,v=c('React').createElement(c('Image.react'),{src:j("22149"),width:'12'}),w=c('React').createElement(c('Image.react'),{src:j("22118"),width:'16'}),x={INCLUDE:i._("Incluir"),EXCLUDE:i._("Excluir"),DELETE:i._("Eliminar")},y={DELETE:i._("Eliminar")},z=0,aa=0;k=babelHelpers.inherits(ba,c('React').Component);l=k&&k.prototype;function ba(){var ca,da;for(var ea=arguments.length,fa=Array(ea),ga=0;ga<ea;ga++)fa[ga]=arguments[ga];return da=(ca=l.constructor).call.apply(ca,[this].concat(fa)),this.state={locating:false,mapOptions:{scrollWheelZoom:!this.props.disableScrollWheelZoom,maxBounds:this.props.maxBounds},size:null,view:this.props.view||s,popupLocationKey:null},this.$AdsTargetingLocationInlineMap1=function(ha){if(ha.coordinateLists.size)return null;var ia=c('LocationConstants').getPluralLocationType(ha.geoLocation.type);switch(ia){case c('LocationConstants').COUNTRIES:return new (c('LeafletView'))({center:ha.center,zoom:u});case c('LocationConstants').COUNTRY_GROUPS:return new (c('LeafletView'))({center:ha.center,zoom:t});case c('LocationConstants').CUSTOM_LOCATIONS:if(ha.geoLocation.custom_type===c('LocationConstants').CUSTOM_TYPE_MULTI_CITY)return new (c('LeafletView'))({center:ha.center,zoom:ha.geoLocation.country?u:t});return null;default:return null;}},this.$AdsTargetingLocationInlineMap8=function(ha,ia){if(ia){return !ha?c('AdsCommonLocalMapUtils').LEAFLET_TARGET_HIGHLIGHT_REGION_INCLUDE_OPTIONS:c('AdsCommonLocalMapUtils').LEAFLET_TARGET_HIGHLIGHT_REGION_EXCLUDE_OPTIONS;}else return !ha?c('AdsCommonLocalMapUtils').LEAFLET_TARGET_REGION_INCLUDE_OPTIONS:c('AdsCommonLocalMapUtils').LEAFLET_TARGET_REGION_EXCLUDE_OPTIONS;},this.$AdsTargetingLocationInlineMap9=function(ha,ia){if(ia){return ha?"_s6h":"_s6i";}else return ha?"_3i44":"_3i45";},this.$AdsTargetingLocationInlineMap4=function(ha,ia,ja,ka){var la=this.props.menuItems||(this.props.onlyInclusion?y:x),ma=void 0;if(!this.props.menuItems)ma=ia?{INCLUDE:false,EXCLUDE:true,DELETE:false}:{INCLUDE:true,EXCLUDE:false,DELETE:false};ha.forEach(function(na,oa){var pa=this.state.popupLocationKey===na.geoLocation.key,qa=this.props.highlightLocations.contains(na)||pa,ra=(qa?'h':'')+(ia?'-':'')+na.geoLocation.key,sa=this.$AdsTargetingLocationInlineMap8(ia,qa),ta=[],ua=c('React').createElement(c('LeafletPopup.react'),{options:{autoPan:false,closeButton:false,className:"_1l0n",maxWidth:500}},na.popup||c('React').createElement(c('AdsTargetingLocationMapPopup'),{label:this.$AdsTargetingLocationInlineMap10(na.geoLocation),location:na.geoLocation,menuItems:p(na.geoLocation)?y:la,menuItemsDisabled:ma,onMenuItemSelect:this.props.onPopupMenuItemSelect})),va=pa||[r.DEFAULT,r.SHOW_POPUP].includes(this.props.clickBehavior)?ua:undefined,wa=this.$AdsTargetingLocationInlineMap11(na),xa=function fb(gb){if(pa)gb.target.openPopup();},ya=function(fb){if(this.state.popupLocationKey!==na.geoLocation.key)this.setState({popupLocationKey:na.geoLocation.key});}.bind(this),za=function(fb){if(this.state.popupLocationKey===na.geoLocation.key&&pa)this.setState({popupLocationKey:null});}.bind(this),ab=function(fb){if(this.props.showPopupOnHover)ya(fb);}.bind(this),bb=function(fb){if(this.props.showPopupOnHover)za(fb);}.bind(this),cb=na.icon||c('leaflet').divIcon(babelHelpers['extends']({},c('AdsCommonLocalMapUtils').LEAFLET_MARKER_ICON_OPTIONS,{className:this.$AdsTargetingLocationInlineMap9(ia,qa)}));ta.push(c('React').createElement(c('LeafletMarker.react'),{coordinates:na.center,eventHandlers:{add:xa,click:wa,mouseover:ab,mouseout:bb,popupclose:za,popupopen:ya},key:'m'+ra,options:{clickable:true,icon:cb,zIndexOffset:qa?1000:0},popup:va}));var db=false;if(na.coordinateLists&&na.coordinateLists.size){ta.push(c('React').createElement(c('LeafletMultiPolygon.react'),{coordinateLists:na.coordinateLists,key:'p'+ra,options:sa}));db=true;}var eb=na.circleCenter||na.center;if(eb&&na.radius){ta.push(c('React').createElement(c('LeafletCircle.react'),{center:eb,key:'c'+ra,options:sa,radius:na.radius}));if(!db)ta.push(c('React').createElement(c('LeafletCircleMarker.react'),{center:eb,key:'cm'+ra,options:c('AdsCommonLocalMapUtils').LEAFLET_TARGET_MARKER_OPTIONS}));}if(qa){ka.push.apply(ka,ta);}else ja.push.apply(ja,ta);}.bind(this));}.bind(this),this.$AdsTargetingLocationInlineMap10=function(ha){return ha.name;},this.$AdsTargetingLocationInlineMap12=function(){c('AdsInterfacesLogger').log({eventName:c('AdsTargetingLocationLoggingEvents').GEO_LOCATION_MAP_ZOOM_IN},c('AdsInterfacesLogger').LOG_TYPE_PRIMARY_APP);var ha=this.state.view;if(ha.zoom<c('TilesMapConfig').ZOOM_RANGE.MAX)this.$AdsTargetingLocationInlineMap3(ha.setZoom(ha.zoom+1));}.bind(this),this.$AdsTargetingLocationInlineMap13=function(){c('AdsInterfacesLogger').log({eventName:c('AdsTargetingLocationLoggingEvents').GEO_LOCATION_MAP_ZOOM_OUT},c('AdsInterfacesLogger').LOG_TYPE_PRIMARY_APP);var ha=this.state.view;if(ha.zoom>c('TilesMapConfig').ZOOM_RANGE.MIN)this.$AdsTargetingLocationInlineMap3(ha.setZoom(ha.zoom-1));}.bind(this),this.$AdsTargetingLocationInlineMap14=function(){c('AdsInterfacesLogger').log({eventName:c('AdsTargetingLocationLoggingEvents').GEO_LOCATION_MAP_ZOOM_TO_FIT},c('AdsInterfacesLogger').LOG_TYPE_PRIMARY_APP);var ha=this.$AdsTargetingLocationInlineMap2(this.state.size,this.props.locations.union(this.props.excludedLocations));this.$AdsTargetingLocationInlineMap3(ha);}.bind(this),this.$AdsTargetingLocationInlineMap15=function(){var ha=this.state.view.zoom<c('TilesMapConfig').ZOOM_RANGE.MAX?this.$AdsTargetingLocationInlineMap12:undefined,ia=this.state.view.zoom>c('TilesMapConfig').ZOOM_RANGE.MIN?this.$AdsTargetingLocationInlineMap13:undefined,ja=!this.props.disableCollapseButton&&c('React').createElement('div',{className:"_qh2"},c('React').createElement(c('XUIButton.react'),{className:"_qh3",image:w,label:i._("click to collaps map"),labelIsHidden:true,type:'button',onClick:this.props.onCollapseMap}));return c('React').createElement(c('FBOverlayElement.react'),{horizontal:'right',key:'zoomControls',vertical:'top'},c('React').createElement('div',null,ja,c('React').createElement(c('FBTilesMapZoomOverlay.react'),{className:"_3-8j",onZoomIn:ha,onZoomOut:ia}),c('React').createElement('div',{className:"_qh4"},c('React').createElement(c('XUIButton.react'),{className:"_qh5",image:v,label:i._("Ampliar para ajustar"),labelIsHidden:true,type:'button',onClick:this.$AdsTargetingLocationInlineMap14}))));}.bind(this),this.$AdsTargetingLocationInlineMap16=function(){return c('React').createElement(c('FBOverlayElement.react'),{horizontal:'right',key:'addLocation',vertical:'bottom'},c('React').createElement('div',null,c('React').createElement(c('BUIAdoptionButton.react'),{disabled:this.props.addingLocation,icon:c('React').createElement(c('Image.react'),{src:this.props.addLocationMode===c('LocationConstants').INCLUDE?j("22123"):j("22122")}),isDepressed:this.state.locating,label:i._("Colocar marcador"),style:{marginBottom:'12px',marginRight:'12px'},type:'button',onClick:this.$AdsTargetingLocationInlineMap17})));}.bind(this),this.$AdsTargetingLocationInlineMap7=function(){if(this.props.hideAllControls)return null;return this.props.enableDropPin?[this.$AdsTargetingLocationInlineMap15(),this.$AdsTargetingLocationInlineMap16()]:[this.$AdsTargetingLocationInlineMap15()];}.bind(this),this.$AdsTargetingLocationInlineMap5=function(event){if(this.state.locating){this.setState({locating:false});this.props.onAddLocationFromMap(new (c('GeoCoordinates'))(event.latlng.lat,c('LeafletUtils').wrapLongitude(event.latlng.lng)));}}.bind(this),this.$AdsTargetingLocationInlineMap17=function(ha){this.setState({locating:!this.state.locating});}.bind(this),this.$AdsTargetingLocationInlineMap2=function(ha,ia){if(!ha||0===ia.size)return this.state.view;var ja=o(ia);if(!ja)return this.state.view;var ka=c('LeafletUtils').fitBounds(ja,{width:ha.x,height:ha.y},{zoomRange:[0,20]});return ka;}.bind(this),this.$AdsTargetingLocationInlineMap6=function(ha){var ia=this.state.view;if(this.props.centerLocations&&this.props.centerLocations.size>0){ia=n(this.state.view,this.props.centerLocations);}else if(this.props.locations.size>0||this.props.excludedLocations.size>0||this.props.fitLocations.size>0)ia=this.$AdsTargetingLocationInlineMap2(ha,this.props.locations.union(this.props.excludedLocations).union(this.props.fitLocations));this.$AdsTargetingLocationInlineMap3(ia,ha);}.bind(this),this.$AdsTargetingLocationInlineMap3=function(ha,ia){var ja=ia||this.state.size;if(this.props.view){this.setState({size:ja});}else this.setState({view:ha,size:ja});if(this.props.onViewChange)this.props.onViewChange(ha,ja);}.bind(this),da;}ba.prototype.componentWillMount=function(){z=c('performanceNow')();};ba.prototype.componentDidMount=function(){var ca=Math.floor(c('performanceNow')()-z);c('AdsInterfacesLogger').log({eventName:c('AdsTargetingLocationLoggingEvents').GEO_LOCATION_MAP_MOUNTING_TIME},c('AdsInterfacesLogger').LOG_TYPE_PRIMARY_APP);c('BanzaiODS').bumpEntityKey('ads_targeting_location','geo_location_map_mounting_time',ca);};ba.prototype.componentWillUpdate=function(ca,da){aa=c('performanceNow')();};ba.prototype.componentWillReceiveProps=function(ca){if(!c('LeafletUtils').areViewEqual(ca.view,this.props.view)){this.setState({view:ca.view||s});}else if(null!==this.state.size&&ca.fitLocations.size>0&&(ca.forceUpdate||!c('areEqual')(ca.fitLocations,this.props.fitLocations))){var da=null;if(ca.fitLocations.size==1){var ea=ca.fitLocations.first();da=this.$AdsTargetingLocationInlineMap1(ea);}if(!da)da=this.$AdsTargetingLocationInlineMap2(this.state.size,ca.fitLocations);this.$AdsTargetingLocationInlineMap3(da);}};ba.prototype.shouldComponentUpdate=function(ca,da){var ea=ca.addLocationMode!==this.props.addLocationMode||!c('areEqual')(ca.highlightLocations,this.props.highlightLocations)||!c('areEqual')(ca.locations,this.props.locations)||!c('areEqual')(ca.excludedLocations,this.props.excludedLocations)||!c('LeafletUtils').areViewEqual(ca.view,this.props.view),fa=da!==undefined&&(da.size!=this.state.size||!c('LeafletUtils').areViewEqual(da.view,this.state.view)||da.popupLocationKey!==this.state.popupLocationKey||da.locating!=this.state.locating);return ea||fa;};ba.prototype.render=function(){var ca=null;if(this.state.locating){ca=this.props.addLocationMode===c('LocationConstants').INCLUDE?"_3aio":"_3aiw";}else ca="_3-cr";var da=[],ea=[];this.$AdsTargetingLocationInlineMap4(this.props.locations,false,da,ea);this.$AdsTargetingLocationInlineMap4(this.props.excludedLocations,true,da,ea);return c('React').createElement(c('FBTilesMap.react'),{className:ca,eventHandlers:{click:this.$AdsTargetingLocationInlineMap5},options:this.state.mapOptions,showReportButton:false,showZoomControls:false,view:this.state.view,onSizeSettled:this.$AdsTargetingLocationInlineMap6,onViewChange:this.$AdsTargetingLocationInlineMap3},this.$AdsTargetingLocationInlineMap7(),da,ea);};ba.prototype.$AdsTargetingLocationInlineMap18=function(ca){var da=ca.meta;if(!this.props.onSingleNodeClick||c('immutable').Set.isSet(da)&&da.size!==1){this.$AdsTargetingLocationInlineMap19(ca);return;}var ea=!c('immutable').Set.isSet(da)?da:da.first();this.props.onSingleNodeClick(ea.getID());};ba.prototype.$AdsTargetingLocationInlineMap11=function(ca){switch(this.props.clickBehavior){case r.DEFAULT:case r.ZOOM_TO_MARKER:return function(){return this.$AdsTargetingLocationInlineMap20(ca);}.bind(this);case r.ZOOM_TO_NEXT_RANGE:return function(){return this.$AdsTargetingLocationInlineMap19(ca);}.bind(this);case r.INVOKE_CALLBACK_ON_SINGLE_NODE:return function(){return this.$AdsTargetingLocationInlineMap18(ca);}.bind(this);default:return c('emptyFunction');}};ba.prototype.$AdsTargetingLocationInlineMap20=function(ca){var da=this.$AdsTargetingLocationInlineMap2(this.state.size,c('immutable').Set.of(ca));this.$AdsTargetingLocationInlineMap3(da);};ba.prototype.$AdsTargetingLocationInlineMap19=function(ca){this.$AdsTargetingLocationInlineMap3(q(ca,this.state.view.zoom));};ba.propTypes={addLocationMode:m.string.isRequired,addingLocation:m.bool,clickBehavior:m.oneOf(Object.keys(r)),disableCollapseButton:m.bool,disableScrollWheelZoom:m.bool,enableDropPin:m.bool.isRequired,excludedLocations:m.instanceOf(c('immutable').Set).isRequired,fitLocations:m.instanceOf(c('immutable').Set).isRequired,forceUpdate:m.bool,hideAllControls:m.bool,highlightLocations:m.instanceOf(c('immutable').Set).isRequired,locations:m.instanceOf(c('immutable').Set).isRequired,maxBounds:m.instanceOf(c('leaflet').LatLngBounds),menuItems:m.object,onlyInclusion:m.bool.isRequired,showPopupOnHover:m.bool,view:m.instanceOf(c('LeafletView')),onAddLocationFromMap:m.func.isRequired,onCollapseMap:m.func.isRequired,onPopupMenuItemSelect:m.func.isRequired,onViewChange:m.func};ba.defaultProps={clickBehavior:r.DEFAULT};f.exports=ba;}),null);
__d('AdsTargetingLocationMapMetaRecord',['cx','AdsCommonLocalMapUtils','AdsTargetingLocationUtils','GeoCoordinates','immutable','LeafletUtils','LocationConstants','Map','leaflet','nullthrows'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k={},l=new (c('Map'))(),m=350,n={NONE:0,SHIFT_LEFT:-1,SHIFT_RIGHT:1};i=babelHelpers.inherits(o,c('immutable').Record({center:null,circleCenter:null,coordinateLists:null,geoLocation:null,icon:null,meta:null,name:null,popup:null,radius:0}));j=i&&i.prototype;function o(p){j.constructor.call(this,p);}o.prototype.hashCode=function(){var p=c('AdsTargetingLocationUtils').getUniqueKey(this.geoLocation);if(!l.has(p))l.set(p,c('AdsTargetingLocationUtils').getHashCode(this.geoLocation));return c('nullthrows')(l.get(p));};o.fromGeoLocations=function(p,q){var r=[];c('LocationConstants').locationTypes.forEach(function(s){(p[s]||[]).forEach(function(t){if(t.latitude==null||t.longitude==null)return;r.push(this.fromGeoLocationCached(t,q(t)));}.bind(this));}.bind(this));return c('immutable').Set(r);};o.fromGeoLocationCached=function(p,q){var r=c('AdsTargetingLocationUtils').getUniqueKey(p);if(!k[r])k[r]=this.fromGeoLocation(p,q);return k[r];};o.fromGeoLocation=function(p,q){var r=[],s=0,t=new (c('GeoCoordinates'))(Number(p.latitude),Number(p.longitude));if(p.polygons&&p.polygons.length)r=this.generatePolygonLists(p.polygons);if(p.radius&&p.distance_unit)s=c('AdsTargetingLocationUtils').getRadiusInMeters(p.radius,p.distance_unit);return new o({center:t,coordinateLists:c('immutable').List(r),geoLocation:p,icon:null,meta:q,name:p.name,popup:null,radius:s});};o.generatePolygonLists=function(p){var q=c('leaflet').latLngBounds(p),r=n.NONE;if(q.getEast()-q.getWest()>m){var s=this.boundsForShiftedMultipolygons(p,n.SHIFT_LEFT),t=this.boundsForShiftedMultipolygons(p,n.SHIFT_RIGHT),u=Math.abs(q.getEast()-q.getWest()),v=Math.abs(s.getEast()-s.getWest()),w=Math.abs(t.getEast()-t.getWest());if(v<=u||w<=u)if(Math.abs(s.getCenter().lng)<=Math.abs(t.getCenter().lng)){r=n.SHIFT_LEFT;}else r=n.SHIFT_RIGHT;}var x=[];p.forEach(function(y){var z=[];y.forEach(function(aa){z.push(new (c('GeoCoordinates'))(Number(aa.lat),this.shiftLongitude(c('LeafletUtils').wrapLongitude(Number(aa.lng)),r)));}.bind(this));x.push(c('immutable').List(z));}.bind(this));return x;};o.shiftLongitude=function(p,q){if(q===n.SHIFT_LEFT){p=p<0?p:p-360;}else if(q===n.SHIFT_RIGHT)p=p>0?p:p+360;return p;};o.boundsForShiftedMultipolygons=function(p,q){var r=[];p.forEach(function(s){var t=[];s.forEach(function(u){t.push(c('LeafletUtils').toLatLng(new (c('GeoCoordinates'))(Number(u.lat),this.shiftLongitude(c('LeafletUtils').wrapLongitude(Number(u.lng)),q))));}.bind(this));r.push(t);}.bind(this));return c('leaflet').latLngBounds(r);};o.iconForSingleLocationSelected=function(){return c('leaflet').divIcon(babelHelpers['extends']({},c('AdsCommonLocalMapUtils').LEAFLET_MARKER_LOCATION_PIN_ICON_SELECTED_OPTIONS,{className:"_tl9"}));};o.iconForSingleLocationNotSelected=function(){return c('leaflet').divIcon(babelHelpers['extends']({},c('AdsCommonLocalMapUtils').LEAFLET_MARKER_LOCATION_PIN_ICON_NOT_SELECTED_OPTIONS,{className:"_tla"}));};f.exports=o;}),null);
__d('AdsTargetingLocationMapRecord',['AdsTargetingLocationMapMetaRecord','emptyFunction'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('AdsTargetingLocationMapMetaRecord'));i=h&&h.prototype;j.fromGeoLocation=function(k){return c('AdsTargetingLocationMapMetaRecord').fromGeoLocation(k,undefined);};j.fromGeoLocationCached=function(k){return c('AdsTargetingLocationMapMetaRecord').fromGeoLocationCached(k,undefined);};j.fromGeoLocations=function(k){return c('AdsTargetingLocationMapMetaRecord').fromGeoLocations(k,c('emptyFunction'));};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('AdsDayPartingInterval',['DateConsts'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){this.start_minute=i*c('DateConsts').MIN_PER_HOUR;this.end_minute=j*c('DateConsts').MIN_PER_HOUR;}f.exports=h;}),null);
__d('DayPartingGrid',['AdsApiScheduleObjectFields','AdsApiScheduleObjectPaths','AdsApiScheduleObjectRecord','AdsDayPartingInterval','DayPartingUtils','getByPath'],(function a(b,c,d,e,f,g){'use strict';var h=c('DayPartingUtils').DAYS_IN_WEEK,i=c('DayPartingUtils').HOURS_IN_DAY;function j(k){if(k){this.hours=new Array(h);for(var l=0;l<h;l++)this.hours[l]=k.hours[l].slice();this.everyDay=k.everyDay.slice();this.allDay=k.allDay.slice();}else{this.hours=this.$DayPartingGrid1();this.allDay=c('DayPartingUtils').createArray(h,function(){return false;});this.everyDay=c('DayPartingUtils').createArray(i,function(){return false;});}}j.prototype.set=function(k,l,m,n,o){var p;if(m<k){p=k;k=m;m=p;}if(n<l){p=l;l=n;n=p;}for(var q=k;q<=m;q++){for(var r=l;r<=n;r++)this.hours[q][r]=o;this.$DayPartingGrid2(q);}for(r=l;r<=n;r++)this.$DayPartingGrid3(r);};j.prototype.setEveryDay=function(k,l,m){if(l<k){var n=k;k=l;l=n;}this.set(0,k,h-1,l,m);};j.prototype.setAllDay=function(k,l,m){if(l<k){var n=k;k=l;l=n;}this.set(k,0,l,i-1,m);};j.prototype.isSelected=function(k,l){if(l===null&&k===null)return false;if(l==null&&this.allDay&&k!=null)return !!this.allDay[k];if(k==null&&this.everyDay&&l!=null)return !!this.everyDay[l];if(this.hours&&k!=null&&l!=null)return !!this.hours[k][l];return false;};j.prototype.$DayPartingGrid2=function(k){var l=true;for(var m=0;m<i;m++)if(this.hours[k][m]!==true){l=false;break;}this.allDay[k]=l;};j.prototype.$DayPartingGrid3=function(k){var l=true;for(var m=0;m<h;m++)if(this.hours[m][k]!==true){l=false;break;}this.everyDay[k]=l;};j.prototype.getSchedule=function(){var k=new Array(7);for(var l=0;l<h;l++){var m=this.toAPIDayIndex(l);k[m]=this.$DayPartingGrid4(l);}return c('DayPartingUtils').mergeDays(k);};j.prototype.getScheduleWithTimezoneType=function(k){var l=new Array(7);for(var m=0;m<h;m++){var n=this.toAPIDayIndex(m);l[n]=this.$DayPartingGrid4(m);}var o=c('DayPartingUtils').mergeDays(l);return o.map(function(p){var q;return new (c('AdsApiScheduleObjectRecord'))((q={},q[c('AdsApiScheduleObjectFields').START_MINUTE]=p.start_minute,q[c('AdsApiScheduleObjectFields').END_MINUTE]=p.end_minute,q[c('AdsApiScheduleObjectFields').DAYS]=p.days,q[c('AdsApiScheduleObjectFields').TIMEZONE_TYPE]=k,q));});};j.prototype.$DayPartingGrid4=function(k){var l=[],m=null,n=function q(r){if(m!==null){var s=new (c('AdsDayPartingInterval'))(m,r);l.push(s);}};for(var o=0;o<i;o++){var p=this.hours[k][o];if(m===null){if(p===true)m=o;}else if(p===false){n(o);m=null;}}if(m!==null)n(i);return l;};j.prototype.setSchedule=function(k){var l=this.$DayPartingGrid1();if(k!=null&&k.length){k.forEach(function(o){var p=o[c('AdsApiScheduleObjectFields').DAYS];if(p!=null&&p.length)p.forEach(function(q){var r=c('getByPath')(o,c('AdsApiScheduleObjectPaths').START_MINUTE),s=c('getByPath')(o,c('AdsApiScheduleObjectPaths').END_MINUTE),t=this.fromAPIDayIndex(q),u=r/60,v=s/60;for(var w=u;w<v;w++)l[t][w]=true;}.bind(this));}.bind(this));this.hours=l;for(var m=0;m<h;m++)this.$DayPartingGrid2(m);for(var n=0;n<i;n++)this.$DayPartingGrid3(n);}return this;};j.prototype.toAPIDayIndex=function(k){return (k+1)%c('DayPartingUtils').DAYS_IN_WEEK;};j.prototype.fromAPIDayIndex=function(k){return (k+6)%c('DayPartingUtils').DAYS_IN_WEEK;};j.prototype.$DayPartingGrid1=function(){return c('DayPartingUtils').createArray(h,function(){return c('DayPartingUtils').createArray(i,function(){return false;});});};f.exports=j;}),null);
__d('EventPermalinkCameraFramesLogging',['EventsActionsLogger'],(function a(b,c,d,e,f,g){'use strict';f.exports={logClick:function h(i,j,k){c('EventsActionsLogger').log(this._eventID,{type:c('EventsActionsLogger').Type.CLICK,target:i,surface:c('EventsActionsLogger').Surface.PERMALINK,mechanism:c('EventsActionsLogger').Mechanism.PERMALINK,target_id:j,acontext:k},{});}};}),null);
__d('MediaEffectOwnerHubHeader.react',['fbt','Link.react','MediaEffectHubViewTab','React','XMediaEffectHubController','XUICardHeader.react','XUICardHeaderTitle.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('React').PureComponent);j=i&&i.prototype;k.prototype.render=function(){var l=this.props,m=l.hubLinkTab,n=l.title,o=null;if(m){var p=c('XMediaEffectHubController').getURIBuilder().setEnum('tab',m).getURI(),q=m===c('MediaEffectHubViewTab').LEARN?h._("M\u00e1s informaci\u00f3n"):h._("Administrar efectos");o=c('React').createElement(c('Link.react'),{href:p,target:'_blank'},q);}return c('React').createElement(c('XUICardHeader.react'),{link:o,type:'secondary'},c('React').createElement(c('XUICardHeaderTitle.react'),null,n));};function k(){i.apply(this,arguments);}f.exports=k;}),null);
__d('EventPermalinkCameraFramesCreate.react',['cx','fbt','ix','AsyncDialog','AsyncRequest','EventPermalinkCameraFramesLogging','EventsActionsLogger','EventsPermalinkTabBar','Image.react','MediaEffectCreateStep','MediaEffectCreationReferrer','MediaEffectFlowType','MediaEffectHubViewTab','MediaEffectOwnerHubHeader.react','MediaEffectWebdriverIDs','React','ShimButton.react','XMediaEffectCreateDialogController','XUICard.react','XUICardSection.react'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;k=babelHelpers.inherits(m,c('React').PureComponent);l=k&&k.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=l.constructor).call.apply(n,[this].concat(q)),this.$EventPermalinkCameraFramesCreate1=function(){c('EventPermalinkCameraFramesLogging').logClick(c('EventsActionsLogger').Target.FRAME_CREATE_RHC,this.props.eventID,this.props.actionContext);var s=c('XMediaEffectCreateDialogController').getURIBuilder().setEnum('flow_type',c('MediaEffectFlowType').EVENT).setFBID('source_id',this.props.eventID).setEnum('step',c('MediaEffectCreateStep').CREATE).setString('action_context',JSON.stringify(this.props.actionContext)).setEnum('active_tab',c('EventsPermalinkTabBar').getCurrentTab()).setEnum('ref',c('MediaEffectCreationReferrer').EVENT_PAGE).getURI();c('AsyncDialog').send(new (c('AsyncRequest'))(s));}.bind(this),o;}m.prototype.render=function(){return c('React').createElement(c('XUICard.react'),null,c('React').createElement(c('MediaEffectOwnerHubHeader.react'),{title:this.props.title,hubLinkTab:c('MediaEffectHubViewTab').LEARN}),c('React').createElement(c('XUICardSection.react'),null,c('React').createElement(c('ShimButton.react'),{className:"_weu",'data-testid':c('MediaEffectWebdriverIDs').HUB_EFFECT_CREATE_BUTTON,onClick:this.$EventPermalinkCameraFramesCreate1},c('React').createElement(c('Image.react'),{src:j("293229")}),c('React').createElement('h1',{className:"_1x8l"},i._("Ayuda a las personas a compartir en tu evento")),c('React').createElement('p',{className:"_wev"},i._("Crea un marco de c\u00e1mara personalizado para tu evento con \u00fatiles plantillas. Las personas podr\u00e1n a\u00f1adirlo a las fotos y los v\u00eddeos que compartan con sus amigos.")),c('React').createElement('p',{className:"_wew"},i._("Empezar")))));};f.exports=m;}),null);
__d('OzConfig',['immutable','Reflux'],(function a(b,c,d,e,f,g){var h=c('immutable').Map,i=c('Reflux').createAction({sync:true}),j=c('Reflux').createAction({sync:true}),k=c('Reflux').createStore({init:function n(){this.data=h();this.listenTo(i,this._onSetConfig);this.listenTo(j,this._onUpdateConfig);},getInitialState:function n(){return this.data;},_onSetConfig:function n(o){this.data=o;this.trigger(this.data);},_onUpdateConfig:function n(o){this.data=this.data.mergeDeep(o);this.trigger(this.data);}});function l(n){return k.data.get(n);}function m(n){return k.data.getIn(n);}f.exports={ConfigStore:k,getInStaticConfig:m,getStaticConfig:l,setConfig:i,updateConfig:j};}),null);
__d('OzActions',['Reflux'],(function a(b,c,d,e,f,g){var h={};h.activateThread=c('Reflux').createAction();h.scrollThreadToTimestamp=c('Reflux').createAction();h.doneScrollingToTimestamp=c('Reflux').createAction();h.updateThreads=c('Reflux').createAction();h.maybeUpdateThreads=c('Reflux').createAction();h.clearReassignState=c('Reflux').createAction();h.deleteTask=c('Reflux').createAction();h.updateMerchants=c('Reflux').createAction();h.deleteMerchants=c('Reflux').createAction();h.updateWitIntents=c('Reflux').createAction();h.updateReps=c('Reflux').createAction();h.replaceReps=c('Reflux').createAction();h.replaceHumans=c('Reflux').createAction();h.updateRequirements=c('Reflux').createAction();h.showDialog=c('Reflux').createAction();h.hideDialog=c('Reflux').createAction();h.updateComposer=c('Reflux').createAction();h.addBubble=c('Reflux').createAction();h.addAutopilot=c('Reflux').createAction();h.isActive=c('Reflux').createAction();h.isInactive=c('Reflux').createAction();h.sendPulse=c('Reflux').createAction();h.updateQueueFilters=c('Reflux').createAction();h.intentCreator=c('Reflux').createActions(['toggle','select','clear']);h.emailComposer=c('Reflux').createActions(['delete','add']);h.emailComposer.update=c('Reflux').createAction({sync:true});h.inviteComposer=c('Reflux').createActions(['delete','add','create']);h.inviteComposer.update=c('Reflux').createAction({sync:true});h.twilio=c('Reflux').createActions(['connect','endCall','hangUp','incoming','incomingAccept','incomingReject','mute','ready','setup','startCall','unmute','updateIncomingInfo','useIntent','updateRating','dialAgain']);h.twilio.changeTo=c('Reflux').createAction({sync:true});h.twilio.sendDigits=c('Reflux').createAction({sync:true});h.sendMessageStart=c('Reflux').createAction();h.sendMessageFinish=c('Reflux').createAction();h.addHandledEvents=c('Reflux').createAction();h.updateServerOffset=c('Reflux').createAction();h.updateLoadingState=c('Reflux').createAction();h.updateCalendarEvents=c('Reflux').createAction();h.skywalkerMessage=c('Reflux').createAction();h.skywalkerStalled=c('Reflux').createAction();h.selectAIPick=c('Reflux').createAction();f.exports=h;}),null);
__d('OzImmutablePureRenderMixin',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h=c('immutable').is;function i(l,m){if(h(l,m))return true;if(typeof l!=='object'||l===null||typeof m!=='object'||m===null)return false;var n=Object.keys(l),o=Object.keys(m);if(n.length!==o.length)return false;for(var p=0;p<n.length;p++)if(!hasOwnProperty.call(m,n[p])||!h(l[n[p]],m[n[p]])){window._debugLogs;return false;}return true;}function j(l,m,n){return !i(l.props,m)||!i(l.state,n);}var k={shouldComponentUpdate:function l(m,n){return j(this,m,n);}};f.exports=k;}),null);
__d('OzNotify',['cx','immutable','OzImmutablePureRenderMixin','React','ReactCSSTransitionGroup','Reflux','ShimButton.react','joinClasses'],(function a(b,c,d,e,f,g,h){var i=c('immutable').OrderedMap,j=c('immutable').Map,k={addNotif:c('Reflux').createAction({sync:true}),removeNotif:c('Reflux').createAction({sync:true})},l=c('Reflux').createStore({init:function s(){this.data=i();this.listenTo(k.addNotif,this._onAddNotif);this.listenTo(k.removeNotif,this._onRemoveNotif);},getInitialState:function s(){return this.data;},_onAddNotif:function s(t){this.data=this.data.set(t.get('id'),t);this.trigger(this.data);},_onRemoveNotif:function s(t){this.data=this.data['delete'](t);this.trigger(this.data);}}),m=j({info:"_4nqo",warn:"_4nqp",error:"_4nqq"}),n=c('React').createClass({displayName:'OzNotify',mixins:[c('Reflux').connect(l,'notifs'),c('OzImmutablePureRenderMixin')],render:function s(){return c('React').createElement(c('ReactCSSTransitionGroup'),{component:'div',transitionName:'oz-fade-in-out',className:"_4nqr",transitionEnterTimeout:500,transitionLeaveTimeout:500},this.state.notifs.reverse().map(function(t,u){return c('React').createElement('div',{key:u,className:c('joinClasses')("_4nqs",m.get(t.get('level')))},t.get('msg'),c('React').createElement(c('ShimButton.react'),{className:"_ok9",inline:true,onClick:function v(){return k.removeNotif(u);}},'\u00D7'));}).valueSeq());}}),o=7000,p=0;function q(s){return function(t){p+=1;k.addNotif(j({id:p,level:s,msg:t}));(function(u){window.setTimeout(function(v){return k.removeNotif(u);},o);})(p);};}var r={Component:n,info:q('info'),warn:q('warn'),error:q('error')};f.exports=r;}),null);
__d('OzAPI',['invariant','OzHelpers','OzNotify','Arbiter','ChannelConstants','ChannelManager','immutable','OzActions','OzAJAX','OzConfig','OzStores','promiseFinally','RTISubscriptionManager'],(function a(b,c,d,e,f,g,h){var i=c('immutable').List,j=c('immutable').Map,k=c('OzAJAX').ajax,l=c('OzAJAX').beacon,m=c('OzAJAX').buildURI,n=c('OzStores').ActiveThreadStore,o=c('OzStores').ThreadStore;c('ChannelManager').startChannelManager();function p(aa){if(aa.attachment&&!aa.attachments)aa.attachments=[aa.attachment];var ba=c('immutable').fromJS(aa);return ba;}function q(aa){return i(aa.map(function(ba){ba=p(ba);return [c('OzHelpers').msgID(ba),ba];})).fromEntrySeq().toMap();}function r(aa){if(!aa.messages)aa.messages=(aa['last-events']||[]).map(function(ca){ca.sender=ca.from;return ca;});aa.messages=q(aa.messages);var ba=c('immutable').fromJS(aa);return ba;}function s(aa){return i(aa.map(r));}function t(aa){var ba=s([aa]);c('OzActions').updateThreads(ba);c('OzActions').addHandledEvents(ba.first().get('handled-events',i()));ba.count()===1||h(0);return ba.first();}function u(aa){Number.isSafeInteger(aa.offset)||h(0);Number.isSafeInteger(aa.limit)||h(0);return k({type:'GET',url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID')),params:aa}).then(function(ba){var ca=ba.threads,da=s(ca);c('OzActions').updateThreads(da);return da;});}function v(aa){var ba=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],ca=arguments.length<=2||arguments[2]===undefined?null:arguments[2];typeof aa==='string'||h(0);typeof ba==='object'||h(0);var da,ea=false;if(ba instanceof FormData){da=ba;}else{da=JSON.stringify(ba);ea=true;}var fa=function ha(){var ia=n.data.get('activeIntent'),ja=n.data.get('threadID'),ka=ia&&ja&&o.data.getIn([ja,'intents'],i()).findLast(function(la){return la.get('id')===ia;},null,j()).get('state');return ka==='open'&&ia;},ga={type:'PUT',url:m('sync'),params:{t:aa,'intent-id':ca||fa(),page:c('OzConfig').getStaticConfig('PAGE_ID')},body:da};if(ea){ga.headers=ga.headers||{};ga.headers['content-type']='application/json';}c('OzHelpers').info('[sync] '+aa,ba);return k(ga);}function w(aa){return function(ba){return v(aa,{tid:ba}).then(function(ca){var da=r(ca);c('OzActions').updateThreads(i([da]));return da;});};}function x(aa){var ba=aa['user-id'],ca=aa['owner-id'],da=aa['last-owner-id'],ea=c('OzConfig').getStaticConfig('uid');return o.data.get(ba)||ca===ea||da===ea;}var y={metrics:j({}),bumpMetric:function aa(ba){y.metrics=y.metrics.updateIn(ba,function(ca){return (ca||0)+1;});},setMetric:function aa(ba,ca){y.metrics=y.metrics.setIn(ba,ca);},_witIntentCSV:function aa(){y.witIntents().done(function(ba){var ca='data:text/csv;charset=utf-8,';ba.forEach(function(da){return ca+='"'+da.get('name')+'","'+da.get('id')+'","'+da.get('doc')+'"\n';});window.open(window.encodeURI(ca));});},grab:w('grab'),release:w('release'),ready:w('ready'),notready:w('notready'),ack:w('ack'),lockThread:w('lock-thread'),markRead:w('mark-read'),unlockThread:function aa(ba,ca){return v('unlock-thread',{tid:ba,'locked-at':ca}).then(t);},assignTo:function aa(ba,ca){return v('assign-to',{tid:ba,id:ca});},escalate:function aa(ba){return y.createTag(ba,'escalated');},escalateTo:function aa(ba,ca){return y.escalate(ba).then(function(){return y.assignTo(ba,ca);});},typing:function aa(ba){return v('rep-typing',{tid:ba});},notTyping:function aa(ba){return v('rep-not-typing',{tid:ba});},createReminder:function aa(ba,ca){return v('create-reminder',babelHelpers['extends']({tid:ba},ca.toJS()));},createTask:function aa(ba,ca){return v('create-task',{tid:ba,task:ca.toJS()});},completeTask:function aa(ba,ca){return v('complete-task',{tid:ba,task:ca.toJS()}).then(t);},editTask:function aa(ba,ca){return v('edit-task',{tid:ba,task:ca.toJS()}).then(t);},cancelTask:function aa(ba,ca){var da=arguments.length<=2||arguments[2]===undefined?false:arguments[2];c('OzActions').deleteTask(ba,ca.get('id'));return v('cancel-task',{tid:ba,task:ca.toJS(),'cancel-future':da}).then(t);},openTask:function aa(ba,ca){return v('open-task',{tid:ba,task:ca.toJS()}).then(t);},closeReminder:function aa(ba,ca,da){return v('close-reminder',{tid:ba,id:ca,all:da}).then(t);},editReminder:function aa(ba,ca){return v('edit-reminder',{tid:ba,reminder:ca.toJS()}).then(t);},snoozeReminder:function aa(ba,ca){return v('snooze-reminder',{tid:ba,id:ca}).then(t);},deleteIntentRequirement:function aa(ba,ca,da){return v('delete-intent-requirement',{tid:ba,'intent-id':ca,'requirement-id':da},ca).then(t);},deleteThreadRequirement:function aa(ba,ca){return v('delete-thread-requirement',{tid:ba,'requirement-id':ca}).then(t);},createIntentRequirement:function aa(ba,ca,da){return v('create-intent-requirement',{tid:ba,'intent-id':ca,'requirement-name':da},ca).then(t);},createThreadRequirement:function aa(ba,ca){return v('create-thread-requirement',{tid:ba,'requirement-name':ca}).then(t);},createIntent:function aa(ba,ca){return v('create-intent',babelHelpers['extends']({tid:ba},ca.toJS())).then(t);},openIntent:function aa(ba,ca){return v('open-intent',{tid:ba,id:ca},ca).then(t);},triggerAIForIntent:function aa(ba,ca){return v('trigger-ai-for-intent',{tid:ba,id:ca},ca);},closeIntent:function aa(ba,ca,da,ea,fa){var ga={tid:ba,id:ca,'close-state':da,feedback:ea,'send-survey':fa};return v('close-intent',ga,ca).then(t);},blockIntent:function aa(ba,ca){return v('block-intent',{tid:ba,id:ca},ca).then(t);},unblockIntent:function aa(ba,ca){return v('unblock-intent',{tid:ba,id:ca},ca).then(t);},addPhoneNumber:function aa(ba,ca){return v('add-phone-number',{tid:ba,'intent-id':ca},ca);},editIntent:function aa(ba,ca){return v('edit-intent',babelHelpers['extends']({tid:ba},ca.toJS()),ca.get('id')).then(t);},createTag:function aa(ba,ca){return v('add-thread-tag',{tid:ba,tag:ca}).then(t);},deleteTag:function aa(ba,ca){return v('remove-thread-tag',{tid:ba,tag:ca}).then(t);},view:w('create-subscription'),unview:function aa(ba){return v('delete-subscription',{tid:ba});},updateMessage:function aa(ba,ca){return v('update-message',{tid:ba,message:ca.toJS()}).then(t);},everstoreUpload:function aa(ba){var ca=new FormData();ba.forEach(function(da,ea){return ca.append(ea,da);});return v('everstore-upload',ca);},upload:function aa(ba){var ca=new FormData();ba.forEach(function(da,ea){return ca.append(ea,da);});return v('upload',ca).then(function(da){return c('immutable').fromJS(da);});},sendMessage:function aa(ba){var ca=v('send',ba).then(function(da){return t({'user-id':ba.tid,'last-events':da});});c('promiseFinally')(ca,function(da){return c('OzActions').sendMessageFinish(ba.tid);});window.setTimeout(function(){return c('OzActions').sendMessageStart(ba.tid);},200);return ca;},scheduleMessage:function aa(ba){return v('schedule-send',ba);},suggest:function aa(ba){return v('suggest',ba).then(t);},scheduleSuggest:function aa(ba){return v('schedule-suggest',ba);},deleteScheduled:function aa(ba,ca){return v('delete-scheduled',{tid:ba,id:ca}).then(t);},saveNote:function aa(ba,ca){var da={tid:ba,infos:{notes:ca}};return v('update-infos',da).then(t);},saveMeta:function aa(ba,ca){var da={tid:ba,infos:{'metadata-json':ca.toJS()}};return v('update-infos',da).then(t);},saveMuted:function aa(ba,ca){var da={tid:ba,infos:{muted:ca}};return v('update-infos',da).then(t);},createMerchant:function aa(ba){return v('create-merchant',ba.toJS()).then(function(ca){var da=i([j(ca)]);c('OzActions').updateMerchants(da);return da;});},editMerchant:function aa(ba){return v('edit-merchant',ba.toJS()).then(function(ca){var da=i([j(ca)]);c('OzActions').updateMerchants(da);return da;});},deleteMerchant:function aa(ba){return v('delete-merchant',ba.toJS()).then(function(ca){if(ca&&ca.id){var da=i([ca.id]);c('OzActions').deleteMerchants(da);return da;}else c('OzHelpers').warn('[api] unexpected delete-merchant response',ca);});},sendEmail:function aa(ba,ca){var da=n.data.get('threadID');return v('send-email',babelHelpers['extends']({tid:da},ba.toJS()),ca);},sendInvite:function aa(ba,ca){var da=n.data.get('threadID');return v('send-calendar',babelHelpers['extends']({tid:da},ba.toJS()),ca);},fetchCalendar:function aa(ba){return k({type:'GET',url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID'),ba,'calendar')}).then(function(ca){c('OzActions').updateCalendarEvents({tid:ba,calendarEvents:ca});return ca;});},bookOpenTable:function aa(ba,ca,da,ea,fa){return v('book-reservation',{tid:ba,rid:da,ts:ea,covers:fa},ca);},everstoreURI:function aa(ba){return v('everstore-uri',{handle:ba});},witIntents:function aa(){return k({type:'GET',url:m('wit-intents',c('OzConfig').getStaticConfig('PAGE_ID'))}).then(function(ba){var ca=c('immutable').fromJS(ba);c('OzActions').updateWitIntents(ca);return ca;});},merchants:function aa(){return k({type:'GET',url:m('merchants')}).then(function(ba){c('OzActions').updateMerchants(i(ba).map(function(ca){return j(ca);}));});},repsSync:function aa(){return k({type:'GET',url:m('reps-sync')});},requirements:function aa(){return k({type:'GET',url:m('requirements')}).then(function(ba){c('OzActions').updateRequirements(c('immutable').fromJS(ba));});},AIModules:function aa(){return k({type:'GET',url:m('ai-modules')}).then(function(ba){return i(ba);});},authorFeedback:function aa(ba){return k({type:'GET',url:m('author-feedback'),params:{author_id:ba}}).then(function(ca){return j(ca.map(function(da){da=c('immutable').fromJS(da);return [c('OzHelpers').msgID(da),da];}));});},myThreads:function aa(){var ba=c('OzConfig').getStaticConfig('PAGE_ID');return k({type:'GET',params:{page:ba},url:m('mythreads')}).then(function(ca){var da=ca.mythreads;c('OzActions').updateThreads(s(da));});},allThreads:function aa(ba,ca,da,ea){var fa={all:true,first_tags:ba.toJS(),last_tags:ca.toJS(),offset:da,limit:ea};if(ba.has('ready')){ba=ba['delete']('ready');fa.ready=true;}else if(ca.has('ready')){ca=ca['delete']('ready');fa.ready=false;}return u(fa);},thread:function aa(ba){return k({type:'GET',url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID'),ba)}).then(t);},handledEvents:function aa(ba){return k({type:'GET',params:{'intent-id':ba},url:m('handled-events')}).then(function(ca){c('OzActions').addHandledEvents(c('immutable').fromJS(ca['handled-events']));});},tasksForIntent:function aa(ba,ca){var da=c('OzConfig').getStaticConfig('PAGE_ID');return k({type:'GET',params:{page:da},url:m('tasks',ba)}).then(function(ea){t({'user-id':ca,tasks:ea});});},history:function aa(ba,ca,da){return k({type:'GET',params:{timestamp:ca,limit:da},url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID'),ba,'history')}).then(function(ea){var fa=t({'user-id':ba,messages:ea});return fa.get('messages');});},topIntents:function aa(){return k({type:'GET',url:m('top-intents')}).then(function(ba){return c('immutable').fromJS(ba);});},intentsDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','intent',c('OzConfig').getStaticConfig('PAGE_ID'))}).then(function(ca){return c('immutable').fromJS(ca);});},aiDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','ai',c('OzConfig').getStaticConfig('PAGE_ID'))}).then(function(ca){return c('immutable').fromJS(ca);});},statsDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','trainer',ba['trainer-id'])}).then(function(ca){return c('immutable').fromJS(ca);});},teamStatsDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','trainer-team-stats')}).then(function(ca){return c('immutable').fromJS(ca);});},humans:function aa(){return k({type:'GET',url:m('humans')}).then(function(ba){return c('OzActions').replaceHumans(c('immutable').fromJS(ba));});},search:function aa(ba){return k({params:ba,type:'GET',url:m('search')}).then(function(ca){return c('immutable').fromJS(ca).flatten(true);});},requestAutopilot:function aa(ba){window.postMessage(ba,'*');},notifyExtension:function aa(ba){c('OzHelpers').debug('[oz-ext] notifying toto',ba);window.postMessage(babelHelpers['extends']({type:'notification'},{data:ba}),'*');},recordActivity:function aa(ba,ca){return v('activity',babelHelpers['extends']({tid:ba},{activity:ca}));},sendPulse:function aa(ba,ca){return k({type:'POST',url:m('pulse'),headers:{'content-type':'application/json'},params:{page:c('OzConfig').getStaticConfig('PAGE_ID'),duration:ba},body:JSON.stringify(ca)});},sendDisconnectPulse:function aa(ba,ca){return l({url:m('pulse'),params:{page:c('OzConfig').getStaticConfig('PAGE_ID'),duration:ba},body:JSON.stringify(ca)});},threadFocus:function aa(ba,ca){return v('thread-focus',{tid:ba,intentID:ca},ca);},away:function aa(ba){return v('away',{away:ba});},coachMode:function aa(ba){return v('coach-mode',{'coach-mode':ba});},timestamp:function aa(){var ba=Date.now();return k({type:'POST',url:m('timestamp')}).then(function(ca){var da=ca.timestamp,ea=Date.now();if(ea-ba>1000){c('OzHelpers').warn('[oz-api] timestamp took over 1 second, not updating offset');}else{var fa=ea-(da+(ea-ba)/2);c('OzActions').updateServerOffset({offsetMs:fa});}});},init:function aa(){return k({type:'GET',url:m('init')}).then(function(ba){ba['twilio-token']&&c('OzActions').twilio.setup(ba['twilio-token']);c('OzConfig').updateConfig(c('immutable').fromJS(ba));});},realTime:function aa(ba,ca){var da,ea=60000,fa=function la(){var ma=Date.now();clearInterval(da);da=setInterval(function(na){var oa=Math.round((Date.now()-ma)/1000);c('OzActions').skywalkerStalled();c('OzHelpers').warn('[rti] no payload in '+oa+'seconds');},ea);},ga={repsVersion:-1},ha=function la(ma,na){var oa=na.payload,pa=na.topic;ma==='sky'||ma==='msg'||h(0);fa();var qa=ma==='sky'?ma+' '+pa+' ->':ma,ra=oa.type,sa=ra||'';c('OzHelpers').debug('[rti] '+qa+' '+sa,oa);if(!oa.data){c('OzHelpers').error('[sky] got sky event without data',oa,pa);return;}var ta=oa.data['page-id'];if(ta&&ta!==c('OzConfig').getStaticConfig('PAGE_ID')){c('OzHelpers').debug('[sky] junk event on '+pa,oa);return;}var ua;y.bumpMetric(['realtime',ra]);c('OzActions').skywalkerMessage({payload:oa,timestamp:c('OzHelpers').serverNow()});switch(ra){case 'thread':ua=oa.data;t(ua);break;case 'thread-metrics':ua=oa.data;if(o.data.get(ua['user-id'])){y.bumpMetric(['realtime','thread-metrics-update-thread']);t(ua);}break;case 'maybe-thread':ua=oa.data;c('OzActions').maybeUpdateThreads(s([ua]));break;case 'delivered':case 'seen':ua=oa.data;t({'user-id':ua['user-id'],'last-seen':ua['last-seen']});break;case 'presence':ua=oa.data;t({'user-id':ua['user-id'],'last-presence':ua['last-presence']});break;case 'carebear':(function(){var bb=oa.data,cb=bb.type,db=bb.tid,eb={'user-id':db};eb['ui-'+cb]=true;t(eb);})();break;case 'inactive':c('OzActions').isInactive();break;case 'updated-merchant':c('OzActions').updateMerchants(i([j(oa.data)]));break;case 'deleted-merchant':c('OzActions').deleteMerchants(i([oa.data.id]));break;case 'phone-call':c('OzActions').twilio.updateIncomingInfo(c('immutable').fromJS(oa.data));break;case 'humans':c('OzActions').replaceHumans(c('immutable').fromJS(oa.data));break;case 'reps-sync':ga=babelHelpers['extends']({},ga,{repsVersion:oa.version});c('OzActions').replaceReps(c('immutable').fromJS(oa.data));break;case 'reps-diff':if(ga.repsVersion!==oa.version-1){c('OzHelpers').warn('[api] reps version out of sync',{'our-version':ga.repsVersion,'next-version':oa.version});ga=babelHelpers['extends']({},ga,{repsVersion:-1});y.repsSync();}else{ga.repsVersion=oa.version;c('OzActions').updateReps(c('immutable').fromJS(oa.data));}break;case 'handled-events':c('OzActions').addHandledEvents(c('immutable').fromJS(oa.data));break;case 'config':c('OzConfig').updateConfig(c('immutable').fromJS(oa.data));break;case 'notify':var va=oa.data,wa=va.level,xa=va.message;c('OzNotify')[wa](xa);break;case 'updated-thread':var ya=oa.data['user-id'];if(x(oa.data)){y.bumpMetric(['realtime','updated-thread-fetch-thread']);c('OzHelpers').info('[api] fetching thread after update',ya);y.thread(ya);}break;case 'ping':var za=oa.data.timestamp,ab=c('OzHelpers').serverNow()-za;y.setMetric(['realtime','pingLatency'],ab);break;default:c('OzHelpers').debug('[sky] unk type',ra,oa);}},ia=function la(){for(var ma=arguments.length,na=Array(ma),oa=0;oa<ma;oa++)na[oa]=arguments[oa];try{ha.apply(undefined,na);}catch(pa){try{c('OzHelpers').error.apply(c('OzHelpers'),['[sky] error handling message'].concat(na));}catch(qa){}}},ja=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('msg'),function(la,ma){ia('msg',ma.obj);}),ka=z(function(){c('Arbiter').unsubscribe(ja);c('RTISubscriptionManager').unsubscribeAll();});c('RTISubscriptionManager').subscribe(ba,ia.bind(this,'sky'),null,z(function(la){var ma=la.data,na=la.error;if(na){ka();ca(na,ma);}else{fa();ca(null,ma,ja);}}));return ka;}};function z(aa){var ba,ca,da=this;return function(){if(!ba){ca=aa.apply(da,arguments);ba=true;}return ca;};}f.exports=y;}),null);
__d('ozMakeColor',['randomShuffle','immutable'],(function a(b,c,d,e,f,g){var h=c('immutable').Map,i=c('immutable').List,j=c('immutable').Range,k=function n(o,p){return 'hsla('+o+', 85%, 30%, '+p+')';};function l(){var n=arguments.length<=0||arguments[0]===undefined?25:arguments[0],o=arguments.length<=1||arguments[1]===undefined?.9:arguments[1],p=i(c('randomShuffle')(j(10,360,n).toJS())),q=0,r=h();return function(s){if(r.has(s)){return k(r.get(s),o);}else{var t=p.get(q);r=r.set(s,t);q=(q+1)%p.count();return k(t);}};}function m(){var n=arguments.length<=0||arguments[0]===undefined?77:arguments[0];return function(o){return k(o*n%360,.9);};}f.exports={makeColorShuffle:l,makeColor:m};}),null);
__d('OzHelpers',['ozMakeColor','BanzaiScuba','DatePickerRestraints','ErrorUtils','getURLRanges','immutable','LogHistory','OzConfig','OzConstants','OzServerTime','OzImmutablePureRenderMixin','React','URI'],(function a(b,c,d,e,f,g){var h=c('ozMakeColor').makeColor,i=c('immutable').List,j=c('immutable').Map,k=c('immutable').Set,l=c('immutable').OrderedMap,m=c('OzConstants').AUTHOR_TYPES,n=c('OzConstants').REMINDERS,o=/^image\//,p={color:h(),blobURI:function ba(ca){return window.URL.createObjectURL(ca);},blobFromDataURI:function ba(ca){var da=ca.split(','),ea=atob(da[1]),fa=da[0].split(':')[1].split(';')[0],ga=new ArrayBuffer(ea.length),ha=new Uint8Array(ga);for(var ia=0;ia<ea.length;ia++)ha[ia]=ea.charCodeAt(ia);return new Blob([ga],{type:fa});},toLocaleDate:function ba(ca){return new Date(ca).toLocaleDateString();},toLocaleTime:function ba(ca){return new Date(ca).toLocaleTimeString();},hasCmdOrCtrl:function ba(ca){return ca.getModifierState('Meta')||ca.getModifierState('Control');},keysIn:function ba(){var ca=k(arguments);return function(da,ea){return ca.has(ea);};},safeParse:function ba(ca){var da={};try{da=JSON.parse(ca);}catch(ea){p.info('invalid json',ca);}return da;},safeURI:function ba(ca){var da=null;try{da=c('URI').isValidURI(ca)&&new (c('URI'))(ca)||null;}catch(ea){p.info('invalid uri',ca);}return da;},pure:s,memoize:t,values:function ba(ca){return Object.keys(ca).map(function(da){return ca[da];});},nonempty:function ba(ca){return ca&&!ca.isEmpty()?ca:null;},uniqId:v,debug:x('debug',false),info:x('info',true),warn:x('warn',true),error:x('error',true),isImageType:function ba(ca){return o.test(ca);},isStickerType:function ba(ca){return ca==='image/sticker';},dateRestraints:w,moveCursorToInputEnd:function ba(ca){if(ca.setSelectionRange){var da=ca.value.length;ca.setSelectionRange(da,da);}},toTitleCase:function ba(ca){var da=k(['a','an','the','at','by','for','in','of','on','to','up','and','as','but','or','nor']),ea=function ga(ha,ia,ja){return ia===0||ia+ha.length===ja.length;},fa=function ga(ha,ia,ja){return ea(ha,ia,ja)||!da.has(ha)?ha.charAt(0).toUpperCase()+ha.substr(1):ha;};return ca.toLowerCase().replace(/\w\S*/g,fa);},scrollToBottom:function ba(ca){ca.scrollTop=ca.scrollHeight;},threadID:function ba(ca){return ca.get('user-id');},isNew:function ba(ca){return !p.intents(ca).find(p.isClosedIntent);},hasOwner:function ba(ca){return ca.getIn(['owner','id']);},hasAllTags:function ba(ca,da){return da.every(function(ea){return p.hasTag(ca,ea);});},hasSomeTag:function ba(ca,da){return da.some(function(ea){return p.hasTag(ca,ea);});},hasTag:function ba(ca,da){return ca.get('tags')&&ca.get('tags').contains(da);},isEscalated:function ba(ca){return p.hasTag(ca,'escalated');},hasEngage:function ba(ca){return !!ca.get('engagement-type');},photo:function ba(ca){return ca.getIn(['user-vcard','photo'])||ca.getIn(['user-vcard','picture']);},compareNums:function ba(ca,da){if(ca&&da){return da-ca;}else if(ca){return -1;}else if(da){return 1;}else return 0;},compareBools:function ba(ca,da){if(ca&&da){return 0;}else if(ca){return -1;}else if(da)return 1;},getIncomingThreads:function ba(ca){return ca.filter(function(da){return da.get('ready')&&!p.hasOwner(da);}).sort(p.threadComparator);},threadComparator:function ba(ca,da){var ea=p.compareBools(p.hasTag(ca,'vip'),p.hasTag(da,'vip')),fa=p.compareBools(p.hasTag(ca,'urgent'),p.hasTag(da,'urgent')),ga=p.compareNums(p.urgentReminders(ca).getIn([0,'scheduled-time']),p.urgentReminders(da).getIn([0,'scheduled-time'])),ha=p.compareNums(ca.get('last-event-at'),da.get('last-event-at'));return ea||fa||ga||ha;},lastEvents:function ba(ca){return ca.get('last-events',i()).sortBy(function(da){return da.get('timestamp');});},lastUserMessage:function ba(ca){return p.lastEvents(ca).findLast(function(da){return p.authorType(da)===m.USER;});},shortDesc:function ba(){var ca=arguments.length<=0||arguments[0]===undefined?j():arguments[0],da=ca.getIn(['attachments',0,'mime_type']),ea=ca.getIn(['attachments',0,'sticker_id']);return ca.get('text')||ea&&'sent a sticker.'||da&&(da.match(/video/i)&&'sent a video.'||da.match(/audio/i)&&'sent an audio clip.'||da.match(/image/i)&&'sent an image');},preferredName:function ba(ca){return ca.getIn(['metadata-json','preferred-name'])||ca.getIn(['user-vcard','first-name']);},userEmail:function ba(ca){return ca.getIn(['metadata-json','email']);},intents:function ba(ca){return ca.get('intents',i()).sortBy(function(da){return da.get('created-at');});},isOwner:function ba(ca,da){var ea=ca.getIn(['owner','id']);return ea&&da&&ea==da;},wasOwner:function ba(ca,da){var ea=ca.getIn(['last-owner','id']);return ea&&da&&ea==da;},isLocker:function ba(ca,da){return ca.get('locked')&&ca.get('locker-id')===da;},nameOrId:function ba(ca){return ca&&(ca.get('name')||ca.get('id'))||'';},isSubscriber:function ba(ca,da){return !!ca.get('subscriptions',i()).find(function(ea){return ea===da;});},hasUnblockedIntents:function ba(ca){return ca.get('intents',i()).some(function(da){return !p.isBlockedIntent(da);});},hasOpenIntents:function ba(ca){return ca.get('intents',i()).some(function(da){return p.isOpenIntent(da);});},openIntents:function ba(ca){return p.intents(ca).filter(p.isOpenIntent);},closedIntents:function ba(ca){return p.intents(ca).filter(p.isClosedIntent);},intentById:function ba(ca,da){return p.intents(ca).findLast(function(ea){return ea.get('id')===da;});},isBlockedIntent:function ba(ca){return ca.get('blocked');},intentName:function ba(ca){return ca.get('name')||'Unknown intent';},intentAlias:function ba(ca){return ca.get('alias')||ca.get('name')||'Unknown intent';},isOpenIntent:function ba(ca){return ca.get('state')==='open';},isClosedIntent:function ba(ca){return !p.isOpenIntent(ca);},isDeleted:function ba(ca){return ca.get('state')==='deleted';},getName:function ba(ca){return ca.getIn(['user-vcard','name'],'Unknown user');},lastPresence:function ba(ca){return Math.max(ca.get('last-seen')||0,ca.get('last-presence')||0);},timeSpent:function ba(ca){if(ca.get('ready')&&ca.get('last-ready-at'))return p.serverNow()-ca.get('last-ready-at');},locationLastSeen:function ba(ca){if(ca.getIn(['location','last-seen']))return new Date(ca.getIn(['location','last-seen']));},timezone:function ba(ca){return ca.getIn(['location','timezone']);},durationStr:function ba(ca){if(ca==null){p.warn('[durationStr] strange duration '+ca);return '[invalid duration]';}else if(ca<-1000){p.warn('[durationStr] strange duration '+ca);return '-'+p.durationStr(-ca);}else if(ca<0){p.warn('[durationStr] strange duration '+ca);return '< 0s';}else if(ca===0){return '0s';}else if(ca<1000){return '< 1s';}else if(ca<60*1000){return Math.floor(ca/1000)+'s';}else if(ca<60*60*1000){return Math.floor(ca/(60*1000))+'m';}else if(ca<24*60*60*1000){return Math.floor(ca/(60*60*1000))+'h';}else return Math.floor(ca/(24*60*60*1000))+'d';},serverNow:function ba(){return c('OzServerTime').serverNow();},repName:function ba(ca,da){var ea=da.get(ca);return ea&&ea.get('name')||ca||null;},authorType:function ba(ca){var da=m.BOT,ea=m.USER,fa=m.TRAINER,ga=ca.get('sender')||ca.get('from'),ha=ca.get('author-type');return ha===da&&da||(ha===fa||ga===c('OzConfig').getStaticConfig('PAGE_ID'))&&fa||ea;},msgID:function ba(){var ca=arguments.length<=0||arguments[0]===undefined?j():arguments[0];return ca.get('offline-threading-id')||ca.get('mid')||p.warn('[msgID] had to resort to timestamp',ca)&&null||ca.get('timestamp');},isActivePulse:function ba(ca){var da=ca&&ca.get('pulse-data');if(!da)return false;return !da.get('away?')&&da.get('inactive-ms',Infinity)<30000;},EMPTY_BODY:c('immutable').fromJS([{'content-type':'text/plain; charset=UTF-8',body:{contents:''}}]),eventToEmail:function ba(ca){return {email:ca.get('data'),intentId:ca.get('intent-id'),id:ca.get('id')};},reEmail:function ba(ca){var da=ca.getIn(['data','subject']),ea=da.toUpperCase().startsWith('RE:')?da:'Re: '+da;return ca.setIn(['data','subject'],ea).setIn(['data','body'],this.EMPTY_BODY);},switchRecip:function ba(ca){var da=ca.get('data'),ea=da.get('from'),fa=da.get('to');return ca.setIn(['data','from'],fa).setIn(['data','to'],i([ea]));},eventToInvite:function ba(ca){return {invite:ca.get('data'),id:ca.get('id'),intentId:ca.get('intent-id'),disabled:true};},urgentReminders:function ba(ca){return ca.get('reminders',i()).sortBy(function(da){return da.get('scheduled-time');}).filter(p.isUrgentReminder);},paidReminders:function ba(ca){return p.urgentReminders(ca).filter(p.isPaidReminder);},isUrgentReminder:function ba(ca){var da=ca.get('state');return da==='active'||da==='active-snoozed';},isPaidReminder:function ba(ca){return !!ca.getIn(['body','suggestion']);},isSnoozedReminder:function ba(ca){var da=ca.get('state');return da==='snoozed'||da==='active-snoozed';},isUrgentTask:function ba(ca){var da=ca.get('state');return da==='dispatched'&&ca.get('deadline')<p.serverNow();},isPaidTask:function ba(ca){return !!ca.getIn(['data','suggestion']);},isCompletedTask:function ba(ca){return ca.get('state')==='completed';},isCanceledTask:function ba(ca){return ca.get('state')==='canceled';},isWaitingTask:function ba(ca){return ca.get('state')==='waiting';},isClosedTask:function ba(ca){return p.isCompletedTask(ca)||p.isCanceledTask(ca);},isOpenTask:function ba(ca){return !p.isClosedTask(ca);},isUnread:function ba(ca){return ca.get('read-state')==='unread';},soonestDueTask:function ba(ca){return ca.filterNot(p.isClosedTask).minBy(function(da){return da.get('start-at');});},nextTaskForIntent:function ba(ca){var da=arguments.length<=1||arguments[1]===undefined?i():arguments[1];return p.soonestDueTask(da.filter(function(ea){return ea.get('intent-id')===ca.get('id');}));},nextTaskForThread:function ba(ca){return p.soonestDueTask(ca.get('tasks',i()));},unreadTs:function ba(ca){return c('OzConfig').ConfigStore.data.getIn(['GK','responsivenessV2'])?ca.get('unread-timestamp'):(p.lastUserMessage(ca)||j()).get('timestamp');},hasPaid:function ba(ca){return !!p.paidReminders(ca).size;},hasReminder:function ba(ca){return !!p.urgentReminders(ca).size;},minAge:function ba(ca){var da=+ca.getIn(['user-vcard','age-range','min']);return Number.isSafeInteger(da)?da:0;},shimURI:function ba(ca){return new (c('URI'))('https://l.facebook.com/l.php').setQueryData({u:ca,h:c('OzConfig').getStaticConfig('shimhash')}).toString();},uiSuggestion:function ba(ca){var da=ca.has('amount')?'$'+(ca.get('amount')/100).toFixed(2):'';return {id:ca.get('item-id')||'-1',name:ca.get('name'),desc:ca.get('description'),thumb_url:ca.get('thumb-url'),merchant_name:ca.get('merchant-name')||'',total_cost:ca.get('amount')?j({amount:ca.get('amount')}):null,display_total_cost:da,target_url:p.shimURI(ca.get('target-url')),payment_id:ca.get('payment-id'),expiration_time:ca.get('expiration-time')};},parsePhoneNumber:function ba(ca){if(!ca)return '';if(ca.length==12&&ca[0]=='+')ca=ca.substr(1);if(ca.length==11&&ca[0]=='1')ca=ca.substr(1);switch(ca.length){case 10:return '('+ca.substr(0,3)+') '+ca.substr(3,3)+'-'+ca.substr(6,4);case 7:return ca.substr(0,3)+'-'+ca.substr(3,4);default:return ca;}},validateURL:function ba(ca){return !!ca&&typeof ca==='string'&&c('getURLRanges')(ca).length&&c('URI').isValidURI(ca);},normalizeMerchant:function ba(ca){return ca.updateIn(['website'],function(da){if(!da)return da;var ea=c('getURLRanges')(da);if(!ea||ea.length===0)return da;return ea[0].entity.url;}).updateIn(['page-id'],function(da){if(Number.isFinite(da)||typeof da==='string')return parseInt(da,10);return null;});},validateMerchant:function ba(ca){var da=k(['name-dba','country']),ea=k(['address','website','page-id']),fa={},ga=ca.get('website','');if(ga&&!this.validateURL(ga))fa.website='Website is an invalid URL';var ha=ca.get('page-id',null);if(ha!=null&&!Number.isFinite(ha))fa['page-id']='FB Page must be a number';da.map(function(ja){if(!ca.get(ja))fa[ja]='This field is required';});if(k(ca.filter(function(ja){return ja;}).keys()).intersect(ea).isEmpty()){var ia='At least one of '+ea.join(', ')+' is required';ea.forEach(function(ja){fa[ja]=ia;});}return j(fa);},isDaytime:function ba(ca){var da=(Date.now()+ca)%(24*60*60*1000),ea=da/(60*60*1000);return ea>=6;},fullThreadData:function ba(ca,da,ea){var fa=ca.get(ea);if(!fa)return null;return fa.update('intents',function(ga){return (ga||i()).map(function(ha){var ia=q(da,ha),ja=r(fa,ia);return ja;});});},threadPath:function ba(ca){var da=ca.threadid,ea=ca.intentid,fa=ca.taskid,ga=ca.eventid,ha=ea?'/intent/'+ea:'',ia=fa?'/task/'+fa:'',ja=ga?'/event/'+ga:'';return '/inbox/'+da+ha+(ia||ja);},updateInWhen:function ba(ca,da,ea){var fa={};if(ca.getIn(da,fa)!==fa)return ca.updateIn(da,ea);return ca;},getRequirement:function ba(ca,da){return ca.get('requirements',i()).find(function(ea){return ea.get('name')===da;});}};function q(ba,ca){var da=ba.getIn(['byIntent',ca.get('id')],j());return ca.set('events',da);}function r(ba,ca){var da=ba.getIn(['tasks-by-intent',ca.get('id')]);return ca.set('tasks',da);}function s(ba){var ca=arguments.length<=1||arguments[1]===undefined?'OzPureComponent':arguments[1];return c('React').createClass({displayName:ca,mixins:[c('OzImmutablePureRenderMixin')],render:function da(){return ba(this.props);}});}function t(ba,ca){var da=arguments.length<=2||arguments[2]===undefined?1000:arguments[2],ea=l();return function(){for(var fa=arguments.length,ga=Array(fa),ha=0;ha<fa;ha++)ga[ha]=arguments[ha];var ia=ca.apply(this,ga);if(ea.get(ia)){return ea.get(ia);}else{var ja=ba.apply(this,ga);ea=ea.set(ia,ja).takeLast(da);return ja;}}.bind(this);}var u=0;function v(){return u++;}function w(){var ba=new Date(),ca=new Date(Date.UTC(ba.getFullYear(),ba.getMonth(),ba.getDate())),da=new Date(+ca);da.setFullYear(ca.getFullYear()+n.RANGE_IN_YEARS);return {dateRestraints:[c('DatePickerRestraints').enforceDateIsNoEarlierThan(ca),c('DatePickerRestraints').enforceDateIsNoLaterThan(da)]};}c('ErrorUtils').addListener(function(ba){var ca=aa({level:'error',message:'[unhandled-error]['+ba.name+'] '+ba.message,data:'--stack\n'+ba.stack+'\n\n--originalError\n'+ba._originalError});z(ca);y(ca);});function x(ba,ca){return function(){for(var da=arguments.length,ea=Array(da),fa=0;fa<da;fa++)ea[fa]=arguments[fa];var ga=ea[0],ha=ea.slice(1);window.console.log(ba,ga,ha);var ia=aa({level:ba,message:ga,data:ha});z(ia);ca&&y(ia);};}function y(ba){var ca=new (c('BanzaiScuba'))(c('OzConfig').getStaticConfig('scubaCategory'));Object.entries(ba).forEach(function(da){var ea=da[0],fa=da[1];Number.isSafeInteger(fa)?ca.addInteger(ea,fa):ca.addNormal(ea,fa);});ca.post();}function z(ba){var ca=c('LogHistory').getInstance('oz-logger');(ca[ba.level]||ca.debug).call(ca,ba.message,'');}function aa(ba){return babelHelpers['extends']({},ba,{uid:c('OzConfig').getStaticConfig('uid'),public_name:c('OzConfig').getStaticConfig('publicName'),rev:c('OzConfig').getStaticConfig('rev'),timestamp:p.serverNow()});}f.exports=p;}),null);
__d('OzServerTime',['OzStores','OzAPI'],(function a(b,c,d,e,f,g){var h=c('OzStores').ServerOffsetStore,i;function j(){return Math.floor(Date.now()-h.data.get('offsetMs'));}function k(){window.clearInterval(i);}function l(){c('OzAPI').timestamp();k();i=window.setInterval(function(){return c('OzAPI').timestamp();},1000*60*60*3);}f.exports={serverNow:j,setup:l,tearDown:k};}),null);
__d('OzStores',['invariant','OzHelpers','immutable','OzActions','Reflux'],(function a(b,c,d,e,f,g,h){var i=c('immutable').List,j=c('immutable').Map,k=c('immutable').OrderedMap,l=c('immutable').OrderedSet,m=c('immutable').Set,n=c('immutable').Iterable,o=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateRequirements,this._onUpdateRequirements);},getInitialState:function na(){return this.data;},_onUpdateRequirements:function na(oa){this.data=this.data.withMutations(function(pa){oa.forEach(function(qa){var ra=qa.get('name'),sa=pa.get(ra,j()).merge(qa).update('wit-intent-uuids',function(ta){return ta&&ta.toSet()||m();});pa.set(ra,sa);});});c('OzHelpers').debug('[oz] updated RequirementStore');this.trigger(this.data);}}),p=c('Reflux').createStore({init:function na(){this.data=l();this.listenTo(c('OzActions').addBubble,this._onAddBubble);},getInitialState:function na(){return this.data;},_onAddBubble:function na(oa){j.isMap(oa)||h(0);this.data=this.data.add(oa).takeLast(100);this.trigger(this.data);},metrics:function na(){return j({bubbleCount:this.data.count()});}}),q=c('Reflux').createStore({init:function na(){this.data=k();this.listenTo(c('OzActions').addAutopilot,this._onAddAutopilot);},getInitialState:function na(){return this.data;},_onAddAutopilot:function na(oa){j.isMap(oa)||h(0);this.data=this.data.set(oa.get('id'),oa.get('data')).takeLast(100);this.trigger(this.data);}}),r='id',s=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateWitIntents,this._onUpdateWitIntents);},getInitialState:function na(){return this.data;},_onUpdateWitIntents:function na(oa){c('immutable').List.isList(oa)||h(0);this.data=this.data.withMutations(function(pa){return oa.reduce(function(qa,ra){return qa.set(ra.get(r),ra);},pa);});this.trigger(this.data);},metrics:function na(){return j({witIntentCount:this.data.count()});}}),t=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').activateThread,this._onActivateThread);},getInitialState:function na(){return this.data;},_onActivateThread:function na(oa){var pa=oa.threadID,qa=oa.intentID,ra=oa.taskID,sa=oa.eventID;c('OzHelpers').info('[store/activeThread] set active thread: ',{threadID:pa,intentID:qa,taskID:ra,eventID:sa});this.data=this.data.set('oldThreadID',this.data.get('threadID')).set('threadID',pa).set('activeIntent',qa).set('activeTask',ra).set('activeEvent',sa);this.trigger(this.data);}}),u='user-id',v=function na(oa,pa){return oa.reduce(function(qa,ra){qa[ra.get(pa)]=ra;return qa;},{});};function w(na,oa){j.isMap(na)&&j.isMap(oa)||h(0);var pa=v(na,'offline-threading-id'),qa=v(na,'mid');return na.withMutations(function(ra){return oa.valueSeq().filterNot(function(sa){var ta=sa.get('attachments');if(ta)return ta.first()&&ta.first().getIn(['xma','body'])===null;return false;}).reduce(function(sa,ta){var ua=ta.get('offline-threading-id'),va=ta.get('mid'),wa=ua&&pa[ua]||va&&qa[va]||sa.get(c('OzHelpers').msgID(ta));if(wa){sa=sa['delete'](c('OzHelpers').msgID(wa));ta=wa.merge(ta);ua=ta.get('offline-threading-id');va=ta.get('mid');}ua&&(pa[ua]=ta);va&&(qa[va]=ta);return sa.set(c('OzHelpers').msgID(ta),ta);},ra);});}var x=function na(oa,pa,qa){switch(qa){case 'messages':return w(oa,pa);case 'intents':case 'reminders':var ra=j().withMutations(function(ua){return (oa||i()).reduce(function(va,wa){return va.set(wa.get('id'),wa);},ua);}),sa=pa.reduce(function(ua,va){var wa=va.get('id');return ua.set(wa,(ua.get(wa)||j()).merge(va));},ra).valueSeq().toList();return sa;case 'tasks':var ta=pa.map(function(ua){return ua.get('intent-id');}).toSet();return oa.filterNot(function(ua){return ta.has(ua.get('intent-id'));}).concat(pa);case 'light-thread':return oa&&pa;default:return pa;}},y=function na(oa){return oa.set('tasks-by-intent',oa.get('tasks',i()).groupBy(function(pa){return pa.get('intent-id');}));},z=function na(oa){typeof oa==='function'||h(0);return function(pa,qa){j.isMap(qa)&&j.isMap(pa)||h(0);var ra=qa.get(u),sa=(pa.get(ra)||j()).mergeWith(oa,qa),ta=y(sa);return pa.set(ra,ta);};},aa=c('Reflux').createStore({init:function na(){this.data=j();this.updatedAt=Date.now();this.listenTo(c('OzActions').updateThreads,this._onUpdateThreads);this.listenTo(c('OzActions').maybeUpdateThreads,this._onMaybeUpdateThreads);this.listenTo(c('OzActions').clearReassignState,this._onClearReassignState);this.listenTo(c('OzActions').deleteTask,this._onDeleteTask);},getInitialState:function na(){return this.data;},_onUpdateThreads:function na(oa){i.isList(oa)||h(0);this.data=this.data.withMutations(function(pa){return oa.reduce(z(x),pa);});this.updatedAt=Date.now();this.trigger(this.data);},_onMaybeUpdateThreads:function na(oa){i.isList(oa)||h(0);var pa=oa.filter(function(qa){return this.data.has(qa.get(u));}.bind(this));if(pa.isEmpty()){c('OzHelpers').debug('[threads] not updating partial threads');return;}this.data=this.data.withMutations(function(qa){return pa.reduce(z(x),qa);});this.updatedAt=Date.now();this.trigger(this.data);},_onClearReassignState:function na(){this.data=this.data.map(function(oa){return oa.get('ui-reassign')?oa['delete']('ui-reassign'):oa;});this.trigger(this.data);},_onDeleteTask:function na(oa,pa){this.data=this.data.updateIn([oa,'tasks'],function(qa){return qa.filterNot(function(ra){return ra.get('id')===pa;});});this.trigger(this.data);},metrics:function na(){return j({threadCount:this.data.count(),taskCount:this.data.reduce(function(oa,pa){return pa.get('tasks',i()).count()+oa;},0)});}}),ba=c('Reflux').createStore({init:function na(){this.data=this._make(null,null);this.listenTo(c('OzActions').showDialog,this._onShowDialog);this.listenTo(c('OzActions').hideDialog,this._onHideDialog);},getInitialState:function na(){return this.data;},_make:function na(oa,pa){return {dialogClass:oa,dialogProps:pa};},_onShowDialog:function na(oa,pa){this.data=this._make(oa,pa);this.trigger(this.data);},_onHideDialog:function na(){this.data=this._make(null,null);this.trigger(this.data);}}),ca=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateMerchants,this._onUpdateMerchants);this.listenTo(c('OzActions').deleteMerchants,this._onDeleteMerchants);},getInitialState:function na(){return this.data;},_onUpdateMerchants:function na(oa){i.isList(oa)||h(0);this.data=this.data.withMutations(function(pa){return oa.reduce(function(qa,ra){var sa=ra.get('id'),ta=qa.get(sa,j()).merge(ra);return qa.set(sa,ta);},pa);});c('OzHelpers').debug('[oz] updated merchants',this.data.toJS());this.trigger(this.data);},_onDeleteMerchants:function na(oa){i.isList(oa)||h(0);this.data=oa.reduce(function(pa,qa){return pa['delete'](qa);},this.data);c('OzHelpers').debug('[oz] deleted merchants',this.data.toJS());this.trigger(this.data);},metrics:function na(){return j({merchantCount:this.data.count()});}}),da=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateReps,this._onUpdateReps);this.listenTo(c('OzActions').replaceReps,this._onReplaceReps);},getInitialState:function na(){return this.data;},_onReplaceReps:function na(oa){this.data=j().withMutations(function(pa){oa.reduce(function(qa,ra){return qa.set(ra.get('fbid'),ra);},pa);});this.trigger(this.data);},_onUpdateReps:function na(oa){this.data=this.data.withMutations(function(pa){return oa.reduce(function(qa,ra){return qa.mergeIn([ra.get('fbid')],ra);},pa);});this.trigger(this.data);},metrics:function na(){return j({repCount:this.data.count()});}}),ea=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').replaceHumans,this._onReplace);},getInitialState:function na(){return this.data;},_onReplace:function na(oa){this.data=oa;this.trigger(this.data);},metrics:function na(){return j({humanCount:this.data.count()});}}),fa=c('Reflux').createStore({init:function na(){this.data=j({queue:j({showTags:m(),hideTags:m()}),all:j({showTags:m(),hideTags:m()})});this.listenTo(c('OzActions').updateQueueFilters,this._onUpdateFilters);},getInitialState:function na(){return this.data;},_onUpdateFilters:function na(oa){this.data=this.data.merge(oa);this.trigger(this.data);}}),ga=c('Reflux').createStore({init:function na(){this._data=j();this.listenTo(c('OzActions').sendMessageStart,this._onShiftSending.bind(this,1));this.listenTo(c('OzActions').sendMessageFinish,this._onShiftSending.bind(this,-1));},getInitialState:function na(){return this._data;},_onShiftSending:function na(oa,pa){this._data=this._data.update(pa,function(qa){return (qa||0)+oa;});this.trigger(this._data);}}),ha=c('Reflux').createStore({init:function na(){this.data=j({byIntent:j(),byThread:j(),byId:j()});this.listenTo(c('OzActions').addHandledEvents,this._onAddHandledEvents);},getInitialState:function na(){return this.data;},_onAddHandledEvents:function na(oa){this.data=this.data.withMutations(function(pa){oa.reduce(function(qa,ra){return qa.setIn(['byIntent',ra.get('intent-id'),ra.get('id')],ra).setIn(['byId',ra.get('id')],ra);},pa);});this.trigger(this.data);},metrics:function na(){return j({handledEventCount:this.data.get('byId').count()});}}),ia=c('Reflux').createStore({init:function na(){this.data=j({offsetMs:0});this.listenTo(c('OzActions').updateServerOffset,this._onUpdateServerOffset);},getInitialState:function na(){return this.offsetMs;},_onUpdateServerOffset:function na(oa){var pa=oa.offsetMs;this.data=this.data.set('offsetMs',pa);this.trigger(this.data);}}),ja=j({state:'loading',error:null,result:null,skip:false}),ka=c('Reflux').createStore({init:function na(){this.data=j({skywalker:ja,init:ja,'wit-intents':ja,merchants:ja,humans:ja,requirements:ja});this.listenTo(c('OzActions').updateLoadingState,this._onUpdateLoadingState);},getInitialState:function na(){return this.data;},_onUpdateLoadingState:function na(oa){var pa=oa.component,qa=oa.state,ra=oa.error,sa=oa.result,ta=oa.skip;c('OzHelpers').info('[store/loading] '+qa+' '+pa);if(!this.data.has(pa))c('OzHelpers').warn('[store/loading] '+pa+' wasn\'t listed in LoadingStore.init');this.data=this.data.set(pa,j({state:qa,error:ra,result:sa,skip:ta}));this.trigger(this.data);}}),la=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateCalendarEvents,this._onUpdateCalendarEvents);},getInitialState:function na(){return this.data;},_onUpdateCalendarEvents:function na(oa){var pa=oa.tid,qa=oa.calendarEvents,ra=qa&&qa.sort?qa:[];this.data=this.data.set(pa,ra.sort(function(sa,ta){var ua=new Date(sa.startDate),va=new Date(ta.startDate);return ua.getTime()-va.getTime();}));this.trigger(this.data);},metrics:function na(){return j({calendarEventCount:this.data.count()});}}),ma=c('Reflux').createStore({init:function na(){this.data=j({isStalled:false});this.listenTo(c('OzActions').skywalkerMessage,this._onSkywalkerMessage);this.listenTo(c('OzActions').skywalkerStalled,this._onSkywalkerStalled);},getInitialState:function na(){return this.data;},_onSkywalkerMessage:function na(oa){var pa=oa.timestamp;this.data=this.data.set('last-receive-ts',pa).set('isStalled',false);this.trigger(this.data);},_onSkywalkerStalled:function na(){this.data=this.data.set('isStalled',true);this.trigger(this.data);}});f.exports={ActiveThreadStore:t,BubbleStore:p,DialogStore:ba,MerchantStore:ca,AutopilotStore:q,QueueFilterStore:fa,RepStore:da,HumanStore:ea,LoadingStore:ka,RequirementStore:o,ThreadStore:aa,WitIntentStore:s,PendingMessageStateStore:ga,HandledEventsStore:ha,ServerOffsetStore:ia,CalendarEventStore:la,SkywalkerStore:ma};}),null);
__d('OzAJAX',['invariant','Promise','OzHelpers','OzNotify','OzConfig','URI'],(function a(b,c,d,e,f,g,h){'use strict';var i={metrics:{pendingCount:0,requestCount:0,failedCount:0,totalRequestMs:0,averageRequestMs:0},updateMetricsStart:function m(){i.metrics.pendingCount+=1;},updateMetricsEnd:function m(n,o){var p=i.metrics;p.pendingCount-=1;if(!n.status||n.status===0||n.status>399)p.failedCount+=1;p.requestCount+=1;p.totalRequestMs+=o;p.averageRequestMs=Math.round(p.totalRequestMs/p.requestCount);},ajax:function m(n){var o=n.type,p=n.headers,q=n.params,r=n.body,s=n.url;q=k(q);var t={type:o,url:s,headers:p,params:q,body:r};i.updateMetricsStart();var u=Date.now();return j(t).then(function(v){i.updateMetricsEnd(v,Date.now()-u);return JSON.parse(v.responseText);},function(v){i.updateMetricsEnd(v,Date.now()-u);var w=void 0;try{w=JSON.parse(v.responseText);}catch(x){}l(w||{},v,t);throw w||v;});},beacon:function m(n){window.navigator&&window.navigator.sendBeacon||h(0);var o=n.params,p=n.body,q=n.url;o=k(o);return window.navigator.sendBeacon(new (c('URI'))(q).addQueryData(o).toString(),new Blob([p],{type:'application/json'}));},buildURI:function m(){var n=c('OzConfig').getStaticConfig('API_PATH');n||h(0);for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return [n].concat(p).join('/');}};function j(m){var n=m.type,o=m.headers,p=m.params,q=m.body,r=m.url;return new (c('Promise'))(function(s,t){var u=new XMLHttpRequest(),v=new (c('URI'))(r);if(p)v.addQueryData(p);u.timeout=1000*60*3;u.open(n,v.toString(),true);if(o)for(var w=Object.keys(o),x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z;u.setRequestHeader(aa,o[aa]);}u.onreadystatechange=function(){if(u.readyState!==4)return;if(u.status===200){s(u);}else t(u);};u.send(q);});}function k(m){c('OzConfig').getStaticConfig('authToken')||h(0);c('OzConfig').getStaticConfig('uid')||h(0);c('OzConfig').getStaticConfig('API_VERSION')||h(0);return babelHelpers['extends']({xs:c('OzConfig').getStaticConfig('authToken'),c_user:c('OzConfig').getStaticConfig('uid'),rep_name:c('OzConfig').getStaticConfig('fullName'),v:c('OzConfig').getStaticConfig('API_VERSION')},m);}function l(m,n,o){c('OzHelpers').error('[oz-api] backend rejected',m,n,o);var p=m.error||'Something went wrong, the team has been notified already.';if(m.info){c('OzNotify').info(p);}else if(n.status===400){c('OzNotify').warn(p);}else if(n.status===0){c('OzNotify').error('Something went wrong. If this continues, please contact the Wit oncall');}else c('OzNotify').error(p);}f.exports=i;}),null);
__d('OzDateTimePicker.react',['cssVar','cx','OzHelpers','joinClasses','AbstractDateTimePicker.react','AdsTimezone','Arbiter','BUIDatePicker.react','BUITimeInput.react','DatePickerRestraints','immutable','LocalDateTime','OzConfig','ReactComponentWithPureRenderMixin','React','ReactDOM','Reflux','SUIAudiencePlatformTheme','SUITheme','SUITimeZoneSelector.react','Timezone','XUIError.react'],(function a(b,c,d,e,f,g,h,i){var j,k,l=c('React').PropTypes,m=c('immutable').Map,n=c('React').createClass({displayName:'OzDateTimePicker',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:babelHelpers['extends']({dateRestraints:l.arrayOf(l.func),disabled:l.bool,height:l.oneOf(['short','tall']),layout:l.oneOf(['one-line','two-line','three-line']),onChange:l.func.isRequired,showTimezoneName:l.bool,timestamp:l.number,timezone:l.string},c('XUIError.react').PropTypes),getDefaultProps:function w(){return {dateRestraints:u(),disabled:false,height:'short',layout:'one-line',showTimezoneName:true,timezone:q()};},render:function w(){var x=this.props,y=x.className,z=x.dateRestraints,aa=x.disabled,ba=x.height,ca=x.layout,da=x.onChange,ea=x.showTimezoneName,fa=x.timestamp,ga=x.timezone,ha=x.xuiError,ia=x.xuiErrorAlignh,ja=x.xuiErrorPosition,ka=babelHelpers.objectWithoutProperties(x,['className','dateRestraints','disabled','height','layout','onChange','showTimezoneName','timestamp','timezone','xuiError','xuiErrorAlignh','xuiErrorPosition']),la={xuiError:ha,xuiErrorAlignh:ia,xuiErrorPosition:ja},ma=t(ga),na=o(fa,ma),oa=c('joinClasses')("_3hma"+(aa?' '+"_3hmb":''),y),pa=ca==='two-line'&&ea&&202||!ea&&110||'auto';return c('React').createElement(c('XUIError.react'),la,c('React').createElement('div',{className:oa},c('React').createElement(c('AbstractDateTimePicker.react'),babelHelpers['extends']({},ka,{className:"_3hmc",classNames:{innerWrapper:"_3hmd"},datePicker:c('React').createElement(c('BUIDatePicker.react'),{className:"_3hme",dateRestraints:this._dateRestraints(ma),height:ba,placeholder:'mm/dd/yyyy'}),disabled:aa,onChange:function(qa){return this._handleChange(qa,ma);}.bind(this),timeInput:c('React').createElement(c('BUITimeInput.react'),{className:"_3hml"+(ca!=='three-line'?' '+"_3hmm":'')+(ca==='three-line'?' '+"_3hmn":''),height:ba}),timezoneID:ma,value:na})),c('React').createElement(v,{style:!fa&&{display:'none'},className:"_3hmo"+(ca==='one-line'?' '+"_3hmm":'')+(ca!=='one-line'?' '+"_3hmn":''),isDisabled:aa,onChange:function(qa){return this._handleChange(na,qa.get('timeZoneId'));}.bind(this),shouldShowSubtitleInSelector:ea,value:c('SUITimeZoneSelector.react').VALUE({timeZoneId:ma}),width:pa})));},_handleChange:function w(x,y){var z=p(x,y),aa=r(y);this.props.onChange({timestamp:z,timezone:aa});},_dateRestraints:function w(x){return this.props.dateRestraints&&this.props.dateRestraints.map(function(y){return function(z){return y(z&&z.toDateTime(x).toDate());};});}});function o(w,x){try{if(w&&x!=null){return c('LocalDateTime').fromInstant(Math.round(w/1000),x);}else return null;}catch(y){c('OzHelpers').warn('[dateTimePicker] cannot convert to LocalDateTime',w,x,y);return null;}}function p(w,x){try{if(w&&x!=null){var y=w.toInstant(x)*1000,z=y-y%60000;return z;}else return null;}catch(aa){c('OzHelpers').warn('[dateTimePicker] cannot convert from LocalDateTime',w,x,aa);return null;}}function q(){var w=c('Timezone').getEnvironmentTimezoneID();w==null&&c('OzHelpers').warn('[dateTimePicker] could not get environment time zone');return r(w);}function r(w){var x=c('AdsTimezone').names[w];x==null&&c('OzHelpers').warn('[dateTimePicker] unknown timezone id',w);return x;}var s=m(c('AdsTimezone').names.map(function(w,x){return [w,x];}));function t(w){var x=s.get(w);x===undefined&&c('OzHelpers').warn('[timezoneIDForName] unrecognized timezone',w);return x||s.get('America/Los_Angeles');}function u(){var w=new Date(),x=new Date(Date.UTC(w.getFullYear(),w.getMonth(),w.getDate())),y=new Date(+x),z=new Date(+x);y.setFullYear(x.getFullYear()-5);z.setFullYear(x.getFullYear()+5);return [c('DatePickerRestraints').enforceDateIsNoEarlierThan(y),c('DatePickerRestraints').enforceDateIsNoLaterThan(z)];}j=babelHelpers.inherits(v,c('React').PureComponent);k=j&&j.prototype;v.prototype.componentDidMount=function(){'use strict';c('ReactDOM').findDOMNode(this.refs.timezoneSelector).addEventListener('focusout',function(w){return window.setTimeout(function(x){return c('Arbiter').inform('reflow');});});};v.prototype.render=function(){'use strict';return c('React').createElement(c('SUITimeZoneSelector.react'),babelHelpers['extends']({},this.props,{ref:'timezoneSelector',theme:c('SUIAudiencePlatformTheme')}));};function v(){'use strict';j.apply(this,arguments);}n.timezoneIDForName=t;f.exports=n;}),null);
__d('MediaEffectOwnerHubEffectCard.react',['cx','fbt','AsyncDialog','AsyncRequest','ContextualDialogArrow','ContextualLayerAutoFlip','FXEntMediaEffectStatus','Layout.react','List.react','MediaEffectMetadataActionCreators','Link.react','Log','MediaEffectCreateStep','MediaEffectHubViewTab','MediaEffectOwnerHubHeader.react','MediaEffectReactFrameEditorPreviewCanvasContainer.react','MediaEffectStatusIndicator.react','PopoverMenu.react','React','ReactXUIMenu','XMediaEffectCreateDialogController','XUICard.react','XUICardSection.react','XUIText.react','MediaEffectCreationReferrer'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('Layout.react').Column,m=c('Layout.react').FillColumn,n=c('ReactXUIMenu').Item,o='archive',p='toggle';j=babelHelpers.inherits(q,c('React').PureComponent);k=j&&j.prototype;function q(){var r,s;for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];return s=(r=k.constructor).call.apply(r,[this].concat(u)),this.onEffectLinkClick=function(){var w=c('XMediaEffectCreateDialogController').getURIBuilder().setEnum('flow_type',this.props.flowType).setEnum('step',c('MediaEffectCreateStep').EDIT).setFBID('media_effect_id',this.props.effectID).setEnum('ref',c('MediaEffectCreationReferrer').HUB).getURI();c('AsyncDialog').send(new (c('AsyncRequest'))(w),function(x){x.subscribe(['hide','success'],function(y,event){this.props.effectUpdateHandler(this.props.effectID);}.bind(this));}.bind(this));}.bind(this),this.onMenuItemClick=function(event,w){var x=w.item.getValue();switch(x){case p:if(this.isToggleEnabled())this.props.toggleEventHandler(this.props.effectID,this.props.effect.effectData.status===c('FXEntMediaEffectStatus').INACTIVE);break;case o:this.props.archiveEventHandler(this.props.effect.effectData);break;default:c('Log').warn('Unexpected action sent to this handler: '+x);}}.bind(this),s;}q.prototype.componentWillMount=function(){c('MediaEffectMetadataActionCreators').initFrameData(this.props.effect.effectEditorData);};q.prototype.buildMenu=function(){var r=this.props.effect.effectData.status,s=r===c('FXEntMediaEffectStatus').INACTIVE?i._("Activar"):i._("Desactivar"),t=this.isToggleEnabled();return c('React').createElement(c('ReactXUIMenu'),{onItemClick:this.onMenuItemClick},c('React').createElement(n,{value:p},c('React').createElement('span',{className:(t?"_2ugo":'')+(!t?' '+"_2ugp":'')},s)),c('React').createElement(n,{value:o},i._("Archivar")));};q.prototype.isToggleEnabled=function(){var r=this.props.effect.effectData.status;return r===c('FXEntMediaEffectStatus').INACTIVE||r===c('FXEntMediaEffectStatus').ACTIVE;};q.prototype.render=function(){return c('React').createElement(c('XUICard.react'),null,c('React').createElement(c('MediaEffectOwnerHubHeader.react'),{hubLinkTab:c('MediaEffectHubViewTab').MANAGE,title:this.props.title}),c('React').createElement(c('XUICardSection.react'),null,c('React').createElement(c('Layout.react'),{className:"_2ugq"},c('React').createElement(l,null,c('React').createElement(c('MediaEffectReactFrameEditorPreviewCanvasContainer.react'),{previewHeight:80,previewWidth:80})),c('React').createElement(m,{className:"_2ugr"},c('React').createElement(c('List.react'),{border:'none',spacing:'small'},c('React').createElement('li',null,c('React').createElement(c('Link.react'),{href:'#',onClick:this.onEffectLinkClick},c('React').createElement(c('XUIText.react'),null,this.props.effect.effectData.name))),c('React').createElement('li',null,c('React').createElement(c('MediaEffectStatusIndicator.react'),{className:"_2ugs",mediaEffect:this.props.effect.effectData})),c('React').createElement('li',null,c('React').createElement(c('XUIText.react'),null,i._({"*":{"*":"{activateCount} usos","268435456":"{activateCount} uso"}},[i.param('activateCount',this.props.effect.effectData.activateCount,[0]),i.plural(this.props.effect.effectData.activateCount)]))))),c('React').createElement(l,{className:"_2ugt"},c('React').createElement(c('PopoverMenu.react'),{alignh:'right',behaviors:[c('ContextualDialogArrow')],layerBehaviors:[c('ContextualLayerAutoFlip')],menu:this.buildMenu(),position:'below'},c('React').createElement('div',{className:"_2ugu"}))))));};f.exports=q;}),null);
__d('MediaEffectOwnerHubNullStateCard.react',['cx','invariant','EventPermalinkCameraFramesCreate.react','MediaEffectFlowType','MediaEffectOwnerHubHeader.react','React','XUICard.react','XUICardSection.react','idx'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;j=babelHelpers.inherits(l,c('React').PureComponent);k=j&&j.prototype;l.prototype.render=function(){var m;switch(this.props.flowType){case c('MediaEffectFlowType').EVENT:var n=(m=this.props)!=null?(m=m.optionalData)!=null?m.eventActionContext:m:m;n||i(0);return c('React').createElement(c('EventPermalinkCameraFramesCreate.react'),{actionContext:n,eventID:this.props.owner,title:this.props.title});default:return c('React').createElement(c('XUICard.react'),null,c('React').createElement(c('MediaEffectOwnerHubHeader.react'),{title:this.props.title}),c('React').createElement(c('XUICardSection.react'),null,c('React').createElement('div',{className:"_fw6"},'No data!')));}};function l(){j.apply(this,arguments);}f.exports=l;}),null);
__d('MediaEffectStoreSharedDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this);}f.exports=new j({strict:false});}),null);
__d('MediaEffectOwnerStore',['AsyncRequest','FluxLoadObjectStore','FXEntMediaEffectStatus','LoadObject','MediaEffectStoreSharedDispatcher','XMediaEffectAsyncFetchController'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[c('FXEntMediaEffectStatus').ACTIVE,c('FXEntMediaEffectStatus').COMPLETED,c('FXEntMediaEffectStatus').DRAFT,c('FXEntMediaEffectStatus').IN_REVIEW,c('FXEntMediaEffectStatus').INACTIVE,c('FXEntMediaEffectStatus').NOT_APPROVED,c('FXEntMediaEffectStatus').SCHEDULED];h=babelHelpers.inherits(k,c('FluxLoadObjectStore'));i=h&&h.prototype;function k(l){i.constructor.call(this,l);l.explicitlyRegisterStore(this);}k.prototype.reduce=function(l,m){switch(m.action){case 'media_effect_owner/add':return this.__handleOne(l,m.key,{ownerID:m.key,effects:m.effects});case 'media_effect_owner/bootstrap':m.bootstrapData.forEach(function(s){l.set(s.ownerID,c('LoadObject').withValue(s));});break;case 'media_effect_owner/error':return this.__handleOne(l,m.key,m.error);case 'media_effect_owner/reload':this.__load(m.key);return l.remove(m.key);case 'media_effect_owner/remove':return l.remove(m.key);case 'media_effect_owner/update_add_effect':var n=l.get(m.key).getValue();if(n){n.effects.push(m.effect);return this.__handleOne(l,m.key,{ownerID:m.key,effects:n.effects});}break;case 'media_effect_saved':var o=m.effect.effectData.owner.id,p=l.get(o).getValue();if(p){p.effects.push(m.effect.effectData.id);return this.__handleOne(l,o,{ownerID:o,effects:p.effects});}break;case 'media_effect_owner/update_remove_effect':var q=l.get(m.key).getValue();if(q)if(q.effects.indexOf(m.effect)>=0){var r=q.effects;r.splice(r.indexOf(m.effect),1);return this.__handleOne(l,m.key,{ownerID:m.key,effects:r});}break;}return l;};k.prototype.__load=function(l){var m=c('XMediaEffectAsyncFetchController').getURIBuilder().setFBIDSet('owner_ids',[l]).setEnumSet('statuses',j).getURI();new (c('AsyncRequest'))(m).setHandler(function(n){c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect_owner/add',key:l,effects:n.payload.effects.map(function(o){return o.id;})});}).setErrorHandler(function(n){c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect_owner/error',key:l,error:n.getError()});}).send();};f.exports=new k(c('MediaEffectStoreSharedDispatcher'));}),null);
__d("XMediaEffectAsyncFetchEffectController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/fbcameraeffects\/async_load_effect\/",{effect_ids:{type:"FBIDSet"}});}),null);
__d('MediaEffectStore',['AsyncRequest','FluxLoadObjectStore','LoadObject','MediaEffectStoreSharedDispatcher','XMediaEffectAsyncFetchEffectController'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxLoadObjectStore'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);k.explicitlyRegisterStore(this);}j.prototype.reduce=function(k,l){switch(l.action){case 'media_effect/add':return this.__handleOne(k,l.key,l.value);case 'media_effect_saved':return this.__handleOne(k,l.effect.effectData.id,l.effect);case 'media_effect/bootstrap':l.bootstrapData.forEach(function(o){k.set(o.effect,c('LoadObject').withValue(o.data));});break;case 'media_effect/error':return this.__handleOne(k,l.key,l.error);case 'media_effect/reload':this.__load(l.key);return k.remove(l.key);case 'media_effect/remove':return k.remove(l.key);case 'media_effect/update_effect':var m=k.get(l.key).getValue();if(m){var n=Object.assign({},m);n.effectData=l.effectData;return this.__handleOne(k.remove(l.key),l.key,n);}break;}return k;};j.prototype.__load=function(k){var l=c('XMediaEffectAsyncFetchEffectController').getURIBuilder().setFBIDSet('effect_ids',[k]).getURI();new (c('AsyncRequest'))(l).setHandler(function(m){c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect/add',key:k,value:m.getPayload().effects[0]});}).setErrorHandler(function(m){c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect/error',key:k,error:m.getError()});}).send();};f.exports=new j(c('MediaEffectStoreSharedDispatcher'));}),null);
__d('MediaEffectStoresBootstrapper',['MediaEffectFrameEditorDispatcher','MediaEffectMetadataActionCreators','MediaEffectOwnerStore','MediaEffectReactFrameEditorCanvasDataStore','MediaEffectReactFrameEditorDataStore','MediaEffectStore','MediaEffectStoreSharedDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h=[c('MediaEffectReactFrameEditorDataStore'),c('MediaEffectReactFrameEditorCanvasDataStore')],i=[c('MediaEffectStore'),c('MediaEffectOwnerStore')],j={isBootstrapped:false,getEditorStores:function k(){return h;},getMediaEffectStores:function k(){return i;},bootstrap:function k(){if(this.isBootstrapped)return;c('MediaEffectFrameEditorDispatcher').explicitlyRegisterStores(this.getEditorStores());c('MediaEffectStoreSharedDispatcher').explicitlyRegisterStores(this.getMediaEffectStores());this.bootstrapFontData();this.isBootstrapped=true;},bootstrapWithData:function k(l){if(this.isBootstrapped)return;c('MediaEffectFrameEditorDispatcher').explicitlyRegisterStores(this.getEditorStores());c('MediaEffectStoreSharedDispatcher').explicitlyRegisterStores(this.getMediaEffectStores());if(l.fontData){c('MediaEffectMetadataActionCreators').addFontData(l.fontData);}else this.bootstrapFontData();if(l.ownerData)c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect_owner/bootstrap',bootstrapData:l.ownerData});if(l.effectData)c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect/bootstrap',bootstrapData:l.effectData});this.isBootstrapped=true;},bootstrapFontData:function k(){c('MediaEffectMetadataActionCreators').bootstrapFontData();}};f.exports=j;}),null);
__d('MediaEffectOwnerHubContainer.react',['cx','AsyncRequest','AsyncResponse','CenteredContainer.react','FluxContainer','immutable','MediaEffectFlowType','MediaEffectHubEffectActionConfig','MediaEffectOwnerHubEffectCard.react','MediaEffectOwnerHubHeader.react','MediaEffectOwnerHubNullStateCard.react','MediaEffectOwnerStore','MediaEffectStore','MediaEffectStoresBootstrapper','MediaEffectStoreSharedDispatcher','React','XMediaEffectHubEffectActivationAsyncController','XUICard.react','XUISpinner.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k,l,m,n,o=c('immutable').Set;i=babelHelpers.inherits(p,c('React').PureComponent);j=i&&i.prototype;p.prototype.render=function(){return c('React').createElement(c('XUICard.react'),null,c('React').createElement(c('MediaEffectOwnerHubHeader.react'),{title:this.props.title}),c('React').createElement(c('XUICard.react'),null,c('React').createElement(c('CenteredContainer.react'),{className:"_60ll"},c('React').createElement(c('XUISpinner.react'),{size:'large'}))));};function p(){i.apply(this,arguments);}k=babelHelpers.inherits(q,c('React').PureComponent);l=k&&k.prototype;q.prototype.render=function(){return c('React').createElement(c('XUICard.react'),null,c('React').createElement(c('MediaEffectOwnerHubHeader.react'),{title:this.props.title}),c('React').createElement(c('XUICard.react'),null,c('React').createElement('div',{className:"_5-nb"},this.props.errorMessage)));};function q(){k.apply(this,arguments);}m=babelHelpers.inherits(r,c('React').PureComponent);n=m&&m.prototype;r.getStores=function(){return [c('MediaEffectStore'),c('MediaEffectOwnerStore')];};r.calculateState=function(s){var t={isLoading:true};if(!s)return t;var u=c('MediaEffectOwnerStore').get(s.ownerID);if(u.hasError()){var v=u.getError();if(v)t={errorMessage:v.message,isError:true,isLoading:false};}if(!u.hasValue())return t;var w=s.defaultFlowType,x=u.getValueEnforcing().effects;if(x.length===0){t={effectData:null,effectIDs:[],flowType:w,isError:false,isLoading:false,selectedEffectIndex:-1};}else{var y=s.selectedEffectIndex<x.length&&s.selectedEffectIndex>=0?s.selectedEffectIndex:0,z=c('MediaEffectStore').get(x[y]);if(z.hasError()){var aa=z.getError();if(aa)t={errorMessage:aa.message,isError:true,isLoading:false};}else if(z.hasValue()){var ba=z.getValueEnforcing();w=ba.effectData.flowType;t={effectData:ba,effectIDs:x,flowType:w,isError:false,isLoading:false,selectedEffectIndex:y};}else t={isLoading:true};}return t;};function r(s){n.constructor.call(this,s);this.effectUpdateHandler=function(v){var w=this.state.effectIDs.length>0&&this.state.selectedEffectIndex>=0?this.state.effectIDs[this.state.selectedEffectIndex]:'';if(v===w)this.setState({isLoading:true});c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect/reload',key:v});}.bind(this);this.toggleEventHandler=function(v,w){var x=c('XMediaEffectHubEffectActivationAsyncController').getURIBuilder().setBool('activate',w).setFBIDVector('effect_ids',[v]).getURI();new (c('AsyncRequest'))().setURI(x).setHandler(function(y){var z=y.getPayload().effects;z.map(function(aa){c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect/update_effect',key:aa.id,effectData:aa});});}).setErrorHandler(function(y){c('AsyncResponse').defaultErrorHandler(y);}).send();this.setState({isLoading:true});}.bind(this);this.archiveEventHandler=function(v){c('MediaEffectHubEffectActionConfig').archive.onClick(o([v]),function(){this.setState({isLoading:true});c('MediaEffectStoreSharedDispatcher').dispatch({action:'media_effect_owner/update_remove_effect',key:this.state.ownerID,effect:v.id});}.bind(this));}.bind(this);var t={defaultFlowType:s.flowType?s.flowType:c('MediaEffectFlowType').BASIC_HUB,effectData:null,effectIDs:[],errorMessage:'',flowType:s.flowType?s.flowType:c('MediaEffectFlowType').BASIC_HUB,isError:false,isLoading:true,ownerID:s.owner,selectedEffectIndex:-1},u=r.calculateState(t);this.state=Object.assign({},t,u);}r.prototype.componentWillMount=function(){c('MediaEffectStoresBootstrapper').bootstrap();};r.prototype.render=function(){var s=this.props,t=s.title,u=s.optionalData,v=this.state,w=v.effectData,x=v.effectIDs,y=v.errorMessage,z=v.flowType,aa=v.isError,ba=v.isLoading,ca=v.ownerID;if(aa){return c('React').createElement(q,{errorMessage:y,title:t});}else if(ba){return c('React').createElement(p,{title:t});}else if(x.length>0&&w){var da=w;return c('React').createElement(c('MediaEffectOwnerHubEffectCard.react'),{archiveEventHandler:this.archiveEventHandler,effect:da,effectID:da.effectData.id,effectUpdateHandler:this.effectUpdateHandler,flowType:z,key:'EffectCard'+da.effectData.id,title:t,toggleEventHandler:this.toggleEventHandler});}else return c('React').createElement(c('MediaEffectOwnerHubNullStateCard.react'),{flowType:z,optionalData:u,owner:ca,title:t});};f.exports=c('FluxContainer').create(r);}),null);
__d('MediaEffectOwnerHubWidgetInit',['MediaEffectOwnerHubContainer.react','MediaEffectStoresBootstrapper','React','ReactRenderer'],(function a(b,c,d,e,f,g){'use strict';var h={init:function i(j){if(j.bootstrapData){c('MediaEffectStoresBootstrapper').bootstrapWithData(j.bootstrapData);}else c('MediaEffectStoresBootstrapper').bootstrap();c('ReactRenderer').renderComponent(c('React').createElement(c('MediaEffectOwnerHubContainer.react'),j.ownerWidgetProps),j.root);}};f.exports=h;}),null);